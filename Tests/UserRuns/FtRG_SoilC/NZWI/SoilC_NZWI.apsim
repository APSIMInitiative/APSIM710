<folder version="36" creator="Apsim 7.6-r3467" name="simulations">
  <simulation name="NZWI">
    <metfile name="met">
      <filename name="filename" input="yes">%apsim%\Tests\UserRuns\FtRG_SoilC\NZWI\NZWI.met</filename>
    </metfile>
    <clock>
      <start_date type="date" description="Enter the start date of the simulation">01/08/1996</start_date>
      <end_date type="date" description="Enter the end date of the simulation">31/12/2011</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <SoilTemperature2>
        <MaxTTimeDefault type="text" description="MaxTTimeDefault">14</MaxTTimeDefault>
        <BoundaryLayerConductanceSource type="text" description="BoundaryLayerConductanceSource">calc</BoundaryLayerConductanceSource>
        <BoundaryLayerConductance type="text" description="BoundaryLayerConductance">20</BoundaryLayerConductance>
        <BoundaryLayerConductanceIterations type="text" description="BoundaryLayerConductanceIterations">1</BoundaryLayerConductanceIterations>
        <NetRadiationSource type="text" description="NetRadiationSource">calc</NetRadiationSource>
        <DefaultWindSpeed type="text" description="DefaultWindSpeed">3</DefaultWindSpeed>
        <DefaultAltitude type="text" description="DefaultAltitude">18</DefaultAltitude>
        <DefaultInstrumentHeight type="text" description="DefaultInstrumentHeight">1.2</DefaultInstrumentHeight>
        <BareSoilHeight type="text" description="BareSoilHeight">57</BareSoilHeight>
      </SoilTemperature2>
      <Soil>
        <RecordNumber>0</RecordNumber>
        <LocalName>Horotiu Silt Loam</LocalName>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <DataSource>Val generated from Landcare soils database, published data and pedotransfer functions</DataSource>
        <Water>
          <Thickness>
            <double>170</double>
            <double>110</double>
            <double>80</double>
            <double>110</double>
            <double>80</double>
            <double>150</double>
            <double>250</double>
            <double>550</double>
          </Thickness>
          <BD>
            <double>1.2</double>
            <double>1.35</double>
            <double>1.42</double>
            <double>0.29</double>
            <double>0.44</double>
            <double>0.44</double>
            <double>0.34</double>
            <double>0.29</double>
          </BD>
          <AirDry>
            <double>0.039</double>
            <double>0.042</double>
            <double>0.045</double>
            <double>0.012</double>
            <double>0.012</double>
            <double>0.012</double>
            <double>0.005</double>
            <double>0.003</double>
          </AirDry>
          <LL15>
            <double>0.27</double>
            <double>0.27</double>
            <double>0.12</double>
            <double>0.04</double>
            <double>0.041</double>
            <double>0.041</double>
            <double>0.018</double>
            <double>0.009</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.17</double>
            <double>0.16</double>
            <double>0.085</double>
            <double>0.085</double>
            <double>0.044</double>
            <double>0.026</double>
          </DUL>
          <SAT>
            <double>0.48</double>
            <double>0.48</double>
            <double>0.44</double>
            <double>0.44</double>
            <double>0.158</double>
            <double>0.158</double>
            <double>0.108</double>
            <double>0.076</double>
          </SAT>
          <KS>
            <double>960</double>
            <double>1440</double>
            <double>1440</double>
            <double>2400</double>
            <double>2400</double>
            <double>2400</double>
            <double>2400</double>
            <double>2400</double>
          </KS>
          <SoilCrop name="AgPasture">
            <Thickness>
              <double>170</double>
              <double>110</double>
              <double>80</double>
              <double>110</double>
              <double>80</double>
              <double>150</double>
              <double>250</double>
              <double>550</double>
            </Thickness>
            <LL>
              <double>0.13</double>
              <double>0.139</double>
              <double>0.151</double>
              <double>0.04</double>
              <double>0.041</double>
              <double>0.041</double>
              <double>0.018</double>
              <double>0.009</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.05</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.5</double>
              <double>0.1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <InitialWater name="Initial water">
          <FractionFull>0.1</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
          <PercentMethod>EvenlyDistributed</PercentMethod>
          <RelativeTo>ll15</RelativeTo>
        </InitialWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>200</RootWt>
          <SoilCN>12.5</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>170</double>
            <double>110</double>
            <double>80</double>
            <double>110</double>
            <double>80</double>
            <double>150</double>
            <double>250</double>
            <double>550</double>
          </Thickness>
          <OC>
            <double>0.035</double>
            <double>0.018</double>
            <double>0.014</double>
            <double>0.002</double>
            <double>0.002</double>
            <double>0.002</double>
            <double>0.001</double>
            <double>0.001</double>
          </OC>
          <FBiom>
            <double>0.08</double>
            <double>0.02</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.58</double>
            <double>0.7</double>
            <double>0.77</double>
            <double>0.9</double>
            <double>0.95</double>
            <double>0.95</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>170</double>
            <double>110</double>
            <double>80</double>
            <double>110</double>
            <double>80</double>
            <double>150</double>
            <double>250</double>
            <double>550</double>
          </Thickness>
          <Rocks>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>72</double>
            <double>67</double>
            <double>67</double>
            <double>76</double>
            <double>81</double>
          </Rocks>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.7</double>
            <double>5.8</double>
            <double>5.8</double>
            <double>5.8</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>6</double>
            <double>6.1</double>
          </PH>
          <CEC>
            <double>14.66</double>
            <double>11.27</double>
            <double>9.6</double>
            <double>6.77</double>
            <double>4.93</double>
            <double>4.93</double>
            <double>4.1</double>
            <double>4.97</double>
          </CEC>
          <ParticleSizeSand>
            <double>13.78</double>
            <double>14.35</double>
            <double>18.42</double>
            <double>12.96</double>
            <double>25.53</double>
            <double>25.53</double>
            <double>21.73</double>
            <double>17.93</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>64.72</double>
            <double>62.65</double>
            <double>59.58</double>
            <double>8.32</double>
            <double>3.51</double>
            <double>3.51</double>
            <double>1.07</double>
            <double>0.5</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>21.5</double>
            <double>23</double>
            <double>22</double>
            <double>6.72</double>
            <double>3.96</double>
            <double>3.96</double>
            <double>1.2</double>
            <double>0.57</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial nitrogen">
          <Thickness>
            <double>170</double>
            <double>110</double>
            <double>80</double>
            <double>110</double>
            <double>80</double>
            <double>150</double>
            <double>250</double>
            <double>550</double>
          </Thickness>
          <NO3>
            <double>6.503</double>
            <double>2.101</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </NO3>
          <NH4>
            <double>0.599</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
          </NH4>
          <NO3Units>ppm</NO3Units>
          <NH4Units>ppm</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <LayerStructure>
          <Thickness>
            <double>10</double>
            <double>20</double>
            <double>30</double>
            <double>40</double>
            <double>50</double>
            <double>50</double>
            <double>50</double>
            <double>50</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>150</double>
            <double>150</double>
            <double>150</double>
            <double>150</double>
            <double>100</double>
          </Thickness>
        </LayerStructure>
        <Swim>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <KDul>1</KDul>
          <PSIDul>-100</PSIDul>
          <VC>true</VC>
          <DTmin>0</DTmin>
          <DTmax>1440</DTmax>
          <MaxWaterIncrement>10</MaxWaterIncrement>
          <SpaceWeightingFactor>0</SpaceWeightingFactor>
          <SoluteSpaceWeightingFactor>0</SoluteSpaceWeightingFactor>
          <Diagnostics>false</Diagnostics>
          <SwimSoluteParameters>
            <Dis>15</Dis>
            <Disp>1</Disp>
            <A>1</A>
            <DTHC>0</DTHC>
            <DTHP>1</DTHP>
            <WaterTableCl>0</WaterTableCl>
            <WaterTableNO3>0</WaterTableNO3>
            <WaterTableNH4>0</WaterTableNH4>
            <WaterTableUrea>0</WaterTableUrea>
            <WaterTableTracer>0</WaterTableTracer>
            <WaterTableMineralisationInhibitor>0</WaterTableMineralisationInhibitor>
            <WaterTableUreaseInhibitor>0</WaterTableUreaseInhibitor>
            <WaterTableNitrificationInhibitor>0</WaterTableNitrificationInhibitor>
            <WaterTableDenitrificationInhibitor>0</WaterTableDenitrificationInhibitor>
            <Thickness>
              <double>170</double>
              <double>110</double>
              <double>80</double>
              <double>110</double>
              <double>80</double>
              <double>150</double>
              <double>250</double>
              <double>550</double>
            </Thickness>
            <NO3Exco>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </NO3Exco>
            <NO3FIP>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </NO3FIP>
            <NH4Exco>
              <double>38.875</double>
              <double>45.016</double>
              <double>45.886</double>
              <double>14.54</double>
              <double>0.13</double>
              <double>0.13</double>
              <double>0.076</double>
              <double>0.054</double>
            </NH4Exco>
            <NH4FIP>
              <double>0.522</double>
              <double>0.468</double>
              <double>0.453</double>
              <double>0.833</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </NH4FIP>
            <UreaExco>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </UreaExco>
            <UreaFIP>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </UreaFIP>
            <ClExco>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </ClExco>
            <ClFIP>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </ClFIP>
            <TracerExco>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </TracerExco>
            <TracerFIP>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </TracerFIP>
          </SwimSoluteParameters>
        </Swim>
      </Soil>
      <folder name="Manager folder">
        <manager2 name="Irrigate3wk">
          <ui>
            <category type="category" description="Irrigation parameters" />
            <amount type="text" description="Amount of irrigation to apply (mm)">100</amount>
            <eff type="text" description="Irrigation efficiency (0-1)">0.5</eff>
            <start type="text" description="The earliest date irrigation will be applied (dd-mmm)">15-sep</start>
            <end type="text" description="The latest date irrigation will be applied (dd-mmm)">15-apr</end>
            <irrig_weeks type="text" description="Apply irrigation every X weeks (1=every week)">3</irrig_weeks>
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Link] Irrigation Irrigation; 
   [Input] DateTime today;
   [Param] float amount;         //amount of irrigation to apply (mm)
   [Param] float eff;            //irrigation efficiency
   [Param] string start;         //no irrigation will be applied before this date
   [Param] string end;           //no irrigation will be applied after this date
   [Param] int irrig_weeks;   //every number of weeks to irrigate
   
   private int week_num;
   
   [EventHandler] public void OnInit2()
   {
      week_num = irrig_weeks-1;
   }
          
   // The following event handler will be called each day at the start of the day
   [EventHandler] public void OnPrepare()
   {
    
      
      //if it's Monday then cycle week_number
      if (today.DayOfWeek.ToString().Equals("Monday"))
      {
         week_num += 1;
         if (week_num &gt; irrig_weeks)
         {
            week_num = 1;
         }
      
      //if it's Monday and we're in the irrigation window
         if (today.DayOfWeek.ToString().Equals("Monday") &amp;&amp; DateUtility.WithinDates(start, today, end))
         {
            // test week_number against irrig_weeks
            if (week_num == irrig_weeks)
            {
               // if week_number = irrig_weeks then do the irrrigation and reset week_number to 0
               IrrigationApplicationType data = new IrrigationApplicationType();
               data.Amount = amount; 
               Irrigation.Set("irrigation_efficiency", eff);
               Irrigation.Apply(data);
            }
         }
      }
   }  
}
       </text>
        </manager2>
        <manager2 name="DoGrazing">
          <ui>
            <Dummy type="category" description="Set grazing parameters" />
            <GrazingTrigger type="list" listvalues="Interval,Biomass,Both" description="Trigger grazing by Interval, Biomass or the earliest of either">Both</GrazingTrigger>
            <arr_Interval type="text" description="Array of monthly (Jan to Dec) grazing intervals (days)">36 36 36 36 57 57 100 100 80 36 36 36 </arr_Interval>
            <arr_PreGraze type="text" description="Array of monthly pre-grazing biomass to trigger grazing (kgDM/ha)">2500 2500 2500 2500 2500 2500 2500 2500 2500 2500 2500 2500 </arr_PreGraze>
            <arr_PostGraze type="text" description="Array of monthly post-grazing biomass (kgDM/ha)">1500 1500 1500 1250 1000 1000 1000 1000 1250 1250 1500 1500 </arr_PostGraze>
            <Dummy type="category" description="Treatment of excreta" />
            <PropNExcreted type="text" description="Proportion of the ingested N that is excreted (dung and urine)">0.75</PropNExcreted>
            <PropExcretedNUrine type="text" description="Proportion of the excreted N that is as urine">0.6</PropExcretedNUrine>
            <DepthUrineDeposition type="text" description="Depth to which urine is deposited in the soil (mm)">150</DepthUrineDeposition>
            <AmtWaterUrine type="text" description="Equivalent depth of water associated with the urine (mm)  [NOT WORKING YET!]">10</AmtWaterUrine>
            <Dummy type="category" description="Treatment of surface litter and tramplling" />
            <PropTrampled type="text" description="Proportion of the pre-grazing biomass that is trampled to litter">0.05</PropTrampled>
            <TrampleSOM type="text" description="Proportion of surface litter incorporated into the soil by hoof action">0.25</TrampleSOM>
            <TrampleSOMDepth type="text" description="Depth to which that litter is incorporated (mm)">100</TrampleSOMDepth>
          </ui>
          <text>Imports System
Imports ModelFramework


Public Class Script 
   
   &lt;Link()&gt; Dim MyPaddock As Paddock
   &lt;Link()&gt; Dim SOM As SurfaceOM
   &lt;Link()&gt; Dim Fert As Fertiliser
   &lt;Link()&gt; Dim Pasture As AgPasture
   &lt;Link()&gt; Dim MySoilN As SoilN
   '&lt;Link()&gt; Dim MySoilWater As SWIM
   
   &lt;Param()&gt; &lt;Output()&gt; Private GrazingTrigger As String
   &lt;Param()&gt; &lt;Output()&gt; Private arr_Interval() As Double 
   &lt;Param()&gt; &lt;Output()&gt; Private arr_PreGraze() As Double 
   &lt;Param()&gt; &lt;Output()&gt; Private arr_PostGraze() As Double 

   &lt;Param()&gt; &lt;Output()&gt; Private PropTrampled As Double    'applies to the pre-graxing biomass
   &lt;Param()&gt; &lt;Output()&gt; Private PropNExcreted As Double 
   &lt;Param()&gt; &lt;Output()&gt; Private PropExcretedNUrine As Double 
   &lt;Param()&gt; &lt;Output()&gt; Private DepthUrineDeposition As Double 

   &lt;Param()&gt; &lt;Output()&gt; Private AmtWaterUrine As Double 
   &lt;Param()&gt; &lt;Output()&gt; Private TrampleSOM As Double 
   &lt;Param()&gt; &lt;Output()&gt; Private TrampleSOMDepth As Double 

   'Events to be raised:
   'Event ChangeSoilNitrogen As NitrogenChangedDelegate

   Private RotLen As Double
   
   &lt;Input&gt; Private dd_mmm_yyyy As String     'Today's date
   &lt;Input&gt; Private dlayer() As Double
   Private Today As Date              'The date of today (in date format)
   Private MonthNum As Integer

   &lt;Output()&gt; Private DaysSinceCut As Integer

   &lt;Output()&gt; Private GrazeNow As Boolean
   &lt;Output()&gt; Private GrazeYesterday As Boolean
   
   'Internal variables
   &lt;Output()&gt; Private Interval As Integer
   &lt;Output()&gt; Private PreGraze As Double 
   &lt;Output()&gt; Private PostGraze As Double 
   
   &lt;Output()&gt; Private DM_Grazed As Double
   &lt;Output()&gt; Private N_Grazed As Double

   &lt;Output()&gt; Private ApparentGR As Double  'apparent growth rate, DM_harvested / DaysSinceCut
   
   &lt;EventHandler()&gt; Public Sub OnInit2()
      
      ReDim Preserve arr_Interval(11)
      ReDim Preserve arr_PreGraze(11)
      ReDim Preserve arr_PostGraze(11)      

      GrazeNow = False
      DaysSinceCut = 0
      ApparentGR = 0.0
      
   End Sub

   &lt;EventHandler()&gt; Public Sub OnPrepare()

      Today = Date.Parse(dd_mmm_yyyy.Replace("_", "/"))
      MonthNum = Today.Month

      Interval = arr_Interval(MonthNum - 1)
      PreGraze = arr_PreGraze(MonthNum - 1)
      PostGraze = arr_PostGraze(MonthNum - 1)
      
      GrazeNow = False
      ApparentGR = 0.0
      DaysSinceCut += 1
      
      If ((GrazingTrigger = "Interval") And (DaysSinceCut &gt;= Interval)) Then
         GrazeNow = True
      ElseIf ((GrazingTrigger = "Biomass") And (Pasture.AboveGroundWt &gt;= PreGraze)) Then
         GrazeNow = True
      ElseIf ((GrazingTrigger = "Both") And ((DaysSinceCut &gt;= Interval) Or (Pasture.AboveGroundWt &gt;= PreGraze))) Then
         GrazeNow = True
      End If
         
      If (GrazeNow) Then

         Dim DM_PreGrazing As Double = 0.0
         Dim N_PreGrazing As Double = 0.0
         
         Dim DM_Removed As Double = 0.0
         Dim N_Removed As Double = 0.0

         Dim DM_ToAllocate As Double = 0.0
         Dim N_ToAllocate As Double = 0.0
      
         Dim DM_Trampled As Double = 0.0
         Dim N_Trampled As Double = 0.0

         Dim DM_ExcretedDung As Double
         Dim N_Excreted as Double
         Dim N_ExcretedDung As Double
         Dim N_ExcretedUrine as Double

         DM_PreGrazing = Pasture.AboveGroundWt 
         N_PreGrazing = Pasture.AboveGroundN 
      
         Dim GZ As GrazeType = New GrazeType()
         GZ.amount = PostGraze
         GZ.type = "residue"
         GZ.sender = "DoGrazing"
         Pasture.Graze(GZ)
         
         'from standing biomass
         DM_Removed = DM_PreGrazing - Pasture.AboveGroundWt: DM_ToAllocate = DM_Removed: DM_Grazed = DM_Removed
         N_Removed = N_PreGrazing - Pasture.AboveGroundN: N_ToAllocate = N_Removed: N_Grazed = N_Removed
         ApparentGR = DM_Removed / DaysSinceCut


         ' allocate some of the biomass removed to trampling and litter
         DM_Trampled = Math.Max(0.0, PropTrampled * DM_ToAllocate): DM_ToAllocate -= DM_Trampled
         N_Trampled = Math.Max(0.0, PropTrampled * N_ToAllocate): N_ToAllocate -= N_Trampled

         ' C excreted comes from digesitibility
         N_Excreted = Math.Max(0.0, PropNExcreted * N_ToAllocate): N_ToAllocate -= N_Excreted
         N_ExcretedUrine = Math.Max(0.0, N_Excreted * PropExcretedNUrine)
         N_ExcretedDung = Math.Max(0.0, N_Excreted - N_ExcretedUrine)
         DM_ExcretedDung = Math.Max(0.0, (1.0 - Pasture.HerbageDigestibility) * DM_ToAllocate)
                  
         'move the trampled DM to litter
         Dim litter As BiomassRemovedType = New BiomassRemovedType()
         litter.crop_type = "grass"
         litter.dm_type = New String() {"grass"}
         litter.dlt_crop_dm = New Single() {DM_Trampled}  
         litter.dlt_dm_n = New Single() {N_Trampled}
         litter.dlt_dm_p = New Single() {0.0}
         litter.fraction_to_residue = New Single() {1.0}
         SOM.Biomassremoved(litter)

         'move the dung to litter
         Dim dung As BiomassRemovedType = New BiomassRemovedType()
         dung.crop_type = "RuminantDung_PastureFed"
         dung.dm_type = New String() {"RuminantDung_PastureFed"}  
         dung.dlt_crop_dm = New Single() {DM_ExcretedDung} 
         dung.dlt_dm_n = New Single() {N_ExcretedDung}  
         dung.dlt_dm_p = New Single() {0.0}
         dung.fraction_to_residue = New Single() {1.0}
         SOM.Biomassremoved(dung)
         
         'move the urine to the soil
         Dim SumDepth As Double = 0.0
         Dim UrineUrea(dlayer.length) As Double
         Dim UrineWater(dlayer.length) As Double
         For i As Integer = 0 To dlayer.Length - 1
            SumDepth += dlayer(i)
            If SumDepth &lt;= DepthUrineDeposition Then
               UrineUrea(i) = dlayer(i) / DepthUrineDeposition * N_ExcretedUrine
               UrineWater(i) = dlayer(i) / DepthUrineDeposition * AmtWaterUrine
            Else
               UrineUrea(i) = Math.Max(0.0, (DepthUrineDeposition - SumDepth)) / DepthUrineDeposition * N_ExcretedUrine
               UrineWater(i) = Math.Max(0.0, (DepthUrineDeposition - SumDepth)) / DepthUrineDeposition * AmtWaterUrine
            End If
            'MySoilWater.sw_dep(i) += UrineWater(i)
         Next
         
         Dim urine As NitrogenChangedType = New NitrogenChangedType
         urine.DeltaUrea = UrineUrea
         urine.DeltaNO3 = New Double() {}
         urine.DeltaNH4 = New Double() {}
         MySoilN.NitrogenChanged(urine)  
         
         Dim trampling As TillageType = New TillageType
         trampling.tillage_depth = TrampleSOMDepth
         trampling.f_incorp = TrampleSOM
         SOM.Tillage(trampling)
         
         GrazeYesterday = True
         DaysSinceCut = 0
         
      Else

         DM_Grazed = 0.0
         N_Grazed = 0.0
         
      End If
      
   End Sub

   
End Class
    </text>
        </manager2>
        <manager2 name="Reporting">
          <ui>
            <ReportStart_str type="text" description="Date to start the reporting">01/01/1900</ReportStart_str>
            <AccumStart_str type="text" description="Date to start the accumulation calculations">01/01/1900</AccumStart_str>
            <ReportModuleName type="text" description="Name of the Reporting module">Sim</ReportModuleName>
            <ResetCum type="list" listvalues="yes,no" description="Reset the accumulation every year?">yes</ResetCum>
            <ReportingFreq type="list" listvalues="Daily,Weekly,TenDaily,Monthly,Annual" description="Reporting frequency">Monthly</ReportingFreq>
          </ui>
          <text>Imports System
Imports ModelFramework


Public Class Script 
   
   &lt;Link()&gt; Dim MyPaddock As Paddock
   &lt;Link()&gt; Dim MySoilN As SoilN
   &lt;Link()&gt; Dim MyIrrig As Irrigation
   &lt;Link()&gt; Dim MyFert As Fertiliser
   &lt;Link()&gt; Dim MyOutput As Outputfile

   'My properties
   &lt;Param&gt; Private ReportingFreq As String   '&lt;Param&gt; Private ReportingFreq As String
   &lt;Param&gt; Private AccumStart_str As String
   &lt;Param&gt; Private ReportStart_str As String
   &lt;Param&gt; Private ReportModuleName As String
   &lt;Param&gt; Private ResetCum As String

   
   'Time type information 
   &lt;Input&gt; Private dd_mmm_yyyy As String     'Today's date
   &lt;Input&gt; Private day As Integer
   &lt;Input&gt; Private year As Integer
   &lt;Input&gt; Private day_of_month As Integer
   &lt;Input&gt; Private is_end_week As Boolean
   &lt;Input&gt; Private is_end_month As Boolean
   &lt;Input&gt; Private is_end_year As Boolean
   &lt;Input&gt; Private simulation_end_day As Integer
   &lt;Input&gt; Private simulation_end_year As Integer
   &lt;Input&gt; Private simulation_days As Integer
   
   
   &lt;Output&gt;&lt;Units("")&gt; Public DaysInAve As Integer
   &lt;Output&gt;&lt;Units("")&gt; Public DaysInCum As Integer
   &lt;Output&gt;&lt;Units("")&gt; Public DaysInSum As Integer
   &lt;Output&gt;&lt;Units("")&gt; Public DaysAfterStart As Integer
   &lt;Output&gt;&lt;Units("")&gt; Public end_sim As Integer
   
   &lt;Input&gt; Private dlayer As Single()         'Thickness of soil layers (mm)
   
   Private Today As Date                      'The date of today (in date format)
   Private AccumStart As Date                 'Date to start the accumulations
   Private ReportStart As Date                'Date to start the reporting
   &lt;Output&gt;Private ReportToday As Integer     
   &lt;Output&gt;Private ReportYesterday As Integer 
   
   &lt;Input&gt;  Private DM_Grazed As Single
   &lt;Output&gt;&lt;Units("mm")&gt; Private CumDMGrazed As Single
   &lt;Input&gt;  Private N_Grazed As Single
   &lt;Output&gt;&lt;Units("mm")&gt; Private CumNGrazed As Single

   &lt;Input&gt;  Private HerbageGrowthWt As Single
   &lt;Output&gt;&lt;Units("mm")&gt; Private SumGrowth As Single
   &lt;Output&gt;&lt;Units("mm")&gt; Private CumGrowth As Single
   
   
   &lt;Input&gt;  Private rain As Single
   &lt;Input&gt;  Private Irrigation as Single
   &lt;Output&gt;&lt;Units("mm")&gt; Private CumPrecip As Single

   &lt;Input&gt;  Private sw_dep As Single()
   &lt;Input&gt;  Private sat_dep As Single()
   &lt;Input&gt;  Private dul_dep As Single()
   &lt;Input&gt;  Private ll15_dep As Single()
   &lt;Output&gt;&lt;Units("mm")&gt; Private Satdep As Single()
   &lt;Output&gt;&lt;Units("mm")&gt; Private Duldep As Single()
   &lt;Output&gt;&lt;Units("mm")&gt; Private ll15dep As Single()
   &lt;Output&gt;&lt;Units("mm")&gt; Private SWdep As Single()
   
   &lt;Input&gt;  Private drain As Single
   &lt;Output&gt;&lt;Units("mm")&gt; Private CumDrain As Single
   
   &lt;Input&gt;  Private sw As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private SW_l As Single()
   &lt;Input&gt;  Private dul As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private Dul_l As Single()
   &lt;Input&gt;  Private ll15 As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private ll15_l As Single()
   
   
   &lt;Input&gt;  Private urea As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private urea_l As Single()
   &lt;Input&gt;  Private nh4 As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private nh4_l As Single()
   &lt;Input&gt;  Private no3 As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private no3_l As Single()

   &lt;Input&gt;  Private biom_n As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private biom_n_l As Single()

   &lt;Input&gt;  Private fom_n As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private fom_n_l As Single()

   &lt;Input&gt;  Private hum_n As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private hum_n_l As Single()

   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private org_n_l As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private min_n_l As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private dlt_biom_n_l As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private dlt_fom_n_l As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private dlt_hum_n_l As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private dlt_org_n_l As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private dlt_min_n_l As Single()
   
   &lt;Input&gt;  Private HarvestWt As Single
   &lt;Output&gt;&lt;Units("mm")&gt; Private cumHarvestWt As Single
   &lt;Input&gt;  Private HarvestN As Single
   &lt;Output&gt;&lt;Units("mm")&gt; Private cumHarvestN As Single

   &lt;Input&gt;  Private leach_no3 As Single
   &lt;Output&gt;&lt;Units("mm")&gt; Private cumleach_no3 As Single
   &lt;Input&gt;  Private leach_nh4 As Single
   &lt;Output&gt;&lt;Units("mm")&gt; Private cumleach_nh4 As Single

   &lt;Input&gt;  Private dnit As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private cum_dnit As Single
   &lt;Input&gt;  Private n2o_atm As Single()
   &lt;Output&gt;&lt;Units("kg/ha")&gt; Private cum_n2o_atm As Single

   
   
   Private ini_biom_n_l As Single()
   Private ini_fom_n_l As Single()
   Private ini_hum_n_l As Single()
   Private ini_org_n_l As Single()
   Private ini_min_n_l As Single()

   Private OutStartDepth As Single()
   Private OutEndDepth As Single()
   Private NumDepths As Integer
   Private WeightsArray As Single(,)
   Private SimStartDepth As Single()
   Private SimEndDepth As Single()


   &lt;EventHandler()&gt; Public Sub OnInit2()
      
      
      'ReportingFreq = "never"
      'ReportStart_str = "01/01/1900"
      
      
      NumDepths = 5
      ReDim OutStartDepth(NumDepths - 1)
      ReDim OutEndDepth(NumDepths - 1)
      ReDim WeightsArray(dlayer.Length - 1, NumDepths - 1)
      
      ReDim Satdep(NumDepths - 1)
      ReDim Duldep(NumDepths - 1)
      ReDim ll15dep(NumDepths - 1)
      ReDim SWdep(NumDepths - 1)
      ReDim Dul_l(NumDepths - 1)
      ReDim ll15_l(NumDepths - 1)
      ReDim SW_l(NumDepths - 1)
      ReDim urea_l(NumDepths - 1)
      ReDim nh4_l(NumDepths - 1)
      ReDim no3_l(NumDepths - 1)
      'ReDim SoilpH_l(NumDepths - 1)
      ReDim biom_n_l(NumDepths - 1)
      ReDim fom_n_l(NumDepths - 1)
      ReDim hum_n_l(NumDepths - 1)
      ReDim org_n_l(NumDepths - 1)
      ReDim min_n_l(NumDepths - 1)

      ReDim dlt_biom_n_l(NumDepths - 1)
      ReDim dlt_fom_n_l(NumDepths - 1)
      ReDim dlt_hum_n_l(NumDepths - 1)
      ReDim dlt_org_n_l(NumDepths - 1)
      ReDim dlt_min_n_l(NumDepths - 1)
      ReDim ini_biom_n_l(NumDepths - 1)
      ReDim ini_fom_n_l(NumDepths - 1)
      ReDim ini_hum_n_l(NumDepths - 1)
      ReDim ini_org_n_l(NumDepths - 1)
      ReDim ini_min_n_l(NumDepths - 1)

      
      OutStartDepth(0) = 0.0: OutEndDepth(0) = 20.0
      OutStartDepth(1) = 20.0: OutEndDepth(1) = 100.0
      OutStartDepth(2) = 100.0: OutEndDepth(2) = 200.0
      OutStartDepth(3) = 200.0: OutEndDepth(3) = 700.0
      'OutStartDepth(4) = 0.0: OutEndDepth(4) = 700.0
      
      Dim SimStartDepth As Single()
      Dim SimEndDepth As Single()
      ReDim SimStartDepth(dlayer.length - 1)
      ReDim SimEndDepth(dlayer.length - 1)
      SimStartDepth(0) = 0.0
      SimEndDepth(0) = dlayer(0)
      For SimLayer As Integer = 1 To dlayer.length - 1
         SimStartDepth(SimLayer) = SimEndDepth(SimLayer - 1)
         SimEndDepth(SimLayer) = SimEndDepth(SimLayer - 1) + dlayer(SimLayer)
      Next

      
      For OutLayer As Integer = 0 To NumDepths - 1
         For SimLayer As Integer = 0 To dlayer.length - 1

            WeightsArray(SimLayer, OutLayer) = Math.MAX(0.0, Math.MIN(Math.MIN(OutEndDepth(OutLayer), SimEndDepth(SimLayer)) - OutStartDepth(OutLayer), Math.MIN(OutEndDepth(OutLayer), SimEndDepth(SimLayer)) - SimStartDepth(SimLayer))) 
            WeightsArray(SimLayer, OutLayer) = WeightsArray(SimLayer, OutLayer) / (SimEndDepth(SimLayer) - SimStartDepth(SimLayer))
         
         Next  'SimLayer
      Next     'OutLayer

      Console.WriteLine("Array of Weights")
      For SimLayer As Integer = 0 To dlayer.length - 1
         Dim Line2Write As String = "End depth (mm): " &amp; SimEndDepth(SimLayer)
         For i As Integer = 0 To NumDepths - 1
            Line2Write += "   " &amp; WeightsArray(SimLayer, i)
         Next
         Console.WriteLine(Line2Write)
      Next  'SimLayer 
      
      
      AccumStart = Date.Parse(AccumStart_str)
      ReportStart = Date.Parse(ReportStart_str)
      ReportYesterday = 1
      
   End Sub

   &lt;EventHandler()&gt; Public Sub OnPrepare()

      Today = Date.Parse(dd_mmm_yyyy.Replace("_", "/"))
      If (day = simulation_end_day) And (year = simulation_end_year) Then
         end_sim = 1
      End If

   ReportToday = 0      
   If Today &gt;= ReportStart Then
      DaysAfterStart += 1
         If ReportingFreq.ToLower = "daily" Then
            ReportToday = 1
         ElseIf ReportingFreq.ToLower = "weekly" Then
            If (is_end_week) Then
               ReportToday = 1
            End If
         ElseIf ReportingFreq.ToLower = "tendaily" Then
            If (day_of_month = 10) Or (day_of_month = 20) Or (is_end_month) Then
               ReportToday = 1
            End If
         ElseIf ReportingFreq.ToLower = "monthly" Then
            If (is_end_month) Then
               ReportToday = 1
            End If
         ElseIf ReportingFreq.ToLower = "annual" Then
            If (is_end_year) Then
               ReportToday = 1
            End If
         ElseIf ReportingFreq.ToLower = "never" Then
            ReportToday = 0      
         Else
            Throw New Exception("Invalid reporting frequency")
         End If
      End If

      If (Today = ReportStart) Or (ReportYesterday = 1) Then 
         ZeroAverages()
         ZeroSums()
         ReportYesterday = 0
      End If

      If (ResetCum.ToLower = "yes") Then
         If (Today.Month = AccumStart.Month) And (Today.Day = AccumStart.Day) Then
            ZeroAccums()
         End If
      End If

      
      If simulation_days = 0 Then

         DoDepthArrays()  ' if this is the first day of the simulation then need ot do the depth aggregation first.  Other days is left over from previous post
         console.writeline("Initialised the deltas")
      End If

      For OutLayer As Integer = 0 To NumDepths - 1 
         ini_biom_n_l(OutLayer) = biom_n_l(OutLayer)
         ini_fom_n_l(OutLayer) = fom_n_l(OutLayer)
         ini_hum_n_l(OutLayer) = hum_n_l(OutLayer)
         ini_org_n_l(OutLayer) = org_n_l(OutLayer)
         ini_min_n_l(OutLayer) = min_n_l(OutLayer) 
      Next
      
      
   End Sub

   &lt;EventHandler()&gt; Public Sub OnPost() 
      
      If Today &gt;= ReportStart Then
         
         DoDepthArrays()
         DoDeltas()
         DoAverages()                        ' sum the Sum outputs
         DoSums()                        ' sum the Sum outputs
         DoAccums()                      ' accum the Cum outputs
                 
         If ReportToday = 1 Then         ' publish the report as needed and set reporting flags

            AverageAverages()
 
            MyOutput.Publish("do_output")
            ReportYesterday = 1
         End If
         
      End If

   End Sub
   
   
   Public Sub ZeroAverages()

      DaysInAve = 0
      
   End Sub
   
   
   Public Sub ZeroSums()
      
      DaysInSum = 0
      SumGrowth = 0.0

   End Sub

   
   Public Sub ZeroAccums()
      
      DaysInCum = 0
      
      CumPrecip = 0.0
      CumDrain = 0.0
      
      cumHarvestWt = 0.0
      cumHarvestN = 0.0

      cumleach_no3 = 0.0
      leach_nh4 = 0.0

      cum_dnit = 0.0
      cum_n2o_atm = 0.0
      
      CumDMGrazed = 0.0
      CumNGrazed = 0.0

      CumGrowth = 0.0

   End Sub
   
   
   Public Sub DoDepthArrays()
      
      For OutLayer As Integer = 0 To NumDepths - 1
         Satdep(OutLayer) = 0.0
         Duldep(OutLayer) = 0.0
         ll15dep(OutLayer) = 0.0
         SWdep(OutLayer) = 0.0
         Dul_l(OutLayer) = 0.0
         ll15_l(OutLayer) = 0.0
         SW_l(OutLayer) = 0.0
         urea_l(OutLayer) = 0.0
         nh4_l(OutLayer) = 0.0
         no3_l(OutLayer) = 0.0
         'SoilpH_l(OutLayer) = 0.0
         biom_n_l(OutLayer) = 0.0
         fom_n_l(OutLayer) = 0.0
         hum_n_l(OutLayer) = 0.0

         For SimLayer As Integer = 0 To dlayer.length - 1

            ll15dep(OutLayer) += WeightsArray(SimLayer, OutLayer) * ll15_dep(SimLayer)
            Duldep(OutLayer) += WeightsArray(SimLayer, OutLayer) * dul_dep(SimLayer)
            Satdep(OutLayer) += WeightsArray(SimLayer, OutLayer) * sat_dep(SimLayer)
            SWdep(OutLayer) += WeightsArray(SimLayer, OutLayer) * sw_dep(SimLayer)
            urea_l(OutLayer) += WeightsArray(SimLayer, OutLayer) * urea(SimLayer)
            nh4_l(OutLayer) += WeightsArray(SimLayer, OutLayer) * nh4(SimLayer)
            no3_l(OutLayer) += WeightsArray(SimLayer, OutLayer) * no3(SimLayer)
            'SoilpH_l(OutLayer) += WeightsArray(SimLayer, OutLayer) * SoilpH(SimLayer) / dlayer(SimLayer)
            biom_n_l(OutLayer) += WeightsArray(SimLayer, OutLayer) * biom_n(SimLayer)
            fom_n_l(OutLayer) += WeightsArray(SimLayer, OutLayer) * fom_n(SimLayer)
            hum_n_l(OutLayer) += WeightsArray(SimLayer, OutLayer) * hum_n(SimLayer)

         Next  'SimLayer
         
         'SoilpH_l(OutLayer) = SoilpH_l(OutLayer) / (OutEndDepth(OutLayer) - OutStartDepth(OutLayer))

         ll15_l(OutLayer) = ll15dep(OutLayer) / (OutEndDepth(OutLayer) - OutStartDepth(OutLayer))
         Dul_l(OutLayer) = Duldep(OutLayer) / (OutEndDepth(OutLayer) - OutStartDepth(OutLayer))
         SW_l(OutLayer) = SWdep(OutLayer) / (OutEndDepth(OutLayer) - OutStartDepth(OutLayer))

         org_n_l(OutLayer) = biom_n_l(OutLayer) + fom_n_l(OutLayer) + hum_n_l(OutLayer)
         min_n_l(OutLayer) = urea_l(OutLayer) + nh4_l(OutLayer) + no3_l(OutLayer)
         
      Next     'OutLayer
      
      
   End Sub
   
   Public Sub DoDeltas()
      
      For OutLayer As Integer = 0 To NumDepths - 1 
         dlt_biom_n_l(OutLayer) = biom_n_l(OutLayer) - ini_biom_n_l(OutLayer) 
         dlt_fom_n_l(OutLayer) = fom_n_l(OutLayer) - ini_fom_n_l(OutLayer) 
         dlt_hum_n_l(OutLayer) = hum_n_l(OutLayer) - ini_hum_n_l(OutLayer) 
         dlt_org_n_l(OutLayer) = org_n_l(OutLayer) - ini_org_n_l(OutLayer) 
         dlt_min_n_l(OutLayer) = min_n_l(OutLayer) - ini_min_n_l(OutLayer) 
      Next


   End Sub
   
   Public Sub DoAverages()
      
      DaysInAve += 1

   End Sub
   
   Public Sub DoSums()
      
      DaysInSum += 1
      
      SumGrowth += HerbageGrowthWt 

   End Sub

   
   Public Sub DoAccums()
      
      DaysInCum += 1
      
      CumPrecip += rain + Irrigation
      CumDrain += drain
      
      cumHarvestWt = cumHarvestWt + HarvestWt
      cumHarvestN = cumHarvestN + HarvestN
      HarvestWt = 0.0
      HarvestN = 0.0
      
      cumleach_no3 += leach_no3
      cumleach_nh4 += leach_nh4

      CumDMGrazed += DM_Grazed
      CumNGrazed += N_Grazed
      
      CumGrowth += HerbageGrowthWt 

    
      For SimLayer As Integer = 0 To dlayer.length - 1
         cum_dnit += dnit(SimLayer)
         cum_n2o_atm += n2o_atm(SimLayer)
      Next  'SimLayer 
      
   End Sub
   
   
   Public Sub AverageAverages()

      
   End Sub



   
End Class
    </text>
        </manager2>
      </folder>
      <micromet name="Micromet">
        <soilalbedo type="text" description="soilalbedo">0.23</soilalbedo>
        <a_interception type="text" description="a_interception">0</a_interception>
        <b_interception type="text" description="b_interception">0</b_interception>
        <c_interception type="text" description="c_interception">0</c_interception>
        <d_interception type="text" description="d_interception">0</d_interception>
      </micromet>
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">300</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.85</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1.0</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in ML">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0</default_cl_conc>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0</default_cl_conc>
      </irrigation>
      <fertiliser />
      <surfaceom name="surface organic matter">
        <PoolName type="text" description="Organic Matter pool name">grass</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">grass</type>
        <mass type="text" description="Initial surface residue (kg/ha)">700</mass>
        <cnr type="text" description="C:N ratio of initial residue">17</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <AgPasture>
        <Nspecies type="text" description="Number of species">2</Nspecies>
        <thisCropName type="text" description="Crop name shown as on the simulation tree">AgPasture</thisCropName>
        <cropName type="text" description="Species names">ryegrass whiteclover</cropName>
        <dmshoot type="text" description="Initial shoot dry matter (kg/ha)">1000      250</dmshoot>
        <dmlitter type="text" description="Initial litter dry matter (kg/ha)">250        50</dmlitter>
        <dmgreenmin type="text" description="Minimum green dry matter (kg/ha)">500        50</dmgreenmin>
        <rootDepth type="text" description="Root depth (mm)">600        250</rootDepth>
        <RootDistributionMethod type="list" listvalues="Homogeneous,UserDefined,ExpoLinear" description="Method to define the root distribution over the soil profile:">ExpoLinear</RootDistributionMethod>
        <ExpoLinearDepthParam type="text" description="Root distribution parameter, fraction of root depth to decrease root proportion (0-1):">0.3</ExpoLinearDepthParam>
        <ExpoLinearCurveParam type="text" description="Root distribution parameter, exponent for decreasing phase of root proportion:">1.0</ExpoLinearCurveParam>
        <WaterUptakeSource type="text" description="Water uptake done by AgPasture (calc) or by apsim?">apsim</WaterUptakeSource>
      </AgPasture>
      <outputfile name="Sim">
        <filename output="yes">NZWI Sim.out</filename>
        <title>NZWI Sim</title>
        <events name="Freq" />
        <variables name="Data">
          <variable>dd/mmm/yyyy as Date</variable>
          <variable>CumDMGrazed</variable>
          <variable>CumGrowth</variable>
          <variable>SumGrowth</variable>
          <variable>carbon_tot()</variable>
          <variable>biom_c()</variable>
          <variable>fom_c()</variable>
          <variable>hum_c()</variable>
        </variables>
      </outputfile>
    </area>
  </simulation>
</folder>