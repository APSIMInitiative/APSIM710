[1958_start.clock.parameters]
start_date = 1/1/1958     ! dd/mm/yyyy
end_date = 30/1/2003     ! dd/mm/yyyy

[all.manager.init]
event = 0
crop_flag = 0
sow_date = 0
cycle_num = 0

[salmon_gums.manager.init]
wheat_fert=40
! a base N amount of 10 is applied, because no higher amounts showed any response in sorg
sorg_fert=10

[scaddan.manager.init]
wheat_fert=80
! a base N amount of 10 is applied, because no higher amounts showed any response in sorg
sorg_fert=10

[myrup.manager.init]
wheat_fert=100
! optimal conditions analysis showed an N response in sorghum at Myrup up to 40kg/ha N
sorg_fert=30

[kendenup.manager.init]
wheat_fert=80
! a base N amount of 10 is applied, because no higher amounts showed any response in sorg
sorg_fert=10

[salmon_gums.manager.start_of_day]
esw10=8.2
esw50=41
esw75=62
esw_layer1 = SoilWat.sw_dep(1)-SoilWat.ll15_dep(1)
esw_layer2 = SoilWat.sw_dep(2)-SoilWat.ll15_dep(2)
esw_layer3 = SoilWat.sw_dep(3)-SoilWat.ll15_dep(3)
esw_layer4 = SoilWat.sw_dep(4)-SoilWat.ll15_dep(4)
esw_rooting_zone = esw_layer1 + esw_layer2 + esw_layer3 + esw_layer4
rz_no3 = no3(1) + no3(2) + no3(3) + no3(4) ! soil nitrate in the root zone

[scaddan.manager.start_of_day]
esw10=10
esw50=49
esw75=73
esw_layer1 = soilwat2.sw_dep(1)-soilwat2.ll15_dep(1)
esw_layer2 = soilwat2.sw_dep(2)-soilwat2.ll15_dep(2)
esw_layer3 = soilwat2.sw_dep(3)-soilwat2.ll15_dep(3)
esw_layer4 = soilwat2.sw_dep(4)-soilwat2.ll15_dep(4)
esw_layer5 = soilwat2.sw_dep(5)-soilwat2.ll15_dep(5)
esw_rooting_zone = esw_layer1 + esw_layer2 + esw_layer3 + esw_layer4 + esw_layer5
rz_no3 = no3(1) + no3(2) + no3(3) + no3(4) + no3(5) ! soil nitrate in the root zone

[myrup.manager.start_of_day]
esw10=9
esw50=45
esw75=68
esw_rooting_zone = SoilWat.esw
rz_no3 = no3() ! soil nitrate in the root zone

[kendenup.manager.start_of_day]
esw10=5
esw50=21
esw75=32
esw_layer1 = SoilWat.sw_dep(1)-SoilWat.ll15_dep(1)
esw_layer2 = SoilWat.sw_dep(2)-SoilWat.ll15_dep(2)
esw_layer3 = SoilWat.sw_dep(3)-SoilWat.ll15_dep(3)
esw_rooting_zone = esw_layer1 + esw_layer2 + esw_layer3
rz_no3 = no3(1) + no3(2) + no3(3) !! soil nitrate in the root zone

[all.accum.parameters]
Accum_variables = rain[5]

[all.SurfaceOM.parameters]
mass = 1000
cnr = 80
type = wheat

!!!! soil water at initialisation !!!!


!------- Default Sections for all simulations -------------!
!----------------------------------------------------------!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! Rotation 1 - sorghum opportunity crop and wheat+N100 !!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

name = wheat
[sorg_wht.manager.start_of_day]
! CROP_FLAG = 0 - neither crop in the ground
! CROP_FLAG = 1 - sorghum in the ground
! CROP_FLAG = 2 - wheat in the ground

! EVENT = 1 - sorghum sow
! EVENT = 2 - sorghum harvest
! EVENT = 3 - wheat sow
! EVENT = 4 - wheat harvest

! reset residues every year to same level


!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!! sorghum !!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

  if ((day >= 300  or  day <= 30)         and
     sorghum.plant_status = 'out'              and
     crop_flag = 0                          and
     rain[5] >= 25  )                       then
     crop_flag = 1
     event = 1
     cycle_num = cycle_num + 1
     sow_date = day
     sorghum sow cultivar = early, plants = 5 (/m2), sowing_depth = 30 (mm),  tiller_no_fertile = 0
       if rz_no3 < sorg_fert then
         amountno3 = (sorg_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif
     report do_output
   endif

   if (sorghum.stage = 11 or sorghum.plant_status = 'dead' or sorghum.DaysAfterSowing > 150) then
     event = 2
     report do_output
     sorghum harvest
     sorghum kill_crop
     sorghum end_crop
     surfaceom tillage type=graze ()
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! wheat crop !!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 135  and  day <= 210)        and
     wheat.plant_status = 'out'                      and
     sorghum.plant_status = 'out'              and
     rain[10] >= 25  )                       then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

!! plant at end of window if criteria not met

   if day = 211 and
     sorghum.plant_status = 'out'              and
     wheat.plant_status = 'out'                      then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if wheat.StageName = 'harvest_ripe' or wheat.plant_status = 'dead' and
     crop_flag = 2         then
     event = 4
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset

   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! Rotation 1a - sorghum opportunity crop and wheat+N100 !!!!!!!!!!
!!!!!!!!! rainfall rule + esw >10mm !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

[sorg_wht_esw10.manager.start_of_day]
! CROP_FLAG = 0 - neither crop in the ground
! CROP_FLAG = 1 - sorghum in the ground
! CROP_FLAG = 2 - wheat in the ground

! EVENT = 1 - sorghum sow
! EVENT = 2 - sorghum harvest
! EVENT = 3 - wheat sow
! EVENT = 4 - wheat harvest

! reset residues every year to same level


!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!! sorghum !!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!



  if ((day >= 300  or  day <= 30)           and
     sorghum.plant_status = 'out'              and
     crop_flag = 0                          and
     rain[5] >= 25                          and
     esw_rooting_zone >= esw10)             then
     crop_flag = 1
     event = 1
     cycle_num = cycle_num + 1
     sow_date = day
     sorghum sow cultivar = early, plants = 5 (/m2), sowing_depth = 30 (mm),  tiller_no_fertile = 0
       if rz_no3 < sorg_fert then
         amountno3 = (sorg_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif
     report do_output
   endif

   if (sorghum.stage = 11 or sorghum.plant_status = 'dead' or sorghum.das > 150) then
     event = 2
     report do_output
     sorghum harvest
     sorghum kill_crop
     sorghum end_crop
     surfaceom tillage type=graze ()
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! wheat crop !!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 135  and  day <= 210)        and
     wheat.plant_status = 'out'                      and
     sorghum.plant_status = 'out'              and
     rain[10] >= 25  )                       then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

!! plant at end of window if criteria not met

   if day = 211 and
     sorghum.plant_status = 'out'              and
     wheat.plant_status = 'out'                      then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if wheat.StageName = 'harvest_ripe' or wheat.plant_status = 'dead' and
     crop_flag = 2         then
     event = 4
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset

   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! Rotation 1b - sorghum opportunity crop and wheat+N100 !!!!!!!!!!
!!!!!!!!! rainfall rule + esw =50mm !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

[sorg_wht_esw50.manager.start_of_day]
! CROP_FLAG = 0 - neither crop in the ground
! CROP_FLAG = 1 - sorghum in the ground
! CROP_FLAG = 2 - wheat in the ground

! EVENT = 1 - sorghum sow
! EVENT = 2 - sorghum harvest
! EVENT = 3 - wheat sow
! EVENT = 4 - wheat harvest

! reset residues every year to same level


!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!! sorghum !!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

  if ((day >= 300  or  day <= 30)         and
     sorghum.plant_status = 'out'              and
     crop_flag = 0                          and
     rain[5] >= 25                          and
     esw_rooting_zone >= esw50)             then
     crop_flag = 1
     event = 1
     cycle_num = cycle_num + 1
     sow_date = day
     sorghum sow cultivar = early, plants = 5 (/m2), sowing_depth = 30 (mm),  tiller_no_fertile = 0
       if rz_no3 < sorg_fert then
         amountno3 = (sorg_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif
     report do_output
   endif

   if (sorghum.stage = 11 or sorghum.plant_status = 'dead' or sorghum.das > 150) then
     event = 2
     report do_output
     sorghum harvest
     sorghum kill_crop
     sorghum end_crop
     surfaceom tillage type=graze ()
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! wheat crop !!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 135  and  day <= 210)        and
     wheat.plant_status = 'out'                      and
     sorghum.plant_status = 'out'              and
     rain[10] >= 25  )                       then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

!! plant at end of window if criteria not met

   if day = 211 and
     sorghum.plant_status = 'out'              and
     wheat.plant_status = 'out'                      then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if wheat.StageName = 'harvest_ripe' or wheat.plant_status = 'dead' and
     crop_flag = 2         then
     event = 4
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset

   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! Rotation 1c - sorghum opportunity crop and wheat+N100 !!!!!!!!!!
!!!!!!!!! rainfall rule + esw =100mm !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

[sorg_wht_esw100.manager.start_of_day]
! CROP_FLAG = 0 - neither crop in the ground
! CROP_FLAG = 1 - sorghum in the ground
! CROP_FLAG = 2 - wheat in the ground

! EVENT = 1 - sorghum sow
! EVENT = 2 - sorghum harvest
! EVENT = 3 - wheat sow
! EVENT = 4 - wheat harvest

! reset residues every year to same level


!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!! sorghum !!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

  if ((day >= 300  or  day <= 30)         and
     sorghum.plant_status = 'out'              and
     crop_flag = 0                          and
     rain[5] >= 25                          and
     esw_rooting_zone >= esw75)             then
     crop_flag = 1
     event = 1
     cycle_num = cycle_num + 1
     sow_date = day
     sorghum sow cultivar = early, plants = 5 (/m2), sowing_depth = 30 (mm),  tiller_no_fertile = 0
       if rz_no3 < sorg_fert then
         amountno3 = (sorg_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif
     report do_output
   endif

   if (sorghum.stage = 11 or sorghum.plant_status = 'dead' or sorghum.das > 150) then
     event = 2
     report do_output
     sorghum harvest
     sorghum kill_crop
     sorghum end_crop
     surfaceom tillage type=graze ()
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! wheat crop !!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 135  and  day <= 210)        and
     wheat.plant_status = 'out'                      and
     sorghum.plant_status = 'out'              and
     rain[10] >= 25  )                       then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

!! plant at end of window if criteria not met

   if day = 211 and
     sorghum.plant_status = 'out'              and
     wheat.plant_status = 'out'                      then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if wheat.StageName = 'harvest_ripe' or wheat.plant_status = 'dead' and
     crop_flag = 2         then
     event = 4
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset

   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! Rotation 2 - continuous wheat+N100!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

[cont_wht.manager.start_of_day]

! CROP_FLAG = 1 - wheat in the ground

! EVENT = 3 - wheat sow
! EVENT = 4 - wheat harvest

! reset residues every year to same level


!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! wheat crop !!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 135  and  day <= 210)         and
     wheat.plant_status = 'out'                      and
     rain[10] >= 25  )                       then
     crop_flag = 1
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if day = 211 and
     wheat.plant_status = 'out'                      then
     crop_flag = 1
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if wheat.StageName = 'harvest_ripe' or wheat.plant_status = 'dead' and
     crop_flag = 1         then
     event = 4
     report do_output
     wheat harvest
     wheat end_crop
!     surfaceom reset
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! Rotation 3 - pasture (wheat) sorghum and wheat+N100 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

[psw.manager.start_of_day]
! CROP_FLAG = 0 - nothing in the ground
! CROP_FLAG = 1 - sorghum in the ground
! CROP_FLAG = 2 - wheat in the ground
! CROP_FLAG = 3 - pasture in the ground

! EVENT = 1 - sorghum sow
! EVENT = 2 - sorghum harvest
! EVENT = 3 - wheat sow
! EVENT = 4 - wheat harvest
! EVENT = 5 - pasture sow
! EVENT = 6 - pasture kill

! reset residues every year to same level



!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!! sorghum crop !!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 260  or  day <= 30)         and
!   if ((day = 260)                          and
     sorghum.plant_status = 'out'              and
     crop_flag = 0                          and
     event = 6  )                           then
     crop_flag = 1
     event = 1
     cycle_num = cycle_num + 1
     sow_date = day
     sorghum sow cultivar = early, plants = 5 (/m2), sowing_depth = 30 (mm),  tiller_no_fertile = 0
       if rz_no3 < sorg_fert then
         amountno3 = (sorg_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif
     report do_output
   endif

   if (sorghum.stage = 11 or sorghum.plant_status = 'dead' or sorghum.das > 150) then
     event = 2
     report do_output
     sorghum harvest
     sorghum kill_crop
     sorghum end_crop
     surfaceom tillage type=graze ()
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! wheat crop !!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 135  and  day <= 210)         and
     wheat.plant_status = 'out'                      and
     sorghum.plant_status = 'out'              and
     crop_flag = 1                          and
     rain[10] >= 25  )                       then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

!! plant at end of window if criteria not met

   if day = 211                             and
     crop_flag = 1                          and
     sorghum.plant_status = 'out'              and
     wheat.plant_status = 'out'                      then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if wheat.StageName = 'harvest_ripe' or wheat.plant_status = 'dead' and
     crop_flag = 2         then
     event = 4
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! pasture crop !!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

! note no planting rain for pasture

   if ((day >= 135  and  day <= 210)         and
     wheat.plant_status = 'out'                      and
     crop_flag = 0   )                       then ! and
 !    rain[5] >= 10  )                       then
     crop_flag = 3
     event = 5
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = pasture

       if rz_no3 < 40 then
         amountno3 = (40 - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

! kill pasture at day 250 and then sow sorghum at day 260

   if (day = 250) and
     crop_flag = 3         then
     event = 6
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset
   endif

! if pasture has failed reset crop_flag to allow sorghum to sow

   if (day = 250)          and
     wheat.plant_status = 'out'     and
     crop_flag = 3         then
     crop_flag = 0
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! Rotation 3a - pasture (wheat) sorghum and wheat+N100 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!! rainfall rule for sorghum planting !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

[psw_r.manager.start_of_day]
! CROP_FLAG = 0 - nothing in the ground
! CROP_FLAG = 1 - sorghum in the ground
! CROP_FLAG = 2 - wheat in the ground
! CROP_FLAG = 3 - pasture in the ground

! EVENT = 1 - sorghum sow
! EVENT = 2 - sorghum harvest
! EVENT = 3 - wheat sow
! EVENT = 4 - wheat harvest
! EVENT = 5 - pasture sow
! EVENT = 6 - pasture kill

! reset residues every year to same level



!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!! sorghum crop !!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 260  or  day <= 30)         and
     sorghum.plant_status = 'out'              and
     crop_flag = 0                          and
     rain[5] >= 25                          and
     event = 6  )                           then
     crop_flag = 1
     event = 1
     cycle_num = cycle_num + 1
     sow_date = day
     sorghum sow cultivar = early, plants = 5 (/m2), sowing_depth = 30 (mm),  tiller_no_fertile = 0
       if rz_no3 < sorg_fert then
         amountno3 = (sorg_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif
     report do_output
   endif

   if (sorghum.stage = 11 or sorghum.plant_status = 'dead' or sorghum.DaysAfterSowing > 150) then
     event = 2
     report do_output
     sorghum harvest
     sorghum kill_crop
     sorghum end_crop
     surfaceom tillage type=graze ()
   endif

!  If we fail to get a sorghum-planting opportunity then set crop_flag to 1 so that wheat will sow
!  in following season
   if day = 134 and event=6 and crop_flag=0 then
      crop_flag = 1
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! wheat crop !!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 135  and  day <= 210)         and
     wheat.plant_status = 'out'                      and
     sorghum.plant_status = 'out'              and
     crop_flag = 1                          and
     rain[10] >= 25  )                       then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

!! plant at end of window if criteria not met

   if day = 211                             and
     crop_flag = 1                          and
     sorghum.plant_status = 'out'              and
     wheat.plant_status = 'out'                      then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if wheat.StageName = 'harvest_ripe' or wheat.plant_status = 'dead' and
     crop_flag = 2         then
     event = 4
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! pasture crop !!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

! note no planting rain for pasture

   if ((day >= 135  and  day <= 210)         and
     wheat.plant_status = 'out'                      and
     crop_flag = 0   )                       then
     crop_flag = 3
     event = 5
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = pasture

       if rz_no3 < 40 then
         amountno3 = (40 - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

! kill pasture at day 250 and then sow sorghum at day 260

   if (day = 250) and
     crop_flag = 3         then
     event = 6
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset
   endif

! if pasture has failed reset crop_flag to allow sorghum to sow

   if (day = 250)          and
     wheat.plant_status = 'out'     and
     crop_flag = 3         then
     crop_flag = 0
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! Rotation 3b - pasture (wheat) sorghum and wheat+N100 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!! rainfall rule + esw>10 for sorghum planting !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

[psw_r_esw10.manager.start_of_day]
! CROP_FLAG = 0 - nothing in the ground
! CROP_FLAG = 1 - sorghum in the ground
! CROP_FLAG = 2 - wheat in the ground
! CROP_FLAG = 3 - pasture in the ground

! EVENT = 1 - sorghum sow
! EVENT = 2 - sorghum harvest
! EVENT = 3 - wheat sow
! EVENT = 4 - wheat harvest
! EVENT = 5 - pasture sow
! EVENT = 6 - pasture kill

! reset residues every year to same level



!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!! sorghum crop !!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 260  or  day <= 30)         and
!   if ((day = 260)                          and
     sorghum.plant_status = 'out'              and
     crop_flag = 0                          and
     rain[5] >= 25                          and
     esw_rooting_zone >= esw10)             and
     event = 6  )                           then
     crop_flag = 1
     event = 1
     cycle_num = cycle_num + 1
     sow_date = day
     sorghum sow cultivar = early, plants = 5 (/m2), sowing_depth = 30 (mm),  tiller_no_fertile = 0
       if rz_no3 < sorg_fert then
         amountno3 = (sorg_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif
     report do_output
   endif

   if (sorghum.stage = 11 or sorghum.plant_status = 'dead' or sorghum.das > 150) then
     event = 2
     report do_output
     sorghum harvest
     sorghum kill_crop
     sorghum end_crop
     surfaceom tillage type=graze ()
   endif

!  If we fail to get a sorghum-planting opportunity then set crop_flag to 1 so that wheat will sow
!  in following season
   if day = 134 and event=6 and crop_flag=0 then
      crop_flag = 1
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! wheat crop !!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 135  and  day <= 210)         and
     wheat.plant_status = 'out'                      and
     sorghum.plant_status = 'out'              and
     crop_flag = 1                          and
     rain[10] >= 25  )                       then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

!! plant at end of window if criteria not met

   if day = 211                             and
     crop_flag = 1                          and
     sorghum.plant_status = 'out'              and
     wheat.plant_status = 'out'                      then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if wheat.StageName = 'harvest_ripe' or wheat.plant_status = 'dead' and
     crop_flag = 2         then
     event = 4
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! pasture crop !!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

! note no planting rain for pasture

   if ((day >= 135  and  day <= 210)         and
     wheat.plant_status = 'out'                      and
     crop_flag = 0   )                       then ! and
 !    rain[5] >= 10  )                       then
     crop_flag = 3
     event = 5
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = pasture

       if rz_no3 < 40 then
         amountno3 = (40 - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

! kill pasture at day 250 and then sow sorghum at day 260

   if (day = 250) and
     crop_flag = 3         then
     event = 6
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset
   endif

! if pasture has failed reset crop_flag to allow sorghum to sow

   if (day = 250)          and
     wheat.plant_status = 'out'     and
     crop_flag = 3         then
     crop_flag = 0
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! Rotation 3c - pasture (wheat) sorghum and wheat+N100 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!! rainfall rule + esw>50 for sorghum planting !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

[psw_r_esw50.manager.start_of_day]
! CROP_FLAG = 0 - nothing in the ground
! CROP_FLAG = 1 - sorghum in the ground
! CROP_FLAG = 2 - wheat in the ground
! CROP_FLAG = 3 - pasture in the ground

! EVENT = 1 - sorghum sow
! EVENT = 2 - sorghum harvest
! EVENT = 3 - wheat sow
! EVENT = 4 - wheat harvest
! EVENT = 5 - pasture sow
! EVENT = 6 - pasture kill

! reset residues every year to same level



!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!! sorghum crop !!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 260  or  day <= 30)         and
!   if ((day = 260)                          and
     sorghum.plant_status = 'out'              and
     crop_flag = 0                          and
     rain[5] >= 25                          and
     esw_rooting_zone >= esw50)             and
     event = 6  )                           then
     crop_flag = 1
     event = 1
     cycle_num = cycle_num + 1
     sow_date = day
     sorghum sow cultivar = early, plants = 5 (/m2), sowing_depth = 30 (mm),  tiller_no_fertile = 0
       if rz_no3 < sorg_fert then
         amountno3 = (sorg_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif
     report do_output
   endif

   if (sorghum.stage = 11 or sorghum.plant_status = 'dead' or sorghum.das > 150) then
     event = 2
     report do_output
     sorghum harvest
     sorghum kill_crop
     sorghum end_crop
     surfaceom tillage type=graze ()
   endif

!  If we fail to get a sorghum-planting opportunity then set crop_flag to 1 so that wheat will sow
!  in following season
   if day = 134 and event=6 and crop_flag=0 then
      crop_flag = 1
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! wheat crop !!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 135  and  day <= 210)         and
     wheat.plant_status = 'out'                      and
     sorghum.plant_status = 'out'              and
     crop_flag = 1                          and
     rain[10] >= 25  )                       then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

!! plant at end of window if criteria not met

   if day = 211                             and
     crop_flag = 1                          and
     sorghum.plant_status = 'out'              and
     wheat.plant_status = 'out'                      then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if wheat.StageName = 'harvest_ripe' or wheat.plant_status = 'dead' and
     crop_flag = 2         then
     event = 4
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! pasture crop !!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

! note no planting rain for pasture

   if ((day >= 135  and  day <= 210)         and
     wheat.plant_status = 'out'                      and
     crop_flag = 0   )                       then ! and
 !    rain[5] >= 10  )                       then
     crop_flag = 3
     event = 5
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = pasture

       if rz_no3 < 40 then
         amountno3 = (40 - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

! kill pasture at day 250 and then sow sorghum at day 260

   if (day = 250) and
     crop_flag = 3         then
     event = 6
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset
   endif

! if pasture has failed reset crop_flag to allow sorghum to sow

   if (day = 250)          and
     wheat.plant_status = 'out'     and
     crop_flag = 3         then
     crop_flag = 0
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! Rotation 3d - pasture (wheat) sorghum and wheat+N100 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!! rainfall rule + esw>100 for sorghum planting !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

[psw_r_esw100.manager.start_of_day]
! CROP_FLAG = 0 - nothing in the ground
! CROP_FLAG = 1 - sorghum in the ground
! CROP_FLAG = 2 - wheat in the ground
! CROP_FLAG = 3 - pasture in the ground

! EVENT = 1 - sorghum sow
! EVENT = 2 - sorghum harvest
! EVENT = 3 - wheat sow
! EVENT = 4 - wheat harvest
! EVENT = 5 - pasture sow
! EVENT = 6 - pasture kill

! reset residues every year to same level



!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!! sorghum crop !!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 260  or  day <= 30)         and
!   if ((day = 260)                          and
     sorghum.plant_status = 'out'              and
     crop_flag = 0                          and
     rain[5] >= 25                          and
     esw_rooting_zone >= esw75)             and
     event = 6  )                           then
     crop_flag = 1
     event = 1
     cycle_num = cycle_num + 1
     sow_date = day
     sorghum sow cultivar = early, plants = 5 (/m2), sowing_depth = 30 (mm),  tiller_no_fertile = 0
       if rz_no3 < sorg_fert then
         amountno3 = (sorg_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif
     report do_output
   endif

   if (sorghum.stage = 11 or sorghum.plant_status = 'dead' or sorghum.das > 150) then
     event = 2
     report do_output
     sorghum harvest
     sorghum kill_crop
     sorghum end_crop
     surfaceom tillage type=graze ()
   endif

!  If we fail to get a sorghum-planting opportunity then set crop_flag to 1 so that wheat will sow
!  in following season
   if day = 134 and event=6 and crop_flag=0 then
      crop_flag = 1
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! wheat crop !!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 135  and  day <= 210)         and
     wheat.plant_status = 'out'                      and
     sorghum.plant_status = 'out'              and
     crop_flag = 1                          and
     rain[10] >= 25  )                       then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

!! plant at end of window if criteria not met

   if day = 211                             and
     crop_flag = 1                          and
     sorghum.plant_status = 'out'              and
     wheat.plant_status = 'out'                      then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if wheat.StageName = 'harvest_ripe' or wheat.plant_status = 'dead' and
     crop_flag = 2         then
     event = 4
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! pasture crop !!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

! note no planting rain for pasture

   if ((day >= 135  and  day <= 210)         and
     wheat.plant_status = 'out'                      and
     crop_flag = 0   )                       then ! and
 !    rain[5] >= 10  )                       then
     crop_flag = 3
     event = 5
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = pasture

       if rz_no3 < 40 then
         amountno3 = (40 - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

! kill pasture at day 250 and then sow sorghum at day 260

   if (day = 250) and
     crop_flag = 3         then
     event = 6
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset
   endif

! if pasture has failed reset crop_flag to allow sorghum to sow

   if (day = 250)          and
     wheat.plant_status = 'out'     and
     crop_flag = 3         then
     crop_flag = 0
   endif



!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! Rotation 5 - pasture (wheat), no sorghum and wheat+N100 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

[no_sorg_sept_wht.manager.start_of_day]
! CROP_FLAG = 0 - nothing in the ground ready to plant wheat
! CROP_FLAG = 1 - wheat in the ground
! CROP_FLAG = 2 - pasture in the ground
! CROP_FLAG = 3 - nothing in the ground ready to plant pasture

! EVENT = 3 - wheat sow
! EVENT = 4 - wheat harvest
! EVENT = 5 - pasture sow
! EVENT = 6 - pasture kill

! reset residues every year to same level


!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! wheat crop !!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 135  and  day <= 210)         and
     wheat.plant_status = 'out'                      and
     crop_flag = 0                          and
     rain[10] >= 25  )                       then
     crop_flag = 1
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if day = 211 and
     crop_flag = 0                          and
     wheat.plant_status = 'out'                      then
     crop_flag = 1
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if wheat.StageName = 'harvest_ripe' or wheat.plant_status = 'dead' and
     crop_flag = 1         then
     event = 4
     report do_output
     crop_flag = 3
     wheat harvest
     wheat end_crop
!     surfaceom reset
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! pasture crop !!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

! note no planting rain for pasture

   if ((day >= 135  and  day <= 210)         and
     wheat.plant_status = 'out'                      and
     crop_flag = 3   )                       then ! and
 !    rain[5] >= 10  )                       then
     crop_flag = 2
     event = 5
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = pasture

       if rz_no3 < 40 then
         amountno3 = (40 - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

! kill pasture at day 250 but no sorghum after

   if (day = 250) and
     crop_flag = 2         then
     event = 6
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! Rotation 7 - sorghum opportunity crop and wheat+N100 on full profile!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

[sorg_wht_fp.manager.start_of_day]
! CROP_FLAG = 0 - neither crop in the ground
! CROP_FLAG = 1 - sorghum in the ground
! CROP_FLAG = 2 - wheat in the ground

! EVENT = 1 - sorghum sow
! EVENT = 2 - sorghum harvest
! EVENT = 3 - wheat sow
! EVENT = 4 - wheat harvest

! reset residues every year to same level


!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!! sorghum !!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

  if ((day >= 300  or  day <= 30)         and
     sorghum.plant_status = 'out'              and
     crop_flag = 0                          then
!     rain[5] >= 25  )                       then
     crop_flag = 1
     event = 1
     cycle_num = cycle_num + 1
     sow_date = day
     sorghum sow cultivar = early, plants = 5 (/m2), sowing_depth = 30 (mm),  tiller_no_fertile = 0
       if rz_no3 < sorg_fert then
         amountno3 = (sorg_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif
     report do_output
   endif

   if (sorghum.stage = 11 or sorghum.plant_status = 'dead' or sorghum.das > 150) then
     event = 2
     report do_output
     sorghum harvest
     sorghum kill_crop
     sorghum end_crop
     surfaceom tillage type=graze ()
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! wheat crop !!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 135  and  day <= 210)        and
     wheat.plant_status = 'out'                      and
     sorghum.plant_status = 'out'              and
     rain[10] >= 25  )                       then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

!! plant at end of window if criteria not met

   if day = 211 and
     sorghum.plant_status = 'out'              and
     wheat.plant_status = 'out'                      then
     crop_flag = 2
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if wheat.StageName = 'harvest_ripe' or wheat.plant_status = 'dead' and
     crop_flag = 2         then
     event = 4
     report do_output
     crop_flag = 0
     wheat harvest
     wheat end_crop
!     surfaceom reset
     soilwat2 init
   endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! Rotation 8 - continuous wheat+N100   fallow on full profile!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

[cont_wht_fp.manager.start_of_day]

! CROP_FLAG = 1 - wheat in the ground

! EVENT = 3 - wheat sow
! EVENT = 4 - wheat harvest

! reset residues every year to same level


!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! wheat crop !!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!

   if ((day >= 135  and  day <= 210)         and
     wheat.plant_status = 'out'                      and
     rain[10] >= 25  )                       then
     crop_flag = 1
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if day = 211 and
     wheat.plant_status = 'out'                      then
     crop_flag = 1
     event = 3
     sow_date = day
     wheat sow plants = 100 (/m2), sowing_depth = 40 (mm), cultivar = hartog

       if rz_no3 < wheat_fert then
         amountno3 = (wheat_fert - rz_no3)
         Fertiliser apply amount = amountno3 , depth = 0, type = no3_n
       endif

     report do_output
   endif

   if wheat.StageName = 'harvest_ripe' or wheat.plant_status = 'dead' and
     crop_flag = 1         then
     event = 4
     report do_output
     wheat harvest
     wheat end_crop
!     surfaceom reset
     soilwat2 init
   endif



!----------------------------------------------------------!
!------- Sections specific to individual simulations ------!
!----------------------------------------------------------!

!!! Katanning Loamy sand !!!

[kar1ls.report.parameters]
screen_output = off
Outputfile  =  kar1ls.out /overwrite
Summaryfile =  kar1ls.sum /overwrite

[kar2ls.report.parameters]
screen_output = off
Outputfile  =  kar2ls.out /overwrite
Summaryfile =  kar2ls.sum /overwrite

[kar3als.report.parameters]
screen_output = off
Outputfile  =  kar3als.out /overwrite
Summaryfile =  kar3als.sum /overwrite

[kar3bls.report.parameters]
screen_output = off
Outputfile  =  kar3bls.out /overwrite
Summaryfile =  kar3bls.sum /overwrite

[kar4als.report.parameters]
screen_output = off
Outputfile  =  kar4als.out /overwrite
Summaryfile =  kar4als.sum /overwrite

[kar4bls.report.parameters]
screen_output = off
Outputfile  =  kar4bls.out /overwrite
Summaryfile =  kar4bls.sum /overwrite

[kar5als.report.parameters]
screen_output = off
Outputfile  =  kar5als.out /overwrite
Summaryfile =  kar5als.sum /overwrite

[kar5bls.report.parameters]
screen_output = off
Outputfile  =  kar5bls.out /overwrite
Summaryfile =  kar5bls.sum /overwrite

[kar6als.report.parameters]
screen_output = off
Outputfile  =  kar6als.out /overwrite
Summaryfile =  kar6als.sum /overwrite

[kar6bls.report.parameters]
screen_output = off
Outputfile  =  kar6bls.out /overwrite
Summaryfile =  kar6bls.sum /overwrite

!!! Katanning clay !!!

[kar1cl.report.parameters]
screen_output = off
Outputfile  =  kar1cl.out /overwrite
Summaryfile =  kar1cl.sum /overwrite

[kar2cl.report.parameters]
screen_output = off
Outputfile  =  kar2cl.out /overwrite
Summaryfile =  kar2cl.sum /overwrite

[kar3acl.report.parameters]
screen_output = off
Outputfile  =  kar3acl.out /overwrite
Summaryfile =  kar3acl.sum /overwrite

[kar3bcl.report.parameters]
screen_output = off
Outputfile  =  kar3bcl.out /overwrite
Summaryfile =  kar3bcl.sum /overwrite

[kar4acl.report.parameters]
screen_output = off
Outputfile  =  kar4acl.out /overwrite
Summaryfile =  kar4acl.sum /overwrite

[kar4bcl.report.parameters]
screen_output = off
Outputfile  =  kar4bcl.out /overwrite
Summaryfile =  kar4bcl.sum /overwrite

[kar5acl.report.parameters]
screen_output = off
Outputfile  =  kar5acl.out /overwrite
Summaryfile =  kar5acl.sum /overwrite

[kar5bcl.report.parameters]
screen_output = off
Outputfile  =  kar5bcl.out /overwrite
Summaryfile =  kar5bcl.sum /overwrite

[kar6acl.report.parameters]
screen_output = off
Outputfile  =  kar6acl.out /overwrite
Summaryfile =  kar6acl.sum /overwrite

[kar6bcl.report.parameters]
screen_output = off
Outputfile  =  kar6bcl.out /overwrite
Summaryfile =  kar6bcl.sum /overwrite

!!! Katanning sand !!!

[kar1sa.report.parameters]
screen_output = off
Outputfile  =  kar1sa.out /overwrite
Summaryfile =  kar1sa.sum /overwrite

[kar2sa.report.parameters]
screen_output = off
Outputfile  =  kar2sa.out /overwrite
Summaryfile =  kar2sa.sum /overwrite

[kar3asa.report.parameters]
screen_output = off
Outputfile  =  kar3asa.out /overwrite
Summaryfile =  kar3asa.sum /overwrite

[kar3bsa.report.parameters]
screen_output = off
Outputfile  =  kar3bsa.out /overwrite
Summaryfile =  kar3bsa.sum /overwrite

[kar4asa.report.parameters]
screen_output = off
Outputfile  =  kar4asa.out /overwrite
Summaryfile =  kar4asa.sum /overwrite

[kar4bsa.report.parameters]
screen_output = off
Outputfile  =  kar4bsa.out /overwrite
Summaryfile =  kar4bsa.sum /overwrite

[kar5asa.report.parameters]
screen_output = off
Outputfile  =  kar5asa.out /overwrite
Summaryfile =  kar5asa.sum /overwrite

[kar5bsa.report.parameters]
screen_output = off
Outputfile  =  kar5bsa.out /overwrite
Summaryfile =  kar5bsa.sum /overwrite

[kar6asa.report.parameters]
screen_output = off
Outputfile  =  kar6asa.out /overwrite
Summaryfile =  kar6asa.sum /overwrite

[kar6bsa.report.parameters]
screen_output = off
Outputfile  =  kar6bsa.out /overwrite
Summaryfile =  kar6bsa.sum /overwrite