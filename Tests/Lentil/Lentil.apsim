<folder version="37" creator="Apsim 7.10-r0" name="simulations">
  <folder name="Soils">
    <Soil name="Nepal-sandy-clay">
      <RecordNumber>0</RecordNumber>
      <LocalName>Nepal Sandy Clay</LocalName>
      <Latitude>NaN</Latitude>
      <Longitude>NaN</Longitude>
      <YearOfSampling>0</YearOfSampling>
      <DataSource>SAARC Nepal simulations (PLP's version)</DataSource>
      <Water>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <BD>
          <double>1.45</double>
          <double>1.65</double>
          <double>1.5</double>
          <double>1.52</double>
          <double>1.55</double>
        </BD>
        <AirDry>
          <double>0.05</double>
          <double>0.2</double>
          <double>0.2</double>
          <double>0.2</double>
          <double>0.2</double>
        </AirDry>
        <LL15>
          <double>0.2</double>
          <double>0.2</double>
          <double>0.2</double>
          <double>0.2</double>
          <double>0.2</double>
        </LL15>
        <DUL>
          <double>0.33</double>
          <double>0.33</double>
          <double>0.33</double>
          <double>0.33</double>
          <double>0.33</double>
        </DUL>
        <SAT>
          <double>0.41</double>
          <double>0.34</double>
          <double>0.39</double>
          <double>0.38</double>
          <double>0.37</double>
        </SAT>
        <KS>
          <double>60</double>
          <double>7</double>
          <double>25</double>
          <double>50</double>
          <double>50</double>
        </KS>
        <SoilCrop name="wheat">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.21</double>
            <double>0.25</double>
            <double>0.33</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <SoilCrop name="canola">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.21</double>
            <double>0.25</double>
            <double>0.33</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <SoilCrop name="grasspea">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
        </SoilCrop>
      </Water>
      <SoilWater>
        <SummerCona>3</SummerCona>
        <SummerU>4</SummerU>
        <SummerDate>1-Apr</SummerDate>
        <WinterCona>2.5</WinterCona>
        <WinterU>3.5</WinterU>
        <WinterDate>1-Oct</WinterDate>
        <DiffusConst>40</DiffusConst>
        <DiffusSlope>16</DiffusSlope>
        <Salb>0.14</Salb>
        <CN2Bare>94</CN2Bare>
        <CNRed>20</CNRed>
        <CNCov>0.8</CNCov>
        <Slope>NaN</Slope>
        <DischargeWidth>NaN</DischargeWidth>
        <CatchmentArea>NaN</CatchmentArea>
        <MaxPond>NaN</MaxPond>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <SWCON>
          <double>0.3</double>
          <double>0.1</double>
          <double>0.3</double>
          <double>0.3</double>
          <double>0.3</double>
          <double>0.3</double>
        </SWCON>
        <MWCON>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
        </MWCON>
      </SoilWater>
      <SoilOrganicMatter>
        <RootCN>40</RootCN>
        <RootWt>1500</RootWt>
        <SoilCN>12.5</SoilCN>
        <EnrACoeff>7.4</EnrACoeff>
        <EnrBCoeff>0.2</EnrBCoeff>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <OC>
          <double>1</double>
          <double>0.3</double>
          <double>0.2</double>
          <double>0.1</double>
          <double>0.05</double>
        </OC>
        <OCMetadata>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
        </OCMetadata>
        <FBiom>
          <double>0.04</double>
          <double>0.02</double>
          <double>0.02</double>
          <double>0.02</double>
          <double>0.01</double>
        </FBiom>
        <FInert>
          <double>0.4</double>
          <double>0.6</double>
          <double>0.8</double>
          <double>0.9</double>
          <double>1</double>
        </FInert>
        <OCUnits>Total</OCUnits>
      </SoilOrganicMatter>
      <Analysis>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <Texture>
          <string />
          <string />
          <string />
          <string />
          <string />
        </Texture>
        <MunsellColour>
          <string />
          <string />
          <string />
          <string />
          <string />
        </MunsellColour>
        <PH>
          <double>7.4</double>
          <double>7.3</double>
          <double>7.2</double>
          <double>6.9</double>
          <double>6.8</double>
        </PH>
        <PHMetadata>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
        </PHMetadata>
        <PHUnits>Water</PHUnits>
        <BoronUnits>HotWater</BoronUnits>
      </Analysis>
      <InitialWater>
        <FractionFull>0.73</FractionFull>
        <DepthWetSoil>NaN</DepthWetSoil>
        <PercentMethod>FilledFromTop</PercentMethod>
        <RelativeTo>ll15</RelativeTo>
      </InitialWater>
      <Sample name="Initial nitrogen">
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <NO3>
          <double>25</double>
          <double>10</double>
          <double>5</double>
          <double>5</double>
          <double>5</double>
        </NO3>
        <NH4>
          <double>5</double>
          <double>1</double>
          <double>0</double>
          <double>0</double>
          <double>0</double>
        </NH4>
        <NO3Units>kgha</NO3Units>
        <NH4Units>kgha</NH4Units>
        <SWUnits>Volumetric</SWUnits>
        <OCUnits>Total</OCUnits>
        <PHUnits>Water</PHUnits>
      </Sample>
    </Soil>
    <Soil name="1-Inceptisol_Typic_Ustochrept">
      <RecordNumber>0</RecordNumber>
      <SoilType>Inceptisol</SoilType>
      <LocalName>Typic_Ustochrepts</LocalName>
      <Latitude>NaN</Latitude>
      <Longitude>NaN</Longitude>
      <YearOfSampling>0</YearOfSampling>
      <DataSource>Ravender et.al., 2009 Research Bulletin 44 Charactersation of Dominant Soil Subgroups of Eastern India</DataSource>
      <Water>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <BD>
          <double>1.39</double>
          <double>1.39</double>
          <double>1.4</double>
          <double>1.41</double>
          <double>1.41</double>
        </BD>
        <AirDry>
          <double>0.12</double>
          <double>0.183</double>
          <double>0.255</double>
          <double>0.286</double>
          <double>0.286</double>
        </AirDry>
        <LL15>
          <double>0.24</double>
          <double>0.245</double>
          <double>0.255</double>
          <double>0.286</double>
          <double>0.286</double>
        </LL15>
        <DUL>
          <double>0.42</double>
          <double>0.435</double>
          <double>0.45</double>
          <double>0.445</double>
          <double>0.445</double>
        </DUL>
        <SAT>
          <double>0.47</double>
          <double>0.472</double>
          <double>0.474</double>
          <double>0.467</double>
          <double>0.467</double>
        </SAT>
        <KS>
          <double>60</double>
          <double>40</double>
          <double>5</double>
          <double>3</double>
          <double>3</double>
        </KS>
        <SoilCrop name="wheat">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.24</double>
            <double>0.245</double>
            <double>0.255</double>
            <double>0.286</double>
            <double>0.286</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <SoilCrop name="canola">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.24</double>
            <double>0.245</double>
            <double>0.255</double>
            <double>0.286</double>
            <double>0.286</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <SoilCrop name="grasspea">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.24</double>
            <double>0.245</double>
            <double>0.255</double>
            <double>0.286</double>
            <double>0.286</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <SoilCrop name="chickpea">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.24</double>
            <double>0.245</double>
            <double>0.255</double>
            <double>0.286</double>
            <double>0.286</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
      </Water>
      <SoilWater>
        <SummerCona>3</SummerCona>
        <SummerU>4</SummerU>
        <SummerDate>1-Apr</SummerDate>
        <WinterCona>2.5</WinterCona>
        <WinterU>3.5</WinterU>
        <WinterDate>1-Oct</WinterDate>
        <DiffusConst>40</DiffusConst>
        <DiffusSlope>16</DiffusSlope>
        <Salb>0.14</Salb>
        <CN2Bare>73</CN2Bare>
        <CNRed>20</CNRed>
        <CNCov>0.8</CNCov>
        <Slope>NaN</Slope>
        <DischargeWidth>NaN</DischargeWidth>
        <CatchmentArea>NaN</CatchmentArea>
        <MaxPond>NaN</MaxPond>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <SWCON>
          <double>0.3</double>
          <double>0.1</double>
          <double>0.3</double>
          <double>0.3</double>
          <double>0.3</double>
          <double>0.3</double>
        </SWCON>
        <MWCON>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
        </MWCON>
      </SoilWater>
      <SoilOrganicMatter>
        <RootCN>40</RootCN>
        <RootWt>1500</RootWt>
        <SoilCN>12.5</SoilCN>
        <EnrACoeff>7.4</EnrACoeff>
        <EnrBCoeff>0.2</EnrBCoeff>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <OC>
          <double>0.32</double>
          <double>0.32</double>
          <double>0.09</double>
          <double>0.06</double>
          <double>0.05</double>
        </OC>
        <OCMetadata>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
        </OCMetadata>
        <FBiom>
          <double>0.04</double>
          <double>0.02</double>
          <double>0.02</double>
          <double>0.02</double>
          <double>0.01</double>
        </FBiom>
        <FInert>
          <double>0.4</double>
          <double>0.6</double>
          <double>0.8</double>
          <double>0.9</double>
          <double>1</double>
        </FInert>
        <OCUnits>Total</OCUnits>
      </SoilOrganicMatter>
      <Analysis>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <Texture>
          <string />
          <string />
          <string />
          <string />
          <string />
        </Texture>
        <MunsellColour>
          <string />
          <string />
          <string />
          <string />
          <string />
        </MunsellColour>
        <EC>
          <double>0.15</double>
          <double>0.15</double>
          <double>0.26</double>
          <double>0.43</double>
          <double>0.43</double>
        </EC>
        <PH>
          <double>5.9</double>
          <double>5.9</double>
          <double>6.9</double>
          <double>7.1</double>
          <double>7.1</double>
        </PH>
        <PHMetadata>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
        </PHMetadata>
        <PHUnits>Water</PHUnits>
        <BoronUnits>HotWater</BoronUnits>
      </Analysis>
      <InitialWater>
        <FractionFull>0.73</FractionFull>
        <DepthWetSoil>NaN</DepthWetSoil>
        <PercentMethod>FilledFromTop</PercentMethod>
        <RelativeTo>ll15</RelativeTo>
      </InitialWater>
      <Sample name="Initial nitrogen">
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <NO3>
          <double>5</double>
          <double>2</double>
          <double>1</double>
          <double>1</double>
          <double>0.05</double>
        </NO3>
        <NH4>
          <double>5</double>
          <double>1</double>
          <double>0</double>
          <double>0</double>
          <double>0</double>
        </NH4>
        <NO3Units>kgha</NO3Units>
        <NH4Units>kgha</NH4Units>
        <SWUnits>Volumetric</SWUnits>
        <OCUnits>Total</OCUnits>
        <PHUnits>Water</PHUnits>
      </Sample>
    </Soil>
    <Soil name="2-Entisol_Typic_Ustipsamment">
      <RecordNumber>0</RecordNumber>
      <SoilType>Entisol</SoilType>
      <LocalName>Typic_Ustipsamment</LocalName>
      <Latitude>NaN</Latitude>
      <Longitude>NaN</Longitude>
      <YearOfSampling>0</YearOfSampling>
      <DataSource>Ravender et.al., 2009 Research Bulletin 44 Charactersation of Dominant Soil Subgroups of Eastern India</DataSource>
      <Water>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <BD>
          <double>1.53</double>
          <double>1.53</double>
          <double>1.54</double>
          <double>1.55</double>
          <double>1.55</double>
        </BD>
        <AirDry>
          <double>0.026</double>
          <double>0.039</double>
          <double>0.09</double>
          <double>0.104</double>
          <double>0.104</double>
        </AirDry>
        <LL15>
          <double>0.053</double>
          <double>0.053</double>
          <double>0.09</double>
          <double>0.104</double>
          <double>0.104</double>
        </LL15>
        <DUL>
          <double>0.125</double>
          <double>0.129</double>
          <double>0.186</double>
          <double>0.194</double>
          <double>0.194</double>
        </DUL>
        <SAT>
          <double>0.395</double>
          <double>0.391</double>
          <double>0.415</double>
          <double>0.415</double>
          <double>0.415</double>
        </SAT>
        <KS>
          <double>600</double>
          <double>40</double>
          <double>7</double>
          <double>7</double>
          <double>7</double>
        </KS>
        <SoilCrop name="wheat">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.053</double>
            <double>0.053</double>
            <double>0.09</double>
            <double>0.104</double>
            <double>0.104</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <SoilCrop name="canola">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.053</double>
            <double>0.053</double>
            <double>0.09</double>
            <double>0.104</double>
            <double>0.104</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <SoilCrop name="grasspea">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.053</double>
            <double>0.053</double>
            <double>0.09</double>
            <double>0.104</double>
            <double>0.104</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <SoilCrop name="maize">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.053</double>
            <double>0.053</double>
            <double>0.09</double>
            <double>0.104</double>
            <double>0.104</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <SoilCrop name="chickpea">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.053</double>
            <double>0.053</double>
            <double>0.09</double>
            <double>0.104</double>
            <double>0.104</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
      </Water>
      <SoilWater>
        <SummerCona>3</SummerCona>
        <SummerU>4</SummerU>
        <SummerDate>1-Apr</SummerDate>
        <WinterCona>2.5</WinterCona>
        <WinterU>3.5</WinterU>
        <WinterDate>1-Oct</WinterDate>
        <DiffusConst>220</DiffusConst>
        <DiffusSlope>40</DiffusSlope>
        <Salb>0.14</Salb>
        <CN2Bare>62</CN2Bare>
        <CNRed>20</CNRed>
        <CNCov>0.8</CNCov>
        <Slope>NaN</Slope>
        <DischargeWidth>NaN</DischargeWidth>
        <CatchmentArea>NaN</CatchmentArea>
        <MaxPond>NaN</MaxPond>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <SWCON>
          <double>0.7</double>
          <double>0.7</double>
          <double>0.7</double>
          <double>0.7</double>
          <double>0.6</double>
          <double>0.5</double>
        </SWCON>
        <MWCON>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
        </MWCON>
      </SoilWater>
      <SoilOrganicMatter>
        <RootCN>40</RootCN>
        <RootWt>1500</RootWt>
        <SoilCN>12.5</SoilCN>
        <EnrACoeff>7.4</EnrACoeff>
        <EnrBCoeff>0.2</EnrBCoeff>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <OC>
          <double>0.39</double>
          <double>0.39</double>
          <double>0.21</double>
          <double>0.15</double>
          <double>0.05</double>
        </OC>
        <OCMetadata>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
        </OCMetadata>
        <FBiom>
          <double>0.04</double>
          <double>0.02</double>
          <double>0.02</double>
          <double>0.02</double>
          <double>0.01</double>
        </FBiom>
        <FInert>
          <double>0.4</double>
          <double>0.6</double>
          <double>0.8</double>
          <double>0.9</double>
          <double>1</double>
        </FInert>
        <OCUnits>Total</OCUnits>
      </SoilOrganicMatter>
      <Analysis>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <Texture>
          <string />
          <string />
          <string />
          <string />
          <string />
        </Texture>
        <MunsellColour>
          <string />
          <string />
          <string />
          <string />
          <string />
        </MunsellColour>
        <EC>
          <double>0.05</double>
          <double>0.05</double>
          <double>0.04</double>
          <double>0.04</double>
          <double>0.04</double>
        </EC>
        <PH>
          <double>5.6</double>
          <double>5.6</double>
          <double>5.9</double>
          <double>6</double>
          <double>6</double>
        </PH>
        <PHMetadata>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
        </PHMetadata>
        <PHUnits>Water</PHUnits>
        <BoronUnits>HotWater</BoronUnits>
      </Analysis>
      <InitialWater>
        <FractionFull>0.73</FractionFull>
        <DepthWetSoil>NaN</DepthWetSoil>
        <PercentMethod>FilledFromTop</PercentMethod>
        <RelativeTo>ll15</RelativeTo>
      </InitialWater>
      <Sample name="Initial nitrogen">
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <NO3>
          <double>5</double>
          <double>2</double>
          <double>1</double>
          <double>1</double>
          <double>0.05</double>
        </NO3>
        <NH4>
          <double>5</double>
          <double>1</double>
          <double>0</double>
          <double>0</double>
          <double>0</double>
        </NH4>
        <NO3Units>kgha</NO3Units>
        <NH4Units>kgha</NH4Units>
        <SWUnits>Volumetric</SWUnits>
        <OCUnits>Total</OCUnits>
        <PHUnits>Water</PHUnits>
      </Sample>
    </Soil>
    <Soil name="3-Inceptisol_Aeric Haplaquept">
      <RecordNumber>0</RecordNumber>
      <SoilType>Inceptisol</SoilType>
      <LocalName>Aeric Haplaquept</LocalName>
      <Latitude>NaN</Latitude>
      <Longitude>NaN</Longitude>
      <YearOfSampling>0</YearOfSampling>
      <DataSource>Ravender et.al., 2009 Research Bulletin 44 Charactersation of Dominant Soil Subgroups of Eastern India</DataSource>
      <Water>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <BD>
          <double>1.46</double>
          <double>1.46</double>
          <double>1.48</double>
          <double>1.48</double>
          <double>1.48</double>
        </BD>
        <AirDry>
          <double>0.051</double>
          <double>0.09</double>
          <double>0.13</double>
          <double>0.173</double>
          <double>0.173</double>
        </AirDry>
        <LL15>
          <double>0.102</double>
          <double>0.102</double>
          <double>0.13</double>
          <double>0.173</double>
          <double>0.173</double>
        </LL15>
        <DUL>
          <double>0.224</double>
          <double>0.244</double>
          <double>0.328</double>
          <double>0.327</double>
          <double>0.327</double>
        </DUL>
        <SAT>
          <double>0.401</double>
          <double>0.405</double>
          <double>0.421</double>
          <double>0.428</double>
          <double>0.428</double>
        </SAT>
        <KS>
          <double>254</double>
          <double>254</double>
          <double>44.16</double>
          <double>44</double>
          <double>44</double>
        </KS>
        <SoilCrop name="wheat">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.102</double>
            <double>0.102</double>
            <double>0.13</double>
            <double>0.173</double>
            <double>0.173</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <SoilCrop name="canola">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.102</double>
            <double>0.102</double>
            <double>0.13</double>
            <double>0.173</double>
            <double>0.173</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <SoilCrop name="grasspea">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.102</double>
            <double>0.102</double>
            <double>0.13</double>
            <double>0.173</double>
            <double>0.173</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <SoilCrop name="chickpea">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.102</double>
            <double>0.102</double>
            <double>0.13</double>
            <double>0.173</double>
            <double>0.173</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.03</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
      </Water>
      <SoilWater>
        <SummerCona>3</SummerCona>
        <SummerU>4</SummerU>
        <SummerDate>1-Apr</SummerDate>
        <WinterCona>2.5</WinterCona>
        <WinterU>3.5</WinterU>
        <WinterDate>1-Oct</WinterDate>
        <DiffusConst>220</DiffusConst>
        <DiffusSlope>40</DiffusSlope>
        <Salb>0.14</Salb>
        <CN2Bare>62</CN2Bare>
        <CNRed>20</CNRed>
        <CNCov>0.8</CNCov>
        <Slope>NaN</Slope>
        <DischargeWidth>NaN</DischargeWidth>
        <CatchmentArea>NaN</CatchmentArea>
        <MaxPond>NaN</MaxPond>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <SWCON>
          <double>0.7</double>
          <double>0.7</double>
          <double>0.5</double>
          <double>0.3</double>
          <double>0.3</double>
        </SWCON>
        <MWCON>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
        </MWCON>
      </SoilWater>
      <SoilOrganicMatter>
        <RootCN>40</RootCN>
        <RootWt>1500</RootWt>
        <SoilCN>12.5</SoilCN>
        <EnrACoeff>7.4</EnrACoeff>
        <EnrBCoeff>0.2</EnrBCoeff>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <OC>
          <double>0.8</double>
          <double>0.8</double>
          <double>0.39</double>
          <double>0.22</double>
          <double>0.1</double>
        </OC>
        <OCMetadata>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
        </OCMetadata>
        <FBiom>
          <double>0.04</double>
          <double>0.02</double>
          <double>0.02</double>
          <double>0.02</double>
          <double>0.01</double>
        </FBiom>
        <FInert>
          <double>0.4</double>
          <double>0.6</double>
          <double>0.8</double>
          <double>0.9</double>
          <double>1</double>
        </FInert>
        <OCUnits>Total</OCUnits>
      </SoilOrganicMatter>
      <Analysis>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <Texture>
          <string />
          <string />
          <string />
          <string />
          <string />
        </Texture>
        <MunsellColour>
          <string />
          <string />
          <string />
          <string />
          <string />
        </MunsellColour>
        <EC>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.09</double>
          <double>0.09</double>
          <double>0.09</double>
        </EC>
        <PH>
          <double>6</double>
          <double>6</double>
          <double>6.1</double>
          <double>6.4</double>
          <double>6.4</double>
        </PH>
        <PHMetadata>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
        </PHMetadata>
        <PHUnits>Water</PHUnits>
        <BoronUnits>HotWater</BoronUnits>
      </Analysis>
      <InitialWater>
        <FractionFull>0.73</FractionFull>
        <DepthWetSoil>NaN</DepthWetSoil>
        <PercentMethod>FilledFromTop</PercentMethod>
        <RelativeTo>ll15</RelativeTo>
      </InitialWater>
      <Sample name="Initial nitrogen">
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <NO3>
          <double>5</double>
          <double>2</double>
          <double>1</double>
          <double>1</double>
          <double>0.05</double>
        </NO3>
        <NH4>
          <double>5</double>
          <double>1</double>
          <double>0</double>
          <double>0</double>
          <double>0</double>
        </NH4>
        <NO3Units>kgha</NO3Units>
        <NH4Units>kgha</NH4Units>
        <SWUnits>Volumetric</SWUnits>
        <OCUnits>Total</OCUnits>
        <PHUnits>Water</PHUnits>
      </Sample>
    </Soil>
  </folder>
  <folder name="Plots">
    <RGraphics name="Flowering DAS x site">
      <script>
        <text># Make some plots
library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)

options(stringsAsFactors = F)

#### Cultivar groups
groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

# Generic function to read apsim output files. 
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))  
#  cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

df.pred&lt;- do.call(rbind, lapply(list.files(pattern="^.*Harvest\\.out$"), read.apsim))
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred&lt;- df.pred[,c("SimulationName", "site", "TOS", "cultivar", "FloweringDAS", "MaturityDAS", "biomass", "yield", "MaxLAI")]

df.obs&lt;-  read.csv("Lentil auto observed.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)

df &lt;- df.obs %&gt;% left_join(df.pred[,!names(df.pred) %in% c("site", "TOS", "cultivar")], 
                           by=c("SimulationName"), 
                           suffix = c(".obs", ".pred"))

jpeg(imageFileName, width=width, height=height)
g&lt;-ggplot(df[!is.na(df$FloweringDAS.obs),]) + geom_point(aes(x=FloweringDAS.obs, y=FloweringDAS.pred, color=site)) + 
    scale_x_continuous(limits=range(na.omit(c(df$FloweringDAS.obs, df$FloweringDAS.pred)))) +
    scale_y_continuous(limits=range(na.omit(c(df$FloweringDAS.obs, df$FloweringDAS.pred)))) +
  labs(title="Flowering DAS", x="Observed", y = "Predicted") +
  geom_abline(intercept=0, colour="grey") + theme_minimal()
  
print(g)
dev.off()

</text>
      </script>
    </RGraphics>
    <RGraphics name="Flowering DAS x cultivar">
      <script>
        <text># Make some plots
library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)

options(stringsAsFactors = F)

#### Cultivar groups
groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

# Generic function to read apsim output files. 
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))  
#  cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

df.pred&lt;- do.call(rbind, lapply(list.files(pattern="^.*Harvest\\.out$"), read.apsim))
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred&lt;- df.pred[,c("SimulationName", "site", "TOS", "cultivar", "FloweringDAS", "MaturityDAS", "biomass", "yield", "MaxLAI")]

df.obs&lt;-  read.csv("Lentil auto observed.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)

df &lt;- df.obs %&gt;% left_join(df.pred[,!names(df.pred) %in% c("site", "TOS", "cultivar")], 
                           by=c("SimulationName"), 
                           suffix = c(".obs", ".pred"))

jpeg(imageFileName, width=width, height=height)
g&lt;-ggplot(df[!is.na(df$FloweringDAS.obs),]) + geom_point(aes(x=FloweringDAS.obs, y=FloweringDAS.pred, color=cultivar)) + 
    scale_x_continuous(limits=range(na.omit(c(df$FloweringDAS.obs, df$FloweringDAS.pred)))) +
    scale_y_continuous(limits=range(na.omit(c(df$FloweringDAS.obs, df$FloweringDAS.pred)))) +
  labs(title="Flowering DAS", x="Observed", y = "Predicted") +
  geom_abline(intercept=0, colour="grey") + theme_minimal()
  
print(g)
dev.off()

</text>
      </script>
    </RGraphics>
    <RGraphics name="Maturity DAS x site">
      <script>
        <text># Make some plots
library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)

options(stringsAsFactors = F)

#### Cultivar groups
groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

# Generic function to read apsim output files. 
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))  
#  cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

df.pred&lt;- do.call(rbind, lapply(list.files(pattern="^.*Harvest\\.out$"), read.apsim))
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred&lt;- df.pred[,c("SimulationName", "site", "TOS", "cultivar", "FloweringDAS", "MaturityDAS", "biomass", "yield", "MaxLAI")]

df.obs&lt;-  read.csv("Lentil auto observed.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)

df &lt;- df.obs %&gt;% left_join(df.pred[,!names(df.pred) %in% c("site", "TOS", "cultivar")], 
                           by=c("SimulationName"), 
                           suffix = c(".obs", ".pred"))

jpeg(imageFileName, width=width, height=height)
g&lt;-ggplot(df[!is.na(df$MaturityDAS.obs),]) + geom_point(aes(x=MaturityDAS.obs, y=MaturityDAS.pred, color=site)) + 
  scale_x_continuous(limits=range(na.omit(c(df$MaturityDAS.obs, df$MaturityDAS.pred)))) +
  scale_y_continuous(limits=range(na.omit(c(df$MaturityDAS.obs, df$MaturityDAS.pred)))) +
  labs(title="Maturity DAS", x="Observed", y = "Predicted") +
  geom_abline(intercept=0, colour="grey") +
  theme_minimal()
    
print(g)
dev.off()

</text>
      </script>
    </RGraphics>
    <RGraphics name="Maturity DAS x cultivar">
      <script>
        <text># Make some plots
library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)

options(stringsAsFactors = F)

#### Cultivar groups
groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

# Generic function to read apsim output files. 
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))  
#  cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

df.pred&lt;- do.call(rbind, lapply(list.files(pattern="^.*Harvest\\.out$"), read.apsim))
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred&lt;- df.pred[,c("SimulationName", "site", "TOS", "cultivar", "FloweringDAS", "MaturityDAS", "biomass", "yield", "MaxLAI")]

df.obs&lt;-  read.csv("Lentil auto observed.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)

df &lt;- df.obs %&gt;% left_join(df.pred[,!names(df.pred) %in% c("site", "TOS", "cultivar")], 
                           by=c("SimulationName"), 
                           suffix = c(".obs", ".pred"))

jpeg(imageFileName, width=width, height=height)
g&lt;-ggplot(df[!is.na(df$MaturityDAS.obs),]) + geom_point(aes(x=MaturityDAS.obs, y=MaturityDAS.pred, color=cultivar)) + 
  scale_x_continuous(limits=range(na.omit(c(df$MaturityDAS.obs, df$MaturityDAS.pred)))) +
  scale_y_continuous(limits=range(na.omit(c(df$MaturityDAS.obs, df$MaturityDAS.pred)))) +
  labs(title="Maturity DAS", x="Observed", y = "Predicted") +
  geom_abline(intercept=0, colour="grey") +
  theme_minimal()
    
print(g)
dev.off()

</text>
      </script>
    </RGraphics>
    <RGraphics name="Harvest biomass">
      <script>
        <text># Make some plots
library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)

options(stringsAsFactors = F)

#### Cultivar groups
groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

# Generic function to read apsim output files. 
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))  
#  cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

df.pred&lt;- do.call(rbind, lapply(list.files(pattern="^.*Harvest\\.out$"), read.apsim))
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred&lt;- df.pred[,c("SimulationName", "site", "TOS", "cultivar", "FloweringDAS", "MaturityDAS", "biomass", "yield", "MaxLAI")]

df.obs&lt;-  read.csv("Lentil auto observed.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)

df &lt;- df.obs %&gt;% left_join(df.pred[,!names(df.pred) %in% c("site", "TOS", "cultivar")], 
                           by=c("SimulationName"), 
                           suffix = c(".obs", ".pred"))

jpeg(imageFileName, width=width, height=height)
g&lt;-ggplot(df[!is.na(df$biomass.obs),]) + geom_point(aes(x=biomass.obs, y=biomass.pred, color=cultivar)) + 
  scale_x_continuous(limits=range(na.omit(c(df$biomass.obs, df$biomass.pred)))) +
  scale_y_continuous(limits=range(na.omit(c(df$biomass.obs, df$biomass.pred)))) +
  labs(title="Biomass (kg/ha)", x="Observed", y = "Predicted") +
  geom_abline(intercept=0, colour="grey") + facet_wrap(~site) +
  theme_minimal()

print(g)
dev.off()

</text>
      </script>
    </RGraphics>
    <RGraphics name="Harvest biomass x TOS">
      <script>
        <text># Make some plots
library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)

options(stringsAsFactors = F)

#### Cultivar groups
groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

# Generic function to read apsim output files. 
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))  
#  cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

df.pred&lt;- do.call(rbind, lapply(list.files(pattern="^.*Harvest\\.out$"), read.apsim))
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred&lt;- df.pred[,c("SimulationName", "site", "TOS", "cultivar", "FloweringDAS", "MaturityDAS", "biomass", "yield", "MaxLAI")]

df.obs&lt;-  read.csv("Lentil auto observed.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)

df &lt;- df.obs %&gt;% left_join(df.pred[,!names(df.pred) %in% c("site", "TOS", "cultivar")], 
                           by=c("SimulationName"), 
                           suffix = c(".obs", ".pred"))

jpeg(imageFileName, width=width, height=height)
g&lt;-ggplot(df[!is.na(df$biomass.obs),]) + geom_point(aes(x=biomass.obs, y=biomass.pred, color=TOS)) + 
  scale_x_continuous(limits=range(na.omit(c(df$biomass.obs, df$biomass.pred)))) +
  scale_y_continuous(limits=range(na.omit(c(df$biomass.obs, df$biomass.pred)))) +
  labs(title="Biomass (kg/ha)", x="Observed", y = "Predicted") +
  geom_abline(intercept=0, colour="grey") + facet_wrap(~site) +
  theme_minimal()

print(g)
dev.off()

</text>
      </script>
    </RGraphics>
    <RGraphics name="Harvest biomass greenethorpe">
      <script>
        <text># Make some plots
library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)

options(stringsAsFactors = F)

#### Cultivar groups
groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

# Generic function to read apsim output files. 
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))  
#  cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

df.pred&lt;- do.call(rbind, lapply(list.files(pattern="^.*Harvest\\.out$"), read.apsim))
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred$Irr &lt;- ifelse(grepl("irr1", df.pred$SimulationName, fixed=T),  "irrigated", "rainfed")
df.pred&lt;- df.pred[,c("SimulationName", "site", "TOS", "Irr", "cultivar", "FloweringDAS", "MaturityDAS", "biomass", "yield", "MaxLAI")]

df.obs&lt;-  read.csv("Lentil auto observed.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)

df &lt;- df.obs %&gt;% left_join(df.pred[,!names(df.pred) %in% c("site", "TOS", "cultivar")], 
                           by=c("SimulationName"), 
                           suffix = c(".obs", ".pred"))

jpeg(imageFileName, width=width, height=height)
g&lt;-ggplot(df[df$site=="Greenethorpe1",]) + geom_point(aes(x=biomass.obs, y=biomass.pred, 
                                                     color=interaction(TOS, Irr, sep=" "))) + 
  scale_x_continuous(limits=c(0,6000)) +
  scale_y_continuous(limits=c(0,6000)) +
  labs(title="Biomass (kg/ha)", x="Observed", y = "Predicted", color="Greenethorpe") +
  geom_abline(intercept=0, colour="grey") + facet_wrap(~site) +
  theme_minimal()

print(g)
dev.off()

</text>
      </script>
    </RGraphics>
    <RGraphics name="Harvest yield">
      <script>
        <text># Make some plots
library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)

options(stringsAsFactors = F)

#### Cultivar groups
groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

# Generic function to read apsim output files. 
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))  
#  cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

df.pred&lt;- do.call(rbind, lapply(list.files(pattern="^.*Harvest\\.out$"), read.apsim))
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred&lt;- df.pred[,c("SimulationName", "site", "TOS", "cultivar", "FloweringDAS", "MaturityDAS", "biomass", "yield", "MaxLAI")]

df.obs&lt;-  read.csv("Lentil auto observed.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)

df &lt;- df.obs %&gt;% left_join(df.pred[,!names(df.pred) %in% c("site", "TOS", "cultivar")], 
                           by=c("SimulationName"), 
                           suffix = c(".obs", ".pred"))

jpeg(imageFileName, width=width, height=height)
g&lt;-ggplot(df[!is.na(df$yield.obs),]) + geom_point(aes(x=yield.obs, y=yield.pred, color=cultivar)) + 
  scale_x_continuous(limits=range(na.omit(c(df$yield.obs, df$yield.pred)))) +
  scale_y_continuous(limits=range(na.omit(c(df$yield.obs, df$yield.pred)))) +
  labs(title="Yield (kg/ha)", x="Observed", y = "Predicted") +
  geom_abline(intercept=0, colour="grey") + facet_wrap(~site) +
  theme_minimal()
print(g)
dev.off()

</text>
      </script>
    </RGraphics>
    <RGraphics name="Harvest yield x TOS">
      <script>
        <text># Make some plots
library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)

options(stringsAsFactors = F)

#### Cultivar groups
groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

# Generic function to read apsim output files. 
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))  
#  cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

df.pred&lt;- do.call(rbind, lapply(list.files(pattern="^.*Harvest\\.out$"), read.apsim))
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred&lt;- df.pred[,c("SimulationName", "site", "TOS", "cultivar", "FloweringDAS", "MaturityDAS", "biomass", "yield", "MaxLAI")]

df.obs&lt;-  read.csv("Lentil auto observed.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)

df &lt;- df.obs %&gt;% left_join(df.pred[,!names(df.pred) %in% c("site", "TOS", "cultivar")], 
                           by=c("SimulationName"), 
                           suffix = c(".obs", ".pred"))

jpeg(imageFileName, width=width, height=height)
g&lt;-ggplot(df[!is.na(df$yield.obs),]) + geom_point(aes(x=yield.obs, y=yield.pred, color=TOS)) + 
  scale_x_continuous(limits=range(na.omit(c(df$yield.obs, df$yield.pred)))) +
  scale_y_continuous(limits=range(na.omit(c(df$yield.obs, df$yield.pred)))) +
  labs(title="Yield (kg/ha)", x="Observed", y = "Predicted") +
  geom_abline(intercept=0, colour="grey") + facet_wrap(~site) +
  theme_minimal()
print(g)
dev.off()

</text>
      </script>
    </RGraphics>
    <RGraphics name="Harvest yield greenethorpe">
      <script>
        <text># Make some plots
library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)

options(stringsAsFactors = F)

#### Cultivar groups
groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

# Generic function to read apsim output files. 
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))  
#  cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

df.pred&lt;- do.call(rbind, lapply(list.files(pattern="^.*Harvest\\.out$"), read.apsim))
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred$Irr &lt;- ifelse(grepl("irr1", df.pred$SimulationName, fixed=T),  "irrigated", "rainfed")
df.pred&lt;- df.pred[,c("SimulationName", "site", "TOS", "Irr", "cultivar", "FloweringDAS", "MaturityDAS", "biomass", "yield", "MaxLAI")]

df.obs&lt;-  read.csv("Lentil auto observed.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)

df &lt;- df.obs %&gt;% left_join(df.pred[,!names(df.pred) %in% c("site", "TOS", "cultivar")], 
                           by=c("SimulationName"), 
                           suffix = c(".obs", ".pred"))

jpeg(imageFileName, width=width, height=height)
g&lt;-ggplot(df[df$site=="Greenethorpe1",]) + geom_point(aes(x=yield.obs, y=yield.pred, 
                                                     color=interaction(TOS, Irr, sep=" "))) + 
  scale_x_continuous(limits=c(0,3000)) +
  scale_y_continuous(limits=c(0,3000)) +
  labs(title="Biomass (kg/ha)", x="Observed", y = "Predicted", color="Greenethorpe") +
  geom_abline(intercept=0, colour="grey") + facet_wrap(~site) +
  theme_minimal()

print(g)
dev.off()

</text>
      </script>
    </RGraphics>
    <RGraphics name="ESW (0-600)">
      <script>
        <text>library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)
library(data.table)

options(stringsAsFactors = F)

# Generic function to read apsim output files. Adds factor levels if found.
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))
  
  #cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2", "Ace")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

df.pred&lt;- rbindlist( lapply(list.files(pattern="^.*Daily\\.out$"), read.apsim), fill=T)
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred$Date &lt;- as.Date(df.pred$Date, format="%d/%m/%Y")
colnames(df.pred)[which(names(df.pred) == "esw_0_600")] &lt;-"esw(0-600)"
colnames(df.pred)[which(names(df.pred) == "esw_100_600")] &lt;-"esw(100-600)"

df.pred$cvgroup &lt;- ifelse(df.pred$cultivar %in% groups[["early"]], "Early",
                            ifelse(df.pred$cultivar %in% groups[["mid"]], "Mid",
                                   ifelse(df.pred$cultivar %in% groups[["late"]], "Late", NA)))


df.obs&lt;-  read.csv("Lentil auto observed daily.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)
df.obs$Date &lt;- as.Date(df.obs$Date, format="%d/%m/%Y")
df.obs$cvgroup &lt;- ifelse(df.obs$cultivar %in% groups[["early"]], "Early",
                          ifelse(df.obs$cultivar %in% groups[["mid"]], "Mid",
                                 ifelse(df.obs$cultivar %in% groups[["late"]], "Late", NA)))


colnames(df.obs)[which(names(df.obs) == "sw.1.")] &lt;-"sw(1)"
colnames(df.obs)[which(names(df.obs) == "sw.2.")] &lt;-"sw(2)"
colnames(df.obs)[which(names(df.obs) == "sw.3.")] &lt;-"sw(3)"
colnames(df.obs)[which(names(df.obs) == "sw.4.")] &lt;-"sw(4)"
colnames(df.obs)[which(names(df.obs) == "sw.5.")] &lt;-"sw(5)"
colnames(df.obs)[which(names(df.obs) == "sw.6.")] &lt;-"sw(6)"
colnames(df.obs)[which(names(df.obs) == "sw.7.")] &lt;-"sw(7)"

colnames(df.obs)[which(names(df.obs) == "esw.1.")] &lt;-"esw(1)"
colnames(df.obs)[which(names(df.obs) == "esw.2.")] &lt;-"esw(2)"
colnames(df.obs)[which(names(df.obs) == "esw.3.")] &lt;-"esw(3)"
colnames(df.obs)[which(names(df.obs) == "esw.4.")] &lt;-"esw(4)"
colnames(df.obs)[which(names(df.obs) == "esw.5.")] &lt;-"esw(5)"
colnames(df.obs)[which(names(df.obs) == "esw.6.")] &lt;-"esw(6)"
colnames(df.obs)[which(names(df.obs) == "esw.7.")] &lt;-"esw(7)"

colnames(df.obs)[which(names(df.obs) == "esw_0_600")] &lt;-"esw(0-600)"
colnames(df.obs)[which(names(df.obs) == "esw_100_600")] &lt;-"esw(100-600)"


#table(df.obs$`sw(2)` &gt; 0 , df.obs$site)

# merge together 
df &lt;- df.pred %&gt;% 
  left_join(select(df.obs, -one_of( c("site", "TOS", "cultivar", "cvgroup", "Date"))), 
     by=c("SimulationName", "DaysAfterSowing"), 
     suffix = c(".pred", ".obs")) 

jpeg(imageFileName, width=width, height=height)

g&lt;-ggplot(df) + geom_abline(intercept=0, colour="lightgrey") +
  geom_point(aes(x=`esw(0-600).obs`, y=`esw(0-600).pred`, color=site), na.rm = TRUE) + 
  labs(title="All esw (0-600)") + 
  theme_minimal()
print(g)

dev.off()</text>
      </script>
    </RGraphics>
    <RGraphics name="ESW (100-600)">
      <script>
        <text>library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)
library(data.table)

options(stringsAsFactors = F)

# Generic function to read apsim output files. Adds factor levels if found.
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))
  
  #cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2", "Ace")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

df.pred&lt;- rbindlist( lapply(list.files(pattern="^.*Daily\\.out$"), read.apsim), fill=T)
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred$Date &lt;- as.Date(df.pred$Date, format="%d/%m/%Y")
colnames(df.pred)[which(names(df.pred) == "esw_0_600")] &lt;-"esw(0-600)"
colnames(df.pred)[which(names(df.pred) == "esw_100_600")] &lt;-"esw(100-600)"

df.pred$cvgroup &lt;- ifelse(df.pred$cultivar %in% groups[["early"]], "Early",
                            ifelse(df.pred$cultivar %in% groups[["mid"]], "Mid",
                                   ifelse(df.pred$cultivar %in% groups[["late"]], "Late", NA)))


df.obs&lt;-  read.csv("Lentil auto observed daily.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)
df.obs$Date &lt;- as.Date(df.obs$Date, format="%d/%m/%Y")
df.obs$cvgroup &lt;- ifelse(df.obs$cultivar %in% groups[["early"]], "Early",
                          ifelse(df.obs$cultivar %in% groups[["mid"]], "Mid",
                                 ifelse(df.obs$cultivar %in% groups[["late"]], "Late", NA)))


colnames(df.obs)[which(names(df.obs) == "sw.1.")] &lt;-"sw(1)"
colnames(df.obs)[which(names(df.obs) == "sw.2.")] &lt;-"sw(2)"
colnames(df.obs)[which(names(df.obs) == "sw.3.")] &lt;-"sw(3)"
colnames(df.obs)[which(names(df.obs) == "sw.4.")] &lt;-"sw(4)"
colnames(df.obs)[which(names(df.obs) == "sw.5.")] &lt;-"sw(5)"
colnames(df.obs)[which(names(df.obs) == "sw.6.")] &lt;-"sw(6)"
colnames(df.obs)[which(names(df.obs) == "sw.7.")] &lt;-"sw(7)"

colnames(df.obs)[which(names(df.obs) == "esw.1.")] &lt;-"esw(1)"
colnames(df.obs)[which(names(df.obs) == "esw.2.")] &lt;-"esw(2)"
colnames(df.obs)[which(names(df.obs) == "esw.3.")] &lt;-"esw(3)"
colnames(df.obs)[which(names(df.obs) == "esw.4.")] &lt;-"esw(4)"
colnames(df.obs)[which(names(df.obs) == "esw.5.")] &lt;-"esw(5)"
colnames(df.obs)[which(names(df.obs) == "esw.6.")] &lt;-"esw(6)"
colnames(df.obs)[which(names(df.obs) == "esw.7.")] &lt;-"esw(7)"

colnames(df.obs)[which(names(df.obs) == "esw_0_600")] &lt;-"esw(0-600)"
colnames(df.obs)[which(names(df.obs) == "esw_100_600")] &lt;-"esw(100-600)"


#table(df.obs$`sw(2)` &gt; 0 , df.obs$site)

# merge together 
df &lt;- df.pred %&gt;% 
  left_join(select(df.obs, -one_of( c("site", "TOS", "cultivar", "cvgroup", "Date"))), 
     by=c("SimulationName", "DaysAfterSowing"), 
     suffix = c(".pred", ".obs")) 

jpeg(imageFileName, width=width, height=height)

g&lt;-ggplot(df) + geom_abline(intercept=0, colour="lightgrey") +
  geom_point(aes(x=`esw(100-600).obs`, y=`esw(100-600).pred`, color=site), na.rm = TRUE) + 
  labs(title="All esw (100-600)") + 
  theme_minimal()
print(g)

dev.off()</text>
      </script>
    </RGraphics>
    <RGraphics name="sw(1)">
      <script>
        <text>library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)
library(data.table)

options(stringsAsFactors = F)

# Generic function to read apsim output files. Adds factor levels if found.
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))
  
  #cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2", "Ace")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

df.pred&lt;- rbindlist( lapply(list.files(pattern="^.*Daily\\.out$"), read.apsim), fill=T)
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred$Date &lt;- as.Date(df.pred$Date, format="%d/%m/%Y")
colnames(df.pred)[which(names(df.pred) == "esw_0_600")] &lt;-"esw(0-600)"
colnames(df.pred)[which(names(df.pred) == "esw_100_600")] &lt;-"esw(100-600)"

df.pred$cvgroup &lt;- ifelse(df.pred$cultivar %in% groups[["early"]], "Early",
                            ifelse(df.pred$cultivar %in% groups[["mid"]], "Mid",
                                   ifelse(df.pred$cultivar %in% groups[["late"]], "Late", NA)))


df.obs&lt;-  read.csv("Lentil auto observed daily.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)
df.obs$Date &lt;- as.Date(df.obs$Date, format="%d/%m/%Y")
df.obs$cvgroup &lt;- ifelse(df.obs$cultivar %in% groups[["early"]], "Early",
                          ifelse(df.obs$cultivar %in% groups[["mid"]], "Mid",
                                 ifelse(df.obs$cultivar %in% groups[["late"]], "Late", NA)))


colnames(df.obs)[which(names(df.obs) == "sw.1.")] &lt;-"sw(1)"
colnames(df.obs)[which(names(df.obs) == "sw.2.")] &lt;-"sw(2)"
colnames(df.obs)[which(names(df.obs) == "sw.3.")] &lt;-"sw(3)"
colnames(df.obs)[which(names(df.obs) == "sw.4.")] &lt;-"sw(4)"
colnames(df.obs)[which(names(df.obs) == "sw.5.")] &lt;-"sw(5)"
colnames(df.obs)[which(names(df.obs) == "sw.6.")] &lt;-"sw(6)"
colnames(df.obs)[which(names(df.obs) == "sw.7.")] &lt;-"sw(7)"

colnames(df.obs)[which(names(df.obs) == "esw.1.")] &lt;-"esw(1)"
colnames(df.obs)[which(names(df.obs) == "esw.2.")] &lt;-"esw(2)"
colnames(df.obs)[which(names(df.obs) == "esw.3.")] &lt;-"esw(3)"
colnames(df.obs)[which(names(df.obs) == "esw.4.")] &lt;-"esw(4)"
colnames(df.obs)[which(names(df.obs) == "esw.5.")] &lt;-"esw(5)"
colnames(df.obs)[which(names(df.obs) == "esw.6.")] &lt;-"esw(6)"
colnames(df.obs)[which(names(df.obs) == "esw.7.")] &lt;-"esw(7)"

colnames(df.obs)[which(names(df.obs) == "esw_0_600")] &lt;-"esw(0-600)"
colnames(df.obs)[which(names(df.obs) == "esw_100_600")] &lt;-"esw(100-600)"


#table(df.obs$`sw(2)` &gt; 0 , df.obs$site)

# merge together 
df &lt;- df.pred %&gt;% 
  left_join(select(df.obs, -one_of( c("site", "TOS", "cultivar", "cvgroup", "Date"))), 
     by=c("SimulationName", "DaysAfterSowing"), 
     suffix = c(".pred", ".obs")) 

swSites&lt;-unique(df$site[!is.na(df$`esw(100-600).obs`)])

jpeg(imageFileName, width=width, height=height)

# Not all sites have sw(1)
df2 &lt;- df[!is.na(df$`sw(1).obs`),]
g&lt;-ggplot() + 
  geom_point(data=df2, aes(x=DaysAfterSowing, color=SimulationName, y=`sw(1).obs`))  + 
  geom_line(data=df.pred[df.pred$site %in% swSites,], aes(x=DaysAfterSowing, group=SimulationName, color=SimulationName, y=`sw(1)`)) + 
  labs(y="sw(1)", x="Days after sowing") +
  facet_wrap(~site)  + theme_minimal() + theme(legend.position = "none")

print(g)
dev.off()
</text>
      </script>
    </RGraphics>
    <RGraphics name="sw(2)">
      <script>
        <text>library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)
library(data.table)

options(stringsAsFactors = F)

# Generic function to read apsim output files. Adds factor levels if found.
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))
  
  #cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2", "Ace")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

df.pred&lt;- rbindlist( lapply(list.files(pattern="^.*Daily\\.out$"), read.apsim), fill=T)
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred$Date &lt;- as.Date(df.pred$Date, format="%d/%m/%Y")
colnames(df.pred)[which(names(df.pred) == "esw_0_600")] &lt;-"esw(0-600)"
colnames(df.pred)[which(names(df.pred) == "esw_100_600")] &lt;-"esw(100-600)"

df.pred$cvgroup &lt;- ifelse(df.pred$cultivar %in% groups[["early"]], "Early",
                            ifelse(df.pred$cultivar %in% groups[["mid"]], "Mid",
                                   ifelse(df.pred$cultivar %in% groups[["late"]], "Late", NA)))


df.obs&lt;-  read.csv("Lentil auto observed daily.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)
df.obs$Date &lt;- as.Date(df.obs$Date, format="%d/%m/%Y")
df.obs$cvgroup &lt;- ifelse(df.obs$cultivar %in% groups[["early"]], "Early",
                          ifelse(df.obs$cultivar %in% groups[["mid"]], "Mid",
                                 ifelse(df.obs$cultivar %in% groups[["late"]], "Late", NA)))


colnames(df.obs)[which(names(df.obs) == "sw.1.")] &lt;-"sw(1)"
colnames(df.obs)[which(names(df.obs) == "sw.2.")] &lt;-"sw(2)"
colnames(df.obs)[which(names(df.obs) == "sw.3.")] &lt;-"sw(3)"
colnames(df.obs)[which(names(df.obs) == "sw.4.")] &lt;-"sw(4)"
colnames(df.obs)[which(names(df.obs) == "sw.5.")] &lt;-"sw(5)"
colnames(df.obs)[which(names(df.obs) == "sw.6.")] &lt;-"sw(6)"
colnames(df.obs)[which(names(df.obs) == "sw.7.")] &lt;-"sw(7)"

colnames(df.obs)[which(names(df.obs) == "esw.1.")] &lt;-"esw(1)"
colnames(df.obs)[which(names(df.obs) == "esw.2.")] &lt;-"esw(2)"
colnames(df.obs)[which(names(df.obs) == "esw.3.")] &lt;-"esw(3)"
colnames(df.obs)[which(names(df.obs) == "esw.4.")] &lt;-"esw(4)"
colnames(df.obs)[which(names(df.obs) == "esw.5.")] &lt;-"esw(5)"
colnames(df.obs)[which(names(df.obs) == "esw.6.")] &lt;-"esw(6)"
colnames(df.obs)[which(names(df.obs) == "esw.7.")] &lt;-"esw(7)"

colnames(df.obs)[which(names(df.obs) == "esw_0_600")] &lt;-"esw(0-600)"
colnames(df.obs)[which(names(df.obs) == "esw_100_600")] &lt;-"esw(100-600)"


#table(df.obs$`sw(2)` &gt; 0 , df.obs$site)

# merge together 
df &lt;- df.pred %&gt;% 
  left_join(select(df.obs, -one_of( c("site", "TOS", "cultivar", "cvgroup", "Date"))), 
     by=c("SimulationName", "DaysAfterSowing"), 
     suffix = c(".pred", ".obs")) 

swSites&lt;-unique(df$site[!is.na(df$`esw(100-600).obs`)])

# Not all sites have sw(1)
df2 &lt;- df[!is.na(df$`sw(2).obs`),]

jpeg(imageFileName, width=width, height=height)
ggplot() + 
  geom_point(data=df2, aes(x=DaysAfterSowing, 
             color=SimulationName, y=`sw(2).obs`))  + 
  geom_line(data=df.pred[df.pred$site %in% swSites,], 
             aes(x=DaysAfterSowing, group=SimulationName, color=SimulationName, y=`sw(2)`)) + 
  labs(y="sw(2)", x="Days after sowing") +
  facet_wrap(~site)  + theme_minimal() + theme(legend.position = "none")

print(g)
dev.off()
</text>
      </script>
    </RGraphics>
    <RGraphics name="sw(3)">
      <script>
        <text>library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)
library(data.table)

options(stringsAsFactors = F)

# Generic function to read apsim output files. Adds factor levels if found.
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))
  
  #cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2", "Ace")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

df.pred&lt;- rbindlist( lapply(list.files(pattern="^.*Daily\\.out$"), read.apsim), fill=T)
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred$Date &lt;- as.Date(df.pred$Date, format="%d/%m/%Y")
colnames(df.pred)[which(names(df.pred) == "esw_0_600")] &lt;-"esw(0-600)"
colnames(df.pred)[which(names(df.pred) == "esw_100_600")] &lt;-"esw(100-600)"

df.pred$cvgroup &lt;- ifelse(df.pred$cultivar %in% groups[["early"]], "Early",
                            ifelse(df.pred$cultivar %in% groups[["mid"]], "Mid",
                                   ifelse(df.pred$cultivar %in% groups[["late"]], "Late", NA)))


df.obs&lt;-  read.csv("Lentil auto observed daily.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)
df.obs$Date &lt;- as.Date(df.obs$Date, format="%d/%m/%Y")
df.obs$cvgroup &lt;- ifelse(df.obs$cultivar %in% groups[["early"]], "Early",
                          ifelse(df.obs$cultivar %in% groups[["mid"]], "Mid",
                                 ifelse(df.obs$cultivar %in% groups[["late"]], "Late", NA)))


colnames(df.obs)[which(names(df.obs) == "sw.1.")] &lt;-"sw(1)"
colnames(df.obs)[which(names(df.obs) == "sw.2.")] &lt;-"sw(2)"
colnames(df.obs)[which(names(df.obs) == "sw.3.")] &lt;-"sw(3)"
colnames(df.obs)[which(names(df.obs) == "sw.4.")] &lt;-"sw(4)"
colnames(df.obs)[which(names(df.obs) == "sw.5.")] &lt;-"sw(5)"
colnames(df.obs)[which(names(df.obs) == "sw.6.")] &lt;-"sw(6)"
colnames(df.obs)[which(names(df.obs) == "sw.7.")] &lt;-"sw(7)"

colnames(df.obs)[which(names(df.obs) == "esw.1.")] &lt;-"esw(1)"
colnames(df.obs)[which(names(df.obs) == "esw.2.")] &lt;-"esw(2)"
colnames(df.obs)[which(names(df.obs) == "esw.3.")] &lt;-"esw(3)"
colnames(df.obs)[which(names(df.obs) == "esw.4.")] &lt;-"esw(4)"
colnames(df.obs)[which(names(df.obs) == "esw.5.")] &lt;-"esw(5)"
colnames(df.obs)[which(names(df.obs) == "esw.6.")] &lt;-"esw(6)"
colnames(df.obs)[which(names(df.obs) == "esw.7.")] &lt;-"esw(7)"

colnames(df.obs)[which(names(df.obs) == "esw_0_600")] &lt;-"esw(0-600)"
colnames(df.obs)[which(names(df.obs) == "esw_100_600")] &lt;-"esw(100-600)"

# merge together 
df &lt;- df.pred %&gt;% 
  left_join(select(df.obs, -one_of( c("site", "TOS", "cultivar", "cvgroup", "Date"))), 
     by=c("SimulationName", "DaysAfterSowing"), 
     suffix = c(".pred", ".obs")) 

swSites&lt;-unique(df$site[!is.na(df$`esw(100-600).obs`)])

# Not all sites have sw(1)
df2 &lt;- df[!is.na(df$`sw(3).obs`),]
jpeg(imageFileName, width=width, height=height)
ggplot() + 
  geom_point(data=df2, aes(x=DaysAfterSowing, color=SimulationName, y=`sw(3).obs`))  + 
  geom_line(data=df.pred[df.pred$site %in% swSites,], aes(x=DaysAfterSowing, group=SimulationName, color=SimulationName, y=`sw(3)`)) + 
  labs(y="sw(3)", x="Days after sowing") +
  facet_wrap(~site)  + theme_minimal() + theme(legend.position = "none")

print(g)
dev.off()

</text>
      </script>
    </RGraphics>
    <RGraphics name="TS Biomass">
      <script>
        <text>library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)
library(data.table)

options(stringsAsFactors = F)

# Generic function to read apsim output files. Adds factor levels if found.
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))
  
  #cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2", "Ace")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

df.pred&lt;- rbindlist( lapply(list.files(pattern="^.*Daily\\.out$"), read.apsim), fill=T)
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred$Date &lt;- as.Date(df.pred$Date, format="%d/%m/%Y")
colnames(df.pred)[which(names(df.pred) == "esw_0_600")] &lt;-"esw(0-600)"
colnames(df.pred)[which(names(df.pred) == "esw_100_600")] &lt;-"esw(100-600)"

df.pred$cvgroup &lt;- ifelse(df.pred$cultivar %in% groups[["early"]], "Early",
                            ifelse(df.pred$cultivar %in% groups[["mid"]], "Mid",
                                   ifelse(df.pred$cultivar %in% groups[["late"]], "Late", NA)))


df.obs&lt;-  read.csv("Lentil auto observed daily.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)
df.obs$Date &lt;- as.Date(df.obs$Date, format="%d/%m/%Y")
df.obs$cvgroup &lt;- ifelse(df.obs$cultivar %in% groups[["early"]], "Early",
                          ifelse(df.obs$cultivar %in% groups[["mid"]], "Mid",
                                 ifelse(df.obs$cultivar %in% groups[["late"]], "Late", NA)))


colnames(df.obs)[which(names(df.obs) == "sw.1.")] &lt;-"sw(1)"
colnames(df.obs)[which(names(df.obs) == "sw.2.")] &lt;-"sw(2)"
colnames(df.obs)[which(names(df.obs) == "sw.3.")] &lt;-"sw(3)"
colnames(df.obs)[which(names(df.obs) == "sw.4.")] &lt;-"sw(4)"
colnames(df.obs)[which(names(df.obs) == "sw.5.")] &lt;-"sw(5)"
colnames(df.obs)[which(names(df.obs) == "sw.6.")] &lt;-"sw(6)"
colnames(df.obs)[which(names(df.obs) == "sw.7.")] &lt;-"sw(7)"

colnames(df.obs)[which(names(df.obs) == "esw.1.")] &lt;-"esw(1)"
colnames(df.obs)[which(names(df.obs) == "esw.2.")] &lt;-"esw(2)"
colnames(df.obs)[which(names(df.obs) == "esw.3.")] &lt;-"esw(3)"
colnames(df.obs)[which(names(df.obs) == "esw.4.")] &lt;-"esw(4)"
colnames(df.obs)[which(names(df.obs) == "esw.5.")] &lt;-"esw(5)"
colnames(df.obs)[which(names(df.obs) == "esw.6.")] &lt;-"esw(6)"
colnames(df.obs)[which(names(df.obs) == "esw.7.")] &lt;-"esw(7)"

colnames(df.obs)[which(names(df.obs) == "esw_0_600")] &lt;-"esw(0-600)"
colnames(df.obs)[which(names(df.obs) == "esw_100_600")] &lt;-"esw(100-600)"

# merge together 
df &lt;- df.pred %&gt;% 
  left_join(select(df.obs, -one_of( c("site", "TOS", "cultivar", "cvgroup", "Date"))), 
     by=c("SimulationName", "DaysAfterSowing"), 
     suffix = c(".pred", ".obs")) 


jpeg(imageFileName, width=width, height=height)

df2 &lt;- df[! df$site %in% c("Beulah", "Birchip", "Gatton", "Greenethorpe2", "Horsham" ),]
ggplot(df2) + 
  geom_point(aes(x=DaysAfterSowing, color=cvgroup, y=AboveGround.Wt.obs), na.rm=T)  + 
  geom_line(aes(x=DaysAfterSowing, group=SimulationName, color=cvgroup, y=AboveGround.Wt.pred))  +
  labs(y="Biomass Wt (g/m2)") +
  facet_wrap(~site)  + theme_minimal() + theme(legend.position = "none")

print(g)
dev.off()

</text>
      </script>
    </RGraphics>
    <RGraphics name="TS Yield">
      <script>
        <text>library(dplyr)
library(ggplot2)
library(gridExtra)
library(grid)
library(data.table)

options(stringsAsFactors = F)

# Generic function to read apsim output files. Adds factor levels if found.
read.apsim &lt;- function(apsim.name) {
  header&lt;-readLines(apsim.name, n=25)
  if (length(header) == 0 ) {return(NULL)}
  i&lt;-3  # 4th line
  apsim &lt;- read.table(apsim.name,skip=i+1,na.strings=c("NA","?"))
  names(apsim) &lt;- unlist(strsplit(trimws(header[i]), " +"))
  
  #cat(apsim.name, " = ", ncol(apsim), "\n")
  return(cbind(filename=apsim.name, apsim))
}

capitalise &lt;- function(x) {
  s &lt;- strsplit(x, " ")[[1]]
  paste(toupper(substring(s, 1,1)), tolower(substring(s, 2)),
        sep="", collapse=" ")
}

groups&lt;- list()
groups[["early"]] &lt;- c("HallmarkXT", "Bolt")
groups[["mid"]] &lt;- c("Blitz", "Jumbo2", "Ace")
groups[["late"]] &lt;- c("Nugget", "Digger", "Greenfield", "Northfield")

df.pred&lt;- rbindlist( lapply(list.files(pattern="^.*Daily\\.out$"), read.apsim), fill=T)
df.pred$SimulationName&lt;- tolower(sapply(strsplit(df.pred$filename, " "), function (x) {return(x[1])}))
df.pred$TOS &lt;- toupper(df.pred$TOS)
df.pred$site &lt;- sapply(df.pred$site, capitalise)
df.pred$cultivar &lt;- sapply(df.pred$cultivar, capitalise)
df.pred$Date &lt;- as.Date(df.pred$Date, format="%d/%m/%Y")
colnames(df.pred)[which(names(df.pred) == "esw_0_600")] &lt;-"esw(0-600)"
colnames(df.pred)[which(names(df.pred) == "esw_100_600")] &lt;-"esw(100-600)"

df.pred$cvgroup &lt;- ifelse(df.pred$cultivar %in% groups[["early"]], "Early",
                            ifelse(df.pred$cultivar %in% groups[["mid"]], "Mid",
                                   ifelse(df.pred$cultivar %in% groups[["late"]], "Late", NA)))


df.obs&lt;-  read.csv("Lentil auto observed daily.csv")
df.obs$SimulationName&lt;- tolower(df.obs$SimulationName)
df.obs$cultivar &lt;- sapply(df.obs$cultivar, capitalise)
df.obs$site &lt;- sapply(df.obs$site, capitalise)
df.obs$Date &lt;- as.Date(df.obs$Date, format="%d/%m/%Y")
df.obs$cvgroup &lt;- ifelse(df.obs$cultivar %in% groups[["early"]], "Early",
                          ifelse(df.obs$cultivar %in% groups[["mid"]], "Mid",
                                 ifelse(df.obs$cultivar %in% groups[["late"]], "Late", NA)))


colnames(df.obs)[which(names(df.obs) == "sw.1.")] &lt;-"sw(1)"
colnames(df.obs)[which(names(df.obs) == "sw.2.")] &lt;-"sw(2)"
colnames(df.obs)[which(names(df.obs) == "sw.3.")] &lt;-"sw(3)"
colnames(df.obs)[which(names(df.obs) == "sw.4.")] &lt;-"sw(4)"
colnames(df.obs)[which(names(df.obs) == "sw.5.")] &lt;-"sw(5)"
colnames(df.obs)[which(names(df.obs) == "sw.6.")] &lt;-"sw(6)"
colnames(df.obs)[which(names(df.obs) == "sw.7.")] &lt;-"sw(7)"

colnames(df.obs)[which(names(df.obs) == "esw.1.")] &lt;-"esw(1)"
colnames(df.obs)[which(names(df.obs) == "esw.2.")] &lt;-"esw(2)"
colnames(df.obs)[which(names(df.obs) == "esw.3.")] &lt;-"esw(3)"
colnames(df.obs)[which(names(df.obs) == "esw.4.")] &lt;-"esw(4)"
colnames(df.obs)[which(names(df.obs) == "esw.5.")] &lt;-"esw(5)"
colnames(df.obs)[which(names(df.obs) == "esw.6.")] &lt;-"esw(6)"
colnames(df.obs)[which(names(df.obs) == "esw.7.")] &lt;-"esw(7)"

colnames(df.obs)[which(names(df.obs) == "esw_0_600")] &lt;-"esw(0-600)"
colnames(df.obs)[which(names(df.obs) == "esw_100_600")] &lt;-"esw(100-600)"

# merge together 
df &lt;- df.pred %&gt;% 
  left_join(select(df.obs, -one_of( c("site", "TOS", "cultivar", "cvgroup", "Date"))), 
     by=c("SimulationName", "DaysAfterSowing"), 
     suffix = c(".pred", ".obs")) 


jpeg(imageFileName, width=width, height=height)
df2 &lt;- df[! df$site %in% c("Beulah", "Birchip","Caragabal", "Emerald",  "Gatton", "Greenethorpe2", "Horsham", "Mildura", "Millmerran" ),]
ggplot(df2) + 
  geom_point(aes(x=DaysAfterSowing, color=cvgroup, y=GrainWt.obs))  + 
  geom_line(aes(x=DaysAfterSowing, group=SimulationName, color=cvgroup, y=GrainWt.pred))  +
  labs(y="Grain Wt") +
  facet_wrap(~site)  + theme_minimal() + theme(legend.position = "none")


print(g)
dev.off()

</text>
      </script>
    </RGraphics>
  </folder>
  <simulation name="Variety-Simal">
    <metfile name="met">
      <filename name="filename">%apsim%\Tests\Lentil\Tarahara_2001-2002.met</filename>
    </metfile>
    <manager name="ClimateControl">
      <ui>
        <category type="category" description="Climate Control Window" />
        <date1 type="ddmmmdate" description="Enter window START date (dd-mmm) : ">1-jan</date1>
        <date2 type="ddmmmdate" description="Enter window END date (dd-mmm) : ">31-dec</date2>
        <category type="category" description="Climate Change Parameters" />
        <MaxtChange type="text" description="Change in maximum temperature (oC):">-3</MaxtChange>
        <MintChange type="text" description="Change in minimum temperature (oC):">-2.2</MintChange>
        <RainChange type="text" description="Relative change in daily rainfall (%):">0</RainChange>
        <RadnChange type="text" description="Relative change in daily radiation (%):">0</RadnChange>
        <CO2 type="text" description="Atmospheric CO2 Concentration (ppm)">400</CO2>
      </ui>
      <script>
        <text>
!  Adjust daily temperatures, rainfall and radiation up or down according to user-defined amounts
! To apply different levels of climate control to different times of year add multiple copies of this logic into your simulation and change the window.

if (date_within('[date1], [date2]') = 1) then
   maxt = maxt + [MaxtChange]
   mint = mint + [MintChange]
   rain = rain + rain * [RainChange] / 100
   radn = radn + radn * [RadnChange] / 100
   co2 = [CO2]
 endif
            </text>
        <event>prenewmet</event>
      </script>
      <script>
        <text>co2 = [CO2]
tav = tav + ([MaxtChange] + [MintChange]) / 2
            </text>
        <event>Init</event>
      </script>
    </manager>
    <clock name="Clock">
      <start_date type="date" description="Select the start date of the simulation">01/10/2001</start_date>
      <end_date type="date" description="Select the end date of the simulation">30/06/2002</end_date>
    </clock>
    <summaryfile>
      <filename name="filename">Continuous Wheat Simulation.sum</filename>
    </summaryfile>
    <area name="Field1">
      <manager name="Harvesting rule">
        <ui>
          <category type="category" description="Harvesting criteria" />
          <crop type="crop" description="Enter name of crop to harvest when ripe : ">lentil</crop>
        </ui>
        <script>
          <text>! Harvest rule for wheat

           if ('[crop]' = 'cotton') then
              if ([crop].ozcot_status &gt; 0) then
                  [crop] harvest
              endif
           elseif ([crop].StageName = 'harvest_ripe' or [crop].plant_status = 'dead') then
              [crop]  harvest
              [crop]  end_crop

! remove some stubble for animal feed
               surfaceom tillage type = user_defined, f_incorp = 0.6 (), tillage_depth = 0.0
           endif
</text>
          <event>end_of_day</event>
        </script>
      </manager>
      <fertiliser />
      <surfaceom name="surfaceOM">
        <PoolName type="text" description="Organic Matter pool name">Soybean</PoolName>
        <type type="list" listvalues="inert,manure,fym,bambatsi,barley,broccoli,camaldulensis,canola,chickpea,cowpea,danthonia,globulus,grandis,fababean,fieldpea,grass,lablab,lucerne,lupin,maize,millet,mucuna,mungbean,horsegram,navybean,cotton,orobanche,peanut,pigeonpea,rice,soybean,sorghum,stylo,sugar,sunflower,sweetcorn,sweetsorghum,weed,wheat" description="Organic Matter type">soybean</type>
        <mass type="text" description="Initial surface residue (kg/ha)">1500</mass>
        <cnr type="text" description="C:N ratio of initial residue">80</cnr>
        <standing_fraction type="text" description="Fraction of residue standing (0-1)">0.15</standing_fraction>
      </surfaceom>
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">800</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <Soil name="1-Inceptisol_Typic_Ustochrept">
        <RecordNumber>0</RecordNumber>
        <SoilType>Inceptisol</SoilType>
        <LocalName>Typic_Ustochrepts</LocalName>
        <Latitude>NaN</Latitude>
        <Longitude>NaN</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Ravender et.al., 2009 Research Bulletin 44 Charactersation of Dominant Soil Subgroups of Eastern India</DataSource>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.39</double>
            <double>1.39</double>
            <double>1.4</double>
            <double>1.41</double>
            <double>1.41</double>
            <double>1.41</double>
          </BD>
          <AirDry>
            <double>0.12</double>
            <double>0.183</double>
            <double>0.255</double>
            <double>0.286</double>
            <double>0.286</double>
            <double>0.286</double>
          </AirDry>
          <LL15>
            <double>0.24</double>
            <double>0.245</double>
            <double>0.255</double>
            <double>0.286</double>
            <double>0.286</double>
            <double>0.286</double>
          </LL15>
          <DUL>
            <double>0.42</double>
            <double>0.435</double>
            <double>0.45</double>
            <double>0.445</double>
            <double>0.445</double>
            <double>0.445</double>
          </DUL>
          <SAT>
            <double>0.47</double>
            <double>0.472</double>
            <double>0.474</double>
            <double>0.467</double>
            <double>0.467</double>
            <double>0.467</double>
          </SAT>
          <KS>
            <double>120</double>
            <double>80</double>
            <double>10</double>
            <double>10</double>
            <double>10</double>
            <double>10</double>
          </KS>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.24</double>
              <double>0.245</double>
              <double>0.255</double>
              <double>0.286</double>
              <double>0.35</double>
              <double>0.445</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.24</double>
              <double>0.245</double>
              <double>0.255</double>
              <double>0.286</double>
              <double>0.286</double>
              <double>0.286</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="grasspea">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.24</double>
              <double>0.245</double>
              <double>0.255</double>
              <double>0.286</double>
              <double>0.286</double>
              <double>0.286</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="maize">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.24</double>
              <double>0.245</double>
              <double>0.255</double>
              <double>0.286</double>
              <double>0.35</double>
              <double>0.445</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.24</double>
              <double>0.245</double>
              <double>0.255</double>
              <double>0.335</double>
              <double>0.445</double>
              <double>0.445</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>4</SummerCona>
          <SummerU>4.5</SummerU>
          <SummerDate>1-Apr</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>3.5</WinterU>
          <WinterDate>1-Oct</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.14</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.1</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
          <MWCON>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </MWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1500</RootWt>
          <SoilCN>12.5</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.79</double>
            <double>0.58</double>
            <double>0.09</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.05</double>
          </OC>
          <OCMetadata>
            <string>Unknown source or quality of data</string>
            <string>Unknown source or quality of data</string>
            <string>Unknown source or quality of data</string>
            <string>Unknown source or quality of data</string>
            <string>Unknown source or quality of data</string>
            <string />
          </OCMetadata>
          <FBiom>
            <double>0.035</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.3</double>
            <double>0.4</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <EC>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.26</double>
            <double>0.43</double>
            <double>0.43</double>
            <double>0.43</double>
          </EC>
          <PH>
            <double>5.9</double>
            <double>5.9</double>
            <double>6.9</double>
            <double>7.1</double>
            <double>7.1</double>
            <double>7.1</double>
          </PH>
          <PHMetadata>
            <string>Unknown source or quality of data</string>
            <string>Unknown source or quality of data</string>
            <string>Unknown source or quality of data</string>
            <string>Unknown source or quality of data</string>
            <string>Unknown source or quality of data</string>
            <string />
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <InitialWater>
          <FractionFull>0.4</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
          <PercentMethod>FilledFromTop</PercentMethod>
          <RelativeTo>ll15</RelativeTo>
        </InitialWater>
        <Sample name="Initial nitrogen">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>5</double>
            <double>2</double>
            <double>1</double>
            <double>1</double>
            <double>0.05</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>5</double>
            <double>1</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
      <folder name="Rabi">
        <manager name="Cultivate_Rabi">
          <ui>
            <category type="category" description="When should tillage be done" />
            <tillage_date type="ddmmmdate" description="Enter tillage date (dd-mmm) : ">14-Oct</tillage_date>
            <category type="category" description="Tillage application details" />
            <surfaceommodule type="modulename" description="Module used to apply the tillage : ">surfaceOM</surfaceommodule>
            <tillage_type type="list" listvalues="user_defined, chisel, disc, planter, burn, burn_90, graze, scarifier, rip, blade, tine" description="Tillage type : ">user_defined</tillage_type>
            <tillage_depth type="text" description="User_defined depth of seedbed preparation (mm) : ">200</tillage_depth>
            <tillage_f_incorp type="text" description="User_defined fraction of surface residues to incorporate (0-1): ">1.0</tillage_f_incorp>
          </ui>
          <script>
            <text>
         if (today = date('[tillage_date]') then
            if ('[tillage_type]' = 'user_defined') then
                '[surfaceommodule]' tillage type = [tillage_type], f_incorp = [tillage_f_incorp] (), tillage_depth = [tillage_depth]
            else
                '[surfaceommodule]' tillage type = [tillage_type]
            endif
            ready_to_till_pre_sow = 0
            till_day_pre_sow = 0
         endif

 

      </text>
            <event>start_of_day</event>
          </script>
        </manager>
        <manager name="Sow_Lentil">
          <ui>
            <category type="category" description="Sowing criteria" />
            <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm) : ">21-Oct</date1>
            <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm) : ">21-oct</date2>
            <must_sow type="yesno" description="Must sow? : ">yes</must_sow>
            <raincrit type="text" description="Amount of rainfall : ">30</raincrit>
            <rainnumdays type="text" description="Number of days of rainfall : ">3</rainnumdays>
            <esw_amount type="text" description="Enter minimum allowable available soil water (mm) : ">200</esw_amount>
            <category type="category" description="Sowing parameters" />
            <crop type="crop" description="Enter name of crop to sow : ">lentil</crop>
            <density type="text" description="Enter sowing density  (plants/m2) : ">151</density>
            <depth type="text" description="Enter sowing depth  (mm) : ">50</depth>
            <cultivar type="cultivars" description="Enter cultivar : ">Simal</cultivar>
            <class type="classes" description="Enter crop growth class : ">plant</class>
            <row_spacing type="text" description="Enter row spacing (mm) : ">200</row_spacing>
          </ui>
          <script>
            <text>
      if (paddock_is_fallow() = 1 and FallowIn &lt;&gt; 'yes' and (NextCrop = 0 or NextCrop = '[crop]')) then
         if (date_within('[date1], [date2]') = 1) then
            if (rain[[rainnumdays]] &gt;= [raincrit] AND esw &gt;= [esw_amount]) OR
                ('[must_sow]' = 'yes' AND today = date('[date2]'))) THEN
               ChooseNextCrop = 'yes'   ! for rotations
               [crop] sow plants =[density], sowing_depth = [depth], cultivar = [cultivar], row_spacing = [row_spacing], crop_class = [class]
 ! irrigation apply amount = 20
                  crop = 'Lentil'
                  CWU = 0
            endif
            if today = date('[date2]') then
               ChooseNextCrop = 'yes'
            endif
         endif
      endif
            

CWU = CWU + es + ep

if daysaftersowing &gt; 10 then
   Root_shoot = RootTotalWt/(leafTotalWt + StemTotalWt + PodTotalWt + GrainTotalWt) 
endif
</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>Root_shoot = 0</text>
            <event>init</event>
          </script>
        </manager>
        <manager name="Irrigate DAS1">
          <ui>
            <category type="category" description="When should fertiliser be applied" />
            <modulename type="modulename" description="On which crop is fertiliser being applied : ">lentil</modulename>
            <irrig_das type="text" description="Enter days after sowing to irrigate : ">129</irrig_das>
            <category type="category" description="Irrigation application details" />
            <irrig_module type="modulename" description="Module used to apply the irrigation : ">Irrigation</irrig_module>
            <irrig_amount type="text" description="Irrigation amount (mm)">50</irrig_amount>
          </ui>
          <script>
            <text>
         if ([modulename].DaysAfterSowing = [irrig_das]) then
            irrigation apply amount = [irrig_amount]
         endif </text>
            <event>start_of_day</event>
          </script>
        </manager>
        <manager name="Fertilise DAS1">
          <ui>
            <category type="category" description="When should fertiliser be applied" />
            <modulename type="modulename" description="On which crop is fertiliser being applied : ">lentil</modulename>
            <fert_das type="text" description="Enter fertiliser days after sowing  : ">1</fert_das>
            <fert_criteria type="text" description="Amount of N required in top 3 layers (kg/ha) : ">1000</fert_criteria>
            <category type="category" description="Fertiliser application details" />
            <fertmodule type="modulename" description="Module used to apply the fertiliser : ">fertiliser</fertmodule>
            <fert_amount type="text" description="Amount of fertiliser to apply (kg/ha) : ">10</fert_amount>
            <fert_type type="list" listvalues="NO3_N, NH4_N, NH4NO3, UAN_N, urea_N, urea_no3, urea, nh4so4_n, rock_p, banded_p, broadcast_p" description="Fertiliser type : ">urea_N</fert_type>
          </ui>
          <script>
            <text>
         if ([modulename].DaysAfterSowing = [fert_das]) then
            '[fertmodule]' apply amount = [fert_amount] (kg/ha), depth = 50 (mm), type = [fert_type] ()
         endif </text>
            <event>start_of_day</event>
          </script>
        </manager>
      </folder>
      <outputfile>
        <filename output="yes">Variety-Simal Field1.out</filename>
        <title>Variety-Simal Field1</title>
        <memo> *NOTE:
1. Have adjusted the climate flie for an area to the SE of Kathmandu to reduce max and min temperatures to reflect temperatures at the altitude of Kathmandu. This seems to work as the observed degree-days to flowering are simulated correctly.

2. 2001-02 was a wetter season than normal so have added one irrigation during the period of increased rainfall (ie. rainfall of 159 mm 86-164 DAS)

3. Only measured values for Green Area Index (GAI) to compare with lentil LAI

4. There is a difference between the sum of the partitioned components (leaf,stem,pod wall and seed) based on figure 5 (Shrestha et al., 2005) and biomass and seed yield values given in Table 2 (Shrestha et al., 2005).
<memo> *NOTE:
1. Have adjusted the climate flie for an area to the SE of Kathmandu to reduce max and min temperatures to reflect temperatures at the altitude of Kathmandu. This seems to work as the observed degree-days to flowering are simulated correctly.
2. 2001-02 was a wetter season than normal so have 

There is a difference between the sum of the partitioned components (leaf,stem,pod wall and seed) based on figure 5 (Shrestha et al., 2005) and biomass and seed yield values given in Table 2 (Shrestha et al., 2005).
</memo></memo>
        <events name="Reporting Frequency">
          <event>daily</event>
        </events>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>Day</variable>
          <variable>Month</variable>
          <variable>Year</variable>
          <variable>DaysAftersowing</variable>
          <variable>Stage</variable>
          <variable>TT</variable>
          <variable>day_length</variable>
          <variable>biomass</variable>
          <variable>green_biomass</variable>
          <variable>yield</variable>
          <variable>yieldwet</variable>
          <variable>biomass_wt</variable>
          <variable>leafGreenWt</variable>
          <variable>leafTotalWt</variable>
          <variable>StemGreenWt</variable>
          <variable>StemTotalWt</variable>
          <variable>PodTotalWt</variable>
          <variable>PodGreenWt</variable>
          <variable>GrainTotalWt</variable>
          <variable>grain_wt</variable>
          <variable>PodSenescedWt</variable>
          <variable>RootTotalWt</variable>
          <variable>Root_shoot</variable>
          <variable>node_no</variable>
          <variable>leaf_no</variable>
          <variable>lai</variable>
          <variable>rain</variable>
          <variable>irrigation</variable>
          <variable>runoff</variable>
          <variable>drain</variable>
          <variable>esw</variable>
          <variable>surfaceom_wt</variable>
          <variable>dul(1)</variable>
          <variable>sw(1)</variable>
          <variable>sw(2)</variable>
          <variable>sw(3)</variable>
          <variable>ep</variable>
          <variable>es</variable>
          <variable>CWU</variable>
          <variable>NO3()</variable>
          <variable>Nh4()</variable>
          <variable>dlt_n_min()</variable>
          <variable>fertiliser</variable>
          <variable>sw_stress_expan</variable>
          <variable>sw_stress_pheno</variable>
          <variable>sw_stress_photo</variable>
          <variable>nfact_expan</variable>
          <variable>nfact_pheno</variable>
          <variable>nfact_photo</variable>
        </variables>
        <Graph name="Growth">
          <Legend>
            <CheckedTitles>Plot, biomass,Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot, yield,Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot, green_biomass,Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot, yieldwet,Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot1, biomass,Simal-obs</CheckedTitles>
            <CheckedTitles>Plot2, yield,Simal-obs</CheckedTitles>
          </Legend>
          <Format>AAEAAAD/////AQAAAAAAAAAMAgAAAFhUZWVDaGFydC5DbGllbnQsIFZlcnNpb249NC4xLjIwMTEuNzI4MywgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj05YzgxMjYyNzZjNzdiZGI3DAMAAABXU3lzdGVtLldpbmRvd3MuRm9ybXMsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5DAQAAABRU3lzdGVtLkRyYXdpbmcsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iMDNmNWY3ZjExZDUwYTNhBQEAAAAVU3RlZW1hLlRlZUNoYXJ0LkNoYXJ0+AAAAA4uWm9vbS5BbmltYXRlZBMuWm9vbS5BbmltYXRlZFN0ZXBzFC5QYW5uaW5nLk1vdXNlQnV0dG9uEC5DdXN0b21DaGFydFJlY3QXLlBhbmVsLkltYWdlQmV2ZWwuV2lkdGgVLlBhbmVsLkJldmVsLkNvbG9yT25lGy5QYW5lbC5CZXZlbC5TdHJpbmdDb2xvck9uZRUuUGFuZWwuQmV2ZWwuQ29sb3JUd28bLlBhbmVsLkJldmVsLlN0cmluZ0NvbG9yVHdvEi5QYW5lbC5CZXZlbC5PdXRlchIuUGFuZWwuQnJ1c2guQ29sb3ISLkxlZ2VuZC5DaGVja0JveGVzES5MZWdlbmQuQWxpZ25tZW50Ei5MZWdlbmQuTWF4TnVtUm93cxwuTGVnZW5kLlRpdGxlLkJldmVsLkNvbG9yT25lIi5MZWdlbmQuVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JPbmUcLkxlZ2VuZC5UaXRsZS5CZXZlbC5Db2xvclR3byIuTGVnZW5kLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yVHdvFi5MZWdlbmQuQmV2ZWwuQ29sb3JPbmUcLkxlZ2VuZC5CZXZlbC5TdHJpbmdDb2xvck9uZRYuTGVnZW5kLkJldmVsLkNvbG9yVHdvHC5MZWdlbmQuQmV2ZWwuU3RyaW5nQ29sb3JUd28WLkxlZ2VuZC5TaGFkb3cuVmlzaWJsZRMuTGVnZW5kLlRyYW5zcGFyZW50DS5IZWFkZXIuTGluZXMRLkhlYWRlci5Gb250Lk5hbWURLkhlYWRlci5Gb250LlNpemUWLkhlYWRlci5Gb250LlNpemVGbG9hdBYuSGVhZGVyLkJldmVsLkNvbG9yT25lHC5IZWFkZXIuQmV2ZWwuU3RyaW5nQ29sb3JPbmUWLkhlYWRlci5CZXZlbC5Db2xvclR3bxwuSGVhZGVyLkJldmVsLlN0cmluZ0NvbG9yVHdvGS5TdWJIZWFkZXIuQmV2ZWwuQ29sb3JPbmUfLlN1YkhlYWRlci5CZXZlbC5TdHJpbmdDb2xvck9uZRkuU3ViSGVhZGVyLkJldmVsLkNvbG9yVHdvHy5TdWJIZWFkZXIuQmV2ZWwuU3RyaW5nQ29sb3JUd28WLkZvb3Rlci5CZXZlbC5Db2xvck9uZRwuRm9vdGVyLkJldmVsLlN0cmluZ0NvbG9yT25lFi5Gb290ZXIuQmV2ZWwuQ29sb3JUd28cLkZvb3Rlci5CZXZlbC5TdHJpbmdDb2xvclR3bxkuU3ViRm9vdGVyLkJldmVsLkNvbG9yT25lHy5TdWJGb290ZXIuQmV2ZWwuU3RyaW5nQ29sb3JPbmUZLlN1YkZvb3Rlci5CZXZlbC5Db2xvclR3bx8uU3ViRm9vdGVyLkJldmVsLlN0cmluZ0NvbG9yVHdvGS5Bc3BlY3QuQ29sb3JQYWxldHRlSW5kZXgOLkFzcGVjdC5WaWV3M0QIU2VyaWVzLjAVLlNlcmllcy4wLkJydXNoLkNvbG9yFy5TZXJpZXMuMC5Qb2ludGVyLlN0eWxlFy5TZXJpZXMuMC5MaW5lUGVuLldpZHRoEy5TZXJpZXMuMC5Db2xvckVhY2gPLlNlcmllcy4wLkNvbG9yDy5TZXJpZXMuMC5UaXRsZQhTZXJpZXMuMRUuU2VyaWVzLjEuQnJ1c2guQ29sb3IXLlNlcmllcy4xLlBvaW50ZXIuU3R5bGUXLlNlcmllcy4xLkxpbmVQZW4uV2lkdGgTLlNlcmllcy4xLkNvbG9yRWFjaA8uU2VyaWVzLjEuQ29sb3IPLlNlcmllcy4xLlRpdGxlCFNlcmllcy4yFS5TZXJpZXMuMi5CcnVzaC5Db2xvchcuU2VyaWVzLjIuUG9pbnRlci5TdHlsZRcuU2VyaWVzLjIuTGluZVBlbi5XaWR0aBMuU2VyaWVzLjIuQ29sb3JFYWNoDy5TZXJpZXMuMi5Db2xvcg8uU2VyaWVzLjIuVGl0bGUIU2VyaWVzLjMVLlNlcmllcy4zLkJydXNoLkNvbG9yFy5TZXJpZXMuMy5Qb2ludGVyLlN0eWxlFy5TZXJpZXMuMy5MaW5lUGVuLldpZHRoEy5TZXJpZXMuMy5Db2xvckVhY2gPLlNlcmllcy4zLkNvbG9yDy5TZXJpZXMuMy5UaXRsZQhTZXJpZXMuNBUuU2VyaWVzLjQuQnJ1c2guQ29sb3IZLlNlcmllcy40LlBvaW50ZXIuVmlzaWJsZRcuU2VyaWVzLjQuUG9pbnRlci5TdHlsZRsuU2VyaWVzLjQuUG9pbnRlci5QZW4uQ29sb3IZLlNlcmllcy40LkxpbmVQZW4uVmlzaWJsZRcuU2VyaWVzLjQuTGluZVBlbi5XaWR0aBMuU2VyaWVzLjQuQ29sb3JFYWNoDy5TZXJpZXMuNC5Db2xvcg8uU2VyaWVzLjQuVGl0bGUIU2VyaWVzLjUVLlNlcmllcy41LkJydXNoLkNvbG9yGS5TZXJpZXMuNS5Qb2ludGVyLlZpc2libGUXLlNlcmllcy41LlBvaW50ZXIuU3R5bGUbLlNlcmllcy41LlBvaW50ZXIuUGVuLkNvbG9yGS5TZXJpZXMuNS5MaW5lUGVuLlZpc2libGUXLlNlcmllcy41LkxpbmVQZW4uV2lkdGgTLlNlcmllcy41LkNvbG9yRWFjaA8uU2VyaWVzLjUuQ29sb3IPLlNlcmllcy41LlRpdGxlCFNlcmllcy42FS5TZXJpZXMuNi5CcnVzaC5Db2xvchkuU2VyaWVzLjYuUG9pbnRlci5WaXNpYmxlFy5TZXJpZXMuNi5Qb2ludGVyLlN0eWxlGy5TZXJpZXMuNi5Qb2ludGVyLlBlbi5Db2xvchkuU2VyaWVzLjYuTGluZVBlbi5WaXNpYmxlFy5TZXJpZXMuNi5MaW5lUGVuLldpZHRoEy5TZXJpZXMuNi5Db2xvckVhY2gPLlNlcmllcy42LkNvbG9yDy5TZXJpZXMuNi5UaXRsZQhTZXJpZXMuNxUuU2VyaWVzLjcuQnJ1c2guQ29sb3IZLlNlcmllcy43LlBvaW50ZXIuVmlzaWJsZRcuU2VyaWVzLjcuUG9pbnRlci5TdHlsZRsuU2VyaWVzLjcuUG9pbnRlci5QZW4uQ29sb3IZLlNlcmllcy43LkxpbmVQZW4uVmlzaWJsZRcuU2VyaWVzLjcuTGluZVBlbi5XaWR0aBMuU2VyaWVzLjcuQ29sb3JFYWNoDy5TZXJpZXMuNy5Db2xvcg8uU2VyaWVzLjcuVGl0bGUaLldhbGxzLkxlZnQuQmV2ZWwuQ29sb3JPbmUgLldhbGxzLkxlZnQuQmV2ZWwuU3RyaW5nQ29sb3JPbmUaLldhbGxzLkxlZnQuQmV2ZWwuQ29sb3JUd28gLldhbGxzLkxlZnQuQmV2ZWwuU3RyaW5nQ29sb3JUd28bLldhbGxzLlJpZ2h0LkJldmVsLkNvbG9yT25lIS5XYWxscy5SaWdodC5CZXZlbC5TdHJpbmdDb2xvck9uZRsuV2FsbHMuUmlnaHQuQmV2ZWwuQ29sb3JUd28hLldhbGxzLlJpZ2h0LkJldmVsLlN0cmluZ0NvbG9yVHdvGi5XYWxscy5CYWNrLkJldmVsLkNvbG9yT25lIC5XYWxscy5CYWNrLkJldmVsLlN0cmluZ0NvbG9yT25lGi5XYWxscy5CYWNrLkJldmVsLkNvbG9yVHdvIC5XYWxscy5CYWNrLkJldmVsLlN0cmluZ0NvbG9yVHdvHC5XYWxscy5Cb3R0b20uQmV2ZWwuQ29sb3JPbmUiLldhbGxzLkJvdHRvbS5CZXZlbC5TdHJpbmdDb2xvck9uZRwuV2FsbHMuQm90dG9tLkJldmVsLkNvbG9yVHdvIi5XYWxscy5Cb3R0b20uQmV2ZWwuU3RyaW5nQ29sb3JUd28OLldhbGxzLlZpc2libGUcLkF4ZXMuTGVmdC5MYWJlbHMuU2VwYXJhdGlvbh0uQXhlcy5MZWZ0LkxhYmVscy5WYWx1ZUZvcm1hdBsuQXhlcy5MZWZ0LkxhYmVscy5Gb250Lk5hbWUbLkF4ZXMuTGVmdC5MYWJlbHMuRm9udC5TaXplIC5BeGVzLkxlZnQuTGFiZWxzLkZvbnQuU2l6ZUZsb2F0IC5BeGVzLkxlZnQuTGFiZWxzLkJldmVsLkNvbG9yT25lJi5BeGVzLkxlZnQuTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yT25lIC5BeGVzLkxlZnQuTGFiZWxzLkJldmVsLkNvbG9yVHdvJi5BeGVzLkxlZnQuTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yVHdvGC5BeGVzLkxlZnQuQXhpc1Blbi5XaWR0aBkuQXhlcy5MZWZ0LkF4aXNQZW4uRW5kQ2FwFy5BeGVzLkxlZnQuR3JpZC5WaXNpYmxlGC5BeGVzLkxlZnQuTWF4aW11bU9mZnNldB0uQXhlcy5MZWZ0Lk1pbm9yVGlja3MuVmlzaWJsZRYuQXhlcy5MZWZ0LlRpY2tzLkNvbG9yGi5BeGVzLkxlZnQuVGl0bGUuRm9udC5OYW1lGi5BeGVzLkxlZnQuVGl0bGUuRm9udC5TaXplHy5BeGVzLkxlZnQuVGl0bGUuRm9udC5TaXplRmxvYXQoLkF4ZXMuTGVmdC5UaXRsZS5Gb250LlNoYWRvdy5CcnVzaC5Db2xvciEuQXhlcy5MZWZ0LlRpdGxlLkZvbnQuQnJ1c2guQ29sb3IfLkF4ZXMuTGVmdC5UaXRsZS5CZXZlbC5Db2xvck9uZSUuQXhlcy5MZWZ0LlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yT25lHy5BeGVzLkxlZnQuVGl0bGUuQmV2ZWwuQ29sb3JUd28lLkF4ZXMuTGVmdC5UaXRsZS5CZXZlbC5TdHJpbmdDb2xvclR3bxsuQXhlcy5Ub3AuTGFiZWxzLlNlcGFyYXRpb24cLkF4ZXMuVG9wLkxhYmVscy5WYWx1ZUZvcm1hdBouQXhlcy5Ub3AuTGFiZWxzLkZvbnQuTmFtZRouQXhlcy5Ub3AuTGFiZWxzLkZvbnQuU2l6ZR8uQXhlcy5Ub3AuTGFiZWxzLkZvbnQuU2l6ZUZsb2F0Hy5BeGVzLlRvcC5MYWJlbHMuQmV2ZWwuQ29sb3JPbmUlLkF4ZXMuVG9wLkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvck9uZR8uQXhlcy5Ub3AuTGFiZWxzLkJldmVsLkNvbG9yVHdvJS5BeGVzLlRvcC5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JUd28XLkF4ZXMuVG9wLkF4aXNQZW4uV2lkdGgYLkF4ZXMuVG9wLkF4aXNQZW4uRW5kQ2FwFi5BeGVzLlRvcC5HcmlkLlZpc2libGUcLkF4ZXMuVG9wLk1pbm9yVGlja3MuVmlzaWJsZRUuQXhlcy5Ub3AuVGlja3MuQ29sb3IZLkF4ZXMuVG9wLlRpdGxlLkZvbnQuTmFtZRkuQXhlcy5Ub3AuVGl0bGUuRm9udC5TaXplHi5BeGVzLlRvcC5UaXRsZS5Gb250LlNpemVGbG9hdCAuQXhlcy5Ub3AuVGl0bGUuRm9udC5CcnVzaC5Db2xvch4uQXhlcy5Ub3AuVGl0bGUuQmV2ZWwuQ29sb3JPbmUkLkF4ZXMuVG9wLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yT25lHi5BeGVzLlRvcC5UaXRsZS5CZXZlbC5Db2xvclR3byQuQXhlcy5Ub3AuVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JUd28RLkF4ZXMuVG9wLlZpc2libGUdLkF4ZXMuUmlnaHQuTGFiZWxzLlNlcGFyYXRpb24eLkF4ZXMuUmlnaHQuTGFiZWxzLlZhbHVlRm9ybWF0HC5BeGVzLlJpZ2h0LkxhYmVscy5Gb250Lk5hbWUcLkF4ZXMuUmlnaHQuTGFiZWxzLkZvbnQuU2l6ZSEuQXhlcy5SaWdodC5MYWJlbHMuRm9udC5TaXplRmxvYXQhLkF4ZXMuUmlnaHQuTGFiZWxzLkJldmVsLkNvbG9yT25lJy5BeGVzLlJpZ2h0LkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvck9uZSEuQXhlcy5SaWdodC5MYWJlbHMuQmV2ZWwuQ29sb3JUd28nLkF4ZXMuUmlnaHQuTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yVHdvGS5BeGVzLlJpZ2h0LkF4aXNQZW4uV2lkdGgaLkF4ZXMuUmlnaHQuQXhpc1Blbi5FbmRDYXAYLkF4ZXMuUmlnaHQuR3JpZC5WaXNpYmxlGS5BeGVzLlJpZ2h0Lk1heGltdW1PZmZzZXQeLkF4ZXMuUmlnaHQuTWlub3JUaWNrcy5WaXNpYmxlFy5BeGVzLlJpZ2h0LlRpY2tzLkNvbG9yGy5BeGVzLlJpZ2h0LlRpdGxlLkZvbnQuTmFtZRsuQXhlcy5SaWdodC5UaXRsZS5Gb250LlNpemUgLkF4ZXMuUmlnaHQuVGl0bGUuRm9udC5TaXplRmxvYXQiLkF4ZXMuUmlnaHQuVGl0bGUuRm9udC5CcnVzaC5Db2xvciAuQXhlcy5SaWdodC5UaXRsZS5CZXZlbC5Db2xvck9uZSYuQXhlcy5SaWdodC5UaXRsZS5CZXZlbC5TdHJpbmdDb2xvck9uZSAuQXhlcy5SaWdodC5UaXRsZS5CZXZlbC5Db2xvclR3byYuQXhlcy5SaWdodC5UaXRsZS5CZXZlbC5TdHJpbmdDb2xvclR3bxMuQXhlcy5SaWdodC5WaXNpYmxlHi5BeGVzLkJvdHRvbS5MYWJlbHMuU2VwYXJhdGlvbiIuQXhlcy5Cb3R0b20uTGFiZWxzLkRhdGVUaW1lRm9ybWF0Hy5BeGVzLkJvdHRvbS5MYWJlbHMuVmFsdWVGb3JtYXQdLkF4ZXMuQm90dG9tLkxhYmVscy5Gb250Lk5hbWUdLkF4ZXMuQm90dG9tLkxhYmVscy5Gb250LlNpemUiLkF4ZXMuQm90dG9tLkxhYmVscy5Gb250LlNpemVGbG9hdCIuQXhlcy5Cb3R0b20uTGFiZWxzLkJldmVsLkNvbG9yT25lKC5BeGVzLkJvdHRvbS5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JPbmUiLkF4ZXMuQm90dG9tLkxhYmVscy5CZXZlbC5Db2xvclR3byguQXhlcy5Cb3R0b20uTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yVHdvFi5BeGVzLkJvdHRvbS5BdXRvbWF0aWMdLkF4ZXMuQm90dG9tLkF1dG9tYXRpY01heGltdW0dLkF4ZXMuQm90dG9tLkF1dG9tYXRpY01pbmltdW0aLkF4ZXMuQm90dG9tLkF4aXNQZW4uV2lkdGgbLkF4ZXMuQm90dG9tLkF4aXNQZW4uRW5kQ2FwGS5BeGVzLkJvdHRvbS5HcmlkLlZpc2libGUaLkF4ZXMuQm90dG9tLk1heGltdW1PZmZzZXQULkF4ZXMuQm90dG9tLk1heGltdW0ULkF4ZXMuQm90dG9tLk1pbmltdW0aLkF4ZXMuQm90dG9tLk1pbmltdW1PZmZzZXQfLkF4ZXMuQm90dG9tLk1pbm9yVGlja3MuVmlzaWJsZRguQXhlcy5Cb3R0b20uVGlja3MuQ29sb3IcLkF4ZXMuQm90dG9tLlRpdGxlLkZvbnQuTmFtZRwuQXhlcy5Cb3R0b20uVGl0bGUuRm9udC5TaXplIS5BeGVzLkJvdHRvbS5UaXRsZS5Gb250LlNpemVGbG9hdCMuQXhlcy5Cb3R0b20uVGl0bGUuRm9udC5CcnVzaC5Db2xvciEuQXhlcy5Cb3R0b20uVGl0bGUuQmV2ZWwuQ29sb3JPbmUnLkF4ZXMuQm90dG9tLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yT25lIS5BeGVzLkJvdHRvbS5UaXRsZS5CZXZlbC5Db2xvclR3bycuQXhlcy5Cb3R0b20uVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JUd28kLkF4ZXMuRGVwdGhUb3AuTGFiZWxzLkJldmVsLkNvbG9yT25lKi5BeGVzLkRlcHRoVG9wLkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvck9uZSQuQXhlcy5EZXB0aFRvcC5MYWJlbHMuQmV2ZWwuQ29sb3JUd28qLkF4ZXMuRGVwdGhUb3AuTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yVHdvIy5BeGVzLkRlcHRoVG9wLlRpdGxlLkJldmVsLkNvbG9yT25lKS5BeGVzLkRlcHRoVG9wLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yT25lIy5BeGVzLkRlcHRoVG9wLlRpdGxlLkJldmVsLkNvbG9yVHdvKS5BeGVzLkRlcHRoVG9wLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yVHdvIS5BeGVzLkRlcHRoLkxhYmVscy5CZXZlbC5Db2xvck9uZScuQXhlcy5EZXB0aC5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JPbmUhLkF4ZXMuRGVwdGguTGFiZWxzLkJldmVsLkNvbG9yVHdvJy5BeGVzLkRlcHRoLkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvclR3byAuQXhlcy5EZXB0aC5UaXRsZS5CZXZlbC5Db2xvck9uZSYuQXhlcy5EZXB0aC5UaXRsZS5CZXZlbC5TdHJpbmdDb2xvck9uZSAuQXhlcy5EZXB0aC5UaXRsZS5CZXZlbC5Db2xvclR3byYuQXhlcy5EZXB0aC5UaXRsZS5CZXZlbC5TdHJpbmdDb2xvclR3bwAABAAABAEEAQQEAAQABAEEAQQBBAEAAAYBAAAEAQQBBAEEAQQBBAEEAQQBAAABBAQAAAQBAQQEAAAEAQEEBAAABAEBBAQAAAQBAQQABAQAAAAEAQEEAAQEAAAABAEBBAAEBAAAAAQBAQQABAQAAAAEAQQBBAEEAQQBBAEEAQQBBAEAAAEBAAAEAQQBAAQAAAAEAQAABAQEAQQBAAEBAAAEAQQBAAQAAAQBAAAEBAEEAQAAAQEAAAQBBAEABAAAAAQBAAAEBAEEAQAAAQEBAAAEAQQBAAAAAAQAAAAAAAAEAQAABAQBBAEEAQQBBAEEAQQBBAEEAQQBAQghU3lzdGVtLldpbmRvd3MuRm9ybXMuTW91c2VCdXR0b25zAwAAAAEIFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAjU3RlZW1hLlRlZUNoYXJ0LkRyYXdpbmcuQmV2ZWxTdHlsZXMCAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAEgU3RlZW1hLlRlZUNoYXJ0LkxlZ2VuZEFsaWdubWVudHMCAAAACBRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABAQgLFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAIARRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAkU3RlZW1hLlRlZUNoYXJ0LlN0eWxlcy5Qb2ludGVyU3R5bGVzAgAAAAgBFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAkU3RlZW1hLlRlZUNoYXJ0LlN0eWxlcy5Qb2ludGVyU3R5bGVzAgAAAAgBFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAkU3RlZW1hLlRlZUNoYXJ0LlN0eWxlcy5Qb2ludGVyU3R5bGVzAgAAAAgBFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAkU3RlZW1hLlRlZUNoYXJ0LlN0eWxlcy5Qb2ludGVyU3R5bGVzAgAAAAgBFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABJFN0ZWVtYS5UZWVDaGFydC5TdHlsZXMuUG9pbnRlclN0eWxlcwIAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAAQgBFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABJFN0ZWVtYS5UZWVDaGFydC5TdHlsZXMuUG9pbnRlclN0eWxlcwIAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAAQgBFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABJFN0ZWVtYS5UZWVDaGFydC5TdHlsZXMuUG9pbnRlclN0eWxlcwIAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAAQgBFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABJFN0ZWVtYS5UZWVDaGFydC5TdHlsZXMuUG9pbnRlclN0eWxlcwIAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAAQgBFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAAQgICxRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACCBTeXN0ZW0uRHJhd2luZy5EcmF3aW5nMkQuTGluZUNhcAQAAAABCAEUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACAsUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACAgLFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAIIFN5c3RlbS5EcmF3aW5nLkRyYXdpbmcyRC5MaW5lQ2FwBAAAAAEBFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAgLFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAAQgICxRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACCBTeXN0ZW0uRHJhd2luZy5EcmF3aW5nMkQuTGluZUNhcAQAAAABCAEUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACAsUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABCAgLFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABAQEIIFN5c3RlbS5EcmF3aW5nLkRyYXdpbmcyRC5MaW5lQ2FwBAAAAAEIBgYIARRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAICxRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAAgAAAAEEAAAABfv///8hU3lzdGVtLldpbmRvd3MuRm9ybXMuTW91c2VCdXR0b25zAQAAAAd2YWx1ZV9fAAgDAAAAAABAAAABAAAABfr///8UU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAABG5hbWUFdmFsdWUKa25vd25Db2xvcgVzdGF0ZQEAAAAJBwcEAAAACv////8AAAAAAAACAAYHAAAACEZGRkZGRkZGAfj////6////CoCAgP8AAAAAAAACAAYJAAAACEZGODA4MDgwBfb///8jU3RlZW1hLlRlZUNoYXJ0LkRyYXdpbmcuQmV2ZWxTdHlsZXMBAAAAB3ZhbHVlX18ACAIAAAAAAAAAAfX////6////Cv////8AAAAAAAACAAEF9P///yBTdGVlbWEuVGVlQ2hhcnQuTGVnZW5kQWxpZ25tZW50cwEAAAAHdmFsdWVfXwAIAgAAAAMAAAAIAAAAAfP////6////Cv////8AAAAAAAACAAYOAAAACEZGRkZGRkZGAfH////6////CoCAgP8AAAAAAAACAAYQAAAACEZGODA4MDgwAe/////6////Cv////8AAAAAAAACAAYSAAAACEZGRkZGRkZGAe3////6////CoCAgP8AAAAAAAACAAYUAAAACEZGODA4MDgwAAEJFQAAAAYWAAAABlRhaG9tYQwAAAAAAEBBAen////6////Cv////8AAAAAAAACAAYYAAAACEZGRkZGRkZGAef////6////CoCAgP8AAAAAAAACAAYaAAAACEZGODA4MDgwAeX////6////Cv////8AAAAAAAACAAYcAAAACEZGRkZGRkZGAeP////6////CoCAgP8AAAAAAAACAAYeAAAACEZGODA4MDgwAeH////6////Cv////8AAAAAAAACAAYgAAAACEZGRkZGRkZGAd/////6////CoCAgP8AAAAAAAACAAYiAAAACEZGODA4MDgwAd3////6////Cv////8AAAAAAAACAAYkAAAACEZGRkZGRkZGAdv////6////CoCAgP8AAAAAAAACAAYmAAAACEZGODA4MDgwAwAAAAAGJwAAABtTdGVlbWEuVGVlQ2hhcnQuU3R5bGVzLkxpbmUB2P////r///8KAAAAAAAAAAAlAAEABdf///8kU3RlZW1hLlRlZUNoYXJ0LlN0eWxlcy5Qb2ludGVyU3R5bGVzAQAAAAd2YWx1ZV9fAAgCAAAACQAAAAIAAAAAAdb////6////CgAAAAAAAAAAJQABAAYrAAAAKVBsb3QsIHdhZ3QsQmFpZC1QYWRkeS1XaGVhdCArSVIxMjBtbSBSaWNlCScAAAAB0/////r///8KAAAAAAAAAACNAAEAAdL////X////CQAAAAIAAAAAAdH////6////CgAAAAAAAAAAjQABAAYwAAAAKFBsb3QsIHdycixCYWlkLVBhZGR5LVdoZWF0ICtJUjEyMG1tIFJpY2UJJwAAAAHO////+v///woAAAAAAAAAAE8AAQABzf///9f///8JAAAAAgAAAAABzP////r///8KAAAAAAAAAABPAAEABjUAAAAyUGxvdCwgd2hlYXQuYmlvbWFzcyxCYWlkLVBhZGR5LVdoZWF0ICtJUjEyMG1tIFJpY2UJJwAAAAHJ////+v///woAAAAAAAAAAH8AAQAByP///9f///8JAAAAAgAAAAABx/////r///8KAAAAAAAAAAB/AAEABjoAAAAwUGxvdCwgd2hlYXQueWllbGQsQmFpZC1QYWRkeS1XaGVhdCArSVIxMjBtbSBSaWNlCScAAAABxP////r///8KAAD//wAAAAAAAAIAAQHD////1////wEAAAABwv////r///8KAAAAAAAAAACkAAEAAAIAAAAAAcH////6////CgAA//8AAAAAAAACAAZAAAAAI09icy15aWVsZCwgeWllbGQsQW1hZ2FyYV9CYWlkX0kxMjB3CScAAAABvv////r///8KAAD//wAAAAAAAAIAAQG9////1////wEAAAABvP////r///8KAAAAAAAAAACkAAEAAAIAAAAAAbv////6////CgAA//8AAAAAAAACAAZGAAAAIU9icy15aWVsZCwgd3JyLEFtYWdhcmFfQmFpZF9JMTIwdwknAAAAAbj////6////Cv8AAP8AAAAAAAACAAEBt////9f///8BAAAAAbb////6////CgAAAAAAAAAApAABAAACAAAAAAG1////+v///wr/AAD/AAAAAAAAAgAGTAAAACRPYnMtQmlvbSwgYmlvbWFzcyxBbWFnYXJhX0JhaWRfSTEyMHcJJwAAAAGy////+v///wr/AAD/AAAAAAAAAgABAbH////X////AQAAAAGw////+v///woAAAAAAAAAAKQAAQAAAgAAAAABr/////r///8K/wAA/wAAAAAAAAIABlIAAAAhT2JzLUJpb20sIHdhZ3QsQW1hZ2FyYV9CYWlkX0kxMjB3Aa3////6////Cv////8AAAAAAAACAAZUAAAACEZGRkZGRkZGAav////6////CoCAgP8AAAAAAAACAAZWAAAACEZGODA4MDgwAan////6////Cv////8AAAAAAAACAAZYAAAACEZGRkZGRkZGAaf////6////CoCAgP8AAAAAAAACAAZaAAAACEZGODA4MDgwAaX////6////Cv////8AAAAAAAACAAZcAAAACEZGRkZGRkZGAaP////6////CoCAgP8AAAAAAAACAAZeAAAACEZGODA4MDgwAaH////6////Cv////8AAAAAAAACAAZgAAAACEZGRkZGRkZGAZ/////6////CoCAgP8AAAAAAAACAAZiAAAACEZGODA4MDgwAFAAAAAGYwAAAAgjIyMwLiMjIwkWAAAACQAAAAAAEEEBm/////r///8K/////wAAAAAAAAIABmYAAAAIRkZGRkZGRkYBmf////r///8KgICA/wAAAAAAAAIABmgAAAAIRkY4MDgwODABAAAABZf///8gU3lzdGVtLkRyYXdpbmcuRHJhd2luZzJELkxpbmVDYXABAAAAB3ZhbHVlX18ACAQAAAACAAAAAAoAAAAAAZb////6////CgAAAP8AAAAAAAACAAkWAAAACwAAAAAAMEEBlP////r///8KwAAA/wAAAAAAAAIAAZP////6////Cv8AAP8AAAAAAAACAAGS////+v///wr/////AAAAAAAAAgAGbwAAAAhGRkZGRkZGRgGQ////+v///wqAgID/AAAAAAAAAgAGcQAAAAhGRjgwODA4MFAAAAAJYwAAAAkWAAAACQAAAAAAEEEBjP////r///8K/////wAAAAAAAAIABnUAAAAIRkZGRkZGRkYBiv////r///8KgICA/wAAAAAAAAIABncAAAAIRkY4MDgwODABAAAAAYj///+X////AgAAAAAAAYf////6////CgAAAP8AAAAAAAACAAkWAAAACwAAAAAAMEEBhf////r///8K/wAA/wAAAAAAAAIAAYT////6////Cv////8AAAAAAAACAAZ9AAAACEZGRkZGRkZGAYL////6////CoCAgP8AAAAAAAACAAZ/AAAACEZGODA4MDgwAFAAAAAJYwAAAAkWAAAACQAAAAAAEEEBfv////r///8K/////wAAAAAAAAIABoMAAAAIRkZGRkZGRkYBfP////r///8KgICA/wAAAAAAAAIABoUAAAAIRkY4MDgwODABAAAAAXr///+X////AgAAAAAKAAAAAAF5////+v///woAAAD/AAAAAAAAAgAJFgAAAAsAAAAAADBBAXf////6////Cv8AAP8AAAAAAAACAAF2////+v///wr/////AAAAAAAAAgAGiwAAAAhGRkZGRkZGRgF0////+v///wqAgID/AAAAAAAAAgAGjQAAAAhGRjgwODA4MABQAAAABo4AAAAJZC9NTS95eXl5CWMAAAAJFgAAAAkAAAAAABBBAW/////6////Cv////8AAAAAAAACAAaSAAAACEZGRkZGRkZGAW3////6////CoCAgP8AAAAAAAACAAaUAAAACEZGODA4MDgwAAAAAQAAAAFr////l////wIAAAAACgAAAAAAAAAAQ+NAAAAAAEAC40AKAAAAAAFq////+v///woAAAD/AAAAAAAAAgAJFgAAAAsAAAAAADBBAWj////6////Cv8AAP8AAAAAAAACAAFn////+v///wr/////AAAAAAAAAgAGmgAAAAhGRkZGRkZGRgFl////+v///wqAgID/AAAAAAAAAgAGnAAAAAhGRjgwODA4MAFj////+v///wr/////AAAAAAAAAgAGngAAAAhGRkZGRkZGRgFh////+v///wqAgID/AAAAAAAAAgAGoAAAAAhGRjgwODA4MAFf////+v///wr/////AAAAAAAAAgAGogAAAAhGRkZGRkZGRgFd////+v///wqAgID/AAAAAAAAAgAGpAAAAAhGRjgwODA4MAFb////+v///wr/////AAAAAAAAAgAGpgAAAAhGRkZGRkZGRgFZ////+v///wqAgID/AAAAAAAAAgAGqAAAAAhGRjgwODA4MAFX////+v///wr/////AAAAAAAAAgAGqgAAAAhGRkZGRkZGRgFV////+v///wqAgID/AAAAAAAAAgAGrAAAAAhGRjgwODA4MBEVAAAAAQAAAAatAAAAAAs=</Format>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <Y>biomass</Y>
            <Y>yield</Y>
            <Y>green_biomass</Y>
            <Y>yieldwet</Y>
            <X>Date</X>
            <GDApsimFileReader name="ApsimFileReader" />
          </Plot>
          <Plot name="Plot1">
            <SeriesType>No line</SeriesType>
            <PointType>Circle</PointType>
            <colour>-65536</colour>
            <Y>biomass</Y>
            <X>Date</X>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader">
                <FileName>Simal-obs.csv</FileName>
              </GDApsimFileReader>
            </GDFilter>
          </Plot>
          <Plot name="Plot2">
            <SeriesType>No line</SeriesType>
            <PointType>Circle</PointType>
            <colour>-16777024</colour>
            <Y>yield</Y>
            <X>Date</X>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader">
                <FileName>Simal-obs.csv</FileName>
              </GDApsimFileReader>
            </GDFilter>
          </Plot>
        </Graph>
        <Graph name="Biomass">
          <Legend>
            <CheckedTitles>Plot, biomass,Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot, green_biomass,Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot1, biomass,Simal-obs</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>DaysAftersowing</X>
            <Y>biomass</Y>
            <Y>green_biomass</Y>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 157</Filter>
              <GDApsimFileReader name="ApsimFileReader" />
            </GDFilter>
          </Plot>
          <Plot name="Plot1">
            <SeriesType>No line</SeriesType>
            <PointType>Circle</PointType>
            <colour>-65536</colour>
            <X>DaysAftersowing</X>
            <Y>biomass</Y>
            <Y>green_biomass</Y>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader">
                <FileName>Simal-obs.csv</FileName>
              </GDApsimFileReader>
            </GDFilter>
          </Plot>
        </Graph>
        <Graph name="Partitioning">
          <Legend>
            <CheckedTitles>Plot, leafGreenWt,Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot, leafTotalWt,Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot, StemTotalWt,Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot, grain_wt,Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot, PodTotalWt,Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Leaf, leafTotalWt,Simal-obs</CheckedTitles>
            <CheckedTitles>Stem, StemTotalWt,Simal-obs</CheckedTitles>
            <CheckedTitles>Pod, PodGrowthWt,Simal-obs</CheckedTitles>
            <CheckedTitles>Grain, grain_wt,Simal-obs</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>DaysAftersowing</X>
            <Y>leafGreenWt</Y>
            <Y>leafTotalWt</Y>
            <Y>StemTotalWt</Y>
            <Y>grain_wt</Y>
            <Y>PodTotalWt</Y>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader" />
            </GDFilter>
          </Plot>
          <Plot name="Leaf">
            <SeriesType>No line</SeriesType>
            <PointType>Circle</PointType>
            <colour>-16776961</colour>
            <Y>leafTotalWt</Y>
            <X>DaysAftersowing</X>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader">
                <FileName>Simal-obs.csv</FileName>
              </GDApsimFileReader>
            </GDFilter>
          </Plot>
          <Plot name="Stem">
            <SeriesType>No line</SeriesType>
            <PointType>Rectangle</PointType>
            <colour>-16744448</colour>
            <Y>StemTotalWt</Y>
            <X>DaysAftersowing</X>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader">
                <FileName>Simal-obs.csv</FileName>
              </GDApsimFileReader>
            </GDFilter>
          </Plot>
          <Plot name="Pod">
            <SeriesType>No line</SeriesType>
            <PointType>Diagonal cross</PointType>
            <colour>-65281</colour>
            <Y>PodGrowthWt</Y>
            <X>DaysAftersowing</X>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader">
                <FileName>Simal-obs.csv</FileName>
              </GDApsimFileReader>
            </GDFilter>
          </Plot>
          <Plot name="Grain">
            <SeriesType>No line</SeriesType>
            <PointType>Triangle</PointType>
            <colour>-8388608</colour>
            <Y>grain_wt</Y>
            <X>DaysAftersowing</X>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader">
                <FileName>Simal-obs.csv</FileName>
              </GDApsimFileReader>
            </GDFilter>
          </Plot>
        </Graph>
        <Graph name="Green area index">
          <Legend>
            <CheckedTitles>Plot, lai,Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot1, GAI,Simal-obs</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <Y>lai</Y>
            <X>DaysAftersowing</X>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 157</Filter>
              <GDApsimFileReader name="ApsimFileReader" />
            </GDFilter>
          </Plot>
          <Plot name="Plot1">
            <SeriesType>No line</SeriesType>
            <PointType>Circle</PointType>
            <colour>-16777024</colour>
            <X>DaysAftersowing</X>
            <Y>GAI</Y>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 157</Filter>
              <GDApsimFileReader name="ApsimFileReader">
                <FileName>Simal-obs.csv</FileName>
              </GDApsimFileReader>
            </GDFilter>
          </Plot>
        </Graph>
        <Graph name="Phenology">
          <Legend>
            <CheckedTitles>Plot, Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot1, Simal-obs</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>DaysAftersowing</X>
            <Y>Stage</Y>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader" />
            </GDFilter>
          </Plot>
          <Plot name="Plot1">
            <SeriesType>No line</SeriesType>
            <PointType>Circle</PointType>
            <colour>
            </colour>
            <X>DaysAftersowing</X>
            <Y>Stage</Y>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader">
                <FileName>Simal-obs.csv</FileName>
              </GDApsimFileReader>
            </GDFilter>
          </Plot>
        </Graph>
        <Graph name="Day length at flowering">
          <Legend>
            <CheckedTitles>Plot, Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot1, Simal-obs</CheckedTitles>
          </Legend>
          <Format>AAEAAAD/////AQAAAAAAAAAMAgAAAFhUZWVDaGFydC5DbGllbnQsIFZlcnNpb249NC4xLjIwMTEuNzI4MywgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj05YzgxMjYyNzZjNzdiZGI3DAMAAABXU3lzdGVtLldpbmRvd3MuRm9ybXMsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5DAQAAABRU3lzdGVtLkRyYXdpbmcsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iMDNmNWY3ZjExZDUwYTNhBQEAAAAVU3RlZW1hLlRlZUNoYXJ0LkNoYXJ0xQAAAA4uWm9vbS5BbmltYXRlZBMuWm9vbS5BbmltYXRlZFN0ZXBzFC5QYW5uaW5nLk1vdXNlQnV0dG9uEC5DdXN0b21DaGFydFJlY3QXLlBhbmVsLkltYWdlQmV2ZWwuV2lkdGgVLlBhbmVsLkJldmVsLkNvbG9yT25lGy5QYW5lbC5CZXZlbC5TdHJpbmdDb2xvck9uZRUuUGFuZWwuQmV2ZWwuQ29sb3JUd28bLlBhbmVsLkJldmVsLlN0cmluZ0NvbG9yVHdvEi5QYW5lbC5CZXZlbC5PdXRlchIuUGFuZWwuQnJ1c2guQ29sb3ISLkxlZ2VuZC5DaGVja0JveGVzES5MZWdlbmQuQWxpZ25tZW50Ei5MZWdlbmQuTWF4TnVtUm93cxwuTGVnZW5kLlRpdGxlLkJldmVsLkNvbG9yT25lIi5MZWdlbmQuVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JPbmUcLkxlZ2VuZC5UaXRsZS5CZXZlbC5Db2xvclR3byIuTGVnZW5kLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yVHdvFi5MZWdlbmQuQmV2ZWwuQ29sb3JPbmUcLkxlZ2VuZC5CZXZlbC5TdHJpbmdDb2xvck9uZRYuTGVnZW5kLkJldmVsLkNvbG9yVHdvHC5MZWdlbmQuQmV2ZWwuU3RyaW5nQ29sb3JUd28WLkxlZ2VuZC5TaGFkb3cuVmlzaWJsZRMuTGVnZW5kLlRyYW5zcGFyZW50DS5IZWFkZXIuTGluZXMRLkhlYWRlci5Gb250Lk5hbWURLkhlYWRlci5Gb250LlNpemUWLkhlYWRlci5Gb250LlNpemVGbG9hdBYuSGVhZGVyLkJldmVsLkNvbG9yT25lHC5IZWFkZXIuQmV2ZWwuU3RyaW5nQ29sb3JPbmUWLkhlYWRlci5CZXZlbC5Db2xvclR3bxwuSGVhZGVyLkJldmVsLlN0cmluZ0NvbG9yVHdvGS5TdWJIZWFkZXIuQmV2ZWwuQ29sb3JPbmUfLlN1YkhlYWRlci5CZXZlbC5TdHJpbmdDb2xvck9uZRkuU3ViSGVhZGVyLkJldmVsLkNvbG9yVHdvHy5TdWJIZWFkZXIuQmV2ZWwuU3RyaW5nQ29sb3JUd28WLkZvb3Rlci5CZXZlbC5Db2xvck9uZRwuRm9vdGVyLkJldmVsLlN0cmluZ0NvbG9yT25lFi5Gb290ZXIuQmV2ZWwuQ29sb3JUd28cLkZvb3Rlci5CZXZlbC5TdHJpbmdDb2xvclR3bxkuU3ViRm9vdGVyLkJldmVsLkNvbG9yT25lHy5TdWJGb290ZXIuQmV2ZWwuU3RyaW5nQ29sb3JPbmUZLlN1YkZvb3Rlci5CZXZlbC5Db2xvclR3bx8uU3ViRm9vdGVyLkJldmVsLlN0cmluZ0NvbG9yVHdvGS5Bc3BlY3QuQ29sb3JQYWxldHRlSW5kZXgOLkFzcGVjdC5WaWV3M0QIU2VyaWVzLjAVLlNlcmllcy4wLkJydXNoLkNvbG9yFy5TZXJpZXMuMC5Qb2ludGVyLlN0eWxlFy5TZXJpZXMuMC5MaW5lUGVuLldpZHRoEy5TZXJpZXMuMC5Db2xvckVhY2gPLlNlcmllcy4wLkNvbG9yDy5TZXJpZXMuMC5UaXRsZQhTZXJpZXMuMRUuU2VyaWVzLjEuQnJ1c2guQ29sb3IZLlNlcmllcy4xLlBvaW50ZXIuVmlzaWJsZRcuU2VyaWVzLjEuUG9pbnRlci5TdHlsZRsuU2VyaWVzLjEuUG9pbnRlci5QZW4uQ29sb3IZLlNlcmllcy4xLkxpbmVQZW4uVmlzaWJsZRcuU2VyaWVzLjEuTGluZVBlbi5XaWR0aBMuU2VyaWVzLjEuQ29sb3JFYWNoDy5TZXJpZXMuMS5Db2xvcg8uU2VyaWVzLjEuVGl0bGUaLldhbGxzLkxlZnQuQmV2ZWwuQ29sb3JPbmUgLldhbGxzLkxlZnQuQmV2ZWwuU3RyaW5nQ29sb3JPbmUaLldhbGxzLkxlZnQuQmV2ZWwuQ29sb3JUd28gLldhbGxzLkxlZnQuQmV2ZWwuU3RyaW5nQ29sb3JUd28bLldhbGxzLlJpZ2h0LkJldmVsLkNvbG9yT25lIS5XYWxscy5SaWdodC5CZXZlbC5TdHJpbmdDb2xvck9uZRsuV2FsbHMuUmlnaHQuQmV2ZWwuQ29sb3JUd28hLldhbGxzLlJpZ2h0LkJldmVsLlN0cmluZ0NvbG9yVHdvGi5XYWxscy5CYWNrLkJldmVsLkNvbG9yT25lIC5XYWxscy5CYWNrLkJldmVsLlN0cmluZ0NvbG9yT25lGi5XYWxscy5CYWNrLkJldmVsLkNvbG9yVHdvIC5XYWxscy5CYWNrLkJldmVsLlN0cmluZ0NvbG9yVHdvHC5XYWxscy5Cb3R0b20uQmV2ZWwuQ29sb3JPbmUiLldhbGxzLkJvdHRvbS5CZXZlbC5TdHJpbmdDb2xvck9uZRwuV2FsbHMuQm90dG9tLkJldmVsLkNvbG9yVHdvIi5XYWxscy5Cb3R0b20uQmV2ZWwuU3RyaW5nQ29sb3JUd28OLldhbGxzLlZpc2libGUcLkF4ZXMuTGVmdC5MYWJlbHMuU2VwYXJhdGlvbh0uQXhlcy5MZWZ0LkxhYmVscy5WYWx1ZUZvcm1hdBsuQXhlcy5MZWZ0LkxhYmVscy5Gb250Lk5hbWUbLkF4ZXMuTGVmdC5MYWJlbHMuRm9udC5TaXplIC5BeGVzLkxlZnQuTGFiZWxzLkZvbnQuU2l6ZUZsb2F0IC5BeGVzLkxlZnQuTGFiZWxzLkJldmVsLkNvbG9yT25lJi5BeGVzLkxlZnQuTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yT25lIC5BeGVzLkxlZnQuTGFiZWxzLkJldmVsLkNvbG9yVHdvJi5BeGVzLkxlZnQuTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yVHdvFC5BeGVzLkxlZnQuQXV0b21hdGljGy5BeGVzLkxlZnQuQXV0b21hdGljTWF4aW11bRsuQXhlcy5MZWZ0LkF1dG9tYXRpY01pbmltdW0YLkF4ZXMuTGVmdC5BeGlzUGVuLldpZHRoGS5BeGVzLkxlZnQuQXhpc1Blbi5FbmRDYXAXLkF4ZXMuTGVmdC5HcmlkLlZpc2libGUYLkF4ZXMuTGVmdC5NYXhpbXVtT2Zmc2V0Ei5BeGVzLkxlZnQuTWF4aW11bRIuQXhlcy5MZWZ0Lk1pbmltdW0dLkF4ZXMuTGVmdC5NaW5vclRpY2tzLlZpc2libGUWLkF4ZXMuTGVmdC5UaWNrcy5Db2xvchouQXhlcy5MZWZ0LlRpdGxlLkZvbnQuTmFtZRouQXhlcy5MZWZ0LlRpdGxlLkZvbnQuU2l6ZR8uQXhlcy5MZWZ0LlRpdGxlLkZvbnQuU2l6ZUZsb2F0KC5BeGVzLkxlZnQuVGl0bGUuRm9udC5TaGFkb3cuQnJ1c2guQ29sb3IhLkF4ZXMuTGVmdC5UaXRsZS5Gb250LkJydXNoLkNvbG9yHy5BeGVzLkxlZnQuVGl0bGUuQmV2ZWwuQ29sb3JPbmUlLkF4ZXMuTGVmdC5UaXRsZS5CZXZlbC5TdHJpbmdDb2xvck9uZR8uQXhlcy5MZWZ0LlRpdGxlLkJldmVsLkNvbG9yVHdvJS5BeGVzLkxlZnQuVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JUd28bLkF4ZXMuVG9wLkxhYmVscy5TZXBhcmF0aW9uHC5BeGVzLlRvcC5MYWJlbHMuVmFsdWVGb3JtYXQaLkF4ZXMuVG9wLkxhYmVscy5Gb250Lk5hbWUaLkF4ZXMuVG9wLkxhYmVscy5Gb250LlNpemUfLkF4ZXMuVG9wLkxhYmVscy5Gb250LlNpemVGbG9hdB8uQXhlcy5Ub3AuTGFiZWxzLkJldmVsLkNvbG9yT25lJS5BeGVzLlRvcC5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JPbmUfLkF4ZXMuVG9wLkxhYmVscy5CZXZlbC5Db2xvclR3byUuQXhlcy5Ub3AuTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yVHdvFy5BeGVzLlRvcC5BeGlzUGVuLldpZHRoGC5BeGVzLlRvcC5BeGlzUGVuLkVuZENhcBYuQXhlcy5Ub3AuR3JpZC5WaXNpYmxlHC5BeGVzLlRvcC5NaW5vclRpY2tzLlZpc2libGUVLkF4ZXMuVG9wLlRpY2tzLkNvbG9yGS5BeGVzLlRvcC5UaXRsZS5Gb250Lk5hbWUZLkF4ZXMuVG9wLlRpdGxlLkZvbnQuU2l6ZR4uQXhlcy5Ub3AuVGl0bGUuRm9udC5TaXplRmxvYXQgLkF4ZXMuVG9wLlRpdGxlLkZvbnQuQnJ1c2guQ29sb3IeLkF4ZXMuVG9wLlRpdGxlLkJldmVsLkNvbG9yT25lJC5BeGVzLlRvcC5UaXRsZS5CZXZlbC5TdHJpbmdDb2xvck9uZR4uQXhlcy5Ub3AuVGl0bGUuQmV2ZWwuQ29sb3JUd28kLkF4ZXMuVG9wLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yVHdvES5BeGVzLlRvcC5WaXNpYmxlHS5BeGVzLlJpZ2h0LkxhYmVscy5TZXBhcmF0aW9uHi5BeGVzLlJpZ2h0LkxhYmVscy5WYWx1ZUZvcm1hdBwuQXhlcy5SaWdodC5MYWJlbHMuRm9udC5OYW1lHC5BeGVzLlJpZ2h0LkxhYmVscy5Gb250LlNpemUhLkF4ZXMuUmlnaHQuTGFiZWxzLkZvbnQuU2l6ZUZsb2F0IS5BeGVzLlJpZ2h0LkxhYmVscy5CZXZlbC5Db2xvck9uZScuQXhlcy5SaWdodC5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JPbmUhLkF4ZXMuUmlnaHQuTGFiZWxzLkJldmVsLkNvbG9yVHdvJy5BeGVzLlJpZ2h0LkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvclR3bxkuQXhlcy5SaWdodC5BeGlzUGVuLldpZHRoGi5BeGVzLlJpZ2h0LkF4aXNQZW4uRW5kQ2FwGC5BeGVzLlJpZ2h0LkdyaWQuVmlzaWJsZRkuQXhlcy5SaWdodC5NYXhpbXVtT2Zmc2V0Hi5BeGVzLlJpZ2h0Lk1pbm9yVGlja3MuVmlzaWJsZRcuQXhlcy5SaWdodC5UaWNrcy5Db2xvchsuQXhlcy5SaWdodC5UaXRsZS5Gb250Lk5hbWUbLkF4ZXMuUmlnaHQuVGl0bGUuRm9udC5TaXplIC5BeGVzLlJpZ2h0LlRpdGxlLkZvbnQuU2l6ZUZsb2F0Ii5BeGVzLlJpZ2h0LlRpdGxlLkZvbnQuQnJ1c2guQ29sb3IgLkF4ZXMuUmlnaHQuVGl0bGUuQmV2ZWwuQ29sb3JPbmUmLkF4ZXMuUmlnaHQuVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JPbmUgLkF4ZXMuUmlnaHQuVGl0bGUuQmV2ZWwuQ29sb3JUd28mLkF4ZXMuUmlnaHQuVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JUd28TLkF4ZXMuUmlnaHQuVmlzaWJsZR4uQXhlcy5Cb3R0b20uTGFiZWxzLlNlcGFyYXRpb24iLkF4ZXMuQm90dG9tLkxhYmVscy5EYXRlVGltZUZvcm1hdB8uQXhlcy5Cb3R0b20uTGFiZWxzLlZhbHVlRm9ybWF0HS5BeGVzLkJvdHRvbS5MYWJlbHMuRm9udC5OYW1lHS5BeGVzLkJvdHRvbS5MYWJlbHMuRm9udC5TaXplIi5BeGVzLkJvdHRvbS5MYWJlbHMuRm9udC5TaXplRmxvYXQiLkF4ZXMuQm90dG9tLkxhYmVscy5CZXZlbC5Db2xvck9uZSguQXhlcy5Cb3R0b20uTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yT25lIi5BeGVzLkJvdHRvbS5MYWJlbHMuQmV2ZWwuQ29sb3JUd28oLkF4ZXMuQm90dG9tLkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvclR3bxouQXhlcy5Cb3R0b20uQXhpc1Blbi5XaWR0aBsuQXhlcy5Cb3R0b20uQXhpc1Blbi5FbmRDYXAZLkF4ZXMuQm90dG9tLkdyaWQuVmlzaWJsZRouQXhlcy5Cb3R0b20uTWF4aW11bU9mZnNldBouQXhlcy5Cb3R0b20uTWluaW11bU9mZnNldB8uQXhlcy5Cb3R0b20uTWlub3JUaWNrcy5WaXNpYmxlGC5BeGVzLkJvdHRvbS5UaWNrcy5Db2xvchwuQXhlcy5Cb3R0b20uVGl0bGUuRm9udC5OYW1lHC5BeGVzLkJvdHRvbS5UaXRsZS5Gb250LlNpemUhLkF4ZXMuQm90dG9tLlRpdGxlLkZvbnQuU2l6ZUZsb2F0Iy5BeGVzLkJvdHRvbS5UaXRsZS5Gb250LkJydXNoLkNvbG9yIS5BeGVzLkJvdHRvbS5UaXRsZS5CZXZlbC5Db2xvck9uZScuQXhlcy5Cb3R0b20uVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JPbmUhLkF4ZXMuQm90dG9tLlRpdGxlLkJldmVsLkNvbG9yVHdvJy5BeGVzLkJvdHRvbS5UaXRsZS5CZXZlbC5TdHJpbmdDb2xvclR3byQuQXhlcy5EZXB0aFRvcC5MYWJlbHMuQmV2ZWwuQ29sb3JPbmUqLkF4ZXMuRGVwdGhUb3AuTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yT25lJC5BeGVzLkRlcHRoVG9wLkxhYmVscy5CZXZlbC5Db2xvclR3byouQXhlcy5EZXB0aFRvcC5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JUd28jLkF4ZXMuRGVwdGhUb3AuVGl0bGUuQmV2ZWwuQ29sb3JPbmUpLkF4ZXMuRGVwdGhUb3AuVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JPbmUjLkF4ZXMuRGVwdGhUb3AuVGl0bGUuQmV2ZWwuQ29sb3JUd28pLkF4ZXMuRGVwdGhUb3AuVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JUd28hLkF4ZXMuRGVwdGguTGFiZWxzLkJldmVsLkNvbG9yT25lJy5BeGVzLkRlcHRoLkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvck9uZSEuQXhlcy5EZXB0aC5MYWJlbHMuQmV2ZWwuQ29sb3JUd28nLkF4ZXMuRGVwdGguTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yVHdvIC5BeGVzLkRlcHRoLlRpdGxlLkJldmVsLkNvbG9yT25lJi5BeGVzLkRlcHRoLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yT25lIC5BeGVzLkRlcHRoLlRpdGxlLkJldmVsLkNvbG9yVHdvJi5BeGVzLkRlcHRoLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yVHdvAAAEAAAEAQQBBAQABAAEAQQBBAEEAQAABgEAAAQBBAEEAQQBBAEEAQQBBAEAAAEEBAAABAEBBAAEBAAAAAQBBAEEAQQBBAEEAQQBBAEEAQAAAQEAAAQBBAEAAAAABAAAAAAABAEAAAQEBAEEAQABAQAABAEEAQAEAAAEAQAABAQBBAEAAAEBAAAEAQQBAAQAAAAEAQAABAQBBAEAAAEBAQAABAEEAQAEAAAAAAQBAAAEBAEEAQQBBAEEAQQBBAEEAQQBBAEBCCFTeXN0ZW0uV2luZG93cy5Gb3Jtcy5Nb3VzZUJ1dHRvbnMDAAAAAQgUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAACNTdGVlbWEuVGVlQ2hhcnQuRHJhd2luZy5CZXZlbFN0eWxlcwIAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAASBTdGVlbWEuVGVlQ2hhcnQuTGVnZW5kQWxpZ25tZW50cwIAAAAIFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAEBCAsUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAgBFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAACRTdGVlbWEuVGVlQ2hhcnQuU3R5bGVzLlBvaW50ZXJTdHlsZXMCAAAACAEUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAEkU3RlZW1hLlRlZUNoYXJ0LlN0eWxlcy5Qb2ludGVyU3R5bGVzAgAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABCAEUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABCAgLFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABAQEIIFN5c3RlbS5EcmF3aW5nLkRyYXdpbmcyRC5MaW5lQ2FwBAAAAAEIBgYBFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAgLFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAgICxRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACCBTeXN0ZW0uRHJhd2luZy5EcmF3aW5nMkQuTGluZUNhcAQAAAABARRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAICxRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAEICAsUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAggU3lzdGVtLkRyYXdpbmcuRHJhd2luZzJELkxpbmVDYXAEAAAAAQgBFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAgLFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAAQgICxRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACCBTeXN0ZW0uRHJhd2luZy5EcmF3aW5nMkQuTGluZUNhcAQAAAABCAgBFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAgLFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAACAAAAAQQAAAAF+////yFTeXN0ZW0uV2luZG93cy5Gb3Jtcy5Nb3VzZUJ1dHRvbnMBAAAAB3ZhbHVlX18ACAMAAAAAAEAAAAEAAAAF+v///xRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAEbmFtZQV2YWx1ZQprbm93bkNvbG9yBXN0YXRlAQAAAAkHBwQAAAAK/////wAAAAAAAAIABgcAAAAIRkZGRkZGRkYB+P////r///8KgICA/wAAAAAAAAIABgkAAAAIRkY4MDgwODAF9v///yNTdGVlbWEuVGVlQ2hhcnQuRHJhd2luZy5CZXZlbFN0eWxlcwEAAAAHdmFsdWVfXwAIAgAAAAAAAAAB9f////r///8K/////wAAAAAAAAIAAQX0////IFN0ZWVtYS5UZWVDaGFydC5MZWdlbmRBbGlnbm1lbnRzAQAAAAd2YWx1ZV9fAAgCAAAAAwAAAAgAAAAB8/////r///8K/////wAAAAAAAAIABg4AAAAIRkZGRkZGRkYB8f////r///8KgICA/wAAAAAAAAIABhAAAAAIRkY4MDgwODAB7/////r///8K/////wAAAAAAAAIABhIAAAAIRkZGRkZGRkYB7f////r///8KgICA/wAAAAAAAAIABhQAAAAIRkY4MDgwODAAAQkVAAAABhYAAAAGVGFob21hDAAAAAAAQEEB6f////r///8K/////wAAAAAAAAIABhgAAAAIRkZGRkZGRkYB5/////r///8KgICA/wAAAAAAAAIABhoAAAAIRkY4MDgwODAB5f////r///8K/////wAAAAAAAAIABhwAAAAIRkZGRkZGRkYB4/////r///8KgICA/wAAAAAAAAIABh4AAAAIRkY4MDgwODAB4f////r///8K/////wAAAAAAAAIABiAAAAAIRkZGRkZGRkYB3/////r///8KgICA/wAAAAAAAAIABiIAAAAIRkY4MDgwODAB3f////r///8K/////wAAAAAAAAIABiQAAAAIRkZGRkZGRkYB2/////r///8KgICA/wAAAAAAAAIABiYAAAAIRkY4MDgwODADAAAAAAYnAAAAG1N0ZWVtYS5UZWVDaGFydC5TdHlsZXMuTGluZQHY////+v///woAAAAAAAAAACUAAQAF1////yRTdGVlbWEuVGVlQ2hhcnQuU3R5bGVzLlBvaW50ZXJTdHlsZXMBAAAAB3ZhbHVlX18ACAIAAAAJAAAAAgAAAAAB1v////r///8KAAAAAAAAAAAlAAEABisAAAAaUGxvdCwgVmFyaWV0eS1TaW1hbCBGaWVsZDEJJwAAAAHT////+v///woAAP//AAAAAAAAAgABAdL////X////AQAAAAHR////+v///woAAAAAAAAAAKQAAQAAAgAAAAAB0P////r///8KAAD//wAAAAAAAAIABjEAAAAQUGxvdDEsIFNpbWFsLW9icwHO////+v///wr/////AAAAAAAAAgAGMwAAAAhGRkZGRkZGRgHM////+v///wqAgID/AAAAAAAAAgAGNQAAAAhGRjgwODA4MAHK////+v///wr/////AAAAAAAAAgAGNwAAAAhGRkZGRkZGRgHI////+v///wqAgID/AAAAAAAAAgAGOQAAAAhGRjgwODA4MAHG////+v///wr/////AAAAAAAAAgAGOwAAAAhGRkZGRkZGRgHE////+v///wqAgID/AAAAAAAAAgAGPQAAAAhGRjgwODA4MAHC////+v///wr/////AAAAAAAAAgAGPwAAAAhGRkZGRkZGRgHA////+v///wqAgID/AAAAAAAAAgAGQQAAAAhGRjgwODA4MABQAAAABkIAAAAIIyMjMC4jIyMJFgAAAAkAAAAAABBBAbz////6////Cv////8AAAAAAAACAAZFAAAACEZGRkZGRkZGAbr////6////CoCAgP8AAAAAAAACAAZHAAAACEZGODA4MDgwAAAAAQAAAAW4////IFN5c3RlbS5EcmF3aW5nLkRyYXdpbmcyRC5MaW5lQ2FwAQAAAAd2YWx1ZV9fAAgEAAAAAgAAAAAKAAAA30+Nl26SLUAAAAAAAAAkQAABt/////r///8KAAAA/wAAAAAAAAIACRYAAAALAAAAAAAwQQG1////+v///wrAAAD/AAAAAAAAAgABtP////r///8K/wAA/wAAAAAAAAIAAbP////6////Cv////8AAAAAAAACAAZOAAAACEZGRkZGRkZGAbH////6////CoCAgP8AAAAAAAACAAZQAAAACEZGODA4MDgwUAAAAAlCAAAACRYAAAAJAAAAAAAQQQGt////+v///wr/////AAAAAAAAAgAGVAAAAAhGRkZGRkZGRgGr////+v///wqAgID/AAAAAAAAAgAGVgAAAAhGRjgwODA4MAEAAAABqf///7j///8CAAAAAAABqP////r///8KAAAA/wAAAAAAAAIACRYAAAALAAAAAAAwQQGm////+v///wr/AAD/AAAAAAAAAgABpf////r///8K/////wAAAAAAAAIABlwAAAAIRkZGRkZGRkYBo/////r///8KgICA/wAAAAAAAAIABl4AAAAIRkY4MDgwODAAUAAAAAlCAAAACRYAAAAJAAAAAAAQQQGf////+v///wr/////AAAAAAAAAgAGYgAAAAhGRkZGRkZGRgGd////+v///wqAgID/AAAAAAAAAgAGZAAAAAhGRjgwODA4MAEAAAABm////7j///8CAAAAAAoAAAAAAZr////6////CgAAAP8AAAAAAAACAAkWAAAACwAAAAAAMEEBmP////r///8K/wAA/wAAAAAAAAIAAZf////6////Cv////8AAAAAAAACAAZqAAAACEZGRkZGRkZGAZX////6////CoCAgP8AAAAAAAACAAZsAAAACEZGODA4MDgwAFAAAAAGbQAAAAlkL01NL3l5eXkJQgAAAAkWAAAACQAAAAAAEEEBkP////r///8K/////wAAAAAAAAIABnEAAAAIRkZGRkZGRkYBjv////r///8KgICA/wAAAAAAAAIABnMAAAAIRkY4MDgwODABAAAAAYz///+4////AgAAAAAKAAAACgAAAAABi/////r///8KAAAA/wAAAAAAAAIACRYAAAALAAAAAAAwQQGJ////+v///wr/AAD/AAAAAAAAAgABiP////r///8K/////wAAAAAAAAIABnkAAAAIRkZGRkZGRkYBhv////r///8KgICA/wAAAAAAAAIABnsAAAAIRkY4MDgwODABhP////r///8K/////wAAAAAAAAIABn0AAAAIRkZGRkZGRkYBgv////r///8KgICA/wAAAAAAAAIABn8AAAAIRkY4MDgwODABgP////r///8K/////wAAAAAAAAIABoEAAAAIRkZGRkZGRkYBfv////r///8KgICA/wAAAAAAAAIABoMAAAAIRkY4MDgwODABfP////r///8K/////wAAAAAAAAIABoUAAAAIRkZGRkZGRkYBev////r///8KgICA/wAAAAAAAAIABocAAAAIRkY4MDgwODABeP////r///8K/////wAAAAAAAAIABokAAAAIRkZGRkZGRkYBdv////r///8KgICA/wAAAAAAAAIABosAAAAIRkY4MDgwODARFQAAAAEAAAAGjAAAAAAL</Format>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <Y>day_length</Y>
            <X>DaysAftersowing</X>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader" />
            </GDFilter>
          </Plot>
          <Plot name="Plot1">
            <SeriesType>No line</SeriesType>
            <PointType>Circle</PointType>
            <colour>-65536</colour>
            <X>DaysAftersowing</X>
            <Y>day_length</Y>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader">
                <FileName>Simal-obs.csv</FileName>
              </GDApsimFileReader>
            </GDFilter>
          </Plot>
        </Graph>
        <Graph name="Degree days at flowering">
          <Legend>
            <CheckedTitles>Plot, Cumulative TT,Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot1, deg_days,Simal-obs</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>DaysAftersowing</X>
            <Y>Cumulative TT</Y>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader" />
            </GDFilter>
          </Plot>
          <Plot name="Plot1">
            <SeriesType>No line</SeriesType>
            <PointType>Circle</PointType>
            <colour>-65536</colour>
            <X>DaysAftersowing</X>
            <Y>deg_days</Y>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader">
                <FileName>Simal-obs.csv</FileName>
              </GDApsimFileReader>
            </GDFilter>
          </Plot>
        </Graph>
        <Graph name="Root-shoot">
          <Legend>
            <CheckedTitles>Plot, Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot1, Simal-obs</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>DaysAftersowing</X>
            <Y>Root_shoot</Y>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161 and DaysAftersowing &gt;10</Filter>
              <GDApsimFileReader name="ApsimFileReader" />
            </GDFilter>
          </Plot>
          <Plot name="Plot1">
            <SeriesType>No line</SeriesType>
            <PointType>Circle</PointType>
            <colour>-65536</colour>
            <X>DaysAftersowing</X>
            <Y>root_shoot</Y>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161 and DaysAftersowing &gt;10</Filter>
              <GDApsimFileReader name="ApsimFileReader">
                <FileName>Simal-obs.csv</FileName>
              </GDApsimFileReader>
            </GDFilter>
          </Plot>
        </Graph>
        <Graph name="Node number">
          <Legend>
            <CheckedTitles> node_no</CheckedTitles>
            <CheckedTitles> leaf_no</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>DaysAftersowing</X>
            <Y>node_no</Y>
            <Y>leaf_no</Y>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader" />
            </GDFilter>
          </Plot>
        </Graph>
        <Graph name="Soil water and rainfall">
          <Legend>
            <CheckedTitles>Plot,  dul(1)</CheckedTitles>
            <CheckedTitles>Plot,  sw(1)</CheckedTitles>
            <CheckedTitles>Plot,  sw(2)</CheckedTitles>
            <CheckedTitles>Plot,  sw(3)</CheckedTitles>
            <CheckedTitles>Plot,  irrigation</CheckedTitles>
            <CheckedTitles>Rain,  rain</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>Date</X>
            <Y>dul(1)</Y>
            <Y>sw(1)</Y>
            <Y>sw(2)</Y>
            <YRight>irrigation</YRight>
            <Y>sw(3)</Y>
            <YRight>applied_furrow_irrigation</YRight>
            <GDApsimFileReader name="ApsimFileReader" />
          </Plot>
          <Plot name="Rain">
            <SeriesType>Bar</SeriesType>
            <PointType>None</PointType>
            <colour>-16776961</colour>
            <X>Date</X>
            <YRight>rain</YRight>
            <GDApsimFileReader name="ApsimFileReader" />
          </Plot>
        </Graph>
        <Graph name="Evapotranspiration">
          <Legend>
            <CheckedTitles>Plot, Variety-Simal Field1</CheckedTitles>
            <CheckedTitles>Plot1, Simal-obs</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>DaysAftersowing</X>
            <Y>CWU</Y>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader" />
            </GDFilter>
          </Plot>
          <Plot name="Plot1">
            <SeriesType>No line</SeriesType>
            <PointType>Circle</PointType>
            <colour>-65536</colour>
            <X>DaysAftersowing</X>
            <Y>CWU</Y>
            <GDFilter name="Filter">
              <Filter>DaysAftersowing &lt; 161</Filter>
              <GDApsimFileReader name="ApsimFileReader">
                <FileName>Simal-obs.csv</FileName>
              </GDApsimFileReader>
            </GDFilter>
          </Plot>
        </Graph>
        <Graph name="Excess H2O">
          <Legend>
            <CheckedTitles> Cumulative runoff</CheckedTitles>
            <CheckedTitles> Cumulative drain</CheckedTitles>
            <CheckedTitles> Cumulative rain</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>Date</X>
            <Y>Cumulative runoff</Y>
            <Y>Cumulative drain</Y>
            <Y>Cumulative rain</Y>
            <GDApsimFileReader name="ApsimFileReader" />
          </Plot>
        </Graph>
        <Graph name="Nitrogen">
          <Legend>
            <CheckedTitles> NO3()</CheckedTitles>
            <CheckedTitles> Nh4()</CheckedTitles>
            <CheckedTitles> Cumulative dlt_n_min()</CheckedTitles>
            <CheckedTitles> esw</CheckedTitles>
            <CheckedTitles> fertiliser</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <Y>NO3()</Y>
            <Y>Nh4()</Y>
            <Y>N_available_4_Rice</Y>
            <YRight>Cumulative dlt_n_min()</YRight>
            <X>Date</X>
            <YRight>esw</YRight>
            <YRight>fertiliser</YRight>
            <GDApsimFileReader name="ApsimFileReader" />
          </Plot>
        </Graph>
        <Graph name="SurfaceOM">
          <Legend>
            <CheckedTitles> Variety-Simal Field1</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>Date</X>
            <Y>surfaceom_wt</Y>
            <Y>wagt</Y>
            <GDApsimFileReader name="ApsimFileReader" />
          </Plot>
        </Graph>
        <Graph name="Stress">
          <Legend>
            <CheckedTitles> sw_stress_expan</CheckedTitles>
            <CheckedTitles> sw_stress_pheno</CheckedTitles>
            <CheckedTitles> sw_stress_photo</CheckedTitles>
            <CheckedTitles> nfact_expan</CheckedTitles>
            <CheckedTitles> nfact_pheno</CheckedTitles>
            <CheckedTitles> nfact_photo</CheckedTitles>
            <CheckedTitles> yield</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>Date</X>
            <Y>sw_stress_expan</Y>
            <Y>sw_stress_pheno</Y>
            <Y>sw_stress_photo</Y>
            <Y>nfact_expan</Y>
            <Y>nfact_pheno</Y>
            <Y>nfact_photo</Y>
            <YRight>yield</YRight>
            <GDApsimFileReader name="ApsimFileReader" />
          </Plot>
        </Graph>
      </outputfile>
    </area>
  </simulation>
  <simulation name="Emerald19TOS1CvBolt">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>10/05/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Bolt</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS1CvBolt outputfile Daily.out</filename>
        <title>Emerald19TOS1CvBolt outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS1CvBolt outputfile Harvest.out</filename>
        <title>Emerald19TOS1CvBolt outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS2CvBolt">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>03/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Bolt</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS2CvBolt outputfile Daily.out</filename>
        <title>Emerald19TOS2CvBolt outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS2CvBolt outputfile Harvest.out</filename>
        <title>Emerald19TOS2CvBolt outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS3CvBolt">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>27/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Bolt</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS3CvBolt outputfile Daily.out</filename>
        <title>Emerald19TOS3CvBolt outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS3CvBolt outputfile Harvest.out</filename>
        <title>Emerald19TOS3CvBolt outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS1CvAce">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>10/05/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS1CvAce outputfile Daily.out</filename>
        <title>Emerald19TOS1CvAce outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS1CvAce outputfile Harvest.out</filename>
        <title>Emerald19TOS1CvAce outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS2CvAce">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>03/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS2CvAce outputfile Daily.out</filename>
        <title>Emerald19TOS2CvAce outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS2CvAce outputfile Harvest.out</filename>
        <title>Emerald19TOS2CvAce outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS3CvAce">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>27/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS3CvAce outputfile Daily.out</filename>
        <title>Emerald19TOS3CvAce outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS3CvAce outputfile Harvest.out</filename>
        <title>Emerald19TOS3CvAce outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS1CvBlitz">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>10/05/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS1CvBlitz outputfile Daily.out</filename>
        <title>Emerald19TOS1CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS1CvBlitz outputfile Harvest.out</filename>
        <title>Emerald19TOS1CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS2CvBlitz">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>03/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS2CvBlitz outputfile Daily.out</filename>
        <title>Emerald19TOS2CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS2CvBlitz outputfile Harvest.out</filename>
        <title>Emerald19TOS2CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS3CvBlitz">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>27/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS3CvBlitz outputfile Daily.out</filename>
        <title>Emerald19TOS3CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS3CvBlitz outputfile Harvest.out</filename>
        <title>Emerald19TOS3CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS1CvGreenfield">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>10/05/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS1CvGreenfield outputfile Daily.out</filename>
        <title>Emerald19TOS1CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS1CvGreenfield outputfile Harvest.out</filename>
        <title>Emerald19TOS1CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS2CvGreenfield">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>03/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS2CvGreenfield outputfile Daily.out</filename>
        <title>Emerald19TOS2CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS2CvGreenfield outputfile Harvest.out</filename>
        <title>Emerald19TOS2CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS3CvGreenfield">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>27/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS3CvGreenfield outputfile Daily.out</filename>
        <title>Emerald19TOS3CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS3CvGreenfield outputfile Harvest.out</filename>
        <title>Emerald19TOS3CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS1CvHallmarkXT">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>10/05/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS1CvHallmarkXT outputfile Daily.out</filename>
        <title>Emerald19TOS1CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS1CvHallmarkXT outputfile Harvest.out</filename>
        <title>Emerald19TOS1CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS2CvHallmarkXT">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>03/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS2CvHallmarkXT outputfile Daily.out</filename>
        <title>Emerald19TOS2CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS2CvHallmarkXT outputfile Harvest.out</filename>
        <title>Emerald19TOS2CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS3CvHallmarkXT">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>27/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS3CvHallmarkXT outputfile Daily.out</filename>
        <title>Emerald19TOS3CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS3CvHallmarkXT outputfile Harvest.out</filename>
        <title>Emerald19TOS3CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS1CvJumbo2">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>10/05/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS1CvJumbo2 outputfile Daily.out</filename>
        <title>Emerald19TOS1CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS1CvJumbo2 outputfile Harvest.out</filename>
        <title>Emerald19TOS1CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS2CvJumbo2">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>03/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS2CvJumbo2 outputfile Daily.out</filename>
        <title>Emerald19TOS2CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS2CvJumbo2 outputfile Harvest.out</filename>
        <title>Emerald19TOS2CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Emerald19TOS3CvJumbo2">
    <metfile name="met">
      <filename>Emerald2019Combo.met</filename>
    </metfile>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>27/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Emerald</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Emerald19TOS3CvJumbo2 outputfile Daily.out</filename>
        <title>Emerald19TOS3CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Emerald19TOS3CvJumbo2 outputfile Harvest.out</filename>
        <title>Emerald19TOS3CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.326</double>
            <double>0.328</double>
            <double>0.345</double>
            <double>0.36</double>
            <double>0.359</double>
            <double>0.326</double>
            <double>0.326</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Dooen01TOS1CvDiggerIrr0">
    <metfile name="met">
      <filename>horsham.met</filename>
    </metfile>
    <clock>
      <start_date>27/06/2001</start_date>
      <end_date>25/03/2002</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>28/06/2001</sow_date>
            <reset_date>27/06/2001</reset_date>
            <lentil_cv>Digger</lentil_cv>
            <lentil_density>230</lentil_density>
            <soil>dooen</soil>
            <site>Dooen</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Dooen01TOS1CvDiggerIrr0 outputfile Daily.out</filename>
        <title>Dooen01TOS1CvDiggerIrr0 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Dooen01TOS1CvDiggerIrr0 outputfile Harvest.out</filename>
        <title>Dooen01TOS1CvDiggerIrr0 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="dooen">
        <RecordNumber>0</RecordNumber>
        <SoilType>Black Vertosol</SoilType>
        <LocalName>Waco</LocalName>
        <Site>Jimbour</Site>
        <NearestTown>Jimbour, Q 4352</NearestTown>
        <Region>South East Queensland</Region>
        <NaturalVegetation>Grassland, mainly Qld bluegrass</NaturalVegetation>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Daniel Rodriguez lentil expt</DataSource>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.2</double>
            <double>1.37</double>
            <double>1.28</double>
            <double>1.38</double>
            <double>1.4</double>
            <double>1.45</double>
            <double>1.45</double>
          </BD>
          <AirDry>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.14</double>
            <double>0.16</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.145</double>
            <double>0.145</double>
            <double>0.197</double>
            <double>0.21</double>
            <double>0.24</double>
            <double>0.243</double>
            <double>0.28</double>
          </LL15>
          <DUL>
            <double>0.384</double>
            <double>0.375</double>
            <double>0.405</double>
            <double>0.391</double>
            <double>0.373</double>
            <double>0.343</double>
            <double>0.32</double>
          </DUL>
          <SAT>
            <double>0.54</double>
            <double>0.419</double>
            <double>0.487</double>
            <double>0.468</double>
            <double>0.449</double>
            <double>0.427</double>
            <double>0.389</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.145</double>
              <double>0.145</double>
              <double>0.197</double>
              <double>0.21</double>
              <double>0.24</double>
              <double>0.243</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35.4</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <SWCON>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>20</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>14.5</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <OC>
            <double>1.12</double>
            <double>1.12</double>
            <double>0.77</double>
            <double>0.5</double>
            <double>0.4</double>
            <double>0.28</double>
            <double>0.23</double>
          </OC>
          <FBiom>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.36</double>
            <double>0.36</double>
            <double>0.5</double>
            <double>0.59</double>
            <double>0.84</double>
            <double>0.8</double>
            <double>0.8</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>8.2</double>
            <double>8.5</double>
            <double>9.1</double>
            <double>9.2</double>
            <double>8.9</double>
            <double>9.02</double>
            <double>9</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <InitialWater name="Initial water">
          <FractionFull>0.05</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
          <PercentMethod>EvenlyDistributed</PercentMethod>
          <RelativeTo>ll15</RelativeTo>
        </InitialWater>
        <Sample name="Initial nitrogen">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>11.04</double>
            <double>10.411999999999999</double>
            <double>12.544</double>
            <double>7.4520000000000008</double>
            <double>4.2</double>
            <double>5.2200000000000006</double>
            <double>4.06</double>
          </NO3>
          <NH4>
            <double>0.36</double>
            <double>0.41</double>
            <double>0.77</double>
            <double>0.83</double>
            <double>0.84</double>
            <double>1.45</double>
            <double>1.45</double>
          </NH4>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.31</double>
            <double>0.24</double>
            <double>0.21</double>
            <double>0.22</double>
            <double>0.245</double>
            <double>0.24</double>
            <double>0.257</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Dooen01TOS1CvDiggerIrr1">
    <metfile name="met">
      <filename>horsham.met</filename>
    </metfile>
    <clock>
      <start_date>27/06/2001</start_date>
      <end_date>25/03/2002</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>28/06/2001</sow_date>
            <reset_date>27/06/2001</reset_date>
            <lentil_cv>Digger</lentil_cv>
            <lentil_density>230</lentil_density>
            <soil>dooen</soil>
            <site>Dooen</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif


if (today = Date('10-aug')) then
irrigation apply amount = 45
endif

if (today = Date('22-sep')) then
irrigation apply amount = 45
endif
</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Dooen01TOS1CvDiggerIrr1 outputfile Daily.out</filename>
        <title>Dooen01TOS1CvDiggerIrr1 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Dooen01TOS1CvDiggerIrr1 outputfile Harvest.out</filename>
        <title>Dooen01TOS1CvDiggerIrr1 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="dooen">
        <RecordNumber>0</RecordNumber>
        <SoilType>Black Vertosol</SoilType>
        <LocalName>Waco</LocalName>
        <Site>Jimbour</Site>
        <NearestTown>Jimbour, Q 4352</NearestTown>
        <Region>South East Queensland</Region>
        <NaturalVegetation>Grassland, mainly Qld bluegrass</NaturalVegetation>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Daniel Rodriguez lentil expt</DataSource>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.2</double>
            <double>1.37</double>
            <double>1.28</double>
            <double>1.38</double>
            <double>1.4</double>
            <double>1.45</double>
            <double>1.45</double>
          </BD>
          <AirDry>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.14</double>
            <double>0.16</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.145</double>
            <double>0.145</double>
            <double>0.197</double>
            <double>0.21</double>
            <double>0.24</double>
            <double>0.243</double>
            <double>0.28</double>
          </LL15>
          <DUL>
            <double>0.384</double>
            <double>0.375</double>
            <double>0.405</double>
            <double>0.391</double>
            <double>0.373</double>
            <double>0.343</double>
            <double>0.32</double>
          </DUL>
          <SAT>
            <double>0.54</double>
            <double>0.419</double>
            <double>0.487</double>
            <double>0.468</double>
            <double>0.449</double>
            <double>0.427</double>
            <double>0.389</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.145</double>
              <double>0.145</double>
              <double>0.197</double>
              <double>0.21</double>
              <double>0.24</double>
              <double>0.243</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.01</double>
              <double>0</double>
              <double>0</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35.4</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <SWCON>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>20</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>14.5</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <OC>
            <double>1.12</double>
            <double>1.12</double>
            <double>0.77</double>
            <double>0.5</double>
            <double>0.4</double>
            <double>0.28</double>
            <double>0.23</double>
          </OC>
          <FBiom>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.015</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.36</double>
            <double>0.36</double>
            <double>0.5</double>
            <double>0.59</double>
            <double>0.84</double>
            <double>0.8</double>
            <double>0.8</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>8.2</double>
            <double>8.5</double>
            <double>9.1</double>
            <double>9.2</double>
            <double>8.9</double>
            <double>9.02</double>
            <double>9</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <InitialWater name="Initial water">
          <FractionFull>0.05</FractionFull>
          <DepthWetSoil>NaN</DepthWetSoil>
          <PercentMethod>EvenlyDistributed</PercentMethod>
          <RelativeTo>ll15</RelativeTo>
        </InitialWater>
        <Sample name="Initial nitrogen">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>11.04</double>
            <double>10.411999999999999</double>
            <double>12.544</double>
            <double>7.4520000000000008</double>
            <double>4.2</double>
            <double>5.2200000000000006</double>
            <double>4.06</double>
          </NO3>
          <NH4>
            <double>0.36</double>
            <double>0.41</double>
            <double>0.77</double>
            <double>0.83</double>
            <double>0.84</double>
            <double>1.45</double>
            <double>1.45</double>
          </NH4>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.31</double>
            <double>0.24</double>
            <double>0.21</double>
            <double>0.22</double>
            <double>0.245</double>
            <double>0.24</double>
            <double>0.257</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS1CvJumbo2">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>01/05/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS1CvJumbo2 outputfile Daily.out</filename>
        <title>Mildura19TOS1CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS1CvJumbo2 outputfile Harvest.out</filename>
        <title>Mildura19TOS1CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS1CvBlitz">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>01/05/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS1CvBlitz outputfile Daily.out</filename>
        <title>Mildura19TOS1CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS1CvBlitz outputfile Harvest.out</filename>
        <title>Mildura19TOS1CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS1CvAce">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>01/05/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS1CvAce outputfile Daily.out</filename>
        <title>Mildura19TOS1CvAce outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS1CvAce outputfile Harvest.out</filename>
        <title>Mildura19TOS1CvAce outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS1CvHallmarkXT">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>01/05/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS1CvHallmarkXT outputfile Daily.out</filename>
        <title>Mildura19TOS1CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS1CvHallmarkXT outputfile Harvest.out</filename>
        <title>Mildura19TOS1CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS1CvGreenfield">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>01/05/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS1CvGreenfield outputfile Daily.out</filename>
        <title>Mildura19TOS1CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS1CvGreenfield outputfile Harvest.out</filename>
        <title>Mildura19TOS1CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS2CvJumbo2">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>18/05/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS2CvJumbo2 outputfile Daily.out</filename>
        <title>Mildura19TOS2CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS2CvJumbo2 outputfile Harvest.out</filename>
        <title>Mildura19TOS2CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS2CvBlitz">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>18/05/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS2CvBlitz outputfile Daily.out</filename>
        <title>Mildura19TOS2CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS2CvBlitz outputfile Harvest.out</filename>
        <title>Mildura19TOS2CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS2CvAce">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>18/05/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS2CvAce outputfile Daily.out</filename>
        <title>Mildura19TOS2CvAce outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS2CvAce outputfile Harvest.out</filename>
        <title>Mildura19TOS2CvAce outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS2CvHallmarkXT">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>18/05/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS2CvHallmarkXT outputfile Daily.out</filename>
        <title>Mildura19TOS2CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS2CvHallmarkXT outputfile Harvest.out</filename>
        <title>Mildura19TOS2CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS2CvGreenfield">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>18/05/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS2CvGreenfield outputfile Daily.out</filename>
        <title>Mildura19TOS2CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS2CvGreenfield outputfile Harvest.out</filename>
        <title>Mildura19TOS2CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS3CvJumbo2">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>07/06/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS3CvJumbo2 outputfile Daily.out</filename>
        <title>Mildura19TOS3CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS3CvJumbo2 outputfile Harvest.out</filename>
        <title>Mildura19TOS3CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS3CvBlitz">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>07/06/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS3CvBlitz outputfile Daily.out</filename>
        <title>Mildura19TOS3CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS3CvBlitz outputfile Harvest.out</filename>
        <title>Mildura19TOS3CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS3CvAce">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>07/06/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS3CvAce outputfile Daily.out</filename>
        <title>Mildura19TOS3CvAce outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS3CvAce outputfile Harvest.out</filename>
        <title>Mildura19TOS3CvAce outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS3CvHallmarkXT">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>07/06/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS3CvHallmarkXT outputfile Daily.out</filename>
        <title>Mildura19TOS3CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS3CvHallmarkXT outputfile Harvest.out</filename>
        <title>Mildura19TOS3CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Mildura19TOS3CvGreenfield">
    <metfile name="met">
      <filename>MildurahPO.met</filename>
    </metfile>
    <clock>
      <start_date>30/04/2019</start_date>
      <end_date>26/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>07/06/2019</sow_date>
            <reset_date>30/04/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Sandy Loam (Kerribee No359)</soil>
            <site>Mildura</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Mildura19TOS3CvGreenfield outputfile Daily.out</filename>
        <title>Mildura19TOS3CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Mildura19TOS3CvGreenfield outputfile Harvest.out</filename>
        <title>Mildura19TOS3CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Sandy Loam (Kerribee No359)">
        <RecordNumber>189</RecordNumber>
        <ASCOrder>Calcarosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Sandy loam </SoilType>
        <LocalName />
        <Site>Kerribee</Site>
        <NearestTown>Paringi</NearestTown>
        <Region>Lower Western</Region>
        <State>New South Wales</State>
        <Country>Australia</Country>
        <NaturalVegetation>Belah and mallee</NaturalVegetation>
        <ApsoilNumber>359</ApsoilNumber>
        <Latitude>-34.288</Latitude>
        <Longitude>142.371</Longitude>
        <LocationAccuracy> +/- 20m</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Based on Soil Characterisation undertaken by Whitbread/Davoren GRDC Soil water project and Jeff Baldock MSF data</DataSource>
        <Comments />
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.286</double>
            <double>1.529</double>
            <double>1.441</double>
            <double>1.486</double>
            <double>1.57</double>
            <double>1.626</double>
            <double>1.626</double>
            <double>1.626</double>
          </BD>
          <AirDry>
            <double>0.016</double>
            <double>0.048</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </AirDry>
          <LL15>
            <double>0.028</double>
            <double>0.065</double>
            <double>0.07</double>
            <double>0.1</double>
            <double>0.11</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.14</double>
          </LL15>
          <DUL>
            <double>0.13</double>
            <double>0.17</double>
            <double>0.19</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.21</double>
            <double>0.19</double>
            <double>0.19</double>
          </DUL>
          <SAT>
            <double>0.46</double>
            <double>0.37</double>
            <double>0.41</double>
            <double>0.39</double>
            <double>0.36</double>
            <double>0.32</double>
            <double>0.32</double>
            <double>0.32</double>
          </SAT>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.105</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.11</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="fieldpea">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.028</double>
              <double>0.065</double>
              <double>0.1</double>
              <double>0.115</double>
              <double>0.115</double>
              <double>0.13</double>
              <double>0.15</double>
              <double>0.14</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="weed">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.05</double>
              <double>0.068</double>
              <double>0.09</double>
              <double>0.131</double>
              <double>0.139</double>
              <double>0.16</double>
              <double>0.16</double>
              <double>0.16</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>2</SummerCona>
          <SummerU>4</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>88</DiffusConst>
          <DiffusSlope>35</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>70</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.7</double>
            <double>0.5</double>
            <double>0.5</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>13.8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.47</double>
            <double>0.37</double>
            <double>0.28</double>
            <double>0.23</double>
            <double>0.22</double>
            <double>0.2</double>
            <double>0.2</double>
            <double>0.2</double>
          </OC>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <Texture>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string>Sandy loam</string>
            <string />
            <string />
          </Texture>
          <EC>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.2</double>
            <double>0.4</double>
            <double>NaN</double>
            <double>NaN</double>
          </EC>
          <PH>
            <double>7.1</double>
            <double>7.8</double>
            <double>8.1</double>
            <double>8.2</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <Boron>
            <double>1.5</double>
            <double>1.1</double>
            <double>1.1</double>
            <double>1.4</double>
            <double>4.4</double>
            <double>8.9</double>
            <double>NaN</double>
            <double>NaN</double>
          </Boron>
          <ParticleSizeSand>
            <double>82.7</double>
            <double>76.9</double>
            <double>72.4</double>
            <double>63.9</double>
            <double>58.1</double>
            <double>59.6</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSand>
          <ParticleSizeSilt>
            <double>5.5</double>
            <double>5.9</double>
            <double>5.9</double>
            <double>4.7</double>
            <double>4.1</double>
            <double>4.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeSilt>
          <ParticleSizeClay>
            <double>10.6</double>
            <double>15.2</double>
            <double>17.7</double>
            <double>21.9</double>
            <double>24.2</double>
            <double>22.1</double>
            <double>NaN</double>
            <double>NaN</double>
          </ParticleSizeClay>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>16.3333333333333</double>
            <double>5.83333333333333</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>2.33333333333333</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.105</double>
            <double>0.149</double>
            <double>0.225</double>
            <double>0.257</double>
            <double>0.255</double>
            <double>0.255</double>
            <double>0.255</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Caragabal19TOS1CvBlitz">
    <metfile name="met">
      <filename>CaragabalPO.met</filename>
    </metfile>
    <clock>
      <start_date>07/05/2019</start_date>
      <end_date>02/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>08/05/2019</sow_date>
            <reset_date>07/05/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Caragabal</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Caragabal19TOS1CvBlitz outputfile Daily.out</filename>
        <title>Caragabal19TOS1CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Caragabal19TOS1CvBlitz outputfile Harvest.out</filename>
        <title>Caragabal19TOS1CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.234</double>
            <double>0.291</double>
            <double>0.279</double>
            <double>0.29</double>
            <double>0.322</double>
            <double>0.335</double>
            <double>0.327</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Caragabal19TOS1CvBolt">
    <metfile name="met">
      <filename>CaragabalPO.met</filename>
    </metfile>
    <clock>
      <start_date>07/05/2019</start_date>
      <end_date>02/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>08/05/2019</sow_date>
            <reset_date>07/05/2019</reset_date>
            <lentil_cv>Bolt</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Caragabal</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Caragabal19TOS1CvBolt outputfile Daily.out</filename>
        <title>Caragabal19TOS1CvBolt outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Caragabal19TOS1CvBolt outputfile Harvest.out</filename>
        <title>Caragabal19TOS1CvBolt outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.234</double>
            <double>0.291</double>
            <double>0.279</double>
            <double>0.29</double>
            <double>0.322</double>
            <double>0.335</double>
            <double>0.327</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Caragabal19TOS1CvGreenfield">
    <metfile name="met">
      <filename>CaragabalPO.met</filename>
    </metfile>
    <clock>
      <start_date>07/05/2019</start_date>
      <end_date>02/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>08/05/2019</sow_date>
            <reset_date>07/05/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Caragabal</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Caragabal19TOS1CvGreenfield outputfile Daily.out</filename>
        <title>Caragabal19TOS1CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Caragabal19TOS1CvGreenfield outputfile Harvest.out</filename>
        <title>Caragabal19TOS1CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.234</double>
            <double>0.291</double>
            <double>0.279</double>
            <double>0.29</double>
            <double>0.322</double>
            <double>0.335</double>
            <double>0.327</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Caragabal19TOS1CvHallmarkXT">
    <metfile name="met">
      <filename>CaragabalPO.met</filename>
    </metfile>
    <clock>
      <start_date>07/05/2019</start_date>
      <end_date>02/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>08/05/2019</sow_date>
            <reset_date>07/05/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Caragabal</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Caragabal19TOS1CvHallmarkXT outputfile Daily.out</filename>
        <title>Caragabal19TOS1CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Caragabal19TOS1CvHallmarkXT outputfile Harvest.out</filename>
        <title>Caragabal19TOS1CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.234</double>
            <double>0.291</double>
            <double>0.279</double>
            <double>0.29</double>
            <double>0.322</double>
            <double>0.335</double>
            <double>0.327</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Caragabal19TOS1CvJumbo2">
    <metfile name="met">
      <filename>CaragabalPO.met</filename>
    </metfile>
    <clock>
      <start_date>07/05/2019</start_date>
      <end_date>02/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>08/05/2019</sow_date>
            <reset_date>07/05/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Caragabal</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Caragabal19TOS1CvJumbo2 outputfile Daily.out</filename>
        <title>Caragabal19TOS1CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Caragabal19TOS1CvJumbo2 outputfile Harvest.out</filename>
        <title>Caragabal19TOS1CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.234</double>
            <double>0.291</double>
            <double>0.279</double>
            <double>0.29</double>
            <double>0.322</double>
            <double>0.335</double>
            <double>0.327</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Caragabal19TOS2CvBlitz">
    <metfile name="met">
      <filename>CaragabalPO.met</filename>
    </metfile>
    <clock>
      <start_date>07/05/2019</start_date>
      <end_date>02/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>17/06/2019</sow_date>
            <reset_date>07/05/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Caragabal</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Caragabal19TOS2CvBlitz outputfile Daily.out</filename>
        <title>Caragabal19TOS2CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Caragabal19TOS2CvBlitz outputfile Harvest.out</filename>
        <title>Caragabal19TOS2CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.234</double>
            <double>0.291</double>
            <double>0.279</double>
            <double>0.29</double>
            <double>0.322</double>
            <double>0.335</double>
            <double>0.327</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Caragabal19TOS2CvBolt">
    <metfile name="met">
      <filename>CaragabalPO.met</filename>
    </metfile>
    <clock>
      <start_date>07/05/2019</start_date>
      <end_date>02/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>17/06/2019</sow_date>
            <reset_date>07/05/2019</reset_date>
            <lentil_cv>Bolt</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Caragabal</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Caragabal19TOS2CvBolt outputfile Daily.out</filename>
        <title>Caragabal19TOS2CvBolt outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Caragabal19TOS2CvBolt outputfile Harvest.out</filename>
        <title>Caragabal19TOS2CvBolt outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.234</double>
            <double>0.291</double>
            <double>0.279</double>
            <double>0.29</double>
            <double>0.322</double>
            <double>0.335</double>
            <double>0.327</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Caragabal19TOS2CvGreenfield">
    <metfile name="met">
      <filename>CaragabalPO.met</filename>
    </metfile>
    <clock>
      <start_date>07/05/2019</start_date>
      <end_date>02/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>17/06/2019</sow_date>
            <reset_date>07/05/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Caragabal</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Caragabal19TOS2CvGreenfield outputfile Daily.out</filename>
        <title>Caragabal19TOS2CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Caragabal19TOS2CvGreenfield outputfile Harvest.out</filename>
        <title>Caragabal19TOS2CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.234</double>
            <double>0.291</double>
            <double>0.279</double>
            <double>0.29</double>
            <double>0.322</double>
            <double>0.335</double>
            <double>0.327</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Caragabal19TOS2CvHallmarkXT">
    <metfile name="met">
      <filename>CaragabalPO.met</filename>
    </metfile>
    <clock>
      <start_date>07/05/2019</start_date>
      <end_date>02/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>17/06/2019</sow_date>
            <reset_date>07/05/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Caragabal</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Caragabal19TOS2CvHallmarkXT outputfile Daily.out</filename>
        <title>Caragabal19TOS2CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Caragabal19TOS2CvHallmarkXT outputfile Harvest.out</filename>
        <title>Caragabal19TOS2CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.234</double>
            <double>0.291</double>
            <double>0.279</double>
            <double>0.29</double>
            <double>0.322</double>
            <double>0.335</double>
            <double>0.327</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Caragabal19TOS2CvJumbo2">
    <metfile name="met">
      <filename>CaragabalPO.met</filename>
    </metfile>
    <clock>
      <start_date>07/05/2019</start_date>
      <end_date>02/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>17/06/2019</sow_date>
            <reset_date>07/05/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>110</lentil_density>
            <soil>Vertosol No7 (PAWC-204 No519-Generic)</soil>
            <site>Caragabal</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Caragabal19TOS2CvJumbo2 outputfile Daily.out</filename>
        <title>Caragabal19TOS2CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Caragabal19TOS2CvJumbo2 outputfile Harvest.out</filename>
        <title>Caragabal19TOS2CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No7 (PAWC-204 No519-Generic)">
        <RecordNumber>99</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>519-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.33</double>
            <double>1.34</double>
            <double>1.34</double>
            <double>1.37</double>
            <double>1.41</double>
            <double>1.43</double>
            <double>1.44</double>
          </BD>
          <AirDry>
            <double>0.109</double>
            <double>0.18</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </AirDry>
          <LL15>
            <double>0.217</double>
            <double>0.225</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
            <double>0.244</double>
          </LL15>
          <DUL>
            <double>0.418</double>
            <double>0.413</double>
            <double>0.414</double>
            <double>0.404</double>
            <double>0.39</double>
            <double>0.382</double>
            <double>0.377</double>
          </DUL>
          <SAT>
            <double>0.468</double>
            <double>0.463</double>
            <double>0.464</double>
            <double>0.454</double>
            <double>0.44</double>
            <double>0.432</double>
            <double>0.427</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.217</double>
              <double>0.225</double>
              <double>0.244</double>
              <double>0.262</double>
              <double>0.294</double>
              <double>0.324</double>
              <double>0.356</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.8</double>
            <double>0.5</double>
            <double>0.25</double>
            <double>0.15</double>
            <double>0.1</double>
            <double>0.1</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.4</double>
            <double>8.6</double>
            <double>8.6</double>
            <double>8</double>
            <double>7.1</double>
            <double>6.5</double>
            <double>6.5</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.234</double>
            <double>0.291</double>
            <double>0.279</double>
            <double>0.29</double>
            <double>0.322</double>
            <double>0.335</double>
            <double>0.327</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS1CvAceIrr0">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>30/04/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS1CvAceIrr0 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS1CvAceIrr0 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS1CvAceIrr0 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS1CvAceIrr0 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS2CvAceIrr0">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS2CvAceIrr0 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS2CvAceIrr0 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS2CvAceIrr0 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS2CvAceIrr0 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS3CvAceIrr0">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>12/06/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS3CvAceIrr0 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS3CvAceIrr0 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS3CvAceIrr0 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS3CvAceIrr0 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS1CvAceIrr1">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>30/04/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif


if (today = Date('21-may')) then
if (TOS = 'TOS2') then 
 irrigation apply amount = 15 
 endif
endif

if (today = Date('13-aug')) then
irrigation apply amount = 10
endif

if (today = Date('14-aug')) then
irrigation apply amount = 10
endif

if (today = Date('15-aug')) then
irrigation apply amount = 10
endif

if (today = Date('26-aug')) then
irrigation apply amount = 10
endif

if (today = Date('31-aug')) then
irrigation apply amount = 10
endif

if (today = Date('03-sep')) then
irrigation apply amount = 10
endif

if (today = Date('25-sep')) then
irrigation apply amount = 10
endif

if (today = Date('30-sep')) then
irrigation apply amount = 10
endif

if (today = Date('1-oct')) then
irrigation apply amount = 10
endif
</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS1CvAceIrr1 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS1CvAceIrr1 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS1CvAceIrr1 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS1CvAceIrr1 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS2CvAceIrr1">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif


if (today = Date('21-may')) then
if (TOS = 'TOS2') then 
 irrigation apply amount = 15 
 endif
endif

if (today = Date('13-aug')) then
irrigation apply amount = 10
endif

if (today = Date('14-aug')) then
irrigation apply amount = 10
endif

if (today = Date('15-aug')) then
irrigation apply amount = 10
endif

if (today = Date('26-aug')) then
irrigation apply amount = 10
endif

if (today = Date('31-aug')) then
irrigation apply amount = 10
endif

if (today = Date('03-sep')) then
irrigation apply amount = 10
endif

if (today = Date('25-sep')) then
irrigation apply amount = 10
endif

if (today = Date('30-sep')) then
irrigation apply amount = 10
endif

if (today = Date('1-oct')) then
irrigation apply amount = 10
endif
</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS2CvAceIrr1 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS2CvAceIrr1 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS2CvAceIrr1 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS2CvAceIrr1 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS3CvAceIrr1">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>12/06/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif


if (today = Date('21-may')) then
if (TOS = 'TOS2') then 
 irrigation apply amount = 15 
 endif
endif

if (today = Date('13-aug')) then
irrigation apply amount = 10
endif

if (today = Date('14-aug')) then
irrigation apply amount = 10
endif

if (today = Date('15-aug')) then
irrigation apply amount = 10
endif

if (today = Date('26-aug')) then
irrigation apply amount = 10
endif

if (today = Date('31-aug')) then
irrigation apply amount = 10
endif

if (today = Date('03-sep')) then
irrigation apply amount = 10
endif

if (today = Date('25-sep')) then
irrigation apply amount = 10
endif

if (today = Date('30-sep')) then
irrigation apply amount = 10
endif

if (today = Date('1-oct')) then
irrigation apply amount = 10
endif
</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS3CvAceIrr1 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS3CvAceIrr1 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS3CvAceIrr1 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS3CvAceIrr1 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS1CvBlitzIrr0">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>30/04/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS1CvBlitzIrr0 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS1CvBlitzIrr0 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS1CvBlitzIrr0 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS1CvBlitzIrr0 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS2CvBlitzIrr0">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS2CvBlitzIrr0 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS2CvBlitzIrr0 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS2CvBlitzIrr0 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS2CvBlitzIrr0 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS3CvBlitzIrr0">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>12/06/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS3CvBlitzIrr0 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS3CvBlitzIrr0 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS3CvBlitzIrr0 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS3CvBlitzIrr0 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS1CvBlitzIrr1">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>30/04/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif


if (today = Date('21-may')) then
if (TOS = 'TOS2') then 
 irrigation apply amount = 15 
 endif
endif

if (today = Date('13-aug')) then
irrigation apply amount = 10
endif

if (today = Date('14-aug')) then
irrigation apply amount = 10
endif

if (today = Date('15-aug')) then
irrigation apply amount = 10
endif

if (today = Date('26-aug')) then
irrigation apply amount = 10
endif

if (today = Date('31-aug')) then
irrigation apply amount = 10
endif

if (today = Date('03-sep')) then
irrigation apply amount = 10
endif

if (today = Date('25-sep')) then
irrigation apply amount = 10
endif

if (today = Date('30-sep')) then
irrigation apply amount = 10
endif

if (today = Date('1-oct')) then
irrigation apply amount = 10
endif
</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS1CvBlitzIrr1 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS1CvBlitzIrr1 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS1CvBlitzIrr1 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS1CvBlitzIrr1 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS2CvBlitzIrr1">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif


if (today = Date('21-may')) then
if (TOS = 'TOS2') then 
 irrigation apply amount = 15 
 endif
endif

if (today = Date('13-aug')) then
irrigation apply amount = 10
endif

if (today = Date('14-aug')) then
irrigation apply amount = 10
endif

if (today = Date('15-aug')) then
irrigation apply amount = 10
endif

if (today = Date('26-aug')) then
irrigation apply amount = 10
endif

if (today = Date('31-aug')) then
irrigation apply amount = 10
endif

if (today = Date('03-sep')) then
irrigation apply amount = 10
endif

if (today = Date('25-sep')) then
irrigation apply amount = 10
endif

if (today = Date('30-sep')) then
irrigation apply amount = 10
endif

if (today = Date('1-oct')) then
irrigation apply amount = 10
endif
</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS2CvBlitzIrr1 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS2CvBlitzIrr1 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS2CvBlitzIrr1 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS2CvBlitzIrr1 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS3CvBlitzIrr1">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>12/06/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif


if (today = Date('21-may')) then
if (TOS = 'TOS2') then 
 irrigation apply amount = 15 
 endif
endif

if (today = Date('13-aug')) then
irrigation apply amount = 10
endif

if (today = Date('14-aug')) then
irrigation apply amount = 10
endif

if (today = Date('15-aug')) then
irrigation apply amount = 10
endif

if (today = Date('26-aug')) then
irrigation apply amount = 10
endif

if (today = Date('31-aug')) then
irrigation apply amount = 10
endif

if (today = Date('03-sep')) then
irrigation apply amount = 10
endif

if (today = Date('25-sep')) then
irrigation apply amount = 10
endif

if (today = Date('30-sep')) then
irrigation apply amount = 10
endif

if (today = Date('1-oct')) then
irrigation apply amount = 10
endif
</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS3CvBlitzIrr1 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS3CvBlitzIrr1 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS3CvBlitzIrr1 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS3CvBlitzIrr1 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS1CvJumbo2Irr0">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>30/04/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS1CvJumbo2Irr0 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS1CvJumbo2Irr0 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS1CvJumbo2Irr0 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS1CvJumbo2Irr0 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS2CvJumbo2Irr0">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS2CvJumbo2Irr0 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS2CvJumbo2Irr0 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS2CvJumbo2Irr0 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS2CvJumbo2Irr0 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS3CvJumbo2Irr0">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>12/06/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS3CvJumbo2Irr0 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS3CvJumbo2Irr0 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS3CvJumbo2Irr0 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS3CvJumbo2Irr0 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS1CvJumbo2Irr1">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>30/04/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif


if (today = Date('21-may')) then
if (TOS = 'TOS2') then 
 irrigation apply amount = 15 
 endif
endif

if (today = Date('13-aug')) then
irrigation apply amount = 10
endif

if (today = Date('14-aug')) then
irrigation apply amount = 10
endif

if (today = Date('15-aug')) then
irrigation apply amount = 10
endif

if (today = Date('26-aug')) then
irrigation apply amount = 10
endif

if (today = Date('31-aug')) then
irrigation apply amount = 10
endif

if (today = Date('03-sep')) then
irrigation apply amount = 10
endif

if (today = Date('25-sep')) then
irrigation apply amount = 10
endif

if (today = Date('30-sep')) then
irrigation apply amount = 10
endif

if (today = Date('1-oct')) then
irrigation apply amount = 10
endif
</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS1CvJumbo2Irr1 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS1CvJumbo2Irr1 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS1CvJumbo2Irr1 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS1CvJumbo2Irr1 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS2CvJumbo2Irr1">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif


if (today = Date('21-may')) then
if (TOS = 'TOS2') then 
 irrigation apply amount = 15 
 endif
endif

if (today = Date('13-aug')) then
irrigation apply amount = 10
endif

if (today = Date('14-aug')) then
irrigation apply amount = 10
endif

if (today = Date('15-aug')) then
irrigation apply amount = 10
endif

if (today = Date('26-aug')) then
irrigation apply amount = 10
endif

if (today = Date('31-aug')) then
irrigation apply amount = 10
endif

if (today = Date('03-sep')) then
irrigation apply amount = 10
endif

if (today = Date('25-sep')) then
irrigation apply amount = 10
endif

if (today = Date('30-sep')) then
irrigation apply amount = 10
endif

if (today = Date('1-oct')) then
irrigation apply amount = 10
endif
</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS2CvJumbo2Irr1 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS2CvJumbo2Irr1 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS2CvJumbo2Irr1 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS2CvJumbo2Irr1 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Greenethorpe19TOS3CvJumbo2Irr1">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>29/04/2019</start_date>
      <end_date>25/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>12/06/2019</sow_date>
            <reset_date>29/04/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe1</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif


if (today = Date('21-may')) then
if (TOS = 'TOS2') then 
 irrigation apply amount = 15 
 endif
endif

if (today = Date('13-aug')) then
irrigation apply amount = 10
endif

if (today = Date('14-aug')) then
irrigation apply amount = 10
endif

if (today = Date('15-aug')) then
irrigation apply amount = 10
endif

if (today = Date('26-aug')) then
irrigation apply amount = 10
endif

if (today = Date('31-aug')) then
irrigation apply amount = 10
endif

if (today = Date('03-sep')) then
irrigation apply amount = 10
endif

if (today = Date('25-sep')) then
irrigation apply amount = 10
endif

if (today = Date('30-sep')) then
irrigation apply amount = 10
endif

if (today = Date('1-oct')) then
irrigation apply amount = 10
endif
</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Greenethorpe19TOS3CvJumbo2Irr1 outputfile Daily.out</filename>
        <title>Greenethorpe19TOS3CvJumbo2Irr1 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Greenethorpe19TOS3CvJumbo2Irr1 outputfile Harvest.out</filename>
        <title>Greenethorpe19TOS3CvJumbo2Irr1 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GreenethorpePhen19TOS1CvAce">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>17/04/2019</start_date>
      <end_date>13/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>18/04/2019</sow_date>
            <reset_date>17/04/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe2</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GreenethorpePhen19TOS1CvAce outputfile Daily.out</filename>
        <title>GreenethorpePhen19TOS1CvAce outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GreenethorpePhen19TOS1CvAce outputfile Harvest.out</filename>
        <title>GreenethorpePhen19TOS1CvAce outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GreenethorpePhen19TOS2CvAce">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>17/04/2019</start_date>
      <end_date>13/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>17/04/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe2</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GreenethorpePhen19TOS2CvAce outputfile Daily.out</filename>
        <title>GreenethorpePhen19TOS2CvAce outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GreenethorpePhen19TOS2CvAce outputfile Harvest.out</filename>
        <title>GreenethorpePhen19TOS2CvAce outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GreenethorpePhen19TOS1CvBlitz">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>17/04/2019</start_date>
      <end_date>13/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>18/04/2019</sow_date>
            <reset_date>17/04/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe2</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GreenethorpePhen19TOS1CvBlitz outputfile Daily.out</filename>
        <title>GreenethorpePhen19TOS1CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GreenethorpePhen19TOS1CvBlitz outputfile Harvest.out</filename>
        <title>GreenethorpePhen19TOS1CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GreenethorpePhen19TOS2CvBlitz">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>17/04/2019</start_date>
      <end_date>13/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>17/04/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe2</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GreenethorpePhen19TOS2CvBlitz outputfile Daily.out</filename>
        <title>GreenethorpePhen19TOS2CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GreenethorpePhen19TOS2CvBlitz outputfile Harvest.out</filename>
        <title>GreenethorpePhen19TOS2CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GreenethorpePhen19TOS1CvBolt">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>17/04/2019</start_date>
      <end_date>13/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>18/04/2019</sow_date>
            <reset_date>17/04/2019</reset_date>
            <lentil_cv>Bolt</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe2</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GreenethorpePhen19TOS1CvBolt outputfile Daily.out</filename>
        <title>GreenethorpePhen19TOS1CvBolt outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GreenethorpePhen19TOS1CvBolt outputfile Harvest.out</filename>
        <title>GreenethorpePhen19TOS1CvBolt outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GreenethorpePhen19TOS2CvBolt">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>17/04/2019</start_date>
      <end_date>13/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>17/04/2019</reset_date>
            <lentil_cv>Bolt</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe2</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GreenethorpePhen19TOS2CvBolt outputfile Daily.out</filename>
        <title>GreenethorpePhen19TOS2CvBolt outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GreenethorpePhen19TOS2CvBolt outputfile Harvest.out</filename>
        <title>GreenethorpePhen19TOS2CvBolt outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GreenethorpePhen19TOS1CvGreenfield">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>17/04/2019</start_date>
      <end_date>13/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>18/04/2019</sow_date>
            <reset_date>17/04/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe2</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GreenethorpePhen19TOS1CvGreenfield outputfile Daily.out</filename>
        <title>GreenethorpePhen19TOS1CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GreenethorpePhen19TOS1CvGreenfield outputfile Harvest.out</filename>
        <title>GreenethorpePhen19TOS1CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GreenethorpePhen19TOS2CvGreenfield">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>17/04/2019</start_date>
      <end_date>13/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>17/04/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe2</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GreenethorpePhen19TOS2CvGreenfield outputfile Daily.out</filename>
        <title>GreenethorpePhen19TOS2CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GreenethorpePhen19TOS2CvGreenfield outputfile Harvest.out</filename>
        <title>GreenethorpePhen19TOS2CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GreenethorpePhen19TOS1CvHallmarkXT">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>17/04/2019</start_date>
      <end_date>13/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>18/04/2019</sow_date>
            <reset_date>17/04/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe2</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GreenethorpePhen19TOS1CvHallmarkXT outputfile Daily.out</filename>
        <title>GreenethorpePhen19TOS1CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GreenethorpePhen19TOS1CvHallmarkXT outputfile Harvest.out</filename>
        <title>GreenethorpePhen19TOS1CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GreenethorpePhen19TOS2CvHallmarkXT">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>17/04/2019</start_date>
      <end_date>13/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>17/04/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe2</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GreenethorpePhen19TOS2CvHallmarkXT outputfile Daily.out</filename>
        <title>GreenethorpePhen19TOS2CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GreenethorpePhen19TOS2CvHallmarkXT outputfile Harvest.out</filename>
        <title>GreenethorpePhen19TOS2CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GreenethorpePhen19TOS1CvJumbo2">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>17/04/2019</start_date>
      <end_date>13/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>18/04/2019</sow_date>
            <reset_date>17/04/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe2</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GreenethorpePhen19TOS1CvJumbo2 outputfile Daily.out</filename>
        <title>GreenethorpePhen19TOS1CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GreenethorpePhen19TOS1CvJumbo2 outputfile Harvest.out</filename>
        <title>GreenethorpePhen19TOS1CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GreenethorpePhen19TOS2CvJumbo2">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>17/04/2019</start_date>
      <end_date>13/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>17/04/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe2</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GreenethorpePhen19TOS2CvJumbo2 outputfile Daily.out</filename>
        <title>GreenethorpePhen19TOS2CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GreenethorpePhen19TOS2CvJumbo2 outputfile Harvest.out</filename>
        <title>GreenethorpePhen19TOS2CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GreenethorpePhen19TOS1CvNugget">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>17/04/2019</start_date>
      <end_date>13/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>18/04/2019</sow_date>
            <reset_date>17/04/2019</reset_date>
            <lentil_cv>Nugget</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe2</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GreenethorpePhen19TOS1CvNugget outputfile Daily.out</filename>
        <title>GreenethorpePhen19TOS1CvNugget outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GreenethorpePhen19TOS1CvNugget outputfile Harvest.out</filename>
        <title>GreenethorpePhen19TOS1CvNugget outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GreenethorpePhen19TOS2CvNugget">
    <metfile name="met">
      <filename>GreenethorpeSILO.met</filename>
    </metfile>
    <clock>
      <start_date>17/04/2019</start_date>
      <end_date>13/01/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>17/04/2019</reset_date>
            <lentil_cv>Nugget</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Greenethorpe_soil_2015</soil>
            <site>Greenethorpe2</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GreenethorpePhen19TOS2CvNugget outputfile Daily.out</filename>
        <title>GreenethorpePhen19TOS2CvNugget outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GreenethorpePhen19TOS2CvNugget outputfile Harvest.out</filename>
        <title>GreenethorpePhen19TOS2CvNugget outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Greenethorpe_soil_2015">
        <RecordNumber>0</RecordNumber>
        <SoilType>SNSW</SoilType>
        <Site>Front paddock</Site>
        <NearestTown>Young</NearestTown>
        <Region>Southern NSW</Region>
        <State>NSW</State>
        <Latitude>0</Latitude>
        <Longitude>0</Longitude>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Kirkegaard/Lilley</DataSource>
        <memo>The soil for Greenethorpe was developed by Julianne Lilley:

''Hi Elizabeth,

Laura and I did a bit of playing around with this soil as I initially adapted something from a Young soil that I had characterised. The simulation I took it from was called Y:\WORK\OCP modelling\Greenethorpe_Iandra\greenethorpe_2013 and was saved on 16 jan 2019 , so this may be the last file we used. Jeremy has also been simulating at the Iandra site, so he may be worth asking, but I know he is not back at work yet.  Anyway this soil will be a good place to start.

Cheers
Julianne"
</memo>
        <Water>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <BD>
            <double>1.5</double>
            <double>1.53</double>
            <double>1.56</double>
            <double>1.54</double>
            <double>1.54</double>
            <double>1.6</double>
            <double>1.62</double>
            <double>1.71</double>
            <double>1.69</double>
            <double>1.77</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.08</double>
            <double>0.08</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
            <double>0.15</double>
          </AirDry>
          <LL15>
            <double>0.08</double>
            <double>0.102</double>
            <double>0.156</double>
            <double>0.213</double>
            <double>0.241</double>
            <double>0.253</double>
            <double>0.258</double>
            <double>0.256</double>
            <double>0.268</double>
            <double>0.268</double>
            <double>0.268</double>
          </LL15>
          <DUL>
            <double>0.25</double>
            <double>0.211</double>
            <double>0.232</double>
            <double>0.287</double>
            <double>0.311</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.35</double>
            <double>0.335</double>
            <double>0.335</double>
          </DUL>
          <SAT>
            <double>0.28</double>
            <double>0.241</double>
            <double>0.262</double>
            <double>0.317</double>
            <double>0.341</double>
            <double>0.369</double>
            <double>0.369</double>
            <double>0.363</double>
            <double>0.357</double>
            <double>0.342</double>
            <double>0.344</double>
          </SAT>
          <SoilCrop name="lentil">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.102</double>
              <double>0.102</double>
              <double>0.156</double>
              <double>0.213</double>
              <double>0.241</double>
              <double>0.253</double>
              <double>0.258</double>
              <double>0.256</double>
              <double>0.268</double>
              <double>0.268</double>
              <double>0.268</double>
            </LL>
            <KL>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.045</double>
              <double>0.03</double>
              <double>0.03</double>
              <double>0.025</double>
              <double>0.02</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="wheat">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
          <SoilCrop name="canola">
            <Thickness>
              <double>100</double>
              <double>100</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
              <double>200</double>
            </Thickness>
            <LL>
              <double>0.104</double>
              <double>0.137</double>
              <double>0.132</double>
              <double>0.178</double>
              <double>0.22</double>
              <double>0.23</double>
              <double>0.24</double>
              <double>0.25</double>
              <double>0.24</double>
              <double>0.27</double>
              <double>0.27</double>
            </LL>
            <KL>
              <double>0.08</double>
              <double>0.08</double>
              <double>0.06</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.03</double>
              <double>0.02</double>
              <double>0.01</double>
              <double>0.01</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>0.7</double>
              <double>0.5</double>
              <double>0</double>
            </XF>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-nov</SummerDate>
          <WinterCona>2</WinterCona>
          <WinterU>2</WinterU>
          <WinterDate>1-apr</WinterDate>
          <DiffusConst>44</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>72</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>500</double>
          </Thickness>
          <SWCON>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.8</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
            <double>0.6</double>
          </SWCON>
        </SoilWater>
        <Analysis>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <Texture>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </Texture>
          <MunsellColour>
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
            <string />
          </MunsellColour>
          <PH>
            <double>5.8</double>
            <double>5.9</double>
            <double>6.6</double>
            <double>6.8</double>
            <double>7</double>
            <double>7.1</double>
            <double>7.2</double>
            <double>7.3</double>
            <double>7.4</double>
            <double>7.4</double>
            <double>7.6</double>
            <double>7.8</double>
            <double>8</double>
            <double>8.2</double>
            <double>8.3</double>
            <double>8.4</double>
            <double>8.4</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.5</double>
          </PH>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <SoilOrganicMatter>
          <RootCN>60</RootCN>
          <RootWt>3000</RootWt>
          <SoilCN>8</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>100</double>
          </Thickness>
          <OC>
            <double>1</double>
            <double>0.35</double>
            <double>0.33</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.22</double>
            <double>0.19</double>
            <double>0.17</double>
            <double>0.15</double>
            <double>0.12</double>
            <double>0.11</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.1</double>
            <double>0.08</double>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
          </OC>
          <FBiom>
            <double>0.06</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.31</double>
            <double>0.35</double>
            <double>0.4</double>
            <double>0.45</double>
            <double>0.5</double>
            <double>0.6</double>
            <double>0.7</double>
            <double>0.8</double>
            <double>0.9</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
            <double>0.99</double>
          </FInert>
          <OCUnits>Total</OCUnits>
        </SoilOrganicMatter>
        <Sample name="Initial nitrogen">
          <Date>19/2/2013</Date>
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>38.7</double>
            <double>15.453</double>
            <double>13.104000000000001</double>
            <double>5.5440000000000005</double>
            <double>4.3119999999999994</double>
            <double>3.136</double>
            <double>2.268</double>
            <double>2.3939999999999997</double>
            <double>3.0420000000000003</double>
            <double>4.248</double>
            <double>5.1</double>
          </NO3>
          <NH4>
            <double>2.25</double>
            <double>0.5355</double>
            <double>0.624</double>
            <double>0.308</double>
            <double>0.2464</double>
            <double>0.288</double>
            <double>0.22680000000000003</double>
            <double>0.5814</double>
            <double>0.507</double>
            <double>0.3894</double>
            <double>0.272</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
            <double>0.2</double>
            <double>0.2</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
            <double>200</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>32.6666666666667</double>
            <double>11.6666666666667</double>
            <double>7</double>
            <double>7</double>
            <double>4.66666666666667</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.181</double>
            <double>0.204</double>
            <double>0.567</double>
            <double>0.319</double>
            <double>0.31</double>
            <double>0.283</double>
            <double>0.269</double>
            <double>0.269</double>
            <double>0.241</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS1CvAce">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>10/05/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS1CvAce outputfile Daily.out</filename>
        <title>GattonPhen19TOS1CvAce outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS1CvAce outputfile Harvest.out</filename>
        <title>GattonPhen19TOS1CvAce outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS2CvAce">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>07/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS2CvAce outputfile Daily.out</filename>
        <title>GattonPhen19TOS2CvAce outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS2CvAce outputfile Harvest.out</filename>
        <title>GattonPhen19TOS2CvAce outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS3CvAce">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>19/07/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS3CvAce outputfile Daily.out</filename>
        <title>GattonPhen19TOS3CvAce outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS3CvAce outputfile Harvest.out</filename>
        <title>GattonPhen19TOS3CvAce outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS1CvBlitz">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>10/05/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS1CvBlitz outputfile Daily.out</filename>
        <title>GattonPhen19TOS1CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS1CvBlitz outputfile Harvest.out</filename>
        <title>GattonPhen19TOS1CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS2CvBlitz">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>07/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS2CvBlitz outputfile Daily.out</filename>
        <title>GattonPhen19TOS2CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS2CvBlitz outputfile Harvest.out</filename>
        <title>GattonPhen19TOS2CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS3CvBlitz">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>19/07/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS3CvBlitz outputfile Daily.out</filename>
        <title>GattonPhen19TOS3CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS3CvBlitz outputfile Harvest.out</filename>
        <title>GattonPhen19TOS3CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS1CvBolt">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>10/05/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Bolt</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS1CvBolt outputfile Daily.out</filename>
        <title>GattonPhen19TOS1CvBolt outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS1CvBolt outputfile Harvest.out</filename>
        <title>GattonPhen19TOS1CvBolt outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS2CvBolt">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>07/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Bolt</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS2CvBolt outputfile Daily.out</filename>
        <title>GattonPhen19TOS2CvBolt outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS2CvBolt outputfile Harvest.out</filename>
        <title>GattonPhen19TOS2CvBolt outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS3CvBolt">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>19/07/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Bolt</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS3CvBolt outputfile Daily.out</filename>
        <title>GattonPhen19TOS3CvBolt outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS3CvBolt outputfile Harvest.out</filename>
        <title>GattonPhen19TOS3CvBolt outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS1CvDigger">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>10/05/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Digger</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS1CvDigger outputfile Daily.out</filename>
        <title>GattonPhen19TOS1CvDigger outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS1CvDigger outputfile Harvest.out</filename>
        <title>GattonPhen19TOS1CvDigger outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS2CvDigger">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>07/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Digger</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS2CvDigger outputfile Daily.out</filename>
        <title>GattonPhen19TOS2CvDigger outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS2CvDigger outputfile Harvest.out</filename>
        <title>GattonPhen19TOS2CvDigger outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS3CvDigger">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>19/07/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Digger</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS3CvDigger outputfile Daily.out</filename>
        <title>GattonPhen19TOS3CvDigger outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS3CvDigger outputfile Harvest.out</filename>
        <title>GattonPhen19TOS3CvDigger outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS1CvGreenfield">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>10/05/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS1CvGreenfield outputfile Daily.out</filename>
        <title>GattonPhen19TOS1CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS1CvGreenfield outputfile Harvest.out</filename>
        <title>GattonPhen19TOS1CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS2CvGreenfield">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>07/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS2CvGreenfield outputfile Daily.out</filename>
        <title>GattonPhen19TOS2CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS2CvGreenfield outputfile Harvest.out</filename>
        <title>GattonPhen19TOS2CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS3CvGreenfield">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>19/07/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS3CvGreenfield outputfile Daily.out</filename>
        <title>GattonPhen19TOS3CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS3CvGreenfield outputfile Harvest.out</filename>
        <title>GattonPhen19TOS3CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS1CvHallmarkXT">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>10/05/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS1CvHallmarkXT outputfile Daily.out</filename>
        <title>GattonPhen19TOS1CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS1CvHallmarkXT outputfile Harvest.out</filename>
        <title>GattonPhen19TOS1CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS2CvHallmarkXT">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>07/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS2CvHallmarkXT outputfile Daily.out</filename>
        <title>GattonPhen19TOS2CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS2CvHallmarkXT outputfile Harvest.out</filename>
        <title>GattonPhen19TOS2CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS3CvHallmarkXT">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>19/07/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS3CvHallmarkXT outputfile Daily.out</filename>
        <title>GattonPhen19TOS3CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS3CvHallmarkXT outputfile Harvest.out</filename>
        <title>GattonPhen19TOS3CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS1CvJumbo2">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>10/05/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS1CvJumbo2 outputfile Daily.out</filename>
        <title>GattonPhen19TOS1CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS1CvJumbo2 outputfile Harvest.out</filename>
        <title>GattonPhen19TOS1CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS2CvJumbo2">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>07/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS2CvJumbo2 outputfile Daily.out</filename>
        <title>GattonPhen19TOS2CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS2CvJumbo2 outputfile Harvest.out</filename>
        <title>GattonPhen19TOS2CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS3CvJumbo2">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>19/07/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS3CvJumbo2 outputfile Daily.out</filename>
        <title>GattonPhen19TOS3CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS3CvJumbo2 outputfile Harvest.out</filename>
        <title>GattonPhen19TOS3CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS1CvNugget">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>10/05/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Nugget</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS1CvNugget outputfile Daily.out</filename>
        <title>GattonPhen19TOS1CvNugget outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS1CvNugget outputfile Harvest.out</filename>
        <title>GattonPhen19TOS1CvNugget outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS2CvNugget">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>07/06/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Nugget</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS2CvNugget outputfile Daily.out</filename>
        <title>GattonPhen19TOS2CvNugget outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS2CvNugget outputfile Harvest.out</filename>
        <title>GattonPhen19TOS2CvNugget outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="GattonPhen19TOS3CvNugget">
    <metfile name="met">
      <filename>Gatton.met</filename>
    </metfile>
    <patchinput>
      <filename>GilbertWS.met</filename>
    </patchinput>
    <clock>
      <start_date>09/05/2019</start_date>
      <end_date>04/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>19/07/2019</sow_date>
            <reset_date>09/05/2019</reset_date>
            <lentil_cv>Nugget</lentil_cv>
            <lentil_density>120</lentil_density>
            <soil>Vertosol No2 (PAWC-269 No514-Generic)</soil>
            <site>Gatton</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">GattonPhen19TOS3CvNugget outputfile Daily.out</filename>
        <title>GattonPhen19TOS3CvNugget outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">GattonPhen19TOS3CvNugget outputfile Harvest.out</filename>
        <title>GattonPhen19TOS3CvNugget outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No2 (PAWC-269 No514-Generic)">
        <RecordNumber>93</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>514-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.06</double>
            <double>1.09</double>
            <double>1.11</double>
            <double>1.13</double>
            <double>1.18</double>
            <double>1.23</double>
            <double>1.25</double>
          </BD>
          <AirDry>
            <double>0.13</double>
            <double>0.217</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </AirDry>
          <LL15>
            <double>0.259</double>
            <double>0.271</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </LL15>
          <DUL>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.494</double>
            <double>0.474</double>
            <double>0.457</double>
            <double>0.45</double>
          </DUL>
          <SAT>
            <double>0.569</double>
            <double>0.558</double>
            <double>0.551</double>
            <double>0.544</double>
            <double>0.524</double>
            <double>0.507</double>
            <double>0.5</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.259</double>
              <double>0.271</double>
              <double>0.295</double>
              <double>0.31</double>
              <double>0.34</double>
              <double>0.368</double>
              <double>0.414</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.12</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>1.1</double>
            <double>0.88</double>
            <double>0.55</double>
            <double>0.275</double>
            <double>0.165</double>
            <double>0.11</double>
            <double>0.11</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>7.3</double>
            <double>7.7</double>
            <double>8.1</double>
            <double>8.5</double>
            <double>8.5</double>
            <double>8.6</double>
            <double>8.6</double>
          </PH>
          <PHMetadata>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
            <string>Measured</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>42</double>
            <double>14</double>
            <double>7</double>
            <double>7</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.519</double>
            <double>0.508</double>
            <double>0.501</double>
            <double>0.415</double>
            <double>0.295</double>
            <double>0.295</double>
            <double>0.295</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS1CvAcePop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS1CvAcePop132 outputfile Daily.out</filename>
        <title>Walgett19TOS1CvAcePop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS1CvAcePop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS1CvAcePop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS1CvBlitzPop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS1CvBlitzPop132 outputfile Daily.out</filename>
        <title>Walgett19TOS1CvBlitzPop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS1CvBlitzPop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS1CvBlitzPop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS1CvBoltPop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>Bolt</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS1CvBoltPop132 outputfile Daily.out</filename>
        <title>Walgett19TOS1CvBoltPop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS1CvBoltPop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS1CvBoltPop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS1CvHallmarkXTPop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS1CvHallmarkXTPop132 outputfile Daily.out</filename>
        <title>Walgett19TOS1CvHallmarkXTPop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS1CvHallmarkXTPop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS1CvHallmarkXTPop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS1CvHallmarkXTPop150">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>150</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS1CvHallmarkXTPop150 outputfile Daily.out</filename>
        <title>Walgett19TOS1CvHallmarkXTPop150 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS1CvHallmarkXTPop150 outputfile Harvest.out</filename>
        <title>Walgett19TOS1CvHallmarkXTPop150 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS1CvJumbo2Pop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>21/05/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS1CvJumbo2Pop132 outputfile Daily.out</filename>
        <title>Walgett19TOS1CvJumbo2Pop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS1CvJumbo2Pop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS1CvJumbo2Pop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS2CvAcePop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>09/06/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS2CvAcePop132 outputfile Daily.out</filename>
        <title>Walgett19TOS2CvAcePop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS2CvAcePop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS2CvAcePop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS2CvBlitzPop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>09/06/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS2CvBlitzPop132 outputfile Daily.out</filename>
        <title>Walgett19TOS2CvBlitzPop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS2CvBlitzPop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS2CvBlitzPop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS2CvBoltPop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>09/06/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>Bolt</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS2CvBoltPop132 outputfile Daily.out</filename>
        <title>Walgett19TOS2CvBoltPop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS2CvBoltPop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS2CvBoltPop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS2CvHallmarkXTPop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>09/06/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS2CvHallmarkXTPop132 outputfile Daily.out</filename>
        <title>Walgett19TOS2CvHallmarkXTPop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS2CvHallmarkXTPop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS2CvHallmarkXTPop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS2CvHallmarkXTPop150">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>09/06/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>150</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS2CvHallmarkXTPop150 outputfile Daily.out</filename>
        <title>Walgett19TOS2CvHallmarkXTPop150 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS2CvHallmarkXTPop150 outputfile Harvest.out</filename>
        <title>Walgett19TOS2CvHallmarkXTPop150 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS2CvJumbo2Pop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>09/06/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS2CvJumbo2Pop132 outputfile Daily.out</filename>
        <title>Walgett19TOS2CvJumbo2Pop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS2CvJumbo2Pop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS2CvJumbo2Pop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS3CvAcePop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>28/06/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS3CvAcePop132 outputfile Daily.out</filename>
        <title>Walgett19TOS3CvAcePop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS3CvAcePop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS3CvAcePop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS3CvBlitzPop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>28/06/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS3CvBlitzPop132 outputfile Daily.out</filename>
        <title>Walgett19TOS3CvBlitzPop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS3CvBlitzPop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS3CvBlitzPop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS3CvBoltPop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>28/06/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>Bolt</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS3CvBoltPop132 outputfile Daily.out</filename>
        <title>Walgett19TOS3CvBoltPop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS3CvBoltPop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS3CvBoltPop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS3CvHallmarkXTPop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>28/06/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS3CvHallmarkXTPop132 outputfile Daily.out</filename>
        <title>Walgett19TOS3CvHallmarkXTPop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS3CvHallmarkXTPop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS3CvHallmarkXTPop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS3CvHallmarkXTPop150">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>28/06/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>150</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS3CvHallmarkXTPop150 outputfile Daily.out</filename>
        <title>Walgett19TOS3CvHallmarkXTPop150 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS3CvHallmarkXTPop150 outputfile Harvest.out</filename>
        <title>Walgett19TOS3CvHallmarkXTPop150 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Walgett19TOS3CvJumbo2Pop132">
    <metfile name="met">
      <filename>Walgett.met</filename>
    </metfile>
    <clock>
      <start_date>20/05/2019</start_date>
      <end_date>15/02/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>28/06/2019</sow_date>
            <reset_date>20/05/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>132</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Walgett</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Walgett19TOS3CvJumbo2Pop132 outputfile Daily.out</filename>
        <title>Walgett19TOS3CvJumbo2Pop132 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Walgett19TOS3CvJumbo2Pop132 outputfile Harvest.out</filename>
        <title>Walgett19TOS3CvJumbo2Pop132 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS1CvAce">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>15/06/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS1CvAce outputfile Daily.out</filename>
        <title>Millmerran19TOS1CvAce outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS1CvAce outputfile Harvest.out</filename>
        <title>Millmerran19TOS1CvAce outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS1CvBlitz">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>15/06/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS1CvBlitz outputfile Daily.out</filename>
        <title>Millmerran19TOS1CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS1CvBlitz outputfile Harvest.out</filename>
        <title>Millmerran19TOS1CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS1CvGreenfield">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>15/06/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS1CvGreenfield outputfile Daily.out</filename>
        <title>Millmerran19TOS1CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS1CvGreenfield outputfile Harvest.out</filename>
        <title>Millmerran19TOS1CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS1CvHallmarkXT">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>15/06/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS1CvHallmarkXT outputfile Daily.out</filename>
        <title>Millmerran19TOS1CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS1CvHallmarkXT outputfile Harvest.out</filename>
        <title>Millmerran19TOS1CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS1CvJumbo2">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>15/06/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS1</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS1CvJumbo2 outputfile Daily.out</filename>
        <title>Millmerran19TOS1CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS1CvJumbo2 outputfile Harvest.out</filename>
        <title>Millmerran19TOS1CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS2CvAce">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>02/07/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS2CvAce outputfile Daily.out</filename>
        <title>Millmerran19TOS2CvAce outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS2CvAce outputfile Harvest.out</filename>
        <title>Millmerran19TOS2CvAce outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS2CvBlitz">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>02/07/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS2CvBlitz outputfile Daily.out</filename>
        <title>Millmerran19TOS2CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS2CvBlitz outputfile Harvest.out</filename>
        <title>Millmerran19TOS2CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS2CvGreenfield">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>02/07/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS2CvGreenfield outputfile Daily.out</filename>
        <title>Millmerran19TOS2CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS2CvGreenfield outputfile Harvest.out</filename>
        <title>Millmerran19TOS2CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS2CvHallmarkXT">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>02/07/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS2CvHallmarkXT outputfile Daily.out</filename>
        <title>Millmerran19TOS2CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS2CvHallmarkXT outputfile Harvest.out</filename>
        <title>Millmerran19TOS2CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS2CvJumbo2">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>02/07/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS2</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS2CvJumbo2 outputfile Daily.out</filename>
        <title>Millmerran19TOS2CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS2CvJumbo2 outputfile Harvest.out</filename>
        <title>Millmerran19TOS2CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS3CvAce">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>15/07/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>Ace</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS3CvAce outputfile Daily.out</filename>
        <title>Millmerran19TOS3CvAce outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS3CvAce outputfile Harvest.out</filename>
        <title>Millmerran19TOS3CvAce outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS3CvBlitz">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>15/07/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>Blitz</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS3CvBlitz outputfile Daily.out</filename>
        <title>Millmerran19TOS3CvBlitz outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS3CvBlitz outputfile Harvest.out</filename>
        <title>Millmerran19TOS3CvBlitz outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS3CvGreenfield">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>15/07/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>Greenfield</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS3CvGreenfield outputfile Daily.out</filename>
        <title>Millmerran19TOS3CvGreenfield outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS3CvGreenfield outputfile Harvest.out</filename>
        <title>Millmerran19TOS3CvGreenfield outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS3CvHallmarkXT">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>15/07/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>HallmarkXT</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS3CvHallmarkXT outputfile Daily.out</filename>
        <title>Millmerran19TOS3CvHallmarkXT outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS3CvHallmarkXT outputfile Harvest.out</filename>
        <title>Millmerran19TOS3CvHallmarkXT outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
  <simulation name="Millmerran19TOS3CvJumbo2">
    <metfile name="met">
      <filename>Millmerran.met</filename>
    </metfile>
    <clock>
      <start_date>14/06/2019</start_date>
      <end_date>11/03/2020</end_date>
    </clock>
    <summaryfile />
    <area name="paddock">
      <surfaceom name="SurfaceOrganicMatter">
        <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
        <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
        <mass type="text" description="Initial surface residue (kg/ha)">50</mass>
        <cnr type="text" description="C:N ratio of initial residue">60</cnr>
        <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
      </surfaceom>
      <fertiliser />
      <irrigation name="Irrigation">
        <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
        <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
        <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
        <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
        <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
        <allocation type="text" description="Allocation in mm">0</allocation>
        <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
        <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
        <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
      </irrigation>
      <lentil />
      <folder name="Manager folder">
        <manager name="Rules">
          <ui>
            <sow_date>15/07/2019</sow_date>
            <reset_date>14/06/2019</reset_date>
            <lentil_cv>Jumbo2</lentil_cv>
            <lentil_density>52</lentil_density>
            <soil>Vertosol No11 (PAWC-136 No523-Generic)</soil>
            <site>Millmerran</site>
            <tos>TOS3</tos>
          </ui>
          <script>
            <text>!rule name 
under_crop = 0 ! 0: no crop in field; 1: field is cropped

sow_day = '[sow_date]'
TOS = '[TOS]'
lentil_cvv = '[lentil_cv]'
lentil_density = '[lentil_density]'
site = '[site]'
MaxLAI = 0

</text>
            <event>init</event>
          </script>
          <script>
            <text>! finds if there is a crop in the field, if 0 no crop if1 crop

if (under_crop &gt; 0 AND StageName = 'out') then
   under_crop = 0
endif


if (lentil.lai &gt; MaxLAI) then
   MaxLAI = lentil.lai
endif

if (Today = Date('[reset_date]')) then 
   '[soil] Water' reset
   '[soil] Nitrogen' reset
   'SurfaceOrganicMatter' reset
endif

if (Today = Date('[sow_date]')) then
   lentil sow cultivar = '[lentil_cv]', plants = [lentil_density] (/m2), sowing_depth = 40 (mm)
   MaxLAI = 0
   under_crop = 1
endif

! if maturity harvest the crop
if (lentil.StageName = 'harvest_ripe') or (lentil.plant_status = 'dead') then
   lentil harvest
   lentil end_crop
endif

</text>
            <event>start_of_day</event>
          </script>
          <script>
            <text>

if (under_crop &gt; 0) then
   'outputfile Daily' do_output
endif

            </text>
            <event>end_of_day</event>
          </script>
        </manager>
        <manager2 name="SW Calcs">
          <ui>
            <category type="category" description="Irrigation parameters" />
          </ui>
          <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Input] DateTime today;
   
   [Link] Paddock Paddock;
   private double [] dlayer;
   private double [] dul_dep;
   private double [] ll15_dep;
   [EventHandler] public void OnInitialised()
   {
      dlayer = new double[15];
      Paddock.Get("dlayer", out dlayer);
      ll15_dep = new double[15];
      Paddock.Get("ll15_dep", out ll15_dep);
      dul_dep = new double[15];
      Paddock.Get("dul_dep", out dul_dep);
   }
   
   // Return the fraction of this layer we include in 
   private double LayerFrac (int layer, double max_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt; max_depth)
         return 1.0;
      if (cum_depth - dlayer[layer] &lt; max_depth)
         return((max_depth - (cum_depth - dlayer[layer])) / dlayer[layer]);
      return 0.0;
   }
   private double TopLayerFrac (int layer, double min_depth) {
      double cum_depth = 0;
      for(int i = 0; i &lt;= layer; i++)
         cum_depth += dlayer[i];
      if (cum_depth &lt;= min_depth)
         return 0.0;
      if (cum_depth - min_depth  &lt; dlayer[layer] )
         return((cum_depth - min_depth) / dlayer[layer]);
      return 1.0;
   }
   //ESW calculated to 600mm
   [Output] double esw_0_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated between 100 &amp; 600mm
   [Output] double esw_100_600 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         double s = 0;
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 600.0) * TopLayerFrac(i, 100);
            s += dlayer[i];
            //Console.WriteLine("1-6 L" + i.ToString() + " " + s + " = " + TopLayerFrac(i, 100) + ", " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }

   //ESW calculated to 1200mm
   [Output] double esw_1200 {
      get {
         double[] sw_dep = new double[15];
         Paddock.Get("sw_dep", out sw_dep);
         
         // relative to LL15
         double[] SW = new double[sw_dep.Length]; //double s = 0;
         for (int i = 0; i &lt; sw_dep.Length; i++) {
            SW[i] = Math.Max(0.0, sw_dep[i] - ll15_dep[i]) * LayerFrac(i, 1200.0);
            //s += dlayer[i];
            //Console.WriteLine("L" + i.ToString() + " " + s + " = " + LayerFrac(i, 600.0));
         }
         return(MathUtility.Sum(SW));
      }
      set {}
   }
}
   </text>
        </manager2>
      </folder>
      <outputfile name="outputfile Daily">
        <filename output="yes">Millmerran19TOS3CvJumbo2 outputfile Daily.out</filename>
        <title>Millmerran19TOS3CvJumbo2 outputfile Daily</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as Date</variable>
          <variable>StageName</variable>
          <variable>DaysAfterSowing</variable>
          <variable>lai</variable>
          <variable>leaf_no as leaves/plant</variable>
          <variable>leaf_no_sen as deadleaves.m2</variable>
          <variable>grainTotalWt as GrainWt</variable>
          <variable>biomass_wt as AboveGround.Wt</variable>
          <variable>root_depth</variable>
          <variable>sw</variable>
          <variable>esw_layr as esw</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>lentil_density  as density</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
          <variable>esw_100_600</variable>
          <variable>esw_0_600</variable>
        </variables>
        <events name="Reporting Frequency" />
      </outputfile>
      <outputfile name="outputfile Harvest">
        <filename output="yes">Millmerran19TOS3CvJumbo2 outputfile Harvest.out</filename>
        <title>Millmerran19TOS3CvJumbo2 outputfile Harvest</title>
        <variables name="Variables">
          <variable>dd/mm/yyyy as HarvestDate</variable>
          <variable>sow_day as SowDate</variable>
          <variable>lentil.yield</variable>
          <variable>lentil.biomass</variable>
          <variable>lentil.root_depth</variable>
          <variable>MaxLAI</variable>
          <variable>lentil.floral_initiation_das as FloralInitDAS</variable>
          <variable>lentil.flowering_das as FloweringDAS</variable>
          <variable>DaysAfterSowing as MaturityDAS</variable>
          <variable>lentil_density  as density</variable>
          <variable>lentil_cvv  as cultivar</variable>
          <variable>tos as TOS</variable>
          <variable>site</variable>
        </variables>
        <events name="Reporting Frequency">
          <event>harvesting</event>
        </events>
      </outputfile>
      <Soil name="Vertosol No11 (PAWC-136 No523-Generic)">
        <RecordNumber>103</RecordNumber>
        <ASCOrder>Vertosol</ASCOrder>
        <ASCSubOrder />
        <SoilType>Clay</SoilType>
        <LocalName />
        <Site>Generic-Qld</Site>
        <NearestTown />
        <Region />
        <State>Generic</State>
        <Country>Australia</Country>
        <NaturalVegetation>NA</NaturalVegetation>
        <ApsoilNumber>523-GENERIC</ApsoilNumber>
        <Latitude>-27.183286</Latitude>
        <Longitude>151.263748</Longitude>
        <LocationAccuracy>Regional Soil Type</LocationAccuracy>
        <YearOfSampling>0</YearOfSampling>
        <DataSource>Generic soil. CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
        <Comments>Generic soil developed by Allan Peake. 'Typical Vertosol' soil properties have been calculated as the average of vertosols with similar characteristics from within the Apsoil database. Groupings were made on the basis of bulk density. Measured BD, DUL and CLL for the groups were then averaged to derive the characteristics of the typical Vertosols. They can then be used in conjunction with measured soil water to simplify the selection of appropriate Vertosols, for paddocks where full soil characterisations have not yet been completed. For more information see Peake et al. 2010: A rapid method for estimating the plant available water capacity of Vertosols, 2010 Australian Agronomy Conference. Typical Vertosols are different to 'Generic' soil types elsewhere in the Apsoil database, which are representative of certain soil types and districts, but have not been calculated from large numbers of similar, characterised soils.

</Comments>
        <Water>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <BD>
            <double>1.59</double>
            <double>1.62</double>
            <double>1.59</double>
            <double>1.58</double>
            <double>1.61</double>
            <double>1.64</double>
            <double>1.7</double>
          </BD>
          <AirDry>
            <double>0.089</double>
            <double>0.14</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </AirDry>
          <LL15>
            <double>0.177</double>
            <double>0.175</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
            <double>0.19</double>
          </LL15>
          <DUL>
            <double>0.32</double>
            <double>0.308</double>
            <double>0.321</double>
            <double>0.322</double>
            <double>0.312</double>
            <double>0.301</double>
            <double>0.28</double>
          </DUL>
          <SAT>
            <double>0.37</double>
            <double>0.358</double>
            <double>0.371</double>
            <double>0.372</double>
            <double>0.362</double>
            <double>0.351</double>
            <double>0.329</double>
          </SAT>
          <BDMetadata>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
            <string>Calculated from gravimetric moisture when profile wet but drained</string>
          </BDMetadata>
          <AirDryMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </AirDryMetadata>
          <LL15Metadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </LL15Metadata>
          <DULMetadata>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
            <string>FM &amp; E</string>
          </DULMetadata>
          <SATMetadata>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
            <string>Calculated from measured, estimated or calculated BD</string>
          </SATMetadata>
          <SoilCrop name="wheat">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="lentil">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.06</double>
              <double>0.04</double>
              <double>0.04</double>
              <double>0.02</double>
              <double>0.02</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="cotton">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.1</double>
              <double>0.09</double>
              <double>0.07</double>
              <double>0.05</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
          <SoilCrop name="sorghum">
            <Thickness>
              <double>150</double>
              <double>150</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
              <double>300</double>
            </Thickness>
            <LL>
              <double>0.177</double>
              <double>0.175</double>
              <double>0.19</double>
              <double>0.22</double>
              <double>0.251</double>
              <double>0.278</double>
              <double>0.28</double>
            </LL>
            <KL>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.07</double>
              <double>0.05</double>
              <double>0.05</double>
              <double>0.04</double>
              <double>0.03</double>
            </KL>
            <XF>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
              <double>1</double>
            </XF>
            <LLMetadata>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
              <string>Field measured and checked for sensibility</string>
            </LLMetadata>
          </SoilCrop>
        </Water>
        <SoilWater>
          <SummerCona>3.5</SummerCona>
          <SummerU>6</SummerU>
          <SummerDate>1-Nov</SummerDate>
          <WinterCona>2.5</WinterCona>
          <WinterU>4</WinterU>
          <WinterDate>1-Apr</WinterDate>
          <DiffusConst>40</DiffusConst>
          <DiffusSlope>16</DiffusSlope>
          <Salb>0.13</Salb>
          <CN2Bare>73</CN2Bare>
          <CNRed>20</CNRed>
          <CNCov>0.8</CNCov>
          <Slope>NaN</Slope>
          <DischargeWidth>NaN</DischargeWidth>
          <CatchmentArea>NaN</CatchmentArea>
          <MaxPond>NaN</MaxPond>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <SWCON>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
            <double>0.3</double>
          </SWCON>
        </SoilWater>
        <SoilOrganicMatter>
          <RootCN>40</RootCN>
          <RootWt>1000</RootWt>
          <SoilCN>12</SoilCN>
          <EnrACoeff>7.4</EnrACoeff>
          <EnrBCoeff>0.2</EnrBCoeff>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <OC>
            <double>0.9</double>
            <double>0.72</double>
            <double>0.45</double>
            <double>0.225</double>
            <double>0.135</double>
            <double>0.09</double>
            <double>0.09</double>
          </OC>
          <OCMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </OCMetadata>
          <FBiom>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
            <double>0.01</double>
          </FBiom>
          <FInert>
            <double>0.4</double>
            <double>0.6</double>
            <double>0.8</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </FInert>
          <OCUnits>WalkleyBlack</OCUnits>
        </SoilOrganicMatter>
        <Analysis>
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <PH>
            <double>8.1</double>
            <double>8.7</double>
            <double>8.9</double>
            <double>8</double>
            <double>7</double>
            <double>6.4</double>
            <double>5.8</double>
          </PH>
          <PHMetadata>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
            <string>Estimated based on local knowledge</string>
          </PHMetadata>
          <PHUnits>Water</PHUnits>
          <BoronUnits>HotWater</BoronUnits>
        </Analysis>
        <Sample name="Initial Conditions">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <NO3>
            <double>21</double>
            <double>7</double>
            <double>3.5</double>
            <double>3.5</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NO3>
          <NH4>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
            <double>0</double>
          </NH4>
          <SW>
            <double>0.199</double>
            <double>0.282</double>
            <double>0.304</double>
            <double>0.303</double>
            <double>0.297</double>
            <double>0.297</double>
            <double>0.297</double>
          </SW>
          <NO3Units>kgha</NO3Units>
          <NH4Units>kgha</NH4Units>
          <SWUnits>Volumetric</SWUnits>
          <OCUnits>Total</OCUnits>
          <PHUnits>Water</PHUnits>
        </Sample>
      </Soil>
    </area>
  </simulation>
</folder>