<folder version="37" creator="Apsim 7.9-r4041" name="Apsim Training">
  <folder name="Soils">
    <Soil name="Sand">
      <RecordNumber>0</RecordNumber>
      <SoilType>Yellow sandy earth _464 ASC</SoilType>
      <Site>Kellerberrin</Site>
      <NearestTown>Kellerberrin</NearestTown>
      <Region>Central Region_North Avon</Region>
      <State>Western Australia</State>
      <Country>Australia</Country>
      <ApsoilNumber>410</ApsoilNumber>
      <Latitude>-31.459</Latitude>
      <Longitude>117.751</Longitude>
      <LocationAccuracy>+/- 20m</LocationAccuracy>
      <YearOfSampling>0</YearOfSampling>
      <DataSource>CSIRO Yvetter Oliver _ GRDC funded project Province Paddock Patch</DataSource>
      <Comments>Soil Qualifier : good acid subsoil Forsyth farmer</Comments>
      <Water>
        <SoilCrop name="wheat">
          <Thickness>
            <double>100</double>
            <double>100</double>
            <double>100</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.05</double>
            <double>0.063</double>
            <double>0.065</double>
            <double>0.066</double>
            <double>0.072</double>
            <double>0.075</double>
            <double>0.077</double>
            <double>0.08</double>
            <double>0.086</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.01</double>
            <double>0.01</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <Thickness>
          <double>100</double>
          <double>100</double>
          <double>100</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <BD>
          <double>1.6</double>
          <double>1.6</double>
          <double>1.6</double>
          <double>1.6</double>
          <double>1.6</double>
          <double>1.6</double>
          <double>1.6</double>
          <double>1.6</double>
          <double>1.6</double>
        </BD>
        <AirDry>
          <double>0.025</double>
          <double>0.05</double>
          <double>0.065</double>
          <double>0.066</double>
          <double>0.066</double>
          <double>0.066</double>
          <double>0.066</double>
          <double>0.066</double>
          <double>0.066</double>
        </AirDry>
        <LL15>
          <double>0.05</double>
          <double>0.063</double>
          <double>0.065</double>
          <double>0.066</double>
          <double>0.066</double>
          <double>0.066</double>
          <double>0.066</double>
          <double>0.066</double>
          <double>0.066</double>
        </LL15>
        <DUL>
          <double>0.12</double>
          <double>0.13</double>
          <double>0.13</double>
          <double>0.13</double>
          <double>0.13</double>
          <double>0.13</double>
          <double>0.13</double>
          <double>0.13</double>
          <double>0.13</double>
        </DUL>
        <SAT>
          <double>0.37</double>
          <double>0.37</double>
          <double>0.37</double>
          <double>0.37</double>
          <double>0.37</double>
          <double>0.37</double>
          <double>0.37</double>
          <double>0.37</double>
          <double>0.37</double>
        </SAT>
      </Water>
      <SoilWater>
        <SummerCona>3.5</SummerCona>
        <SummerU>6</SummerU>
        <SummerDate>1-Nov</SummerDate>
        <WinterCona>2</WinterCona>
        <WinterU>2</WinterU>
        <WinterDate>1-Apr</WinterDate>
        <DiffusConst>88</DiffusConst>
        <DiffusSlope>35</DiffusSlope>
        <Salb>0.13</Salb>
        <CN2Bare>60</CN2Bare>
        <CNRed>20</CNRed>
        <CNCov>0.8</CNCov>
        <Slope>0</Slope>
        <DischargeWidth>0</DischargeWidth>
        <CatchmentArea>0</CatchmentArea>
        <MaxPond>0</MaxPond>
        <Thickness>
          <double>100</double>
          <double>100</double>
          <double>100</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <SWCON>
          <double>0.5</double>
          <double>0.5</double>
          <double>0.5</double>
          <double>0.5</double>
          <double>0.5</double>
          <double>0.5</double>
          <double>0.5</double>
          <double>0.5</double>
          <double>0.5</double>
        </SWCON>
        <MWCON>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
        </MWCON>
      </SoilWater>
      <SoilOrganicMatter>
        <RootCN>40</RootCN>
        <RootWt>1000</RootWt>
        <SoilCN>12</SoilCN>
        <EnrACoeff>7.4</EnrACoeff>
        <EnrBCoeff>0.2</EnrBCoeff>
        <Thickness>
          <double>100</double>
          <double>100</double>
          <double>100</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <OC>
          <double>0.9</double>
          <double>0.49</double>
          <double>0.25</double>
          <double>0.2</double>
          <double>0.15</double>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </OC>
        <OCMetadata>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
        </OCMetadata>
        <FBiom>
          <double>0.04</double>
          <double>0.03</double>
          <double>0.02</double>
          <double>0.02</double>
          <double>0.02</double>
          <double>0.01</double>
          <double>0.01</double>
          <double>0.01</double>
          <double>0.01</double>
        </FBiom>
        <FInert>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.2</double>
          <double>0.8</double>
          <double>0.8</double>
          <double>0.9</double>
          <double>0.9</double>
          <double>0.9</double>
        </FInert>
      </SoilOrganicMatter>
      <Analysis>
        <Thickness>
          <double>100</double>
          <double>100</double>
          <double>100</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <PH>
          <double>5.5</double>
          <double>4.8</double>
          <double>5</double>
          <double>5.5</double>
          <double>6.2</double>
          <double>6.4</double>
          <double>6.3</double>
          <double>6.3</double>
          <double>6.4</double>
        </PH>
        <PHMetadata>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
          <string>Unknown source or quality of data</string>
        </PHMetadata>
      </Analysis>
      <InitialWater>
        <FractionFull>1</FractionFull>
        <PercentMethod>FilledFromTop</PercentMethod>
      </InitialWater>
      <Sample name="Initial nitrogen">
        <Date type="date" description="Sample date:" />
        <Thickness>
          <double>100</double>
        </Thickness>
        <NO3>
          <double>0</double>
        </NO3>
        <NH4>
          <double>0</double>
        </NH4>
        <SW>
          <double>0</double>
        </SW>
      </Sample>
    </Soil>
    <Soil name="Heavy Clay">
      <RecordNumber>0</RecordNumber>
      <SoilType>Generic Vertosol</SoilType>
      <Site>Generic</Site>
      <NearestTown>Toowoomba</NearestTown>
      <Region>Darling Downs and Granite Belt</Region>
      <State>Queensland</State>
      <Country>Australia</Country>
      <Latitude>-27.564333</Latitude>
      <Longitude>151.953991</Longitude>
      <LocationAccuracy>Regional Soil Type</LocationAccuracy>
      <YearOfSampling>0</YearOfSampling>
      <DataSource>YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
      <Comments>Generic soil developed by Allan Peake.</Comments>
      <Water>
        <SoilCrop name="wheat">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.27</double>
            <double>0.28</double>
            <double>0.29</double>
            <double>0.3</double>
            <double>0.31</double>
            <double>0.32</double>
            <double>0.33</double>
          </LL>
          <KL>
            <double>0.06</double>
            <double>0.06</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.04</double>
            <double>0.02</double>
            <double>0.02</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <SoilCrop name="sorghum">
          <Thickness>
            <double>150</double>
            <double>150</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
            <double>300</double>
          </Thickness>
          <LL>
            <double>0.27</double>
            <double>0.28</double>
            <double>0.29</double>
            <double>0.3</double>
            <double>0.31</double>
            <double>0.32</double>
            <double>0.33</double>
          </LL>
          <KL>
            <double>0.07</double>
            <double>0.07</double>
            <double>0.07</double>
            <double>0.05</double>
            <double>0.04</double>
            <double>0.03</double>
            <double>0.02</double>
          </KL>
          <XF>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
            <double>1</double>
          </XF>
        </SoilCrop>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <BD>
          <double>1.05</double>
          <double>1.08</double>
          <double>1.12</double>
          <double>1.15</double>
          <double>1.18</double>
          <double>1.21</double>
          <double>1.25</double>
        </BD>
        <AirDry>
          <double>0.135</double>
          <double>0.196</double>
          <double>0.232</double>
          <double>0.27</double>
          <double>0.279</double>
          <double>0.288</double>
          <double>0.297</double>
        </AirDry>
        <LL15>
          <double>0.27</double>
          <double>0.28</double>
          <double>0.29</double>
          <double>0.3</double>
          <double>0.31</double>
          <double>0.32</double>
          <double>0.33</double>
        </LL15>
        <DUL>
          <double>0.51</double>
          <double>0.5</double>
          <double>0.49</double>
          <double>0.48</double>
          <double>0.47</double>
          <double>0.46</double>
          <double>0.45</double>
        </DUL>
        <SAT>
          <double>0.574</double>
          <double>0.562</double>
          <double>0.547</double>
          <double>0.536</double>
          <double>0.525</double>
          <double>0.513</double>
          <double>0.498</double>
        </SAT>
      </Water>
      <SoilWater>
        <SummerCona>3.5</SummerCona>
        <SummerU>6</SummerU>
        <SummerDate>1-Nov</SummerDate>
        <WinterCona>2.5</WinterCona>
        <WinterU>4</WinterU>
        <WinterDate>1-apr</WinterDate>
        <DiffusConst>40</DiffusConst>
        <DiffusSlope>16</DiffusSlope>
        <Salb>0.13</Salb>
        <CN2Bare>73</CN2Bare>
        <CNRed>20</CNRed>
        <CNCov>0.8</CNCov>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <SWCON>
          <double>0.3</double>
          <double>0.3</double>
          <double>0.3</double>
          <double>0.3</double>
          <double>0.3</double>
          <double>0.3</double>
          <double>0.3</double>
        </SWCON>
      </SoilWater>
      <SoilOrganicMatter>
        <RootCN>40</RootCN>
        <RootWt>1000</RootWt>
        <SoilCN>12</SoilCN>
        <EnrACoeff>7.4</EnrACoeff>
        <EnrBCoeff>0.2</EnrBCoeff>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <OC>
          <double>1</double>
          <double>0.5</double>
          <double>0.25</double>
          <double>0.2</double>
          <double>0.1</double>
          <double>0.1</double>
          <double>0.1</double>
        </OC>
        <FBiom>
          <double>0.02</double>
          <double>0.02</double>
          <double>0.01</double>
          <double>0.01</double>
          <double>0.01</double>
          <double>0.01</double>
          <double>0.01</double>
        </FBiom>
        <FInert>
          <double>0.4</double>
          <double>0.6</double>
          <double>0.8</double>
          <double>0.9</double>
          <double>1</double>
          <double>1</double>
          <double>1</double>
        </FInert>
      </SoilOrganicMatter>
      <Analysis>
        <Thickness>
          <double>150</double>
          <double>150</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
          <double>300</double>
        </Thickness>
        <EC>
          <double>0.1</double>
          <double>0.2</double>
          <double>0.2</double>
          <double>0.3</double>
          <double>0.4</double>
          <double>0.5</double>
          <double>0.6</double>
        </EC>
        <PH>
          <double>8.5</double>
          <double>8.7</double>
          <double>8.5</double>
          <double>8</double>
          <double>7</double>
          <double>6</double>
          <double>5</double>
        </PH>
        <CL>
          <double>20</double>
          <double>40</double>
          <double>70</double>
          <double>110</double>
          <double>160</double>
          <double>220</double>
          <double>300</double>
        </CL>
        <ESP>
          <double>1</double>
          <double>2</double>
          <double>3</double>
          <double>5</double>
          <double>8</double>
          <double>12</double>
          <double>15</double>
        </ESP>
      </Analysis>
      <InitialWater>
        <FractionFull>1</FractionFull>
        <PercentMethod>FilledFromTop</PercentMethod>
      </InitialWater>
      <Sample name="Initial nitrogen">
        <Date type="date" description="Sample date:" />
        <Thickness>
          <double>100</double>
        </Thickness>
        <NO3>
          <double>0</double>
        </NO3>
        <NH4>
          <double>0</double>
        </NH4>
        <SW>
          <double>0</double>
        </SW>
      </Sample>
    </Soil>
  </folder>
  <folder name="Completed Exercises">
    <folder name="Module 1">
      <simulation name="Clay Fallow">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1989</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1989</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <outputfile>
            <filename output="yes">Clay Fallow.out</filename>
            <title>Clay Fallow</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>day</variable>
              <variable>year</variable>
              <variable>rain</variable>
              <variable>esw</variable>
              <variable>es</variable>
              <variable>runoff</variable>
              <variable>drain</variable>
              <variable>no3()</variable>
              <variable>dlt_n_min()</variable>
              <variable>surfaceom_wt</variable>
              <variable>surfaceom_cover</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>end_day</event>
            </events>
            <Graph name="ESW">
              <Legend>
                <CheckedTitles> esw</CheckedTitles>
                <CheckedTitles> rain</CheckedTitles>
              </Legend>
              <Plot>
                <SeriesType>Solid line</SeriesType>
                <PointType>None</PointType>
                <colour>
                </colour>
                <X>Date</X>
                <Y>esw</Y>
                <YRight>rain</YRight>
                <GDApsimFileReader name="ApsimFileReader" />
              </Plot>
            </Graph>
            <Graph name="Runoff">
              <Legend>
                <CheckedTitles> runoff</CheckedTitles>
                <CheckedTitles> rain</CheckedTitles>
              </Legend>
              <Plot>
                <SeriesType>Dot line</SeriesType>
                <PointType>None</PointType>
                <colour>
                </colour>
                <X>Date</X>
                <YRight>rain</YRight>
                <Y>runoff</Y>
                <GDApsimFileReader name="ApsimFileReader" />
              </Plot>
            </Graph>
          </outputfile>
          <Soil name="Heavy Clay">
            <SoilType description="Soil description">Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown description="Nearest town">Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude description="Latitude (WGS84)">-27.564333</Latitude>
            <Longitude description="Longitude (WGS84)">151.953991</Longitude>
            <LocationAccuracy description="Location accuracy">Regional Soil Type</LocationAccuracy>
            <DataSource type="multiedit" description="Data source">YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments type="multiedit" description="Comments">Generic soil developed by Allan Peake.</Comments>
            <Water>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <RelativeTo>ll15</RelativeTo>
              <FractionFull>0.1</FractionFull>
              <PercentMethod>FilledFromTop</PercentMethod>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Thickness>
                <double>100</double>
              </Thickness>
              <NO3>
                <double>50</double>
              </NO3>
              <NH4>
                <double>3</double>
              </NH4>
              <SW>
                <double>0</double>
              </SW>
              <NO3Units>kgha</NO3Units>
              <NH4Units>kgha</NH4Units>
              <SWUnits>Volumetric</SWUnits>
              <OCUnits>Total</OCUnits>
              <PHUnits>Water</PHUnits>
            </Sample>
          </Soil>
        </area>
      </simulation>
      <simulation name="Sand Fallow">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1989</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1989</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <outputfile>
            <filename output="yes">Sand Fallow.out</filename>
            <title>Sand Fallow</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>day</variable>
              <variable>year</variable>
              <variable>rain</variable>
              <variable>esw</variable>
              <variable>es</variable>
              <variable>runoff</variable>
              <variable>drain</variable>
              <variable>no3()</variable>
              <variable>dlt_n_min()</variable>
              <variable>surfaceom_wt</variable>
              <variable>surfaceom_cover</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>end_day</event>
            </events>
            <Graph name="XY">
              <Legend>
                <CheckedTitles> esw</CheckedTitles>
                <CheckedTitles> rain</CheckedTitles>
              </Legend>
              <Plot>
                <SeriesType>Solid line</SeriesType>
                <PointType>None</PointType>
                <colour>
                </colour>
                <X>Date</X>
                <Y>esw</Y>
                <YRight>rain</YRight>
                <GDApsimFileReader name="ApsimFileReader" />
              </Plot>
            </Graph>
            <Graph name="XY1">
              <Legend>
                <CheckedTitles> runoff</CheckedTitles>
                <CheckedTitles> rain</CheckedTitles>
              </Legend>
              <Plot>
                <SeriesType>Dot line</SeriesType>
                <PointType>None</PointType>
                <colour>
                </colour>
                <X>Date</X>
                <YRight>rain</YRight>
                <Y>runoff</Y>
                <GDApsimFileReader name="ApsimFileReader" />
              </Plot>
            </Graph>
          </outputfile>
          <Soil name="Sand">
            <RecordNumber>0</RecordNumber>
            <SoilType>Yellow sandy earth _464 ASC</SoilType>
            <Site>Kellerberrin</Site>
            <NearestTown>Kellerberrin</NearestTown>
            <Region>Central Region_North Avon</Region>
            <State>Western Australia</State>
            <Country>Australia</Country>
            <ApsoilNumber>410</ApsoilNumber>
            <Latitude>-31.459</Latitude>
            <Longitude>117.751</Longitude>
            <LocationAccuracy>+/- 20m</LocationAccuracy>
            <DataSource>CSIRO Yvetter Oliver _ GRDC funded project Province Paddock Patch</DataSource>
            <Comments>Soil Qualifier : good acid subsoil Forsyth farmer</Comments>
            <Water>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>100</double>
                  <double>100</double>
                  <double>100</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.05</double>
                  <double>0.063</double>
                  <double>0.065</double>
                  <double>0.066</double>
                  <double>0.072</double>
                  <double>0.075</double>
                  <double>0.077</double>
                  <double>0.08</double>
                  <double>0.086</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.01</double>
                  <double>0.01</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <Thickness>
                <double>100</double>
                <double>100</double>
                <double>100</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.6</double>
                <double>1.6</double>
                <double>1.6</double>
                <double>1.6</double>
                <double>1.6</double>
                <double>1.6</double>
                <double>1.6</double>
                <double>1.6</double>
                <double>1.6</double>
              </BD>
              <AirDry>
                <double>0.025</double>
                <double>0.05</double>
                <double>0.065</double>
                <double>0.066</double>
                <double>0.066</double>
                <double>0.066</double>
                <double>0.066</double>
                <double>0.066</double>
                <double>0.066</double>
              </AirDry>
              <LL15>
                <double>0.05</double>
                <double>0.063</double>
                <double>0.065</double>
                <double>0.066</double>
                <double>0.066</double>
                <double>0.066</double>
                <double>0.066</double>
                <double>0.066</double>
                <double>0.066</double>
              </LL15>
              <DUL>
                <double>0.12</double>
                <double>0.13</double>
                <double>0.13</double>
                <double>0.13</double>
                <double>0.13</double>
                <double>0.13</double>
                <double>0.13</double>
                <double>0.13</double>
                <double>0.13</double>
              </DUL>
              <SAT>
                <double>0.37</double>
                <double>0.37</double>
                <double>0.37</double>
                <double>0.37</double>
                <double>0.37</double>
                <double>0.37</double>
                <double>0.37</double>
                <double>0.37</double>
                <double>0.37</double>
              </SAT>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2</WinterCona>
              <WinterU>2</WinterU>
              <WinterDate>1-Apr</WinterDate>
              <DiffusConst>88</DiffusConst>
              <DiffusSlope>35</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>60</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>100</double>
                <double>100</double>
                <double>100</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.5</double>
                <double>0.5</double>
                <double>0.5</double>
                <double>0.5</double>
                <double>0.5</double>
                <double>0.5</double>
                <double>0.5</double>
                <double>0.5</double>
                <double>0.5</double>
              </SWCON>
              <MWCON>
                <double>1</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </MWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>100</double>
                <double>100</double>
                <double>100</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>0.9</double>
                <double>0.49</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.15</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <OCMetadata>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
              </OCMetadata>
              <FBiom>
                <double>0.04</double>
                <double>0.03</double>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.8</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>0.9</double>
                <double>0.9</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>100</double>
                <double>100</double>
                <double>100</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <PH>
                <double>5.5</double>
                <double>4.8</double>
                <double>5</double>
                <double>5.5</double>
                <double>6.2</double>
                <double>6.4</double>
                <double>6.3</double>
                <double>6.3</double>
                <double>6.4</double>
              </PH>
              <PHMetadata>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
                <string>Unknown source or quality of data</string>
              </PHMetadata>
            </Analysis>
            <InitialWater>
              <FractionFull>1</FractionFull>
              <PercentMethod>FilledFromTop</PercentMethod>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Thickness>
                <double>1800</double>
              </Thickness>
              <NO3>
                <double>0</double>
              </NO3>
              <NH4>
                <double>3</double>
              </NH4>
              <SW>
                <double>0</double>
              </SW>
              <NO3Units>kgha</NO3Units>
              <NH4Units>kgha</NH4Units>
              <SWUnits>Volumetric</SWUnits>
              <OCUnits>Total</OCUnits>
              <PHUnits>Water</PHUnits>
            </Sample>
          </Soil>
        </area>
      </simulation>
      <Graph name="Runoff">
        <Legend>
        </Legend>
        <Plot>
          <SeriesType>Solid line</SeriesType>
          <PointType>None</PointType>
          <colour>
          </colour>
          <Y>Cumulative runoff</Y>
          <YRight>rain</YRight>
          <X>day</X>
          <GDApsimFileReader name="ApsimFileReader" />
        </Plot>
      </Graph>
    </folder>
    <folder name="Module 2">
      <simulation name="Clay Fallow">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1989</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1989</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <outputfile>
            <filename output="yes">Clay Fallow.out</filename>
            <title>Clay Fallow</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>day</variable>
              <variable>year</variable>
              <variable>rain</variable>
              <variable>esw</variable>
              <variable>es</variable>
              <variable>runoff</variable>
              <variable>drain</variable>
              <variable>no3()</variable>
              <variable>dlt_n_min()</variable>
              <variable>surfaceom_wt</variable>
              <variable>surfaceom_cover</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>end_day</event>
            </events>
          </outputfile>
          <Soil name="Heavy Clay">
            <SoilType description="Soil description">Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown description="Nearest town">Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude description="Latitude (WGS84)">-27.564333</Latitude>
            <Longitude description="Longitude (WGS84)">151.953991</Longitude>
            <LocationAccuracy description="Location accuracy">Regional Soil Type</LocationAccuracy>
            <DataSource type="multiedit" description="Data source">YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments type="multiedit" description="Comments">Generic soil developed by Allan Peake.</Comments>
            <Water>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <RelativeTo>ll15</RelativeTo>
              <FractionFull>0.1</FractionFull>
              <PercentMethod>FilledFromTop</PercentMethod>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Date type="date" description="Sample date:" />
              <Thickness>
                <double>1800</double>
              </Thickness>
              <NO3>
                <double>50.34</double>
              </NO3>
              <NO3Units>kgha</NO3Units>
              <NH4>
                <double>3.23</double>
              </NH4>
              <NH4Units>kgha</NH4Units>
              <SW>
                <double>0</double>
              </SW>
            </Sample>
          </Soil>
        </area>
      </simulation>
      <simulation name="Clay Residue">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1989</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1989</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">3000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <outputfile>
            <filename output="yes">Clay Residue.out</filename>
            <title>Clay Residue</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>day</variable>
              <variable>year</variable>
              <variable>rain</variable>
              <variable>esw</variable>
              <variable>es</variable>
              <variable>runoff</variable>
              <variable>drain</variable>
              <variable>no3()</variable>
              <variable>dlt_n_min()</variable>
              <variable>surfaceom_wt</variable>
              <variable>surfaceom_cover</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>end_day</event>
            </events>
          </outputfile>
          <Soil name="Heavy Clay">
            <SoilType description="Soil description">Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown description="Nearest town">Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude description="Latitude (WGS84)">-27.564333</Latitude>
            <Longitude description="Longitude (WGS84)">151.953991</Longitude>
            <LocationAccuracy description="Location accuracy">Regional Soil Type</LocationAccuracy>
            <DataSource type="multiedit" description="Data source">YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments type="multiedit" description="Comments">Generic soil developed by Allan Peake.</Comments>
            <Water>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <RelativeTo>ll15</RelativeTo>
              <FractionFull>0.1</FractionFull>
              <PercentMethod>FilledFromTop</PercentMethod>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Date type="date" description="Sample date:" />
              <Thickness>
                <double>1800</double>
              </Thickness>
              <NO3>
                <double>50.34</double>
              </NO3>
              <NO3Units>kgha</NO3Units>
              <NH4>
                <double>3.23</double>
              </NH4>
              <NH4Units>kgha</NH4Units>
              <SW>
                <double>0</double>
              </SW>
            </Sample>
          </Soil>
          <Graph name="XY">
            <Legend>
              <CheckedTitles> surfaceom_cover</CheckedTitles>
              <CheckedTitles> rain</CheckedTitles>
            </Legend>
            <Plot>
              <SeriesType>Solid line</SeriesType>
              <PointType>None</PointType>
              <colour>
              </colour>
              <X>Date</X>
              <Y>surfaceom_cover</Y>
              <YRight>rain</YRight>
              <GDApsimFileReader name="ApsimFileReader" />
            </Plot>
          </Graph>
        </area>
      </simulation>
      <simulation name="Clay Chickpea Residue">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1989</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1989</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">chickpea</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">chickpea</type>
            <mass type="text" description="Initial surface residue (kg/ha)">3000</mass>
            <cnr type="text" description="C:N ratio of initial residue">25</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <outputfile>
            <filename output="yes">Clay Chickpea Residue.out</filename>
            <title>Clay Chickpea Residue</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>day</variable>
              <variable>year</variable>
              <variable>rain</variable>
              <variable>esw</variable>
              <variable>es</variable>
              <variable>runoff</variable>
              <variable>drain</variable>
              <variable>no3()</variable>
              <variable>dlt_n_min()</variable>
              <variable>surfaceom_wt</variable>
              <variable>surfaceom_cover</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>end_day</event>
            </events>
            <Graph name="XY">
              <Legend>
                <CheckedTitles> esw</CheckedTitles>
                <CheckedTitles> rain</CheckedTitles>
              </Legend>
              <Plot>
                <SeriesType>Solid line</SeriesType>
                <PointType>None</PointType>
                <colour>
                </colour>
                <X>Date</X>
                <Y>esw</Y>
                <YRight>rain</YRight>
                <GDApsimFileReader name="ApsimFileReader" />
              </Plot>
            </Graph>
            <Graph name="XY1">
              <Legend>
                <CheckedTitles> runoff</CheckedTitles>
                <CheckedTitles> rain</CheckedTitles>
              </Legend>
              <Plot>
                <SeriesType>Dot line</SeriesType>
                <PointType>None</PointType>
                <colour>
                </colour>
                <X>Date</X>
                <YRight>rain</YRight>
                <Y>runoff</Y>
                <GDApsimFileReader name="ApsimFileReader" />
              </Plot>
            </Graph>
          </outputfile>
          <Soil name="Heavy Clay">
            <SoilType description="Soil description">Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown description="Nearest town">Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude description="Latitude (WGS84)">-27.564333</Latitude>
            <Longitude description="Longitude (WGS84)">151.953991</Longitude>
            <LocationAccuracy description="Location accuracy">Regional Soil Type</LocationAccuracy>
            <DataSource type="multiedit" description="Data source">YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments type="multiedit" description="Comments">Generic soil developed by Allan Peake.</Comments>
            <Water>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <RelativeTo>ll15</RelativeTo>
              <FractionFull>0.1</FractionFull>
              <PercentMethod>FilledFromTop</PercentMethod>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Date type="date" description="Sample date:" />
              <Thickness>
                <double>1800</double>
              </Thickness>
              <NO3>
                <double>50.34</double>
              </NO3>
              <NO3Units>kgha</NO3Units>
              <NH4>
                <double>3.23</double>
              </NH4>
              <NH4Units>kgha</NH4Units>
              <SW>
                <double>0</double>
              </SW>
            </Sample>
          </Soil>
        </area>
      </simulation>
      <Graph name="Runoff">
        <Legend>
          <CheckedTitles> Cumulative runoff, Clay Fallow</CheckedTitles>
          <CheckedTitles> Cumulative runoff, Clay Residue</CheckedTitles>
          <CheckedTitles> rain, Clay Fallow</CheckedTitles>
        </Legend>
        <Plot>
          <SeriesType>Solid line</SeriesType>
          <PointType>None</PointType>
          <colour>
          </colour>
          <X>Date</X>
          <Y>Cumulative runoff</Y>
          <YRight>rain</YRight>
          <GDApsimFileReader name="ApsimFileReader" />
        </Plot>
      </Graph>
      <Graph name="Cover">
        <Legend>
          <CheckedTitles> Clay Fallow</CheckedTitles>
          <CheckedTitles> Clay Residue</CheckedTitles>
          <CheckedTitles> Clay Chickpea Residue</CheckedTitles>
        </Legend>
        <Plot>
          <SeriesType>Solid line</SeriesType>
          <PointType>None</PointType>
          <colour>
          </colour>
          <X>Date</X>
          <Y>surfaceom_cover</Y>
          <GDApsimFileReader name="ApsimFileReader" />
        </Plot>
      </Graph>
    </folder>
    <folder name="Module 3">
      <simulation name="Nitrogen Cycle">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%\Examples\MetFiles\Dalby.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1989</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1989</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <wheat />
          <folder name="Manager folder">
            <manager2 name="Fertilise on fixed date">
              <ui>
                <category type="category" description="When should fertiliser be applied" />
                <fert_date type="ddmmmdate" description="Enter fertiliser date (dd-mmm) : ">10-jan</fert_date>
                <fert_criteria type="text" description="Don't add fertiliser if N in top 2 layers exceeds (kg/ha) : ">1000</fert_criteria>
                <category type="category" description="Fertiliser application details" />
                <fert_amount type="text" description="Amount of fertiliser to apply (kg/ha) : ">100</fert_amount>
                <fert_type type="list" listvalues="NO3_N, NH4_N, NH4NO3, urea_N, urea_no3, urea, nh4so4_n, rock_p, banded_p, broadcast_p" description="Fertiliser type : ">urea_N</fert_type>
              </ui>
              <text>using CSGeneral; 
using ModelFramework;
using System;

// Crop management: Fertilise on a fixed date
// Not Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.

public class Script 
{
   [Link]  public Simulation MyPaddock;
   [Link]  public Fertiliser MyFertiliser;

   [Param] private string fert_date;
   [Param] private float fert_criteria;
   [Param] private float fert_amount;
   [Param] private string fert_type;

   [Input] private DateTime today; 

   [EventHandler] public void OnPrepare()
   {
      if (DateUtility.DatesEqual(fert_date, today))
      {
         float[] NO3 = new float[20];
         float[] NH4 = new float[20];
         MyPaddock.Get("no3", out NO3);
         MyPaddock.Get("nh4", out NH4);
         float N_topsoil = NO3[0] + NO3[1] + NH4[0] + NH4[1];
         if(N_topsoil &lt; fert_criteria){
            MyFertiliser.Apply(fert_amount, 50, fert_type);
         }
      }
   }
}
                            </text>
            </manager2>
          </folder>
          <outputfile>
            <filename output="yes">Nitrogen Cycle.out</filename>
            <title>Nitrogen Cycle</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>day</variable>
              <variable>year</variable>
              <variable>rain</variable>
              <variable>dlayer</variable>
              <variable>drain</variable>
              <variable>esw</variable>
              <variable>no3() as NO3Total</variable>
              <variable>nh4() as NH4Total</variable>
              <variable>no3</variable>
              <variable>nh4</variable>
              <variable>dnit()</variable>
              <variable>urea()</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>end_day</event>
            </events>
            <Graph name="XY">
              <Legend>
                <CheckedTitles> NO3Total</CheckedTitles>
                <CheckedTitles> NH4Total</CheckedTitles>
                <CheckedTitles> urea()</CheckedTitles>
              </Legend>
              <Plot>
                <SeriesType>Solid line</SeriesType>
                <PointType>None</PointType>
                <colour>
                </colour>
                <X>day</X>
                <Y>NO3Total</Y>
                <Y>NH4Total</Y>
                <Y>urea()</Y>
                <GDApsimFileReader name="ApsimFileReader" />
              </Plot>
            </Graph>
            <Graph name="XY1">
              <Legend>
                <CheckedTitles> NO3Total</CheckedTitles>
                <CheckedTitles> rain</CheckedTitles>
                <CheckedTitles> esw</CheckedTitles>
                <CheckedTitles> dnit()</CheckedTitles>
              </Legend>
              <Plot>
                <SeriesType>Solid line</SeriesType>
                <PointType>None</PointType>
                <colour>
                </colour>
                <X>day</X>
                <Y>NO3Total</Y>
                <Y>rain</Y>
                <Y>esw</Y>
                <YRight>dnit()</YRight>
                <GDApsimFileReader name="ApsimFileReader" />
              </Plot>
            </Graph>
          </outputfile>
          <Soil name="Heavy Clay">
            <SoilType>Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown>Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude>-27.564333</Latitude>
            <Longitude>151.953991</Longitude>
            <LocationAccuracy>Regional Soil Type</LocationAccuracy>
            <DataSource>YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments>Generic soil developed by Allan Peake.</Comments>
            <Water>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <FractionFull>0.5</FractionFull>
              <DepthWetSoil>NaN</DepthWetSoil>
              <PercentMethod>EvenlyDistributed</PercentMethod>
              <RelativeTo>ll15</RelativeTo>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Thickness>
                <double>1800</double>
              </Thickness>
              <NO3>
                <double>19</double>
              </NO3>
              <NH4>
                <double>0</double>
              </NH4>
              <SW>
                <double>0</double>
              </SW>
              <NO3Units>kgha</NO3Units>
              <NH4Units>kgha</NH4Units>
              <SWUnits>Volumetric</SWUnits>
              <OCUnits>Total</OCUnits>
            </Sample>
          </Soil>
        </area>
        <Graph name="XY">
          <Legend>
            <CheckedTitles> urea()</CheckedTitles>
            <CheckedTitles> NO3Total</CheckedTitles>
            <CheckedTitles> NH4Total</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>day</X>
            <Y>urea()</Y>
            <Y>NO3Total</Y>
            <Y>NH4Total</Y>
            <GDApsimFileReader name="ApsimFileReader" />
          </Plot>
        </Graph>
        <Graph name="XY1">
          <Legend>
            <CheckedTitles> rain</CheckedTitles>
            <CheckedTitles> esw</CheckedTitles>
            <CheckedTitles> NO3Total</CheckedTitles>
            <CheckedTitles> dnit()</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>day</X>
            <Y>rain</Y>
            <Y>esw</Y>
            <Y>NO3Total</Y>
            <YRight>dnit()</YRight>
            <GDApsimFileReader name="ApsimFileReader" />
          </Plot>
        </Graph>
        <Graph name="Depth">
          <Legend>
            <CheckedTitles> no3,   31/01/1989</CheckedTitles>
            <CheckedTitles> no3,   16/06/1989</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <Y>Depth</Y>
            <colour>
            </colour>
            <XTop>no3</XTop>
            <XTop>nh4</XTop>
            <GDDepth name="Depth">
              <AllXOnTopAxis>Yes</AllXOnTopAxis>
              <Date>31/1/1989</Date>
              <Date>16/6/1989</Date>
              <GDApsimFileReader name="ApsimFileReader" />
            </GDDepth>
          </Plot>
        </Graph>
      </simulation>
    </folder>
    <folder name="Module 4">
      <simulation name="Sorghum Nil Fertiliser">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%\Examples\MetFiles\Dalby.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1988</start_date>
          <end_date type="date" description="Enter the end date of the simulation">30/06/1988</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <Soil name="Heavy Clay">
            <SoilType>Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown>Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude>-27.564333</Latitude>
            <Longitude>151.953991</Longitude>
            <LocationAccuracy>Regional Soil Type</LocationAccuracy>
            <DataSource>YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments>Generic soil developed by Allan Peake.</Comments>
            <Water>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <RelativeTo>ll15</RelativeTo>
              <FractionFull>0.25</FractionFull>
              <PercentMethod>FilledFromTop</PercentMethod>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Date type="date" description="Sample date:" />
              <Thickness>
                <double>1800</double>
              </Thickness>
              <NO3>
                <double>12</double>
              </NO3>
              <NO3Units>kgha</NO3Units>
              <NH4>
                <double>3</double>
              </NH4>
              <NH4Units>kgha</NH4Units>
              <SW>
                <double>0</double>
              </SW>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <sorghum />
          <folder name="Manager folder">
            <manager2 name="Crop Management">
              <ui>
                <category type="category" description="Crop properties" />
                <crop type="crop" description="Name of this crop">sorghum</crop>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm)">1-jan</date1>
                <date3 type="ddmmmdate" description="Enter cultivar change date (na if not in use)">na</date3>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm)">1-jan</date2>
                <must_sow type="yesno" description="Must Sow">yes</must_sow>
                <rain_amount type="text" description="Enter amount of cumulative rainfall (mm)">30</rain_amount>
                <rain_days type="text" description="Enter number of days to accumulate rainfall (days)">3</rain_days>
                <esw_amount type="text" description="Enter amount of soil water (mm)">200</esw_amount>
                <category type="category" description="Sowing Parameters" />
                <cultivar1 type="cultivars" description="Enter cultivar : ">early</cultivar1>
                <cultivar2 type="cultivars" description="Enter 2nd Cultivar (na if not using a second cultivar)">na</cultivar2>
                <density1 type="text" description="Enter sowing density  (plants/m2)">8</density1>
                <depth1 type="text" description="Enter sowing depth  (mm)">30</depth1>
                <row_spacing1 type="text" description="Enter row spacing  (mm)">1000</row_spacing1>
                <category type="category" description="Extra Parameters" />
                <ftn1 type="text" description="Enter Fertile Tiller Number (na for auto) : ">na</ftn1>
                <skiprow1 type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow1>
                <tillageImplement type="text" description="Name of tillage implement (na if not in use): ">na</tillageImplement>
              </ui>
              <text>using System;
using ModelFramework;
using CSGeneral;

// Basic crop management: sowing &amp; harvesting.
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.
// It will assume it is the only crop in the system if it doesnt find a sequencer.
// If it does find a sequencer, it will do nothing until told to (via Enter/Leave).
public class Script 
{      
   [Link()]  public Simulation MySimulation;

   [Param()] private string crop;         // The module name of this crop
   [Param()] private string date1;         //Start of sowing window
   [Param()] private string date2;         //End of sowing window
   [Param()] private string date3;         //date to change to different cultivar
   [Param()] int esw_amount;
   [Param()] private string must_sow;

   [Input()] private DateTime today;

   // Rainfall accumulator
   [Param()] int rain_days;              //check for rain over this period
   [Param()] int rain_amount;            //this much rain over that period

   // Daily rainfall from the system
   [Input] private double rain;
   private ManagerUtility.Tracker&lt;double&gt; rainTracker; 

   private bool inWindow = false;
   private bool endOfWindow = false;
   private bool ChangeCultivar = false;

   //initialise tracker, telling it how many days to track
   [EventHandler] public void OnInitialised()
   {
      rainTracker = new ManagerUtility.Tracker&lt;double&gt;(rain_days); 
   }

   // Daily tests common to all paddocks
   [EventHandler] public void OnPrepare()
   {
      bool startOfWindow = DateUtility.DatesEqual(date1, today);

      inWindow = DateUtility.WithinDates(date1, today, date2);
      ChangeCultivar = false;
      if(date3 != "na")  
         ChangeCultivar = DateUtility.WithinDates(date3, today, date2);
      endOfWindow = DateUtility.DatesEqual(date2, today);

      rainTracker.Add(rain);
      string currentPaddock = "";
      if (MySimulation.Get("currentPaddock", out currentPaddock) == false) 
      {
         // If there is no sequencer plugged in then we are it..
         if (canEnter &gt; 0) {
            OnEnter();
         }
         if (canLeave &gt; 0) {
            OnLeave();
         }
      }
   }
   // Test whether we can sow a crop today
   // +ve number - yes
   // 0          - no
   // -ve number - no, out of scope (planting window)
   [Output, Description("Test whether we can sow a crop today")] public int canEnter  {
      get {
         bool isPossibleToday = false;

         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("1. '" + currentPaddock + "'");

         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Component cropModule = (Component) paddockModule.LinkByName( crop );

         //Console.WriteLine("3. " + cropModule.Name);
         string plantStatus = "";
         cropModule.Get("plant_status", out plantStatus);

         double esw = 0.0;
         Component soilModule = (Component) paddockModule.LinkByType("SoilWat");
         soilModule.Get("esw", out esw);
         if (plantStatus == "out" &amp;&amp;
             inWindow &amp;&amp;
             rainTracker.Sum() &gt;= rain_amount &amp;&amp;
             esw &gt; esw_amount) 
         {
             isPossibleToday = true;
         } 

         if (isPossibleToday)
            return 1;

         if (plantStatus == "out" &amp;&amp; endOfWindow &amp;&amp; must_sow == "yes")
            return 1;

         if (plantStatus == "out" &amp;&amp; !inWindow)
            return -1;

         return 0;
      }
   }  


   // Sow a crop
   [Param()] private string cultivar1;
   [Param()] private string cultivar2;
   [Param()] private double density1;
   [Param()] private double depth1;
   [Param()] private double row_spacing1;
   [Param()] private string ftn1;
   [Param()] private string skiprow1;
   [Param()] private string tillageImplement;

   [EventHandler, Description("Sow the crop")] public void OnEnter()
   {
      Console.WriteLine(today + " Sowing Crop");
      SowType data = new SowType();
      data.Cultivar = cultivar1;
      if(ChangeCultivar)
         data.Cultivar = cultivar2;

      data.plants = density1;
      data.sowing_depth = depth1;
      data.row_spacing = row_spacing1;
      data.tiller_no_fertile = (ftn1 == "na") ? "" : ftn1;
      data.SkipRow = 0 ;
      if (skiprow1 == "single")
         data.SkipRow = 1;
      else if (skiprow1 == "double")
         data.SkipRow = 2;

      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("Sow", data);

      if (tillageImplement.ToLower() != "na") 
      {
         TillageType t = new TillageType();
         t.type = tillageImplement;
         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = MySimulation.ChildPaddocks[0];
         paddockModule.Publish("tillage", t);
      }         
   }

   // Test whether we can harvest a crop today
   // +ve number - yes
   // 0          - no
   // -ve        - out of scope
   [Output] public int canLeave  
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (StageName == "harvest_ripe" || plantStatus == "dead")
            return 1;
         return 0;
      }
   }

   [EventHandler] public void OnLeave()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 0.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);

      KillCropType kdata = new KillCropType();
      kdata.KillFraction = 0.0F;
      cropModule.Publish("killcrop", kdata);
      cropModule.Publish("end_crop");
   } 
}
                            </text>
            </manager2>
            <manager2 name="Fertilise at Sowing">
              <ui>
                <tag type="category" description="When should fertiliser be applied" />
                <ModuleName type="modulename" description="On which module should the event come from: ">sorghum</ModuleName>
                <EventName type="text" description="On which event should spraying be triggered">sowing</EventName>
                <tag type="category" description="Event details" />
                <fertType type="text" description="The type of fertiliser">urea_N</fertType>
                <fertAmt type="text" description="Amount of fertiliser to apply (kg/ha)">0</fertAmt>
              </ui>
              <text>using System;
using System.Linq;
using System.Collections.Generic;
using ModelFramework;

// Crop management: fertilise at sowing
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.

public class Script 
{      
   [Link]  public Simulation MySimulation;
   [Param] string fertType;
   [Param] float fertAmt;
   [Param] string ModuleName;
   [Param] string EventName;

   [EventHandler] public void OnStart_Simulation()
   {
      foreach (Paddock paddock in MySimulation.ChildPaddocks) 
      {
         foreach (Component child in paddock.Children) {
            if(child.Name == ModuleName){
               RuntimeEventHandler.NullFunction curried = () =&gt; OnTrigger(paddock.Name);
               MySimulation.Subscribe(child.FullName + "." + EventName, curried);
               //Console.WriteLine("Subscribed '" + child.FullName + "." + EventName + " =&gt; " + paddock.Name + "'"); 
            }
         }
      }
   }

   public void OnTrigger(string paddock)
   {
      Console.WriteLine("Fertiliser OnTrigger called, paddock='" + paddock + "'"); 
      if (fertAmt &gt; 0) 
      {         
         Component paddockModule;
         if (paddock != "")
            paddockModule = (Component) MySimulation.LinkByName(paddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Fertiliser fertModule = (Fertiliser) paddockModule.LinkByName("Fertiliser");
         fertModule.Apply(fertAmt, 50, fertType);
      }
   }
}
                            </text>
            </manager2>
          </folder>
          <outputfile>
            <filename output="yes">Sorghum Nil Fertiliser.out</filename>
            <title>Sorghum Nil Fertiliser</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>day</variable>
              <variable>year</variable>
              <variable>dlayer</variable>
              <variable>sw</variable>
              <variable>DaysAfterSowing</variable>
              <variable>lai</variable>
              <variable>biomass</variable>
              <variable>yield</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>end_day</event>
            </events>
            <Graph name="XY">
              <Plot>
                <SeriesType>Solid line</SeriesType>
                <PointType>Circle</PointType>
                <colour>
                </colour>
                <X>Date</X>
                <Y>biomass</Y>
                <Y>yield</Y>
                <GDApsimFileReader name="ApsimFileReader" />
              </Plot>
            </Graph>
          </outputfile>
        </area>
      </simulation>
      <simulation name="Sorghum 30kg N Fertiliser">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%\Examples\MetFiles\Dalby.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1988</start_date>
          <end_date type="date" description="Enter the end date of the simulation">30/06/1988</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <Soil name="Heavy Clay">
            <SoilType>Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown>Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude>-27.564333</Latitude>
            <Longitude>151.953991</Longitude>
            <LocationAccuracy>Regional Soil Type</LocationAccuracy>
            <DataSource>YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments>Generic soil developed by Allan Peake.</Comments>
            <Water>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <RelativeTo>ll15</RelativeTo>
              <FractionFull>0.25</FractionFull>
              <PercentMethod>FilledFromTop</PercentMethod>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Date type="date" description="Sample date:" />
              <Thickness>
                <double>1800</double>
              </Thickness>
              <NO3>
                <double>12</double>
              </NO3>
              <NO3Units>kgha</NO3Units>
              <NH4>
                <double>3</double>
              </NH4>
              <NH4Units>kgha</NH4Units>
              <SW>
                <double>0</double>
              </SW>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <sorghum />
          <folder name="Manager folder">
            <manager2 name="Crop Management">
              <ui>
                <category type="category" description="Crop properties" />
                <crop type="crop" description="Name of this crop">sorghum</crop>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm)">1-jan</date1>
                <date3 type="ddmmmdate" description="Enter cultivar change date (na if not in use)">na</date3>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm)">1-jan</date2>
                <must_sow type="yesno" description="Must Sow">yes</must_sow>
                <rain_amount type="text" description="Enter amount of cumulative rainfall (mm)">30</rain_amount>
                <rain_days type="text" description="Enter number of days to accumulate rainfall (days)">3</rain_days>
                <esw_amount type="text" description="Enter amount of soil water (mm)">200</esw_amount>
                <category type="category" description="Sowing Parameters" />
                <cultivar1 type="cultivars" description="Enter cultivar : ">early</cultivar1>
                <cultivar2 type="cultivars" description="Enter 2nd Cultivar (na if not using a second cultivar)">na</cultivar2>
                <density1 type="text" description="Enter sowing density  (plants/m2)">8</density1>
                <depth1 type="text" description="Enter sowing depth  (mm)">30</depth1>
                <row_spacing1 type="text" description="Enter row spacing  (mm)">1000</row_spacing1>
                <category type="category" description="Extra Parameters" />
                <ftn1 type="text" description="Enter Fertile Tiller Number (na for auto) : ">na</ftn1>
                <skiprow1 type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow1>
                <tillageImplement type="text" description="Name of tillage implement (na if not in use): ">na</tillageImplement>
              </ui>
              <text>using System;
using ModelFramework;
using CSGeneral;

// Basic crop management: sowing &amp; harvesting.
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.
// It will assume it is the only crop in the system if it doesnt find a sequencer.
// If it does find a sequencer, it will do nothing until told to (via Enter/Leave).
public class Script 
{      
   [Link()]  public Simulation MySimulation;

   [Param()] private string crop;         // The module name of this crop
   [Param()] private string date1;         //Start of sowing window
   [Param()] private string date2;         //End of sowing window
   [Param()] private string date3;         //date to change to different cultivar
   [Param()] int esw_amount;
   [Param()] private string must_sow;

   [Input()] private DateTime today;

   // Rainfall accumulator
   [Param()] int rain_days;              //check for rain over this period
   [Param()] int rain_amount;            //this much rain over that period

   // Daily rainfall from the system
   [Input] private double rain;
   private ManagerUtility.Tracker&lt;double&gt; rainTracker; 

   private bool inWindow = false;
   private bool endOfWindow = false;
   private bool ChangeCultivar = false;

   //initialise tracker, telling it how many days to track
   [EventHandler] public void OnInitialised()
   {
      rainTracker = new ManagerUtility.Tracker&lt;double&gt;(rain_days); 
   }

   // Daily tests common to all paddocks
   [EventHandler] public void OnPrepare()
   {
      bool startOfWindow = DateUtility.DatesEqual(date1, today);

      inWindow = DateUtility.WithinDates(date1, today, date2);
      ChangeCultivar = false;
      if(date3 != "na")  
         ChangeCultivar = DateUtility.WithinDates(date3, today, date2);
      endOfWindow = DateUtility.DatesEqual(date2, today);

      rainTracker.Add(rain);
      string currentPaddock = "";
      if (MySimulation.Get("currentPaddock", out currentPaddock) == false) 
      {
         // If there is no sequencer plugged in then we are it..
         if (canEnter &gt; 0) {
            OnEnter();
         }
         if (canLeave &gt; 0) {
            OnLeave();
         }
      }
   }
   // Test whether we can sow a crop today
   // +ve number - yes
   // 0          - no
   // -ve number - no, out of scope (planting window)
   [Output, Description("Test whether we can sow a crop today")] public int canEnter  {
      get {
         bool isPossibleToday = false;

         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("1. '" + currentPaddock + "'");

         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Component cropModule = (Component) paddockModule.LinkByName( crop );

         //Console.WriteLine("3. " + cropModule.Name);
         string plantStatus = "";
         cropModule.Get("plant_status", out plantStatus);

         double esw = 0.0;
         Component soilModule = (Component) paddockModule.LinkByType("SoilWat");
         soilModule.Get("esw", out esw);
         if (plantStatus == "out" &amp;&amp;
             inWindow &amp;&amp;
             rainTracker.Sum() &gt;= rain_amount &amp;&amp;
             esw &gt; esw_amount) 
         {
             isPossibleToday = true;
         } 

         if (isPossibleToday)
            return 1;

         if (plantStatus == "out" &amp;&amp; endOfWindow &amp;&amp; must_sow == "yes")
            return 1;

         if (plantStatus == "out" &amp;&amp; !inWindow)
            return -1;

         return 0;
      }
   }  


   // Sow a crop
   [Param()] private string cultivar1;
   [Param()] private string cultivar2;
   [Param()] private double density1;
   [Param()] private double depth1;
   [Param()] private double row_spacing1;
   [Param()] private string ftn1;
   [Param()] private string skiprow1;
   [Param()] private string tillageImplement;

   [EventHandler, Description("Sow the crop")] public void OnEnter()
   {
      Console.WriteLine(today + " Sowing Crop");
      SowType data = new SowType();
      data.Cultivar = cultivar1;
      if(ChangeCultivar)
         data.Cultivar = cultivar2;

      data.plants = density1;
      data.sowing_depth = depth1;
      data.row_spacing = row_spacing1;
      data.tiller_no_fertile = (ftn1 == "na") ? "" : ftn1;
      data.SkipRow = 0 ;
      if (skiprow1 == "single")
         data.SkipRow = 1;
      else if (skiprow1 == "double")
         data.SkipRow = 2;

      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("Sow", data);

      if (tillageImplement.ToLower() != "na") 
      {
         TillageType t = new TillageType();
         t.type = tillageImplement;
         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = MySimulation.ChildPaddocks[0];
         paddockModule.Publish("tillage", t);
      }         
   }

   // Test whether we can harvest a crop today
   // +ve number - yes
   // 0          - no
   // -ve        - out of scope
   [Output] public int canLeave  
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (StageName == "harvest_ripe" || plantStatus == "dead")
            return 1;
         return 0;
      }
   }

   [EventHandler] public void OnLeave()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 0.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);

      KillCropType kdata = new KillCropType();
      kdata.KillFraction = 0.0F;
      cropModule.Publish("killcrop", kdata);
      cropModule.Publish("end_crop");
   } 
}
                            </text>
            </manager2>
            <manager2 name="Fertilise at Sowing">
              <ui>
                <tag type="category" description="When should fertiliser be applied" />
                <ModuleName type="modulename" description="On which module should the event come from: ">sorghum</ModuleName>
                <EventName type="text" description="On which event should spraying be triggered">sowing</EventName>
                <tag type="category" description="Event details" />
                <fertType type="text" description="The type of fertiliser">urea_N</fertType>
                <fertAmt type="text" description="Amount of fertiliser to apply (kg/ha)">30</fertAmt>
              </ui>
              <text>using System;
using System.Linq;
using System.Collections.Generic;
using ModelFramework;

// Crop management: fertilise at sowing
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.

public class Script 
{      
   [Link]  public Simulation MySimulation;
   [Param] string fertType;
   [Param] float fertAmt;
   [Param] string ModuleName;
   [Param] string EventName;

   [EventHandler] public void OnStart_Simulation()
   {
      foreach (Paddock paddock in MySimulation.ChildPaddocks) 
      {
         foreach (Component child in paddock.Children) {
            if(child.Name == ModuleName){
               RuntimeEventHandler.NullFunction curried = () =&gt; OnTrigger(paddock.Name);
               MySimulation.Subscribe(child.FullName + "." + EventName, curried);
               //Console.WriteLine("Subscribed '" + child.FullName + "." + EventName + " =&gt; " + paddock.Name + "'"); 
            }
         }
      }
   }

   public void OnTrigger(string paddock)
   {
      Console.WriteLine("Fertiliser OnTrigger called, paddock='" + paddock + "'"); 
      if (fertAmt &gt; 0) 
      {         
         Component paddockModule;
         if (paddock != "")
            paddockModule = (Component) MySimulation.LinkByName(paddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Fertiliser fertModule = (Fertiliser) paddockModule.LinkByName("Fertiliser");
         fertModule.Apply(fertAmt, 50, fertType);
      }
   }
}
                            </text>
            </manager2>
          </folder>
          <outputfile>
            <filename output="yes">Sorghum 30kg N Fertiliser.out</filename>
            <title>Sorghum 30kg N Fertiliser</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>day</variable>
              <variable>year</variable>
              <variable>dlayer</variable>
              <variable>sw</variable>
              <variable>DaysAfterSowing</variable>
              <variable>lai</variable>
              <variable>biomass</variable>
              <variable>yield</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>end_day</event>
            </events>
            <Graph name="XY">
              <Plot>
                <SeriesType>Solid line</SeriesType>
                <PointType>Circle</PointType>
                <colour>
                </colour>
                <X>Date</X>
                <Y>biomass</Y>
                <Y>yield</Y>
                <GDApsimFileReader name="ApsimFileReader" />
              </Plot>
            </Graph>
          </outputfile>
        </area>
      </simulation>
      <simulation name="Sorghum 60kg N Fertiliser">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%\Examples\MetFiles\Dalby.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1988</start_date>
          <end_date type="date" description="Enter the end date of the simulation">30/06/1988</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <Soil name="Heavy Clay">
            <SoilType>Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown>Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude>-27.564333</Latitude>
            <Longitude>151.953991</Longitude>
            <LocationAccuracy>Regional Soil Type</LocationAccuracy>
            <DataSource>YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments>Generic soil developed by Allan Peake.</Comments>
            <Water>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <RelativeTo>ll15</RelativeTo>
              <FractionFull>0.25</FractionFull>
              <PercentMethod>FilledFromTop</PercentMethod>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Date type="date" description="Sample date:" />
              <Thickness>
                <double>1800</double>
              </Thickness>
              <NO3>
                <double>12</double>
              </NO3>
              <NO3Units>kgha</NO3Units>
              <NH4>
                <double>3</double>
              </NH4>
              <NH4Units>kgha</NH4Units>
              <SW>
                <double>0</double>
              </SW>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <sorghum />
          <folder name="Manager folder">
            <manager2 name="Crop Management">
              <ui>
                <category type="category" description="Crop properties" />
                <crop type="crop" description="Name of this crop">sorghum</crop>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm)">1-jan</date1>
                <date3 type="ddmmmdate" description="Enter cultivar change date (na if not in use)">na</date3>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm)">1-jan</date2>
                <must_sow type="yesno" description="Must Sow">yes</must_sow>
                <rain_amount type="text" description="Enter amount of cumulative rainfall (mm)">30</rain_amount>
                <rain_days type="text" description="Enter number of days to accumulate rainfall (days)">3</rain_days>
                <esw_amount type="text" description="Enter amount of soil water (mm)">200</esw_amount>
                <category type="category" description="Sowing Parameters" />
                <cultivar1 type="cultivars" description="Enter cultivar : ">early</cultivar1>
                <cultivar2 type="cultivars" description="Enter 2nd Cultivar (na if not using a second cultivar)">na</cultivar2>
                <density1 type="text" description="Enter sowing density  (plants/m2)">8</density1>
                <depth1 type="text" description="Enter sowing depth  (mm)">30</depth1>
                <row_spacing1 type="text" description="Enter row spacing  (mm)">1000</row_spacing1>
                <category type="category" description="Extra Parameters" />
                <ftn1 type="text" description="Enter Fertile Tiller Number (na for auto) : ">na</ftn1>
                <skiprow1 type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow1>
                <tillageImplement type="text" description="Name of tillage implement (na if not in use): ">na</tillageImplement>
              </ui>
              <text>using System;
using ModelFramework;
using CSGeneral;

// Basic crop management: sowing &amp; harvesting.
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.
// It will assume it is the only crop in the system if it doesnt find a sequencer.
// If it does find a sequencer, it will do nothing until told to (via Enter/Leave).
public class Script 
{      
   [Link()]  public Simulation MySimulation;

   [Param()] private string crop;         // The module name of this crop
   [Param()] private string date1;         //Start of sowing window
   [Param()] private string date2;         //End of sowing window
   [Param()] private string date3;         //date to change to different cultivar
   [Param()] int esw_amount;
   [Param()] private string must_sow;

   [Input()] private DateTime today;

   // Rainfall accumulator
   [Param()] int rain_days;              //check for rain over this period
   [Param()] int rain_amount;            //this much rain over that period

   // Daily rainfall from the system
   [Input] private double rain;
   private ManagerUtility.Tracker&lt;double&gt; rainTracker; 

   private bool inWindow = false;
   private bool endOfWindow = false;
   private bool ChangeCultivar = false;

   //initialise tracker, telling it how many days to track
   [EventHandler] public void OnInitialised()
   {
      rainTracker = new ManagerUtility.Tracker&lt;double&gt;(rain_days); 
   }

   // Daily tests common to all paddocks
   [EventHandler] public void OnPrepare()
   {
      bool startOfWindow = DateUtility.DatesEqual(date1, today);

      inWindow = DateUtility.WithinDates(date1, today, date2);
      ChangeCultivar = false;
      if(date3 != "na")  
         ChangeCultivar = DateUtility.WithinDates(date3, today, date2);
      endOfWindow = DateUtility.DatesEqual(date2, today);

      rainTracker.Add(rain);
      string currentPaddock = "";
      if (MySimulation.Get("currentPaddock", out currentPaddock) == false) 
      {
         // If there is no sequencer plugged in then we are it..
         if (canEnter &gt; 0) {
            OnEnter();
         }
         if (canLeave &gt; 0) {
            OnLeave();
         }
      }
   }
   // Test whether we can sow a crop today
   // +ve number - yes
   // 0          - no
   // -ve number - no, out of scope (planting window)
   [Output, Description("Test whether we can sow a crop today")] public int canEnter  {
      get {
         bool isPossibleToday = false;

         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("1. '" + currentPaddock + "'");

         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Component cropModule = (Component) paddockModule.LinkByName( crop );

         //Console.WriteLine("3. " + cropModule.Name);
         string plantStatus = "";
         cropModule.Get("plant_status", out plantStatus);

         double esw = 0.0;
         Component soilModule = (Component) paddockModule.LinkByType("SoilWat");
         soilModule.Get("esw", out esw);
         if (plantStatus == "out" &amp;&amp;
             inWindow &amp;&amp;
             rainTracker.Sum() &gt;= rain_amount &amp;&amp;
             esw &gt; esw_amount) 
         {
             isPossibleToday = true;
         } 

         if (isPossibleToday)
            return 1;

         if (plantStatus == "out" &amp;&amp; endOfWindow &amp;&amp; must_sow == "yes")
            return 1;

         if (plantStatus == "out" &amp;&amp; !inWindow)
            return -1;

         return 0;
      }
   }  


   // Sow a crop
   [Param()] private string cultivar1;
   [Param()] private string cultivar2;
   [Param()] private double density1;
   [Param()] private double depth1;
   [Param()] private double row_spacing1;
   [Param()] private string ftn1;
   [Param()] private string skiprow1;
   [Param()] private string tillageImplement;

   [EventHandler, Description("Sow the crop")] public void OnEnter()
   {
      Console.WriteLine(today + " Sowing Crop");
      SowType data = new SowType();
      data.Cultivar = cultivar1;
      if(ChangeCultivar)
         data.Cultivar = cultivar2;

      data.plants = density1;
      data.sowing_depth = depth1;
      data.row_spacing = row_spacing1;
      data.tiller_no_fertile = (ftn1 == "na") ? "" : ftn1;
      data.SkipRow = 0 ;
      if (skiprow1 == "single")
         data.SkipRow = 1;
      else if (skiprow1 == "double")
         data.SkipRow = 2;

      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("Sow", data);

      if (tillageImplement.ToLower() != "na") 
      {
         TillageType t = new TillageType();
         t.type = tillageImplement;
         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = MySimulation.ChildPaddocks[0];
         paddockModule.Publish("tillage", t);
      }         
   }

   // Test whether we can harvest a crop today
   // +ve number - yes
   // 0          - no
   // -ve        - out of scope
   [Output] public int canLeave  
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (StageName == "harvest_ripe" || plantStatus == "dead")
            return 1;
         return 0;
      }
   }

   [EventHandler] public void OnLeave()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 0.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);

      KillCropType kdata = new KillCropType();
      kdata.KillFraction = 0.0F;
      cropModule.Publish("killcrop", kdata);
      cropModule.Publish("end_crop");
   } 
}
                            </text>
            </manager2>
            <manager2 name="Fertilise at Sowing">
              <ui>
                <tag type="category" description="When should fertiliser be applied" />
                <ModuleName type="modulename" description="On which module should the event come from: ">sorghum</ModuleName>
                <EventName type="text" description="On which event should spraying be triggered">sowing</EventName>
                <tag type="category" description="Event details" />
                <fertType type="text" description="The type of fertiliser">urea_N</fertType>
                <fertAmt type="text" description="Amount of fertiliser to apply (kg/ha)">30</fertAmt>
              </ui>
              <text>using System;
using System.Linq;
using System.Collections.Generic;
using ModelFramework;

// Crop management: fertilise at sowing
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.

public class Script 
{      
   [Link]  public Simulation MySimulation;
   [Param] string fertType;
   [Param] float fertAmt;
   [Param] string ModuleName;
   [Param] string EventName;

   [EventHandler] public void OnStart_Simulation()
   {
      foreach (Paddock paddock in MySimulation.ChildPaddocks) 
      {
         foreach (Component child in paddock.Children) {
            if(child.Name == ModuleName){
               RuntimeEventHandler.NullFunction curried = () =&gt; OnTrigger(paddock.Name);
               MySimulation.Subscribe(child.FullName + "." + EventName, curried);
               //Console.WriteLine("Subscribed '" + child.FullName + "." + EventName + " =&gt; " + paddock.Name + "'"); 
            }
         }
      }
   }

   public void OnTrigger(string paddock)
   {
      Console.WriteLine("Fertiliser OnTrigger called, paddock='" + paddock + "'"); 
      if (fertAmt &gt; 0) 
      {         
         Component paddockModule;
         if (paddock != "")
            paddockModule = (Component) MySimulation.LinkByName(paddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Fertiliser fertModule = (Fertiliser) paddockModule.LinkByName("Fertiliser");
         fertModule.Apply(fertAmt, 50, fertType);
      }
   }
}
                            </text>
            </manager2>
          </folder>
          <outputfile>
            <filename output="yes">Sorghum 60kg N Fertiliser.out</filename>
            <title>Sorghum 60kg N Fertiliser</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>day</variable>
              <variable>year</variable>
              <variable>dlayer</variable>
              <variable>sw</variable>
              <variable>DaysAfterSowing</variable>
              <variable>lai</variable>
              <variable>biomass</variable>
              <variable>yield</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>end_day</event>
            </events>
            <Graph name="XY">
              <Plot>
                <SeriesType>Solid line</SeriesType>
                <PointType>Circle</PointType>
                <colour>
                </colour>
                <X>Date</X>
                <Y>biomass</Y>
                <Y>yield</Y>
                <GDApsimFileReader name="ApsimFileReader" />
              </Plot>
            </Graph>
          </outputfile>
        </area>
      </simulation>
      <Graph name="XY">
        <Legend>
        </Legend>
        <Plot>
          <SeriesType>Solid line</SeriesType>
          <PointType>None</PointType>
          <colour>
          </colour>
          <X>Date</X>
          <Y>yield</Y>
          <GDApsimFileReader name="ApsimFileReader" />
        </Plot>
      </Graph>
      <Graph name="Depth">
        <Legend>
        </Legend>
        <Plot>
          <SeriesType>Solid line</SeriesType>
          <PointType>None</PointType>
          <Y>Depth</Y>
          <colour>
          </colour>
          <XTop>sw</XTop>
          <GDDepth name="Depth">
            <AllXOnTopAxis>Yes</AllXOnTopAxis>
            <Date>15/3/1988</Date>
            <Date>31/5/1988</Date>
            <GDApsimFileReader name="ApsimFileReader" />
          </GDDepth>
        </Plot>
      </Graph>
    </folder>
    <folder name="Module 5">
      <simulation name="Chickpea 10 plants">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1940</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1980</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <Soil name="Heavy Clay">
            <RecordNumber>0</RecordNumber>
            <SoilType>Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown>Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude>-27.564333</Latitude>
            <Longitude>151.953991</Longitude>
            <LocationAccuracy>Regional Soil Type</LocationAccuracy>
            <YearOfSampling>0</YearOfSampling>
            <DataSource>YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments>Generic soil developed by Allan Peake.</Comments>
            <Water>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="chickpea">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Slope>NaN</Slope>
              <DischargeWidth>NaN</DischargeWidth>
              <CatchmentArea>NaN</CatchmentArea>
              <MaxPond>NaN</MaxPond>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
              <OCUnits>Total</OCUnits>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <FractionFull>0.5</FractionFull>
              <DepthWetSoil>NaN</DepthWetSoil>
              <PercentMethod>FilledFromTop</PercentMethod>
              <RelativeTo>ll15</RelativeTo>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Thickness>
                <double>100</double>
              </Thickness>
              <NO3>
                <double>20</double>
              </NO3>
              <NH4>
                <double>0</double>
              </NH4>
              <SW>
                <double>0</double>
              </SW>
              <NO3Units>kgha</NO3Units>
              <NH4Units>kgha</NH4Units>
              <SWUnits>Volumetric</SWUnits>
              <OCUnits>Total</OCUnits>
              <PHUnits>Water</PHUnits>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">sorghum</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">sorghum</type>
            <mass type="text" description="Initial surface residue (kg/ha)">550</mass>
            <cnr type="text" description="C:N ratio of initial residue">76</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <chickpea>
            <MaxRootDepth description="Maximum rooting depth (mm) 0=no restriction">0</MaxRootDepth>
          </chickpea>
          <folder name="Manager folder">
            <manager2 name="Reset on Date">
              <ui>
                <category type="category" description="When should a reset be done" />
                <reset_date type="text" description="Enter date of reset (dd-mmm) : ">1-may</reset_date>
                <category type="category" description="Reset details" />
                <ResetWater type="yesno" description="Reset soil water?">yes</ResetWater>
                <ResetNitrogen type="yesno" description="Reset soil nitrogen?">yes</ResetNitrogen>
                <ResetSurfaceOM type="yesno" description="Reset surface organic matter?">yes</ResetSurfaceOM>
              </ui>
              <text>using System;
using ModelFramework;
using CSGeneral; 

// Crop management: Reset on a fixed date
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.

public class Script 
   {
   [Link]  public Simulation MySimulation;

   [Param] private string reset_date;                    // date to reset 
   [Param] private string ResetWater;                    // reset water yes/no 
   [Param] private string ResetNitrogen;                 // reset nitrogen yes/no
   [Param] private string ResetSurfaceOM;                // reset surfaceOM yes/no
   [Input] private DateTime today;                       // input date from clock 


   [EventHandler] public void OnPrepare()                    // what comes under this section heading will be done at the beginning of each day 
   {
      if (DateUtility.DatesEqual(reset_date,today))          // test that today is equal to the reset date
      {
         Console.WriteLine(today + " Reset Day");
         foreach (Paddock paddock in MySimulation.ChildPaddocks) {
            if(ResetWater == "yes"){
               Component soilwat = (Component) paddock.LinkByType("soilwat");
               soilwat.Publish("reset");
            }
            if(ResetSurfaceOM == "yes"){
               Component surfaceom = (Component) paddock.LinkByType("surfaceom");
               surfaceom.Publish("reset");
            }
            if(ResetNitrogen == "yes"){
               Component soiln = (Component) paddock.LinkByType("soiln");
               soiln.Publish("reset");
            }
         }
      }
   }
}
                            </text>
            </manager2>
            <manager2 name="Chickpea Management">
              <ui>
                <category type="category" description="Crop properties" />
                <crop type="crop" description="Name of this crop">chickpea</crop>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm)">1-may</date1>
                <date3 type="ddmmmdate" description="Enter cultivar change date (na if not in use)">na</date3>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm)">1-aug</date2>
                <must_sow type="yesno" description="Must Sow">no</must_sow>
                <rain_amount type="text" description="Enter amount of cumulative rainfall (mm)">15</rain_amount>
                <rain_days type="text" description="Enter number of days to accumulate rainfall (days)">3</rain_days>
                <esw_amount type="text" description="Enter amount of soil water (mm)">200</esw_amount>
                <category type="category" description="Sowing Parameters" />
                <cultivar1 type="cultivars" description="Enter cultivar : ">amethyst</cultivar1>
                <cultivar2 type="cultivars" description="Enter 2nd Cultivar (na if not using a second cultivar)">na</cultivar2>
                <density1 type="text" description="Enter sowing density  (plants/m2)">10</density1>
                <depth1 type="text" description="Enter sowing depth  (mm)">30</depth1>
                <row_spacing1 type="text" description="Enter row spacing  (mm)">350</row_spacing1>
                <category type="category" description="Extra Parameters" />
                <ftn1 type="text" description="Enter Fertile Tiller Number (na for auto) : ">na</ftn1>
                <skiprow1 type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow1>
                <tillageImplement type="text" description="Name of tillage implement (na if not in use): ">na</tillageImplement>
              </ui>
              <text>using System;
using ModelFramework;
using CSGeneral;

// Basic crop management: sowing &amp; harvesting.
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.
// It will assume it is the only crop in the system if it doesnt find a sequencer.
// If it does find a sequencer, it will do nothing until told to (via Enter/Leave).

public class Script 
{      
   [Link()]  public Simulation MySimulation;

   [Param()] private string crop;         // The module name of this crop
   [Param()] private string date1;         //Start of sowing window
   [Param()] private string date2;         //End of sowing window
   [Param()] private string date3;         //date to change to different cultivar
   [Param()] int esw_amount;
   [Param()] private string must_sow;

   [Input()] private DateTime today;

   // Rainfall accumulator
   [Param()] int rain_days;              //check for rain over this period
   [Param()] int rain_amount;            //this much rain over that period

   // Daily rainfall from the system
   [Input] private double rain;
   private ManagerUtility.Tracker&lt;double&gt; rainTracker; 

   private bool inWindow = false;
   private bool endOfWindow = false;
   private bool ChangeCultivar = false;

   //initialise tracker, telling it how many days to track
   [EventHandler] public void OnInitialised()
   {
      rainTracker = new ManagerUtility.Tracker&lt;double&gt;(rain_days); 
   }

   // Daily tests common to all paddocks
   [EventHandler] public void OnPrepare()
   {
      bool startOfWindow = DateUtility.DatesEqual(date1, today);

      inWindow = DateUtility.WithinDates(date1, today, date2);
      ChangeCultivar = false;
      if(date3 != "na")  
         ChangeCultivar = DateUtility.WithinDates(date3, today, date2);
      endOfWindow = DateUtility.DatesEqual(date2, today);

      rainTracker.Add(rain);
      string currentPaddock = "";
      if (MySimulation.Get("currentPaddock", out currentPaddock) == false) 
      {
         // If there is no sequencer plugged in then we are it..
         if (canEnter &gt; 0) {
            OnEnter();
         }
         if (canLeave &gt; 0) {
            OnLeave();
         }
      }
   }
   // Test whether we can sow a crop today
   // +ve number - yes
   // 0          - no
   // -ve number - no, out of scope (planting window)
   [Output, Description("Test whether we can sow a crop today")] public int canEnter  {
      get {
         bool isPossibleToday = false;

         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("1. '" + currentPaddock + "'");

         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Component cropModule = (Component) paddockModule.LinkByName( crop );

         //Console.WriteLine("3. " + cropModule.Name);
         string plantStatus = "";
         cropModule.Get("plant_status", out plantStatus);

         double esw = 0.0;
         Component soilModule = (Component) paddockModule.LinkByType("SoilWat");
         soilModule.Get("esw", out esw);
         if (plantStatus == "out" &amp;&amp;
             inWindow &amp;&amp;
             rainTracker.Sum() &gt;= rain_amount &amp;&amp;
             esw &gt; esw_amount) 
         {
             isPossibleToday = true;
         } 

         if (isPossibleToday)
            return 1;

         if (plantStatus == "out" &amp;&amp; endOfWindow &amp;&amp; must_sow == "yes")
            return 1;

         if (plantStatus == "out" &amp;&amp; !inWindow)
            return -1;

         return 0;
      }
   }  


   // Sow a crop
   [Param()] private string cultivar1;
   [Param()] private string cultivar2;
   [Param()] private double density1;
   [Param()] private double depth1;
   [Param()] private double row_spacing1;
   [Param()] private string ftn1;
   [Param()] private string skiprow1;
   [Param()] private string tillageImplement;

   [EventHandler, Description("Sow the crop")] public void OnEnter()
   {
      Console.WriteLine(today + " Sowing Crop");
      SowType data = new SowType();
      data.Cultivar = cultivar1;
      if(ChangeCultivar)
         data.Cultivar = cultivar2;

      data.plants = density1;
      data.sowing_depth = depth1;
      data.row_spacing = row_spacing1;
      data.tiller_no_fertile = (ftn1 == "na") ? "" : ftn1;
      data.SkipRow = 0 ;
      if (skiprow1 == "single")
         data.SkipRow = 1;
      else if (skiprow1 == "double")
         data.SkipRow = 2;

      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("Sow", data);

      if (tillageImplement.ToLower() != "na") 
      {
         TillageType t = new TillageType();
         t.type = tillageImplement;
         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = MySimulation.ChildPaddocks[0];
         paddockModule.Publish("tillage", t);
      }         
   }

   // Test whether we can harvest a crop today
   // +ve number - yes
   // 0          - no
   // -ve        - out of scope
   [Output] public int canLeave  
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (StageName == "harvest_ripe" || plantStatus == "dead")
            return 1;
         return 0;
      }
   }

   [EventHandler] public void OnLeave()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 0.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);

      KillCropType kdata = new KillCropType();
      kdata.KillFraction = 0.0F;
      cropModule.Publish("killcrop", kdata);
      cropModule.Publish("end_crop");
   } 
}
                            </text>
            </manager2>
          </folder>
          <outputfile>
            <filename output="yes">Chickpea 10 plants.out</filename>
            <title>Chickpea 10 plants</title>
            <variables name="Variables">
              <variable>year</variable>
              <variable>yield</variable>
            </variables>
            <events name="Reporting Frequency">
              <event description="">harvesting</event>
            </events>
          </outputfile>
        </area>
      </simulation>
      <simulation name="Chickpea 15 plants">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1940</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1980</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <Soil name="Heavy Clay">
            <RecordNumber>0</RecordNumber>
            <SoilType>Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown>Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude>-27.564333</Latitude>
            <Longitude>151.953991</Longitude>
            <LocationAccuracy>Regional Soil Type</LocationAccuracy>
            <YearOfSampling>0</YearOfSampling>
            <DataSource>YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments>Generic soil developed by Allan Peake.</Comments>
            <Water>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="chickpea">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Slope>NaN</Slope>
              <DischargeWidth>NaN</DischargeWidth>
              <CatchmentArea>NaN</CatchmentArea>
              <MaxPond>NaN</MaxPond>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
              <OCUnits>Total</OCUnits>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <FractionFull>0.5</FractionFull>
              <DepthWetSoil>NaN</DepthWetSoil>
              <PercentMethod>FilledFromTop</PercentMethod>
              <RelativeTo>ll15</RelativeTo>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Thickness>
                <double>100</double>
              </Thickness>
              <NO3>
                <double>20</double>
              </NO3>
              <NH4>
                <double>0</double>
              </NH4>
              <SW>
                <double>0</double>
              </SW>
              <NO3Units>kgha</NO3Units>
              <NH4Units>kgha</NH4Units>
              <SWUnits>Volumetric</SWUnits>
              <OCUnits>Total</OCUnits>
              <PHUnits>Water</PHUnits>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">sorghum</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">sorghum</type>
            <mass type="text" description="Initial surface residue (kg/ha)">550</mass>
            <cnr type="text" description="C:N ratio of initial residue">76</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <chickpea>
            <MaxRootDepth description="Maximum rooting depth (mm) 0=no restriction">0</MaxRootDepth>
          </chickpea>
          <folder name="Manager folder">
            <manager2 name="Reset on Date">
              <ui>
                <category type="category" description="When should a reset be done" />
                <reset_date type="text" description="Enter date of reset (dd-mmm) : ">1-may</reset_date>
                <category type="category" description="Reset details" />
                <ResetWater type="yesno" description="Reset soil water?">yes</ResetWater>
                <ResetNitrogen type="yesno" description="Reset soil nitrogen?">yes</ResetNitrogen>
                <ResetSurfaceOM type="yesno" description="Reset surface organic matter?">yes</ResetSurfaceOM>
              </ui>
              <text>using System;
using ModelFramework;
using CSGeneral; 

// Crop management: Reset on a fixed date
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.

public class Script 
   {
   [Link]  public Simulation MySimulation;

   [Param] private string reset_date;                    // date to reset 
   [Param] private string ResetWater;                    // reset water yes/no 
   [Param] private string ResetNitrogen;                 // reset nitrogen yes/no
   [Param] private string ResetSurfaceOM;                // reset surfaceOM yes/no
   [Input] private DateTime today;                       // input date from clock 


   [EventHandler] public void OnPrepare()                    // what comes under this section heading will be done at the beginning of each day 
   {
      if (DateUtility.DatesEqual(reset_date,today))          // test that today is equal to the reset date
      {
         Console.WriteLine(today + " Reset Day");
         foreach (Paddock paddock in MySimulation.ChildPaddocks) {
            if(ResetWater == "yes"){
               Component soilwat = (Component) paddock.LinkByType("soilwat");
               soilwat.Publish("reset");
            }
            if(ResetSurfaceOM == "yes"){
               Component surfaceom = (Component) paddock.LinkByType("surfaceom");
               surfaceom.Publish("reset");
            }
            if(ResetNitrogen == "yes"){
               Component soiln = (Component) paddock.LinkByType("soiln");
               soiln.Publish("reset");
            }
         }
      }
   }
}
                            </text>
            </manager2>
            <manager2 name="Chickpea Management">
              <ui>
                <category type="category" description="Crop properties" />
                <crop type="crop" description="Name of this crop">chickpea</crop>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm)">1-may</date1>
                <date3 type="ddmmmdate" description="Enter cultivar change date (na if not in use)">na</date3>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm)">1-aug</date2>
                <must_sow type="yesno" description="Must Sow">no</must_sow>
                <rain_amount type="text" description="Enter amount of cumulative rainfall (mm)">15</rain_amount>
                <rain_days type="text" description="Enter number of days to accumulate rainfall (days)">3</rain_days>
                <esw_amount type="text" description="Enter amount of soil water (mm)">200</esw_amount>
                <category type="category" description="Sowing Parameters" />
                <cultivar1 type="cultivars" description="Enter cultivar : ">amethyst</cultivar1>
                <cultivar2 type="cultivars" description="Enter 2nd Cultivar (na if not using a second cultivar)">na</cultivar2>
                <density1 type="text" description="Enter sowing density  (plants/m2)">15</density1>
                <depth1 type="text" description="Enter sowing depth  (mm)">30</depth1>
                <row_spacing1 type="text" description="Enter row spacing  (mm)">350</row_spacing1>
                <category type="category" description="Extra Parameters" />
                <ftn1 type="text" description="Enter Fertile Tiller Number (na for auto) : ">na</ftn1>
                <skiprow1 type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow1>
                <tillageImplement type="text" description="Name of tillage implement (na if not in use): ">na</tillageImplement>
              </ui>
              <text>using System;
using ModelFramework;
using CSGeneral;

// Basic crop management: sowing &amp; harvesting.
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.
// It will assume it is the only crop in the system if it doesnt find a sequencer.
// If it does find a sequencer, it will do nothing until told to (via Enter/Leave).

public class Script 
{      
   [Link()]  public Simulation MySimulation;

   [Param()] private string crop;         // The module name of this crop
   [Param()] private string date1;         //Start of sowing window
   [Param()] private string date2;         //End of sowing window
   [Param()] private string date3;         //date to change to different cultivar
   [Param()] int esw_amount;
   [Param()] private string must_sow;

   [Input()] private DateTime today;

   // Rainfall accumulator
   [Param()] int rain_days;              //check for rain over this period
   [Param()] int rain_amount;            //this much rain over that period

   // Daily rainfall from the system
   [Input] private double rain;
   private ManagerUtility.Tracker&lt;double&gt; rainTracker; 

   private bool inWindow = false;
   private bool endOfWindow = false;
   private bool ChangeCultivar = false;

   //initialise tracker, telling it how many days to track
   [EventHandler] public void OnInitialised()
   {
      rainTracker = new ManagerUtility.Tracker&lt;double&gt;(rain_days); 
   }

   // Daily tests common to all paddocks
   [EventHandler] public void OnPrepare()
   {
      bool startOfWindow = DateUtility.DatesEqual(date1, today);

      inWindow = DateUtility.WithinDates(date1, today, date2);
      ChangeCultivar = false;
      if(date3 != "na")  
         ChangeCultivar = DateUtility.WithinDates(date3, today, date2);
      endOfWindow = DateUtility.DatesEqual(date2, today);

      rainTracker.Add(rain);
      string currentPaddock = "";
      if (MySimulation.Get("currentPaddock", out currentPaddock) == false) 
      {
         // If there is no sequencer plugged in then we are it..
         if (canEnter &gt; 0) {
            OnEnter();
         }
         if (canLeave &gt; 0) {
            OnLeave();
         }
      }
   }
   // Test whether we can sow a crop today
   // +ve number - yes
   // 0          - no
   // -ve number - no, out of scope (planting window)
   [Output, Description("Test whether we can sow a crop today")] public int canEnter  {
      get {
         bool isPossibleToday = false;

         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("1. '" + currentPaddock + "'");

         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Component cropModule = (Component) paddockModule.LinkByName( crop );

         //Console.WriteLine("3. " + cropModule.Name);
         string plantStatus = "";
         cropModule.Get("plant_status", out plantStatus);

         double esw = 0.0;
         Component soilModule = (Component) paddockModule.LinkByType("SoilWat");
         soilModule.Get("esw", out esw);
         if (plantStatus == "out" &amp;&amp;
             inWindow &amp;&amp;
             rainTracker.Sum() &gt;= rain_amount &amp;&amp;
             esw &gt; esw_amount) 
         {
             isPossibleToday = true;
         } 

         if (isPossibleToday)
            return 1;

         if (plantStatus == "out" &amp;&amp; endOfWindow &amp;&amp; must_sow == "yes")
            return 1;

         if (plantStatus == "out" &amp;&amp; !inWindow)
            return -1;

         return 0;
      }
   }  


   // Sow a crop
   [Param()] private string cultivar1;
   [Param()] private string cultivar2;
   [Param()] private double density1;
   [Param()] private double depth1;
   [Param()] private double row_spacing1;
   [Param()] private string ftn1;
   [Param()] private string skiprow1;
   [Param()] private string tillageImplement;

   [EventHandler, Description("Sow the crop")] public void OnEnter()
   {
      Console.WriteLine(today + " Sowing Crop");
      SowType data = new SowType();
      data.Cultivar = cultivar1;
      if(ChangeCultivar)
         data.Cultivar = cultivar2;

      data.plants = density1;
      data.sowing_depth = depth1;
      data.row_spacing = row_spacing1;
      data.tiller_no_fertile = (ftn1 == "na") ? "" : ftn1;
      data.SkipRow = 0 ;
      if (skiprow1 == "single")
         data.SkipRow = 1;
      else if (skiprow1 == "double")
         data.SkipRow = 2;

      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("Sow", data);

     if (tillageImplement.ToLower() != "na") 
      {
         TillageType t = new TillageType();
         t.type = tillageImplement;
         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = MySimulation.ChildPaddocks[0];
         paddockModule.Publish("tillage", t);
      }         
    }

   // Test whether we can harvest a crop today
   // +ve number - yes
   // 0          - no
   // -ve        - out of scope
   [Output] public int canLeave  
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (StageName == "harvest_ripe" || plantStatus == "dead")
            return 1;
         return 0;
      }
   }

   [EventHandler] public void OnLeave()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 0.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);

      KillCropType kdata = new KillCropType();
      kdata.KillFraction = 0.0F;
      cropModule.Publish("killcrop", kdata);
      cropModule.Publish("end_crop");
   } 
}
                            </text>
            </manager2>
          </folder>
          <outputfile>
            <filename output="yes">Chickpea 15 plants.out</filename>
            <title>Chickpea 15 plants</title>
            <variables name="Variables">
              <variable>year</variable>
              <variable>yield</variable>
            </variables>
            <events name="Reporting Frequency">
              <event description="">harvesting</event>
            </events>
          </outputfile>
        </area>
      </simulation>
      <Graph name="XY">
        <Legend>
        </Legend>
        <Plot>
          <SeriesType>Bar</SeriesType>
          <PointType>Circle</PointType>
          <colour>
          </colour>
          <X>year</X>
          <Y>yield</Y>
          <GDApsimFileReader name="ApsimFileReader" />
        </Plot>
      </Graph>
      <Graph name="Probability Exceedence">
        <Legend>
        </Legend>
        <Plot>
          <SeriesType>Solid line</SeriesType>
          <PointType>None</PointType>
          <Y>Probability of being above</Y>
          <colour>
          </colour>
          <X>yield</X>
          <GDProbability>
            <Exceedence>Yes</Exceedence>
            <GDApsimFileReader name="ApsimFileReader" />
          </GDProbability>
        </Plot>
      </Graph>
    </folder>
    <folder name="Advanced - Climate Change">
      <simulation name="350ppm">
        <memo name="Read Me">Climate Change in APSIM Simulations

To perform a simple simulation to quantify the effects of climate change on production system simply drag a climate change object from the standard toolbow onto the simulation at the same level as your met file.  The climate change user interface will allow you to enter simple modifiers (either additive or multiplicative) for maximum and minimum temperature, solar radiation and rainfall.
                </memo>
        <manager name="ClimateControl">
          <ui>
            <category type="category" description="Climate Control Window" />
            <date1 type="ddmmmdate" description="Enter window START date (dd-mmm) : ">1-jan</date1>
            <date2 type="ddmmmdate" description="Enter window END date (dd-mmm) : ">31-dec</date2>
            <category type="category" description="Climate Change Parameters" />
            <MaxtChange type="text" description="Change in maximum temperature (oC):">0</MaxtChange>
            <MintChange type="text" description="Change in minimum temperature (oC):">0</MintChange>
            <RainChange type="text" description="Relative change in daily rainfall (%):">0</RainChange>
            <RadnChange type="text" description="Relative change in daily radiation (%):">0</RadnChange>
            <CO2 type="text" description="Atmospheric CO2 Concentration (ppm)">350</CO2>
          </ui>
          <script>
            <text>
!  Adjust daily temperatures, rainfall and radiation up or down according to user-defined amounts
! To apply different levels of climate control to different times of year add multiple copies of this logic into your simulation and change the window.

if (date_within('[date1], [date2]') = 1) then
   maxt = maxt + [MaxtChange]
   mint = mint + [MintChange]
   rain = rain + rain * [RainChange] / 100
   radn = radn + radn * [RadnChange] / 100
   co2 = [CO2]
 endif
                        </text>
            <event>prenewmet</event>
          </script>
          <script>
            <text>co2 = [CO2]
tav = tav + ([MaxtChange] + [MintChange]) / 2
                        </text>
            <event>Init</event>
          </script>
        </manager>
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1970</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1989</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <Soil>
            <SoilType description="Soil description">Black Vertosol</SoilType>
            <LocalName>Waco</LocalName>
            <Site>Jimbour</Site>
            <NearestTown description="Nearest town">Jimbour, Q 4352</NearestTown>
            <Region>South East Queensland</Region>
            <NaturalVegetation description="Natural vegetation">Grassland, mainly Qld bluegrass</NaturalVegetation>
            <InitialWater name="Initial water">
              <FractionFull>1</FractionFull>
              <PercentMethod>FilledFromTop</PercentMethod>
            </InitialWater>
            <Water>
              <SoilCrop name="Barley">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.32</double>
                  <double>0.38</double>
                  <double>0.39</double>
                  <double>0.39</double>
                  <double>0.41</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.01</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Chickpea">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.36</double>
                  <double>0.43</double>
                  <double>0.51</double>
                  <double>0.5</double>
                  <double>0.5</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.01</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Lucerne">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                  <double>0.34</double>
                  <double>0.35</double>
                  <double>0.36</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Maize">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.34</double>
                  <double>0.34</double>
                  <double>0.37</double>
                  <double>0.4</double>
                  <double>0.42</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Perennial Grass">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.39</double>
                  <double>0.41</double>
                  <double>0.4</double>
                  <double>0.4</double>
                  <double>0.41</double>
                  <double>0.41</double>
                  <double>0.4</double>
                  <double>0.4</double>
                  <double>0.42</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.09</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.35</double>
                  <double>0.38</double>
                  <double>0.4</double>
                  <double>0.4</double>
                  <double>0.4</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.32</double>
                  <double>0.32</double>
                  <double>0.35</double>
                  <double>0.38</double>
                  <double>0.41</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.01</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.02</double>
                <double>1.03</double>
                <double>1.02</double>
                <double>1.02</double>
                <double>1.06</double>
                <double>1.11</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.2</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.15</double>
                <double>0.26</double>
                <double>0.29</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
                <double>0.34</double>
                <double>0.35</double>
                <double>0.36</double>
              </AirDry>
              <LL15>
                <double>0.29</double>
                <double>0.29</double>
                <double>0.29</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
                <double>0.34</double>
                <double>0.35</double>
                <double>0.36</double>
              </LL15>
              <DUL>
                <double>0.54</double>
                <double>0.53</double>
                <double>0.54</double>
                <double>0.54</double>
                <double>0.52</double>
                <double>0.5</double>
                <double>0.5</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.44</double>
              </DUL>
              <SAT>
                <double>0.59</double>
                <double>0.58</double>
                <double>0.59</double>
                <double>0.58</double>
                <double>0.57</double>
                <double>0.55</double>
                <double>0.55</double>
                <double>0.53</double>
                <double>0.52</double>
                <double>0.51</double>
                <double>0.49</double>
              </SAT>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>3.5</WinterCona>
              <WinterU>6</WinterU>
              <WinterDate>1-Apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>200</RootWt>
              <SoilCN>12.5</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1.04</double>
                <double>0.89</double>
                <double>0.89</double>
                <double>0.89</double>
                <double>0.77</double>
                <double>0.45</double>
                <double>0.27</double>
                <double>0.22</double>
                <double>0.16</double>
                <double>0.13</double>
                <double>0.12</double>
              </OC>
              <FBiom>
                <double>0.025</double>
                <double>0.02</double>
                <double>0.015</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.2</double>
                <double>0.25</double>
                <double>0.31</double>
                <double>0.4</double>
                <double>0.59</double>
                <double>0.84</double>
                <double>0.93</double>
                <double>1.01</double>
                <double>1.06</double>
                <double>1.05</double>
                <double>1.01</double>
              </EC>
              <PH>
                <double>8.4</double>
                <double>8.8</double>
                <double>9</double>
                <double>9.2</double>
                <double>9.2</double>
                <double>9.1</double>
                <double>9</double>
                <double>9</double>
                <double>8.9</double>
                <double>8.9</double>
                <double>8.9</double>
              </PH>
            </Analysis>
            <Sample name="Initial nitrogen">
              <Date type="date" description="Sample date:" />
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <NO3>
                <double>6.503</double>
                <double>2.101</double>
                <double>2.101</double>
                <double>1.701</double>
                <double>1.701</double>
                <double>1.701</double>
                <double>1.701</double>
                <double>1.701</double>
                <double>1.701</double>
                <double>1.701</double>
                <double>1.701</double>
              </NO3>
              <NH4>
                <double>0.599</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
              </NH4>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <wheat />
          <folder name="Manager folder">
            <manager name="Sowing rule">
              <ui>
                <category description="Sowing criteria" type="category" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm) : ">15-may</date1>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm) : ">10-jul</date2>
                <must_sow type="yesno" description="Must sow? : ">no</must_sow>
                <raincrit type="text" description="Amount of rainfall : ">30</raincrit>
                <rainnumdays type="text" description="Number of days of rainfall : ">3</rainnumdays>
                <esw_amount type="text" description="Enter minimum allowable available soil water (mm) : ">200</esw_amount>
                <category description="Sowing parameters" type="category" />
                <crop type="crop" description="Enter name of crop to sow : ">wheat</crop>
                <density type="text" description="Enter sowing density  (plants/m2) : ">100</density>
                <depth type="text" description="Enter sowing depth  (mm) : ">30</depth>
                <cultivar type="cultivars" description="Enter cultivar : ">hartog</cultivar>
                <class type="classes" description="Enter crop growth class : ">plant</class>
                <row_spacing type="text" description="Enter row spacing (mm) : ">250</row_spacing>
              </ui>
              <script>
                <text>
      if (paddock_is_fallow() = 1 and FallowIn &lt;&gt; 'yes' and (NextCrop = 0 or NextCrop = '[crop]')) then
         if (date_within('[date1], [date2]') = 1) then
            if (rain[[rainnumdays]] &gt;= [raincrit] AND esw &gt;= [esw_amount]) OR
                ('[must_sow]' = 'yes' AND today = date('[date2]'))) THEN
               ChooseNextCrop = 'yes'   ! for rotations
               [crop] sow plants =[density], sowing_depth = [depth], cultivar = [cultivar], row_spacing = [row_spacing], crop_class = [class]
            endif
            if today = date('[date2]') then
               ChooseNextCrop = 'yes'
            endif
         endif
      endif
                                </text>
                <event>start_of_day</event>
              </script>
              <script>
                <text>
            nextcrop = 0
            fallowin = 0
                                </text>
                <event>init</event>
              </script>
            </manager>
            <manager name="Sowing fertiliser">
              <ui>
                <category description="When should fertiliser be applied" type="category" />
                <modulename type="modulename" description="On which module should the event come from : ">wheat</modulename>
                <eventname type="text" description="On which event should fertiliser be applied : ">sowing</eventname>
                <category description="Fertiliser application details" type="category" />
                <fertmodule type="modulename" description="Module used to apply the fertiliser : ">fertiliser</fertmodule>
                <fert_amount_sow type="text" description="Amount of starter fertiliser at sowing (kg/ha) : ">150</fert_amount_sow>
                <fert_type_sow type="list" listvalues="NO3_N, NH4_N, NH4NO3, urea_N, urea_no3, urea, nh4so4_n, rock_p, banded_p, broadcast_p" description="Sowing fertiliser type : ">urea_N</fert_type_sow>
              </ui>
              <script>
                <text>
        [fertmodule] apply amount = [fert_amount_sow] (kg/ha), depth = 50 (mm), type = [fert_type_sow]
                                </text>
                <event>[modulename].[eventname]</event>
              </script>
            </manager>
            <manager name="Harvesting rule">
              <ui>
                <category type="category" description="Harvesting criteria" />
                <crop type="crop" description="Enter name of crop to harvest when ripe : ">wheat</crop>
              </ui>
              <script>
                <text>

           if [crop].StageName = 'harvest_ripe' or [crop].plant_status = 'dead' then
              [crop]  harvest
              [crop]  end_crop
           endif

                                </text>
                <event>end_of_day</event>
              </script>
            </manager>
            <manager name="Reset water, nitrogen and surfaceOM on fixed date">
              <ui>
                <category type="category" description="When should a reset be done" />
                <reset_date type="ddmmmdate" description="Enter date of reset (dd-mmm) : ">1-jan</reset_date>
                <category type="category" description="Reset details" />
                <soilmodule type="modulename" description="Name of your soil module : ">Soil</soilmodule>
                <surfaceommodule type="modulename" description="Name of your surface organic matter module : ">SurfaceOrganicMatter</surfaceommodule>
                <resetWater type="yesno" description="Reset soil water?">yes</resetWater>
                <resetNitrogen type="yesno" description="Reset soil nitrogen?">yes</resetNitrogen>
                <resetSurfaceOM type="yesno" description="Reset surface organic matter?">yes</resetSurfaceOM>
              </ui>
              <script>
                <text>
         if (today = date('[reset_date]')) then
            resetWater = '[resetWater]'
            resetNitrogen  = '[resetNitrogen]'
            resetSurfaceOM = '[resetSurfaceOM]'
            if (resetWater = 'yes') then
                '[soilmodule] Water' reset
            endif
            if (resetNitrogen = 'yes') then
                '[soilmodule] Nitrogen' reset
            endif
            if (resetSurfaceOM = 'yes') then
                '[surfaceommodule]' reset
            endif
            act_mods reseting
         endif
                                </text>
                <event>start_of_day</event>
              </script>
            </manager>
          </folder>
          <outputfile>
            <filename output="yes">350ppm.out</filename>
            <title>350ppm</title>
            <variables name="Variables">
              <variable array="?" description="Date (dd/mm/yyyy)">dd/mm/yyyy as Date</variable>
              <variable array="?" description="Biomass">Biomass</variable>
              <variable array="?" description="Yield">Yield</variable>
              <variable array="?" description="grain protein content">grain_protein</variable>
              <variable array="?" description="Size of each grain">grain_size</variable>
              <variable array="?" description="Extractable Soil Water (mm)">esw</variable>
            </variables>
            <events name="Reporting Frequency">
              <event description="">harvesting</event>
            </events>
          </outputfile>
        </area>
      </simulation>
      <simulation name="600ppm">
        <memo name="Read Me">Climate Change in APSIM Simulations

To perform a simple simulation to quantify the effects of climate change on production system simply drag a climate change object from the standard toolbow onto the simulation at the same level as your met file.  The climate change user interface will allow you to enter simple modifiers (either additive or multiplicative) for maximum and minimum temperature, solar radiation and rainfall.
                </memo>
        <manager name="ClimateControl">
          <ui>
            <category type="category" description="Climate Control Window" />
            <date1 type="ddmmmdate" description="Enter window START date (dd-mmm) : ">1-jan</date1>
            <date2 type="ddmmmdate" description="Enter window END date (dd-mmm) : ">31-dec</date2>
            <category type="category" description="Climate Change Parameters" />
            <MaxtChange type="text" description="Change in maximum temperature (oC):">2</MaxtChange>
            <MintChange type="text" description="Change in minimum temperature (oC):">2</MintChange>
            <RainChange type="text" description="Relative change in daily rainfall (%):">-10</RainChange>
            <RadnChange type="text" description="Relative change in daily radiation (%):">0</RadnChange>
            <CO2 type="text" description="Atmospheric CO2 Concentration (ppm)">600</CO2>
          </ui>
          <script>
            <text>
!  Adjust daily temperatures, rainfall and radiation up or down according to user-defined amounts
! To apply different levels of climate control to different times of year add multiple copies of this logic into your simulation and change the window.

if (date_within('[date1], [date2]') = 1) then
   maxt = maxt + [MaxtChange]
   mint = mint + [MintChange]
   rain = rain + rain * [RainChange] / 100
   radn = radn + radn * [RadnChange] / 100
   co2 = [CO2]
 endif
                        </text>
            <event>prenewmet</event>
          </script>
          <script>
            <text>co2 = [CO2]
tav = tav + ([MaxtChange] + [MintChange]) / 2
                        </text>
            <event>Init</event>
          </script>
        </manager>
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1970</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1989</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <Soil>
            <SoilType>Black Vertosol</SoilType>
            <LocalName>Waco</LocalName>
            <Site>Jimbour</Site>
            <NearestTown>Jimbour, Q 4352</NearestTown>
            <Region>South East Queensland</Region>
            <NaturalVegetation>Grassland, mainly Qld bluegrass</NaturalVegetation>
            <Latitude>0</Latitude>
            <Longitude>0</Longitude>
            <InitialWater name="Initial water">
              <FractionFull>0.3</FractionFull>
              <DepthWetSoil>NaN</DepthWetSoil>
              <PercentMethod>FilledFromTop</PercentMethod>
              <RelativeTo>ll15</RelativeTo>
            </InitialWater>
            <Water>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.02</double>
                <double>1.03</double>
                <double>1.02</double>
                <double>1.02</double>
                <double>1.06</double>
                <double>1.11</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.2</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.15</double>
                <double>0.26</double>
                <double>0.29</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
                <double>0.34</double>
                <double>0.35</double>
                <double>0.36</double>
              </AirDry>
              <LL15>
                <double>0.29</double>
                <double>0.29</double>
                <double>0.29</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
                <double>0.34</double>
                <double>0.35</double>
                <double>0.36</double>
              </LL15>
              <DUL>
                <double>0.54</double>
                <double>0.53</double>
                <double>0.54</double>
                <double>0.54</double>
                <double>0.52</double>
                <double>0.5</double>
                <double>0.5</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.44</double>
              </DUL>
              <SAT>
                <double>0.59</double>
                <double>0.58</double>
                <double>0.59</double>
                <double>0.58</double>
                <double>0.57</double>
                <double>0.55</double>
                <double>0.55</double>
                <double>0.53</double>
                <double>0.52</double>
                <double>0.51</double>
                <double>0.49</double>
              </SAT>
              <SoilCrop name="Barley">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.32</double>
                  <double>0.38</double>
                  <double>0.39</double>
                  <double>0.39</double>
                  <double>0.41</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.01</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Chickpea">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.36</double>
                  <double>0.43</double>
                  <double>0.51</double>
                  <double>0.5</double>
                  <double>0.5</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.01</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Lucerne">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                  <double>0.34</double>
                  <double>0.35</double>
                  <double>0.36</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Maize">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.34</double>
                  <double>0.34</double>
                  <double>0.37</double>
                  <double>0.4</double>
                  <double>0.42</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Perennial Grass">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.39</double>
                  <double>0.41</double>
                  <double>0.4</double>
                  <double>0.4</double>
                  <double>0.41</double>
                  <double>0.41</double>
                  <double>0.4</double>
                  <double>0.4</double>
                  <double>0.42</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.09</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.35</double>
                  <double>0.38</double>
                  <double>0.4</double>
                  <double>0.4</double>
                  <double>0.4</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.32</double>
                  <double>0.32</double>
                  <double>0.35</double>
                  <double>0.38</double>
                  <double>0.41</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.01</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>3.5</WinterCona>
              <WinterU>6</WinterU>
              <WinterDate>1-Apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Slope>0</Slope>
              <DischargeWidth>0</DischargeWidth>
              <CatchmentArea>0</CatchmentArea>
              <MaxPond>0</MaxPond>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>200</RootWt>
              <SoilCN>12.5</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1.04</double>
                <double>0.89</double>
                <double>0.89</double>
                <double>0.89</double>
                <double>0.77</double>
                <double>0.45</double>
                <double>0.27</double>
                <double>0.22</double>
                <double>0.16</double>
                <double>0.13</double>
                <double>0.12</double>
              </OC>
              <FBiom>
                <double>0.025</double>
                <double>0.02</double>
                <double>0.015</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.2</double>
                <double>0.25</double>
                <double>0.31</double>
                <double>0.4</double>
                <double>0.59</double>
                <double>0.84</double>
                <double>0.93</double>
                <double>1.01</double>
                <double>1.06</double>
                <double>1.05</double>
                <double>1.01</double>
              </EC>
              <PH>
                <double>8.4</double>
                <double>8.8</double>
                <double>9</double>
                <double>9.2</double>
                <double>9.2</double>
                <double>9.1</double>
                <double>9</double>
                <double>9</double>
                <double>8.9</double>
                <double>8.9</double>
                <double>8.9</double>
              </PH>
            </Analysis>
            <Sample name="Initial nitrogen">
              <Date type="date" description="Sample date:" />
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <NO3>
                <double>6.503</double>
                <double>2.101</double>
                <double>2.101</double>
                <double>1.701</double>
                <double>1.701</double>
                <double>1.701</double>
                <double>1.701</double>
                <double>1.701</double>
                <double>1.701</double>
                <double>1.701</double>
                <double>1.701</double>
              </NO3>
              <NH4>
                <double>0.599</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
                <double>0.100</double>
              </NH4>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <wheat />
          <folder name="Manager folder">
            <manager name="Sowing rule">
              <ui>
                <category description="Sowing criteria" type="category" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm) : ">15-may</date1>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm) : ">10-jul</date2>
                <must_sow type="yesno" description="Must sow? : ">no</must_sow>
                <raincrit type="text" description="Amount of rainfall : ">30</raincrit>
                <rainnumdays type="text" description="Number of days of rainfall : ">3</rainnumdays>
                <esw_amount type="text" description="Enter minimum allowable available soil water (mm) : ">200</esw_amount>
                <category description="Sowing parameters" type="category" />
                <crop type="crop" description="Enter name of crop to sow : ">wheat</crop>
                <density type="text" description="Enter sowing density  (plants/m2) : ">100</density>
                <depth type="text" description="Enter sowing depth  (mm) : ">30</depth>
                <cultivar type="cultivars" description="Enter cultivar : ">hartog</cultivar>
                <class type="classes" description="Enter crop growth class : ">plant</class>
                <row_spacing type="text" description="Enter row spacing (mm) : ">250</row_spacing>
              </ui>
              <script>
                <text>
      if (paddock_is_fallow() = 1 and FallowIn &lt;&gt; 'yes' and (NextCrop = 0 or NextCrop = '[crop]')) then
         if (date_within('[date1], [date2]') = 1) then
            if (rain[[rainnumdays]] &gt;= [raincrit] AND esw &gt;= [esw_amount]) OR
                ('[must_sow]' = 'yes' AND today = date('[date2]'))) THEN
               ChooseNextCrop = 'yes'   ! for rotations
               [crop] sow plants =[density], sowing_depth = [depth], cultivar = [cultivar], row_spacing = [row_spacing], crop_class = [class]
            endif
            if today = date('[date2]') then
               ChooseNextCrop = 'yes'
            endif
         endif
      endif
                                </text>
                <event>start_of_day</event>
              </script>
              <script>
                <text>
            nextcrop = 0
            fallowin = 0
                                </text>
                <event>init</event>
              </script>
            </manager>
            <manager name="Sowing fertiliser">
              <ui>
                <category description="When should fertiliser be applied" type="category" />
                <modulename type="modulename" description="On which module should the event come from : ">wheat</modulename>
                <eventname type="text" description="On which event should fertiliser be applied : ">sowing</eventname>
                <category description="Fertiliser application details" type="category" />
                <fertmodule type="modulename" description="Module used to apply the fertiliser : ">fertiliser</fertmodule>
                <fert_amount_sow type="text" description="Amount of starter fertiliser at sowing (kg/ha) : ">150</fert_amount_sow>
                <fert_type_sow type="list" listvalues="NO3_N, NH4_N, NH4NO3, urea_N, urea_no3, urea, nh4so4_n, rock_p, banded_p, broadcast_p" description="Sowing fertiliser type : ">urea_N</fert_type_sow>
              </ui>
              <script>
                <text>
        [fertmodule] apply amount = [fert_amount_sow] (kg/ha), depth = 50 (mm), type = [fert_type_sow]
                                </text>
                <event>[modulename].[eventname]</event>
              </script>
            </manager>
            <manager name="Harvesting rule">
              <ui>
                <category type="category" description="Harvesting criteria" />
                <crop type="crop" description="Enter name of crop to harvest when ripe : ">wheat</crop>
              </ui>
              <script>
                <text>

           if [crop].StageName = 'harvest_ripe' or [crop].plant_status = 'dead' then
              [crop]  harvest
              [crop]  end_crop
           endif

                                </text>
                <event>end_of_day</event>
              </script>
            </manager>
            <manager name="Reset water, nitrogen and surfaceOM on fixed date">
              <ui>
                <category type="category" description="When should a reset be done" />
                <reset_date type="ddmmmdate" description="Enter date of reset (dd-mmm) : ">1-jan</reset_date>
                <category type="category" description="Reset details" />
                <soilmodule type="modulename" description="Name of your soil module : ">Soil</soilmodule>
                <surfaceommodule type="modulename" description="Name of your surface organic matter module : ">SurfaceOrganicMatter</surfaceommodule>
                <resetWater type="yesno" description="Reset soil water?">yes</resetWater>
                <resetNitrogen type="yesno" description="Reset soil nitrogen?">yes</resetNitrogen>
                <resetSurfaceOM type="yesno" description="Reset surface organic matter?">yes</resetSurfaceOM>
              </ui>
              <script>
                <text>
         if (today = date('[reset_date]')) then
            resetWater = '[resetWater]'
            resetNitrogen  = '[resetNitrogen]'
            resetSurfaceOM = '[resetSurfaceOM]'
            if (resetWater = 'yes') then
                '[soilmodule] Water' reset
            endif
            if (resetNitrogen = 'yes') then
                '[soilmodule] Nitrogen' reset
            endif
            if (resetSurfaceOM = 'yes') then
                '[surfaceommodule]' reset
            endif
            act_mods reseting
         endif
                                </text>
                <event>start_of_day</event>
              </script>
            </manager>
          </folder>
          <outputfile>
            <filename output="yes">600ppm.out</filename>
            <title>600ppm</title>
            <variables name="Variables">
              <variable array="?" description="Date (dd/mm/yyyy)">dd/mm/yyyy as Date</variable>
              <variable array="?" description="Biomass">Biomass</variable>
              <variable array="?" description="Yield">Yield</variable>
              <variable array="?" description="grain protein content">grain_protein</variable>
              <variable array="?" description="Size of each grain">grain_size</variable>
              <variable array="?" description="Extractable Soil Water (mm)">esw</variable>
            </variables>
            <events name="Reporting Frequency">
              <event description="">harvesting</event>
            </events>
          </outputfile>
        </area>
      </simulation>
      <Graph name="Probability Exceedence">
        <Legend>
          <CheckedTitles> 350ppm</CheckedTitles>
          <CheckedTitles> 600ppm</CheckedTitles>
        </Legend>
        <Plot>
          <SeriesType>Solid line</SeriesType>
          <PointType>None</PointType>
          <Y>Probability of being above</Y>
          <colour>
          </colour>
          <X>Yield</X>
          <GDProbability>
            <Exceedence>Yes</Exceedence>
            <GDApsimFileReader name="ApsimFileReader" />
          </GDProbability>
        </Plot>
      </Graph>
    </folder>
    <folder name="Advanced - Wheat Lucerne Rotation">
      <simulation name="WheatLucerne">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1940</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1989</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <cotton />
          <Soil name="Heavy Clay">
            <RecordNumber>0</RecordNumber>
            <SoilType>Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown>Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude>-27.564333</Latitude>
            <Longitude>151.953991</Longitude>
            <LocationAccuracy>Regional Soil Type</LocationAccuracy>
            <YearOfSampling>0</YearOfSampling>
            <DataSource>YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments>Generic soil developed by Allan Peake.</Comments>
            <Water>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="lucerne">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <FractionFull>1</FractionFull>
              <DepthWetSoil>NaN</DepthWetSoil>
              <PercentMethod>FilledFromTop</PercentMethod>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <NO3>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
              </NO3>
              <NH4>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
              </NH4>
              <SW>
                <double>0</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
              </SW>
              <NO3Units>ppm</NO3Units>
              <NH4Units>ppm</NH4Units>
              <SWUnits>Volumetric</SWUnits>
              <OCUnits>Total</OCUnits>
              <PHUnits>Water</PHUnits>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat_stubble</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <lucerne />
          <wheat />
          <folder name="Manager folder">
            <rotplot name="Rotation Management">
              <canvas_height>362</canvas_height>
              <rules_height>207</rules_height>
              <graph_name>stateGraph</graph_name>
              <language>C#</language>
              <node>
                <name>lucerne</name>
                <x1>191</x1>
                <y1>319</y1>
                <desc>
                </desc>
                <fill>-8323328</fill>
              </node>
              <node>
                <name>wheat</name>
                <x1>190</x1>
                <y1>10</y1>
                <desc>
                </desc>
                <fill>-16744320</fill>
              </node>
              <node>
                <name>summer_fallow2</name>
                <x1>10</x1>
                <y1>160</y1>
                <desc>
                </desc>
                <fill>-4144960</fill>
              </node>
              <node>
                <name>summer_fallow</name>
                <x1>358</x1>
                <y1>170</y1>
                <desc>
                </desc>
                <fill>-657956</fill>
              </node>
              <arc>
                <name>arc2</name>
                <source>wheat</source>
                <target>summer_fallow2</target>
                <x>50</x>
                <y>55</y>
                <actions>Wheat Management.Leave</actions>
                <actions>SummerFallow.Enter</actions>
                <rules>Wheat Management.canLeave</rules>
              </arc>
              <arc>
                <name>arc6</name>
                <source>summer_fallow</source>
                <target>wheat</target>
                <x>419</x>
                <y>56</y>
                <actions>SummerFallow.Leave</actions>
                <actions>Wheat Management.Enter</actions>
                <rules>SummerFallow.canLeave</rules>
                <rules>Wheat Management.canEnter</rules>
              </arc>
              <arc>
                <name>arc8</name>
                <source>lucerne</source>
                <target>summer_fallow</target>
                <x>417</x>
                <y>385</y>
                <actions>Lucerne Ley Management.Leave</actions>
                <actions>SummerFallow.Enter</actions>
                <rules>Lucerne Ley Management.canLeave</rules>
              </arc>
              <arc>
                <name>arc0</name>
                <source>summer_fallow2</source>
                <target>lucerne</target>
                <x>51</x>
                <y>386</y>
                <actions>SummerFallow.Leave</actions>
                <actions>Lucerne Ley Management.Enter</actions>
                <rules>SummerFallow.CanLeave</rules>
                <rules>Lucerne Ley Management.canEnter</rules>
              </arc>
              <arc>
                <name>arc1</name>
                <source>lucerne</source>
                <target>lucerne</target>
                <x>184</x>
                <y>200</y>
                <actions>Lucerne Ley Management.Harvest</actions>
                <rules>Lucerne Ley Management.canHarvest</rules>
              </arc>
              <paddock>
                <name>paddock</name>
                <isManaged>True</isManaged>
                <initialState>summer_fallow</initialState>
              </paddock>
              <component name="Rotation Management_" executable="%apsim%/Model/Manager2.dll">
                <executable>%apsim%/Model/Manager2.dll</executable>
                <initdata>
                  <text><![CDATA[using System;
using System.Collections.Generic;
using System.Dynamic;
using System.Text;
using ModelFramework;
using CSGeneral;
public class Script {
[Link] public Simulation MySimulation;
private List<string> paddocks = new List<string>();
private List<dynamic> paddockStates = new List<dynamic>();
private Graph g = new Graph();
private Dictionary<string,string> _currentState = new Dictionary<string,string>();
[Output, Description("Current State of DG")] public string currentState {
  get {string[] r = new string[_currentState.Count]; _currentState.Values.CopyTo(r,0);  
       return(String.Join(" ", r));} 
}
private void setState(string p, string s) {
  _currentState[p] = s;
}
private string getState(string p) {
  return(_currentState[p]);
}
[Output, Description("Current paddock")] public string currentPaddock = "";
[Output] public string [] states = new string[0]; 
[EventHandler] public void OnInitialised()
{
g = new Graph();
states = new string[4];
int i = 0;
g.AddNode("lucerne");
states[i++] = "lucerne";
g.AddNode("wheat");
states[i++] = "wheat";
g.AddNode("summer_fallow2");
states[i++] = "summer_fallow2";
g.AddNode("summer_fallow");
states[i++] = "summer_fallow";
ruleAction arc2 = new ruleAction();
arc2.testCondition.Add("Wheat Management.canLeave");
arc2.action.Add("Wheat Management.Leave");
arc2.action.Add("SummerFallow.Enter");
g.AddDirectedEdge("wheat","summer_fallow2",arc2);
ruleAction arc6 = new ruleAction();
arc6.testCondition.Add("SummerFallow.canLeave");
arc6.testCondition.Add("Wheat Management.canEnter");
arc6.action.Add("SummerFallow.Leave");
arc6.action.Add("Wheat Management.Enter");
g.AddDirectedEdge("summer_fallow","wheat",arc6);
ruleAction arc8 = new ruleAction();
arc8.testCondition.Add("Lucerne Ley Management.canLeave");
arc8.action.Add("Lucerne Ley Management.Leave");
arc8.action.Add("SummerFallow.Enter");
g.AddDirectedEdge("lucerne","summer_fallow",arc8);
ruleAction arc0 = new ruleAction();
arc0.testCondition.Add("SummerFallow.CanLeave");
arc0.testCondition.Add("Lucerne Ley Management.canEnter");
arc0.action.Add("SummerFallow.Leave");
arc0.action.Add("Lucerne Ley Management.Enter");
g.AddDirectedEdge("summer_fallow2","lucerne",arc0);
ruleAction arc1 = new ruleAction();
arc1.testCondition.Add("Lucerne Ley Management.canHarvest");
arc1.action.Add("Lucerne Ley Management.Harvest");
g.AddDirectedEdge("lucerne","lucerne",arc1);
}
[EventHandler] public void OnStart_Simulation()
{
paddocks.Add("paddock");
setState("paddock","summer_fallow");
   MySimulation.Publish("transition");
}
[Output] public string paddock_state {get {return(getState("paddock"));}}
private string modname(string x) {
  if (x.Contains(".")) return(x.Split('.')[0]);
  return("");
}
private string varname(string x) {
  if (x.Contains(".")) return(x.Split('.')[1]);
  return(x);
}
[EventHandler] public void OnProcess()
{
   bool more = true;
   while (more) {
      more = false;
      double bestScore = -1.0; string bestArc = ""; string bestPaddock = "";
      foreach (string p in paddocks) {
         Node s = g.FindNode(getState(p));
         // Console.WriteLine(" state=" + s.Name);
         foreach (string _arc in s.arcs.Keys) {
            double score = 1;
            foreach (string testCondition in s.arcs[_arc].testCondition){
               double c = 0.0;
               currentPaddock = p;
               if (MySimulation.Get(testCondition, out c))
                  score *= c;
               else
                  throw new Exception("Nothing returned from expression '" + testCondition + "'");
               //Console.WriteLine(" p=" + p +" a=" + _arc + "cond=" + testCondition + " score=" + score);
            }
            if (score > bestScore) {
               bestScore = score;
               bestArc = _arc;
               bestPaddock = p;
            }
         }
      }
      currentPaddock = "";
      if (bestScore > 0.0) {
         Node s = g.FindNode(getState(bestPaddock));
         if( bestPaddock != "")
            currentPaddock = bestPaddock;
         if (getState(bestPaddock) != "") MySimulation.Publish("transition_from_" + getState(bestPaddock));
         MySimulation.Publish("transition");
         setState (bestPaddock, g.FindArcTarget(bestArc));
         foreach (string action in s.arcs[bestArc].action ) {
            MySimulation.Publish(action);
            //Console.WriteLine(" best=" + bestPaddock + " action=" + action);
         }
         MySimulation.Publish("transition_to_" + getState(bestPaddock));
         more = true;
      }
   }
}
  public class ruleAction
  {
     public string Target;
     public List<string> testCondition = new List<string>();
     public List<string> action = new List<string>();
  }
   public class Node : IEquatable<Node>
   {
      private string data /*, alias*/;
      public Node(string _data) { data = _data; }
      public Dictionary<string, ruleAction> arcs = new Dictionary<string, ruleAction>();
      public bool Equals(Node other)
      {
         return ( this.data == other.data );
      }
      public string Name { get { return (data); } }
   }

   class Graph
   {
      public List<Node> vertices;
      public void print() {
         foreach (Node n in vertices) {
            Console.WriteLine(n.Name + ":"); 
            foreach (string k in n.arcs.Keys) {
               Console.WriteLine("  " + k); 
            }
         }
      }
      public Graph() { vertices = new List<Node>(); }
      public Node AddNode(Node node)
      {
         if (vertices.Find(delegate(Node n) { return (n.Equals(node)); }) == null)
            vertices.Add(node);
         return (vertices.Find(delegate(Node n) { return (n.Equals(node)); }));
      }
      public Node AddNode(string value)
      {
         return (AddNode(new Node(value)));
      }
      public Node FindNode(string value)
      {
         return (FindNode(AddNode(value)));
      }
      public Node FindNode(Node node)
      {
         return (vertices.Find(delegate(Node n) { return (n.Equals(node)); }));
      }
      public void AddDirectedEdge(string source, string dest, ruleAction value)
      {
         int i = 0;
         foreach (Node n in vertices) {
            foreach (string arc in n.arcs.Keys) {
               i++;
            }
         }
         Node node1 = AddNode(source);
         AddNode(dest);
         value.Target = dest;
         node1.arcs.Add("arc" + i.ToString(), value);
      }
      public string FindArcTarget(string arc)
      {
         foreach (Node n in vertices) {
            foreach (string a in n.arcs.Keys) {
               if (a == arc) { return (n.arcs[a].Target); }
            }
         }
         Console.WriteLine("Aiee - no target for arc " + arc ); 
         return("");
      }
   }
}
]]></text>
                </initdata>
              </component>
            </rotplot>
            <manager2 name="Lucerne Ley Management">
              <ui>
                <category type="category" description="Crop properties" />
                <crop type="crop" description="Name of this crop">lucerne</crop>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm)">15-sep</date1>
                <date3 type="ddmmmdate" description="Enter cultivar change date (na if not in use)">na</date3>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm)">10-dec</date2>
                <must_sow type="yesno" description="Must Sow">yes</must_sow>
                <rain_amount type="text" description="Enter amount of cumulative rainfall (mm)">25</rain_amount>
                <rain_days type="text" description="Enter number of days to accumulate rainfall (days)">3</rain_days>
                <esw_amount type="text" description="Enter amount of soil water (mm)">50</esw_amount>
                <category type="category" description="Sowing Parameters" />
                <cultivar1 type="cultivars" description="Enter cultivar : ">hunter_river</cultivar1>
                <cultivar2 type="cultivars" description="Enter 2nd Cultivar (na if not using a second cultivar)">na</cultivar2>
                <density1 type="text" description="Enter sowing density  (plants/m2)">50</density1>
                <depth1 type="text" description="Enter sowing depth  (mm)">30</depth1>
                <row_spacing1 type="text" description="Enter row spacing  (mm)">250</row_spacing1>
                <category type="category" description="Extra Parameters" />
                <ftn1 type="text" description="Enter Fertile Tiller Number (na for auto) : ">na</ftn1>
                <skiprow1 type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow1>
                <tillageImplement type="text" description="Name of tillage implement (na if not in use): ">na</tillageImplement>
                <yearsInLey type="text" description="Years in ley">3</yearsInLey>
              </ui>
              <text>using System;
using System.Collections.Generic;
using ModelFramework;
using CSGeneral;

// Basic crop management: sowing &amp; harvesting.
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.
// It will assume it is the only crop in the system if it doesnt find a sequencer.
// If it does find a sequencer, it will do nothing until told to (via Enter/Leave).
public class Script 
{      
   [Link()]  public Simulation MySimulation;
   
   [Param()] private string crop;         // The module name of this crop
   [Param()] private string date1;         //Start of sowing window
   [Param()] private string date2;         //End of sowing window
   [Param()] private string date3;         //date to change to different cultivar
   [Param()] int esw_amount;
   [Param()] private string must_sow;

   [Input()] private DateTime today;

   // Rainfall accumulator
   [Param()] int rain_days;              //check for rain over this period
   [Param()] int rain_amount;            //this much rain over that period

   // Day tracker
   private Dictionary&lt;string,int&gt; daysIn = new Dictionary&lt;string,int&gt;();
   [Param] float yearsInLey;            // How many years to remain in ley phase
  
   // Daily rainfall from the system
   [Input] private double rain;
   private ManagerUtility.Tracker&lt;double&gt; rainTracker; 

   private bool inWindow = false;
   private bool endOfWindow = false;
   private bool ChangeCultivar = false;

   //initialise tracker, telling it how many days to track
   [EventHandler] public void OnStart_Simulation()
   {
      rainTracker = new ManagerUtility.Tracker&lt;double&gt;(rain_days); 
      daysIn.Add("", -1);
      foreach (Paddock paddock in MySimulation.ChildPaddocks) 
         daysIn.Add(paddock.Name, -1);

   }

   // Daily tests common to all paddocks
   [EventHandler] public void OnPrepare()
   {
      bool startOfWindow = DateUtility.DatesEqual(date1, today);

      inWindow = DateUtility.WithinDates(date1, today, date2);
      ChangeCultivar = false;
      if(date3 != "na")  
         ChangeCultivar = DateUtility.WithinDates(date3, today, date2);
      endOfWindow = DateUtility.DatesEqual(date2, today);

      rainTracker.Add(rain);
      string currentPaddock = "";
      if (MySimulation.Get("currentPaddock", out currentPaddock) == false) 
      {
         // If there is no sequencer plugged in then we are it..
         if (canEnter &gt; 0) {
            OnEnter();
         }
         if (canLeave &gt; 0) {
            OnLeave();
         }
      }
   }
   [EventHandler] public void OnPost()
   {
      List &lt;string&gt; paddocks = new List&lt;string&gt;(daysIn.Keys);
      foreach (string p in paddocks) 
         if (daysIn[p] &gt;= 0)
            daysIn[p]++;
   }
   // Test whether we can sow a crop today
   // +ve number - yes
   // 0          - no
   // -ve number - no, out of scope (planting window)
   [Output, Description("Test whether we can sow a crop today")] public int canEnter  {
      get {
         bool isPossibleToday = false;
         
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("1. '" + currentPaddock + "'");

         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Component cropModule = (Component) paddockModule.LinkByName( crop );

         //Console.WriteLine("3. " + cropModule.Name);
         string plantStatus = "";
         cropModule.Get("plant_status", out plantStatus);

         double esw = 0.0;
         Component soilModule = (Component) paddockModule.LinkByType("SoilWat");
         soilModule.Get("esw", out esw);
         if (plantStatus == "out" &amp;&amp;
             inWindow &amp;&amp;
             rainTracker.Sum() &gt;= rain_amount &amp;&amp;
             esw &gt; esw_amount) 
         {
             isPossibleToday = true;
         } 

	     if (isPossibleToday)
            return 1;
         
         if (plantStatus == "out" &amp;&amp; endOfWindow &amp;&amp; must_sow == "yes")
            return 1;

         if (plantStatus == "out" &amp;&amp; !inWindow)
            return -1;
         
         return 0;
      }
   }  
   [Output, Description("Test whether we have passed the end of the window")] public int pastWindow  {
      get {
         return( (DateUtility.CompareDates(date2, today) &lt; 0) ? 1 : 0);
      }
   }
   
   // Sow a crop
   [Param()] private string cultivar1;
   [Param()] private string cultivar2;
   [Param()] private double density1;
   [Param()] private double depth1;
   [Param()] private double row_spacing1;
   [Param()] private string ftn1;
   [Param()] private string skiprow1;
   [Param()] private string tillageImplement;
   
   [EventHandler, Description("Sow the crop")] public void OnEnter()
   {
      Console.WriteLine(today + " Sowing Crop");
      SowType data = new SowType();
      data.Cultivar = cultivar1;
      if(ChangeCultivar)
         data.Cultivar = cultivar2;

      data.plants = density1;
      data.sowing_depth = depth1;
      data.row_spacing = row_spacing1;
      data.tiller_no_fertile = (ftn1 == "na") ? "" : ftn1;
      data.SkipRow = 0 ;
      if (skiprow1 == "single")
         data.SkipRow = 1;
      else if (skiprow1 == "double")
         data.SkipRow = 2;

      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("Sow", data);
      if (tillageImplement.ToLower() != "na") 
	  {
         TillageType t = new TillageType();
         t.type = tillageImplement;
         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = MySimulation.ChildPaddocks[0];
         paddockModule.Publish("tillage", t);
      }		 
      daysIn[currentPaddock] = 0;
   }

   // Test whether we can harvest a crop today
   // +ve number - yes
   // 0          - no
   // -ve        - out of scope
   [Output, Description("Test whether the ley has finished")] public int canLeave  
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (plantStatus == "dead")
            return 1;
         
         if (daysIn[currentPaddock] &gt; /*(int) (*/365.25 * yearsInLey)
            return 1;
         
         return 0;
      }
   }

   [EventHandler] public void OnLeave()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 0.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);

      KillCropType kdata = new KillCropType();
      kdata.KillFraction = 0.0F;
      cropModule.Publish("killcrop", kdata);
      cropModule.Publish("end_crop");
   } 

   [EventHandler] public void OnHarvest()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 1.0;
      hdata.Height = 50.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);
   } 
   [Output, Description("Test whether the crop can be harvested")] public int canHarvest 
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (StageName == "flowering")
            return 1;
         return 0;
      }
   }

}
       </text>
            </manager2>
            <manager2 name="Wheat Management">
              <ui>
                <category type="category" description="Crop properties" />
                <crop type="crop" description="Name of this crop">wheat</crop>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm)">15-may</date1>
                <date3 type="ddmmmdate" description="Enter cultivar change date (na if not in use)">na</date3>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm)">10-jul</date2>
                <must_sow type="yesno" description="Must Sow">yes</must_sow>
                <rain_amount type="text" description="Enter amount of cumulative rainfall (mm)">25</rain_amount>
                <rain_days type="text" description="Enter number of days to accumulate rainfall (days)">3</rain_days>
                <esw_amount type="text" description="Enter amount of soil water (mm)">50</esw_amount>
                <category type="category" description="Sowing Parameters" />
                <cultivar1 type="cultivars" description="Enter cultivar : ">hartog</cultivar1>
                <cultivar2 type="cultivars" description="Enter 2nd Cultivar (na if not using a second cultivar)">na</cultivar2>
                <density1 type="text" description="Enter sowing density  (plants/m2)">100</density1>
                <depth1 type="text" description="Enter sowing depth  (mm)">30</depth1>
                <row_spacing1 type="text" description="Enter row spacing  (mm)">250</row_spacing1>
                <category type="category" description="Extra Parameters" />
                <ftn1 type="text" description="Enter Fertile Tiller Number (na for auto) : ">na</ftn1>
                <skiprow1 type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow1>
                <tillageImplement type="text" description="Name of tillage implement (na if not in use): ">na</tillageImplement>
              </ui>
              <text>using System;
using ModelFramework;
using CSGeneral;

// Basic crop management: sowing &amp; harvesting.
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.
// It will assume it is the only crop in the system if it doesnt find a sequencer.
// If it does find a sequencer, it will do nothing until told to (via Enter/Leave).
public class Script 
{      
   [Link()]  public Simulation MySimulation;
   
   [Param()] private string crop;         // The module name of this crop
   [Param()] private string date1;         //Start of sowing window
   [Param()] private string date2;         //End of sowing window
   [Param()] private string date3;         //date to change to different cultivar
   [Param()] int esw_amount;
   [Param()] private string must_sow;

   [Input()] private DateTime today;

   // Rainfall accumulator
   [Param()] int rain_days;              //check for rain over this period
   [Param()] int rain_amount;            //this much rain over that period

   // Daily rainfall from the system
   [Input] private double rain;
   private ManagerUtility.Tracker&lt;double&gt; rainTracker; 

   private bool inWindow = false;
   private bool endOfWindow = false;
   private bool ChangeCultivar = false;

   //initialise tracker, telling it how many days to track
   [EventHandler] public void OnInitialised()
   {
      rainTracker = new ManagerUtility.Tracker&lt;double&gt;(rain_days); 
   }

   // Daily tests common to all paddocks
   [EventHandler] public void OnPrepare()
   {
      bool startOfWindow = DateUtility.DatesEqual(date1, today);

      inWindow = DateUtility.WithinDates(date1, today, date2);
      ChangeCultivar = false;
      if(date3 != "na")  
         ChangeCultivar = DateUtility.WithinDates(date3, today, date2);
      endOfWindow = DateUtility.DatesEqual(date2, today);

      rainTracker.Add(rain);
      string currentPaddock = "";
      if (MySimulation.Get("currentPaddock", out currentPaddock) == false) 
      {
         // If there is no sequencer plugged in then we are it..
         if (canEnter &gt; 0) {
            OnEnter();
         }
         if (canLeave &gt; 0) {
            OnLeave();
         }
      }
   }
   // Test whether we can sow a crop today
   // +ve number - yes
   // 0          - no
   // -ve number - no, out of scope (planting window)
   [Output, Description("Test whether we can sow a crop today")] public int canEnter  {
      get {
         bool isPossibleToday = false;
         
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("1. '" + currentPaddock + "'");

         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Component cropModule = (Component) paddockModule.LinkByName( crop );

         //Console.WriteLine("3. " + cropModule.Name);
         string plantStatus = "";
         cropModule.Get("plant_status", out plantStatus);

         double esw = 0.0;
         Component soilModule = (Component) paddockModule.LinkByType("SoilWat");
         soilModule.Get("esw", out esw);
         if (plantStatus == "out" &amp;&amp;
             inWindow &amp;&amp;
             rainTracker.Sum() &gt;= rain_amount &amp;&amp;
             esw &gt; esw_amount) 
         {
             isPossibleToday = true;
         } 

	     if (isPossibleToday)
            return 1;
         
         if (plantStatus == "out" &amp;&amp; endOfWindow &amp;&amp; must_sow == "yes")
            return 1;

         if (plantStatus == "out" &amp;&amp; !inWindow)
            return -1;
         
         return 0;
      }
   }  
   [Output, Description("Test whether we have passed the end of the window")] public int pastWindow  {
      get {
         return( (DateUtility.CompareDates(date2, today) &lt; 0) ? 1 : 0);
      }
   }
   
   // Sow a crop
   [Param()] private string cultivar1;
   [Param()] private string cultivar2;
   [Param()] private double density1;
   [Param()] private double depth1;
   [Param()] private double row_spacing1;
   [Param()] private string ftn1;
   [Param()] private string skiprow1;
   [Param()] private string tillageImplement;
   
   [EventHandler, Description("Sow the crop")] public void OnEnter()
   {
      Console.WriteLine(today + " Sowing Crop");
      SowType data = new SowType();
      data.Cultivar = cultivar1;
      if(ChangeCultivar)
         data.Cultivar = cultivar2;

      data.plants = density1;
      data.sowing_depth = depth1;
      data.row_spacing = row_spacing1;
      data.tiller_no_fertile = (ftn1 == "na") ? "" : ftn1;
      data.SkipRow = 0 ;
      if (skiprow1 == "single")
         data.SkipRow = 1;
      else if (skiprow1 == "double")
         data.SkipRow = 2;

      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("Sow", data);
      if (tillageImplement.ToLower() != "na") 
	  {
         TillageType t = new TillageType();
         t.type = tillageImplement;
         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = MySimulation.ChildPaddocks[0];
         paddockModule.Publish("tillage", t);
      }		 
   }

   // Test whether we can harvest a crop today
   // +ve number - yes
   // 0          - no
   // -ve        - out of scope
   [Output] public int canLeave  
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (StageName == "harvest_ripe" || plantStatus == "dead")
            return 1;
         return 0;
      }
   }

   [EventHandler] public void OnLeave()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 0.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);

      KillCropType kdata = new KillCropType();
      kdata.KillFraction = 0.0F;
      cropModule.Publish("killcrop", kdata);
      cropModule.Publish("end_crop");
   } 
}
       </text>
            </manager2>
            <manager2 name="Wheat Sowing Fertiliser">
              <ui>
                <fertType type="text" description="The type of fertiliser">Urea_N</fertType>
                <fertAmt type="text" description="Amout of fertiliser to apply (kg/ha)">150</fertAmt>
                <tag type="category" description="Event details" />
                <ModuleName type="modulename" description="On which module should the event come from: ">wheat</ModuleName>
                <EventName type="text" description="On which event should spraying be triggered">sowing</EventName>
              </ui>
              <text>using System;
using System.Linq;
using System.Collections.Generic;
using ModelFramework;

// Crop management: fertilise at sowing
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.

public class Script 
{      
   [Link]  public Simulation MySimulation;
   [Param] string fertType;
   [Param] float fertAmt;
   [Param] string ModuleName;
   [Param] string EventName;
   
   [EventHandler] public void OnStart_Simulation()
   {
      foreach (Paddock paddock in MySimulation.ChildPaddocks) 
      {
         foreach (Component child in paddock.Children) {
            if(child.Name == ModuleName){
               RuntimeEventHandler.NullFunction curried = () =&gt; OnTrigger(paddock.Name);
               MySimulation.Subscribe(child.FullName + "." + EventName, curried);
               Console.WriteLine("Subscribed '" + child.FullName + "." + EventName + " =&gt; " + paddock.Name + "'"); 
            }
         }
      }
   }

   public void OnTrigger(string paddock)
   {
      Console.WriteLine("Fertiliser OnTrigger called, paddock='" + paddock + "'"); 
      if (fertAmt &gt; 0) 
      {         
         Component paddockModule;
         if (paddock != "")
            paddockModule = (Component) MySimulation.LinkByName(paddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Fertiliser fertModule = (Fertiliser) paddockModule.LinkByName("Fertiliser");
         fertModule.Apply(fertAmt, 50, fertType);
      }
   }
}
       </text>
            </manager2>
            <manager2 name="SummerFallow">
              <ui>
                <endDate type="text" description="Enter the end date of the pause">15-mar</endDate>
              </ui>
              <text>using System;
using System.Collections.Generic;
using ModelFramework;
using CSGeneral;

// A "blocking" period that waits until a specified date.
// Multi-paddock aware.

public class Script 
{  
   [Link()] public Simulation MySimulation;

   [Input] private DateTime today; 
   [Param] private string endDate; 

   private Dictionary&lt;string,bool&gt; flag = new Dictionary&lt;string,bool&gt;();

   // +ve number - yes
   // 0          - no
   [Output, Description("Test whether we can enter the pause")] public int canEnter  
   {
      get {return (1);}
   }

   // Set the flag to say that we cannot leave until the end of the period is passed
   [EventHandler, Description("Enter the pause period")] public void OnEnter()
   {
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      flag[currentPaddock] = false;
   } 
   
   [Output, Description("Test whether we can leave the pause")] public int canLeave  
   {get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("CanLeave called, p=" + currentPaddock + ",c=" + counter[currentPaddock]);
         if (flag[currentPaddock]) {
            return (1);
         }   
         return (0);

      }
   }
   
   [EventHandler, Description("Leave the pause")] public void OnLeave()
   {
       // Nothing
   } 

   // Setup
   [EventHandler] public void OnStart_Simulation()
   {
      flag.Add("", true);
      foreach (Paddock paddock in MySimulation.ChildPaddocks) 
         flag.Add(paddock.Name, true);
   }

   // Set the flag to say that the end of the period has passed
   [EventHandler] public void OnPost()
   {
      if (DateUtility.DatesEqual(endDate, today)) {
         List &lt;string&gt; paddocks = new List&lt;string&gt;(flag.Keys);
         foreach (string p in paddocks) 
            flag[p] = true;
      }
   }
}

</text>
            </manager2>
            <manager2 name="PaddockAccumulator">
              <ui />
              <text>using System; 
using System.Collections.Generic;
using ModelFramework; 
using CSGeneral;

// This captures and accumulates the states of several paddock variables
// to be reported on a single report line. 

// Multi-paddock aware.

public class Script 
{ 
   [Link] public Simulation MySimulation;

   // Cumulative Ep
   [Output, Description("The total transpiration since the last transition"), Units("mm")] public double TEp {
      get {setup(); string s = currentPaddock() + "_Ep"; return(me[s]);}
   }
   // Cumulative Drainage
   [Output, Description("The total drainage since the last transition"), Units("mm")] public double TDrainage {
      get {setup(); string s = currentPaddock() + "_drainage"; return(me[s]);}
   }
   // Cumulative Runoff
   [Output, Description("The total runoff since the last transition"), Units("mm")] public double TRunoff {
      get {setup(); string s = currentPaddock() + "_runoff"; return(me[s]);}
   }
   // Cumulative Es
   [Output, Description("The total soil evaporation since the last transition"), Units("mm")] public double TEs {
      get {setup(); string s = currentPaddock() + "_evaporation"; return(me[s]);}
   }
   // Cumulative fertiliser
   [Output, Description("The total fertiliser applied since the last transition"), Units("kg/ha")] public double applied_fert {
      get {setup(); string s = currentPaddock() + "_applied_fert"; return(me[s]);}
   }
   // Instantaneous sw at start
   [Output, Description("The soil water on the first day of a rotation"), Units("mm")] public double swStart {
      get {setup(); string s = currentPaddock() + "_swStart"; return(me[s]);}
   }
   // Instantaneous sw at end
   [Output, Description("The soil water on the last day of a rotation"), Units("mm")] public double swYesterday {
      get {setup(); string s = currentPaddock() + "_swYesterday"; return(me[s]);}
   }
   // Instantaneous no3 at start
   [Output, Description("The soil NO3 on the first day of a rotation"), Units("kg/ha")] public double no3Start {
      get {setup(); string s = currentPaddock() + "_no3Start"; return(me[s]);}
   }
   // Instantaneous no3 at end
   [Output, Description("The soil NO3 on the last day of a rotation"), Units("kg/ha")] public double no3Yesterday {
      get {setup(); string s = currentPaddock() + "_no3Yesterday"; return(me[s]);}
   }
   // Instantaneous carbon at end
   [Output, Description("The soil carbon on the last day of a rotation"), Units("kg/ha")] public double carbonYesterday {
      get {setup(); string s = currentPaddock() + "_carbon"; return(me[s]);}
   }
   // Instantaneous yield of all crops
   [Output, Description("Crop Yield"), Units("kg/ha")] public double yield_kgha {
      get{
         double yld2 = 0;
         Paddock p = (Paddock) MySimulation.LinkByName(currentPaddock());
         foreach (Component crop in p.Crops)
         {
            double yld = 0;
            crop.Get("yield", out yld);
            yld2 = yld2 + yld;
         }
         return yld2 ;}
   }
   // Instantaneous yield of all crops
   [Output, Description("Crop Yield"), Units("kg")] public double yield_kg {
      get{
         double yld2 = 0, area = 1.0;
         Paddock p = (Paddock) MySimulation.LinkByName(currentPaddock());
         MySimulation.Get(p.Name + ".area", out area);
         foreach (Component crop in p.Crops)
         {
            double yld = 0;
            crop.Get("yield", out yld);
            yld2 = yld2 + yld * area;
         }
         return yld2 ;}
   }
   // Instantaneous biomass of all crops
   [Output, Description("Crop biomass"), Units("kg/ha")] public double biomass_kgha {
      get{
         double biomass2 = 0;
         Paddock p = (Paddock) MySimulation.LinkByName(currentPaddock());
         foreach (Component crop in p.Crops)
         {
            double biomass = 0;
            crop.Get("biomass", out biomass);
            biomass2 = biomass2 + biomass;
         }
         return biomass2 ;}
   }
   // Instantaneous yield of all crops
   [Output, Description("Crop Biomass"), Units("kg")] public double biomass_kg {
      get{
         double biomass2 = 0, area = 1.0;
         Paddock p = (Paddock) MySimulation.LinkByName(currentPaddock());
         MySimulation.Get(p.Name + ".area", out area);
         foreach (Component crop in p.Crops)
         {
            double biomass = 0;
            crop.Get("biomass", out biomass);
            biomass2 = biomass2 + biomass * area;
         }
         return biomass2 ;}
   }
   // Instantaneous protein of all crops
   [Output, Description("Grain Protein"), Units("%")] public double protein {
      get{
         double pro2 = 0;
         Paddock p = (Paddock) MySimulation.LinkByName(currentPaddock());
         foreach (Component crop in p.Crops)
         {
            double pro = 0;
            crop.Get("grain_protein", out pro);
            pro2 = pro2 + pro;
         }
        
         return pro2 ;}
   }
   
   // Instantaneous N of all crops
   [Output, Description("Grain N"), Units("g/m2")] public double GrainN_gm2 {
      get{
         double GN2 = 0;
         Paddock p = (Paddock) MySimulation.LinkByName(currentPaddock());
         foreach (Component crop in p.Crops)
         {
            double GN = 0;
            if (crop.Get("grain_N", out GN))
               GN2 = GN2 + GN;
            else if (crop.Get("GrainGreenN", out GN))
               GN2 = GN2 + GN;
         }
         return GN2 ;}
   }
   
   
   [Output, Description("The state of the current paddock"), Units("")] public string paddockState {
      get {
         string cs = "";
         string cp = currentPaddock();
         MySimulation.Get(cp + "_state", out cs);
         return(cs);
      }
   }
   [Output, Description("The number of days in a rotation"), Units("")] public int daysInPhase = 0;
 
   private string currentPaddock() {
      string result = "";
      MySimulation.Get("currentPaddock", out result);
      if (result != "")
         return(result);
      else
         return(MySimulation.ChildPaddocks[0].Name);
   }


   // An accumulator for each thing in each paddock
   private Dictionary&lt;string, double&gt; me = new Dictionary&lt;string, double&gt;();

   private void setup() {
      if (me.Keys.Count == 0) { OnStart_Simulation(); }
   }
   
   [EventHandler] public void OnStart_Simulation() { 
      if (me.Keys.Count == 0) {
         foreach (Paddock paddock in MySimulation.ChildPaddocks) 
         {
            Component soil = (Component) paddock.LinkByType("soilwat");
            double [] swdep = new double[15];
            soil.Get("sw_dep", out swdep);
            me.Add(paddock.Name + "_swStart", MathUtility.Sum(swdep));
            me.Add(paddock.Name + "_swYesterday", MathUtility.Sum(swdep));
         
            Component soilN = (Component) paddock.LinkByType("soiln");
            double [] no3dep = new double[15];
            soilN.Get("no3", out no3dep);
            me.Add(paddock.Name + "_no3Start", MathUtility.Sum(no3dep));
            me.Add(paddock.Name + "_no3Yesterday", MathUtility.Sum(no3dep));
            me.Add(paddock.Name + "_Ep", 0);
            me.Add(paddock.Name + "_drainage", 0);
            me.Add(paddock.Name + "_runoff", 0);
            me.Add(paddock.Name + "_evaporation", 0);
            me.Add(paddock.Name + "_applied_fert", 0);
            double[] carbon = new double[15];
            soilN.Get("carbon_tot", out carbon);
            me.Add(paddock.Name + "_carbon", MathUtility.Sum(carbon));
         }
      }
   } 
   [EventHandler] public void OnTransition() {
      setup();   
      string s = currentPaddock();
      me[s + "_swStart"] = me[s+"_swYesterday"]; 
      me[s + "_no3Start"] = me[s + "_no3Yesterday"];
      me[s + "_Ep"] = 0;
      me[s + "_drainage"] = 0;
      me[s + "_runoff"] = 0;
      me[s + "_evaporation"] = 0;
      me[s + "_applied_fert"] = 0;
      me[s + "_carbon"] = 0;
      daysInPhase = 0;
   } 
   [EventHandler] public void OnPost() { 
      foreach (Paddock paddock in MySimulation.ChildPaddocks) 
      {
         Component soil = (Component) paddock.LinkByType("soilwat");
         Component soilN = (Component) paddock.LinkByType("soiln");
         Component fertiliser = (Component) paddock.LinkByType("fertiliser");
         double [] swdep = new double[15];
         soil.Get("sw_dep", out swdep);
         me[paddock.Name + "_swYesterday"] = MathUtility.Sum(swdep);

         double [] no3dep = new double[15];
         soilN.Get("no3", out no3dep);
         me[paddock.Name + "_no3Yesterday"] = MathUtility.Sum(no3dep);

         double drain = 0;
         soil.Get("drain", out drain);
         me[paddock.Name + "_drainage"] += drain;

         double runoff = 0;
         soil.Get("runoff", out runoff);
         me[paddock.Name + "_runoff"] += runoff;

         double es = 0;
         soil.Get("es", out es);
         me[paddock.Name + "_evaporation"] += es;

         double applied_fert = 0;
         fertiliser.Get("fertiliser", out applied_fert);
         me[paddock.Name + "_applied_fert"] += applied_fert;

         double[] carbon = new double[15];
         soilN.Get("carbon_tot", out carbon);
         me[paddock.Name + "_carbon"] = MathUtility.Sum(carbon);

         foreach (Component crop in paddock.Crops)
         {
            double Ep = 0.0;
            if(crop.Get("Ep", out Ep))
               me[paddock.Name + "_Ep"] += Ep;
         }
      }
      daysInPhase++;
   }
} 
</text>
            </manager2>
            <manager2 name="RotationCounter">
              <ui />
              <text>using System; 
using ModelFramework; 

// Counts the number of times a rotation has completed (ie gone back to the starting point)
 
public class Script 
{ 
   [Link()] public Paddock myPaddock;   

   [Output, Description("Number of times the rotation has cycled"), Units("n")] public int rotationNumber = 0; 
  
   private string initialState = ""; 
   [EventHandler] public void OnStart_Simulation() { 
      myPaddock.Get("currentState", out initialState);  
   }    
 
   private bool needsCheck = false; 
   [EventHandler] public void OnPrepare() { needsCheck = false; } 
   [EventHandler] public void OnTransition() { needsCheck = true; } 
   [EventHandler] public void OnPost() { 
      if (needsCheck)  { 
         string currentState = ""; 
         myPaddock.Get("currentstate", out currentState);  
         if (currentState == initialState)  
            rotationNumber++; 
      } 
   } 
} 
</text>
            </manager2>
            <tracker>
              <variable>sum of rain on end_of_day from transition to now as TRainfall</variable>
              <variable>count of clock.simulation_days on end_of_day from transition to now as days_in_stage</variable>
            </tracker>
          </folder>
          <outputfile name="Harvest">
            <filename output="yes">WheatLucerne Harvest.out</filename>
            <title>WheatLucerne Harvest</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>yield</variable>
              <variable>biomass</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>harvesting</event>
            </events>
          </outputfile>
          <outputfile name="Phases">
            <filename output="yes">WheatLucerne Phases.out</filename>
            <title>WheatLucerne Phases</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>currentState</variable>
              <variable>TRainfall as Rainfall</variable>
              <variable>Trunoff as runoff</variable>
              <variable>Tes as evap</variable>
              <variable>Tdrainage as drainage</variable>
              <variable>TEp as Ep</variable>
              <variable>swStart</variable>
              <variable>swYesterday as swEnd</variable>
              <variable>no3Start</variable>
              <variable>no3Yesterday as no3End</variable>
              <variable>biomass_kgha as Biomass</variable>
              <variable>yield_kgha as Yield</variable>
              <variable>GrainN_gm2 as grainN</variable>
              <variable>carbonYesterday as carbon</variable>
              <variable>applied_fert</variable>
              <variable>rotationNumber</variable>
              <variable>simulation_days</variable>
              <variable>daysInPhase</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>transition</event>
            </events>
            <RGraphics name="Rugplot Graph">
              <script>
                <text>library(ggplot2)

apsim.input&lt;- inputFiles 
aps1 &lt;- read.table(apsim.input,skip=2,header=T) 
aps.name &lt;- names(aps1)
df &lt;- read.table(apsim.input,skip=3,header=T,col.names=aps.name,na.strings = "?")
df$Date&lt;-as.Date(df$Date, format="%d/%m/%Y")

# sort out the beginning and ending dates of each phase
x1 &lt;- df$Date[-1*nrow(df)]
x2 &lt;- df$Date[-1] 
df &lt;- df[-1,]  # throw away the first - it's from Start_Simulation
df$x1&lt;-x1
df$x2&lt;-x2

#lower bound of rectangles at bottom
df$ymin &lt;- -0.25 * max(df$Yield)
 
jpeg(file=imageFileName, width=width, height=height)
g&lt;- ggplot(df) +
 geom_bar(aes(x=Date, y=Yield, fill= currentState), stat="identity") +
 geom_rect(aes(xmin = x1 , xmax = x2, ymin= ymin, ymax=0, fill= currentState ) ) +
 scale_x_date() + scale_fill_discrete(name="state") + theme(
       axis.line = element_line(colour = "black"),
       panel.grid.major = element_blank(),
       panel.grid.minor = element_blank(),
       panel.border = element_blank(),
       panel.background = element_blank() )
print(g)

dev.off()
</text>
              </script>
            </RGraphics>
          </outputfile>
          <Graph name="XY">
            <Legend>
              <CheckedTitles> paddock.wheat.biomass</CheckedTitles>
              <CheckedTitles> paddock.lucerne.biomass</CheckedTitles>
            </Legend>
            <Plot>
              <SeriesType>Bar</SeriesType>
              <PointType>Circle</PointType>
              <colour>
              </colour>
              <X>Date</X>
              <Y>paddock.wheat.biomass</Y>
              <Y>paddock.lucerne.biomass</Y>
              <GDApsimFileReader name="ApsimFileReader" />
            </Plot>
          </Graph>
        </area>
      </simulation>
      <simulation name="WheatLucerne1">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1940</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1989</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <cotton />
          <Soil name="Heavy Clay">
            <RecordNumber>0</RecordNumber>
            <SoilType>Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown>Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude>-27.564333</Latitude>
            <Longitude>151.953991</Longitude>
            <LocationAccuracy>Regional Soil Type</LocationAccuracy>
            <YearOfSampling>0</YearOfSampling>
            <DataSource>YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments>Generic soil developed by Allan Peake.</Comments>
            <Water>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="lucerne">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <FractionFull>1</FractionFull>
              <DepthWetSoil>NaN</DepthWetSoil>
              <PercentMethod>FilledFromTop</PercentMethod>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <NO3>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
              </NO3>
              <NH4>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
                <double>0.099999999999999992</double>
              </NH4>
              <SW>
                <double>0</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
              </SW>
              <NO3Units>ppm</NO3Units>
              <NH4Units>ppm</NH4Units>
              <SWUnits>Volumetric</SWUnits>
              <OCUnits>Total</OCUnits>
              <PHUnits>Water</PHUnits>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat_stubble</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <lucerne />
          <wheat />
          <folder name="Manager folder">
            <rotplot name="Rotation Management">
              <canvas_height>362</canvas_height>
              <rules_height>207</rules_height>
              <graph_name>stateGraph</graph_name>
              <language>C#</language>
              <node>
                <name>lucerne</name>
                <x1>191</x1>
                <y1>319</y1>
                <desc>
                </desc>
                <fill>-8323328</fill>
              </node>
              <node>
                <name>wheat</name>
                <x1>190</x1>
                <y1>10</y1>
                <desc>
                </desc>
                <fill>-16744320</fill>
              </node>
              <node>
                <name>summer_fallow2</name>
                <x1>10</x1>
                <y1>160</y1>
                <desc>
                </desc>
                <fill>-4144960</fill>
              </node>
              <node>
                <name>summer_fallow</name>
                <x1>358</x1>
                <y1>170</y1>
                <desc>
                </desc>
                <fill>-657956</fill>
              </node>
              <arc>
                <name>arc2</name>
                <source>wheat</source>
                <target>summer_fallow2</target>
                <x>50</x>
                <y>55</y>
                <actions>Wheat Management.Leave</actions>
                <actions>SummerFallow.Enter</actions>
                <rules>Wheat Management.canLeave</rules>
              </arc>
              <arc>
                <name>arc6</name>
                <source>summer_fallow</source>
                <target>wheat</target>
                <x>419</x>
                <y>56</y>
                <actions>SummerFallow.Leave</actions>
                <actions>Wheat Management.Enter</actions>
                <rules>SummerFallow.canLeave</rules>
                <rules>Wheat Management.canEnter</rules>
              </arc>
              <arc>
                <name>arc8</name>
                <source>lucerne</source>
                <target>summer_fallow</target>
                <x>417</x>
                <y>385</y>
                <actions>Lucerne Ley Management.Leave</actions>
                <actions>SummerFallow.Enter</actions>
                <rules>Lucerne Ley Management.canLeave</rules>
              </arc>
              <arc>
                <name>arc0</name>
                <source>summer_fallow2</source>
                <target>lucerne</target>
                <x>51</x>
                <y>386</y>
                <actions>SummerFallow.Leave</actions>
                <actions>Lucerne Ley Management.Enter</actions>
                <rules>SummerFallow.CanLeave</rules>
                <rules>Lucerne Ley Management.canEnter</rules>
              </arc>
              <arc>
                <name>arc1</name>
                <source>lucerne</source>
                <target>lucerne</target>
                <x>184</x>
                <y>200</y>
                <actions>Lucerne Ley Management.Harvest</actions>
                <rules>Lucerne Ley Management.canHarvest</rules>
              </arc>
              <paddock>
                <name>paddock</name>
                <isManaged>True</isManaged>
                <initialState>summer_fallow2</initialState>
              </paddock>
              <component name="Rotation Management_" executable="%apsim%/Model/Manager2.dll">
                <executable>%apsim%/Model/Manager2.dll</executable>
                <initdata>
                  <text><![CDATA[using System;
using System.Collections.Generic;
using System.Dynamic;
using System.Text;
using ModelFramework;
using CSGeneral;
public class Script {
[Link] public Simulation MySimulation;
private List<string> paddocks = new List<string>();
private List<dynamic> paddockStates = new List<dynamic>();
private Graph g = new Graph();
private Dictionary<string,string> _currentState = new Dictionary<string,string>();
[Output, Description("Current State of DG")] public string currentState {
  get {string[] r = new string[_currentState.Count]; _currentState.Values.CopyTo(r,0);  
       return(String.Join(" ", r));} 
}
private void setState(string p, string s) {
  _currentState[p] = s;
}
private string getState(string p) {
  return(_currentState[p]);
}
[Output, Description("Current paddock")] public string currentPaddock = "";
[Output] public string [] states = new string[0]; 
[EventHandler] public void OnInitialised()
{
g = new Graph();
states = new string[4];
int i = 0;
g.AddNode("lucerne");
states[i++] = "lucerne";
g.AddNode("wheat");
states[i++] = "wheat";
g.AddNode("summer_fallow2");
states[i++] = "summer_fallow2";
g.AddNode("summer_fallow");
states[i++] = "summer_fallow";
ruleAction arc2 = new ruleAction();
arc2.testCondition.Add("Wheat Management.canLeave");
arc2.action.Add("Wheat Management.Leave");
arc2.action.Add("SummerFallow.Enter");
g.AddDirectedEdge("wheat","summer_fallow2",arc2);
ruleAction arc6 = new ruleAction();
arc6.testCondition.Add("SummerFallow.canLeave");
arc6.testCondition.Add("Wheat Management.canEnter");
arc6.action.Add("SummerFallow.Leave");
arc6.action.Add("Wheat Management.Enter");
g.AddDirectedEdge("summer_fallow","wheat",arc6);
ruleAction arc8 = new ruleAction();
arc8.testCondition.Add("Lucerne Ley Management.canLeave");
arc8.action.Add("Lucerne Ley Management.Leave");
arc8.action.Add("SummerFallow.Enter");
g.AddDirectedEdge("lucerne","summer_fallow",arc8);
ruleAction arc0 = new ruleAction();
arc0.testCondition.Add("SummerFallow.CanLeave");
arc0.testCondition.Add("Lucerne Ley Management.canEnter");
arc0.action.Add("SummerFallow.Leave");
arc0.action.Add("Lucerne Ley Management.Enter");
g.AddDirectedEdge("summer_fallow2","lucerne",arc0);
ruleAction arc1 = new ruleAction();
arc1.testCondition.Add("Lucerne Ley Management.canHarvest");
arc1.action.Add("Lucerne Ley Management.Harvest");
g.AddDirectedEdge("lucerne","lucerne",arc1);
}
[EventHandler] public void OnStart_Simulation()
{
paddocks.Add("paddock");
setState("paddock","summer_fallow2");
   MySimulation.Publish("transition");
}
[Output] public string paddock_state {get {return(getState("paddock"));}}
private string modname(string x) {
  if (x.Contains(".")) return(x.Split('.')[0]);
  return("");
}
private string varname(string x) {
  if (x.Contains(".")) return(x.Split('.')[1]);
  return(x);
}
[EventHandler] public void OnProcess()
{
   bool more = true;
   while (more) {
      more = false;
      double bestScore = -1.0; string bestArc = ""; string bestPaddock = "";
      foreach (string p in paddocks) {
         Node s = g.FindNode(getState(p));
         // Console.WriteLine(" state=" + s.Name);
         foreach (string _arc in s.arcs.Keys) {
            double score = 1;
            foreach (string testCondition in s.arcs[_arc].testCondition){
               double c = 0.0;
               currentPaddock = p;
               if (MySimulation.Get(testCondition, out c))
                  score *= c;
               else
                  throw new Exception("Nothing returned from expression '" + testCondition + "'");
               //Console.WriteLine(" p=" + p +" a=" + _arc + "cond=" + testCondition + " score=" + score);
            }
            if (score > bestScore) {
               bestScore = score;
               bestArc = _arc;
               bestPaddock = p;
            }
         }
      }
      currentPaddock = "";
      if (bestScore > 0.0) {
         Node s = g.FindNode(getState(bestPaddock));
         if( bestPaddock != "")
            currentPaddock = bestPaddock;
         if (getState(bestPaddock) != "") MySimulation.Publish("transition_from_" + getState(bestPaddock));
         MySimulation.Publish("transition");
         setState (bestPaddock, g.FindArcTarget(bestArc));
         foreach (string action in s.arcs[bestArc].action ) {
            MySimulation.Publish(action);
            //Console.WriteLine(" best=" + bestPaddock + " action=" + action);
         }
         MySimulation.Publish("transition_to_" + getState(bestPaddock));
         more = true;
      }
   }
}
  public class ruleAction
  {
     public string Target;
     public List<string> testCondition = new List<string>();
     public List<string> action = new List<string>();
  }
   public class Node : IEquatable<Node>
   {
      private string data /*, alias*/;
      public Node(string _data) { data = _data; }
      public Dictionary<string, ruleAction> arcs = new Dictionary<string, ruleAction>();
      public bool Equals(Node other)
      {
         return ( this.data == other.data );
      }
      public string Name { get { return (data); } }
   }

   class Graph
   {
      public List<Node> vertices;
      public void print() {
         foreach (Node n in vertices) {
            Console.WriteLine(n.Name + ":"); 
            foreach (string k in n.arcs.Keys) {
               Console.WriteLine("  " + k); 
            }
         }
      }
      public Graph() { vertices = new List<Node>(); }
      public Node AddNode(Node node)
      {
         if (vertices.Find(delegate(Node n) { return (n.Equals(node)); }) == null)
            vertices.Add(node);
         return (vertices.Find(delegate(Node n) { return (n.Equals(node)); }));
      }
      public Node AddNode(string value)
      {
         return (AddNode(new Node(value)));
      }
      public Node FindNode(string value)
      {
         return (FindNode(AddNode(value)));
      }
      public Node FindNode(Node node)
      {
         return (vertices.Find(delegate(Node n) { return (n.Equals(node)); }));
      }
      public void AddDirectedEdge(string source, string dest, ruleAction value)
      {
         int i = 0;
         foreach (Node n in vertices) {
            foreach (string arc in n.arcs.Keys) {
               i++;
            }
         }
         Node node1 = AddNode(source);
         AddNode(dest);
         value.Target = dest;
         node1.arcs.Add("arc" + i.ToString(), value);
      }
      public string FindArcTarget(string arc)
      {
         foreach (Node n in vertices) {
            foreach (string a in n.arcs.Keys) {
               if (a == arc) { return (n.arcs[a].Target); }
            }
         }
         Console.WriteLine("Aiee - no target for arc " + arc ); 
         return("");
      }
   }
}
]]></text>
                </initdata>
              </component>
            </rotplot>
            <manager2 name="Lucerne Ley Management">
              <ui>
                <category type="category" description="Crop properties" />
                <crop type="crop" description="Name of this crop">lucerne</crop>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm)">15-sep</date1>
                <date3 type="ddmmmdate" description="Enter cultivar change date (na if not in use)">na</date3>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm)">10-dec</date2>
                <must_sow type="yesno" description="Must Sow">yes</must_sow>
                <rain_amount type="text" description="Enter amount of cumulative rainfall (mm)">25</rain_amount>
                <rain_days type="text" description="Enter number of days to accumulate rainfall (days)">3</rain_days>
                <esw_amount type="text" description="Enter amount of soil water (mm)">50</esw_amount>
                <category type="category" description="Sowing Parameters" />
                <cultivar1 type="cultivars" description="Enter cultivar : ">hunter_river</cultivar1>
                <cultivar2 type="cultivars" description="Enter 2nd Cultivar (na if not using a second cultivar)">na</cultivar2>
                <density1 type="text" description="Enter sowing density  (plants/m2)">50</density1>
                <depth1 type="text" description="Enter sowing depth  (mm)">30</depth1>
                <row_spacing1 type="text" description="Enter row spacing  (mm)">250</row_spacing1>
                <category type="category" description="Extra Parameters" />
                <ftn1 type="text" description="Enter Fertile Tiller Number (na for auto) : ">na</ftn1>
                <skiprow1 type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow1>
                <tillageImplement type="text" description="Name of tillage implement (na if not in use): ">na</tillageImplement>
                <yearsInLey type="text" description="Years in ley">3</yearsInLey>
              </ui>
              <text>using System;
using System.Collections.Generic;
using ModelFramework;
using CSGeneral;

// Basic crop management: sowing &amp; harvesting.
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.
// It will assume it is the only crop in the system if it doesnt find a sequencer.
// If it does find a sequencer, it will do nothing until told to (via Enter/Leave).
public class Script 
{      
   [Link()]  public Simulation MySimulation;
   
   [Param()] private string crop;         // The module name of this crop
   [Param()] private string date1;         //Start of sowing window
   [Param()] private string date2;         //End of sowing window
   [Param()] private string date3;         //date to change to different cultivar
   [Param()] int esw_amount;
   [Param()] private string must_sow;

   [Input()] private DateTime today;

   // Rainfall accumulator
   [Param()] int rain_days;              //check for rain over this period
   [Param()] int rain_amount;            //this much rain over that period

   // Day tracker
   private Dictionary&lt;string,int&gt; daysIn = new Dictionary&lt;string,int&gt;();
   [Param] float yearsInLey;            // How many years to remain in ley phase
  
   // Daily rainfall from the system
   [Input] private double rain;
   private ManagerUtility.Tracker&lt;double&gt; rainTracker; 

   private bool inWindow = false;
   private bool endOfWindow = false;
   private bool ChangeCultivar = false;

   //initialise tracker, telling it how many days to track
   [EventHandler] public void OnStart_Simulation()
   {
      rainTracker = new ManagerUtility.Tracker&lt;double&gt;(rain_days); 
      daysIn.Add("", -1);
      foreach (Paddock paddock in MySimulation.ChildPaddocks) 
         daysIn.Add(paddock.Name, -1);

   }

   // Daily tests common to all paddocks
   [EventHandler] public void OnPrepare()
   {
      bool startOfWindow = DateUtility.DatesEqual(date1, today);

      inWindow = DateUtility.WithinDates(date1, today, date2);
      ChangeCultivar = false;
      if(date3 != "na")  
         ChangeCultivar = DateUtility.WithinDates(date3, today, date2);
      endOfWindow = DateUtility.DatesEqual(date2, today);

      rainTracker.Add(rain);
      string currentPaddock = "";
      if (MySimulation.Get("currentPaddock", out currentPaddock) == false) 
      {
         // If there is no sequencer plugged in then we are it..
         if (canEnter &gt; 0) {
            OnEnter();
         }
         if (canLeave &gt; 0) {
            OnLeave();
         }
      }
   }
   [EventHandler] public void OnPost()
   {
      List &lt;string&gt; paddocks = new List&lt;string&gt;(daysIn.Keys);
      foreach (string p in paddocks) 
         if (daysIn[p] &gt;= 0)
            daysIn[p]++;
   }
   // Test whether we can sow a crop today
   // +ve number - yes
   // 0          - no
   // -ve number - no, out of scope (planting window)
   [Output, Description("Test whether we can sow a crop today")] public int canEnter  {
      get {
         bool isPossibleToday = false;
         
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("1. '" + currentPaddock + "'");

         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Component cropModule = (Component) paddockModule.LinkByName( crop );

         //Console.WriteLine("3. " + cropModule.Name);
         string plantStatus = "";
         cropModule.Get("plant_status", out plantStatus);

         double esw = 0.0;
         Component soilModule = (Component) paddockModule.LinkByType("SoilWat");
         soilModule.Get("esw", out esw);
         if (plantStatus == "out" &amp;&amp;
             inWindow &amp;&amp;
             rainTracker.Sum() &gt;= rain_amount &amp;&amp;
             esw &gt; esw_amount) 
         {
             isPossibleToday = true;
         } 

	     if (isPossibleToday)
            return 1;
         
         if (plantStatus == "out" &amp;&amp; endOfWindow &amp;&amp; must_sow == "yes")
            return 1;

         if (plantStatus == "out" &amp;&amp; !inWindow)
            return -1;
         
         return 0;
      }
   }  
   [Output, Description("Test whether we have passed the end of the window")] public int pastWindow  {
      get {
         return( (DateUtility.CompareDates(date2, today) &lt; 0) ? 1 : 0);
      }
   }
   
   // Sow a crop
   [Param()] private string cultivar1;
   [Param()] private string cultivar2;
   [Param()] private double density1;
   [Param()] private double depth1;
   [Param()] private double row_spacing1;
   [Param()] private string ftn1;
   [Param()] private string skiprow1;
   [Param()] private string tillageImplement;
   
   [EventHandler, Description("Sow the crop")] public void OnEnter()
   {
      Console.WriteLine(today + " Sowing Crop");
      SowType data = new SowType();
      data.Cultivar = cultivar1;
      if(ChangeCultivar)
         data.Cultivar = cultivar2;

      data.plants = density1;
      data.sowing_depth = depth1;
      data.row_spacing = row_spacing1;
      data.tiller_no_fertile = (ftn1 == "na") ? "" : ftn1;
      data.SkipRow = 0 ;
      if (skiprow1 == "single")
         data.SkipRow = 1;
      else if (skiprow1 == "double")
         data.SkipRow = 2;

      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("Sow", data);
      if (tillageImplement.ToLower() != "na") 
	  {
         TillageType t = new TillageType();
         t.type = tillageImplement;
         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = MySimulation.ChildPaddocks[0];
         paddockModule.Publish("tillage", t);
      }		 
      daysIn[currentPaddock] = 0;
   }

   // Test whether we can harvest a crop today
   // +ve number - yes
   // 0          - no
   // -ve        - out of scope
   [Output, Description("Test whether the ley has finished")] public int canLeave  
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (plantStatus == "dead")
            return 1;
         
         if (daysIn[currentPaddock] &gt; /*(int) (*/365.25 * yearsInLey)
            return 1;
         
         return 0;
      }
   }

   [EventHandler] public void OnLeave()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 0.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);

      KillCropType kdata = new KillCropType();
      kdata.KillFraction = 0.0F;
      cropModule.Publish("killcrop", kdata);
      cropModule.Publish("end_crop");
   } 

   [EventHandler] public void OnHarvest()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 1.0;
      hdata.Height = 50.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);
   } 
   [Output, Description("Test whether the crop can be harvested")] public int canHarvest 
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (StageName == "flowering")
            return 1;
         return 0;
      }
   }

}
       </text>
            </manager2>
            <manager2 name="Wheat Management">
              <ui>
                <category type="category" description="Crop properties" />
                <crop type="crop" description="Name of this crop">wheat</crop>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm)">15-may</date1>
                <date3 type="ddmmmdate" description="Enter cultivar change date (na if not in use)">na</date3>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm)">10-jul</date2>
                <must_sow type="yesno" description="Must Sow">yes</must_sow>
                <rain_amount type="text" description="Enter amount of cumulative rainfall (mm)">25</rain_amount>
                <rain_days type="text" description="Enter number of days to accumulate rainfall (days)">3</rain_days>
                <esw_amount type="text" description="Enter amount of soil water (mm)">50</esw_amount>
                <category type="category" description="Sowing Parameters" />
                <cultivar1 type="cultivars" description="Enter cultivar : ">hartog</cultivar1>
                <cultivar2 type="cultivars" description="Enter 2nd Cultivar (na if not using a second cultivar)">na</cultivar2>
                <density1 type="text" description="Enter sowing density  (plants/m2)">100</density1>
                <depth1 type="text" description="Enter sowing depth  (mm)">30</depth1>
                <row_spacing1 type="text" description="Enter row spacing  (mm)">250</row_spacing1>
                <category type="category" description="Extra Parameters" />
                <ftn1 type="text" description="Enter Fertile Tiller Number (na for auto) : ">na</ftn1>
                <skiprow1 type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow1>
                <tillageImplement type="text" description="Name of tillage implement (na if not in use): ">na</tillageImplement>
              </ui>
              <text>using System;
using ModelFramework;
using CSGeneral;

// Basic crop management: sowing &amp; harvesting.
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.
// It will assume it is the only crop in the system if it doesnt find a sequencer.
// If it does find a sequencer, it will do nothing until told to (via Enter/Leave).
public class Script 
{      
   [Link()]  public Simulation MySimulation;
   
   [Param()] private string crop;         // The module name of this crop
   [Param()] private string date1;         //Start of sowing window
   [Param()] private string date2;         //End of sowing window
   [Param()] private string date3;         //date to change to different cultivar
   [Param()] int esw_amount;
   [Param()] private string must_sow;

   [Input()] private DateTime today;

   // Rainfall accumulator
   [Param()] int rain_days;              //check for rain over this period
   [Param()] int rain_amount;            //this much rain over that period

   // Daily rainfall from the system
   [Input] private double rain;
   private ManagerUtility.Tracker&lt;double&gt; rainTracker; 

   private bool inWindow = false;
   private bool endOfWindow = false;
   private bool ChangeCultivar = false;

   //initialise tracker, telling it how many days to track
   [EventHandler] public void OnInitialised()
   {
      rainTracker = new ManagerUtility.Tracker&lt;double&gt;(rain_days); 
   }

   // Daily tests common to all paddocks
   [EventHandler] public void OnPrepare()
   {
      bool startOfWindow = DateUtility.DatesEqual(date1, today);

      inWindow = DateUtility.WithinDates(date1, today, date2);
      ChangeCultivar = false;
      if(date3 != "na")  
         ChangeCultivar = DateUtility.WithinDates(date3, today, date2);
      endOfWindow = DateUtility.DatesEqual(date2, today);

      rainTracker.Add(rain);
      string currentPaddock = "";
      if (MySimulation.Get("currentPaddock", out currentPaddock) == false) 
      {
         // If there is no sequencer plugged in then we are it..
         if (canEnter &gt; 0) {
            OnEnter();
         }
         if (canLeave &gt; 0) {
            OnLeave();
         }
      }
   }
   // Test whether we can sow a crop today
   // +ve number - yes
   // 0          - no
   // -ve number - no, out of scope (planting window)
   [Output, Description("Test whether we can sow a crop today")] public int canEnter  {
      get {
         bool isPossibleToday = false;
         
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("1. '" + currentPaddock + "'");

         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Component cropModule = (Component) paddockModule.LinkByName( crop );

         //Console.WriteLine("3. " + cropModule.Name);
         string plantStatus = "";
         cropModule.Get("plant_status", out plantStatus);

         double esw = 0.0;
         Component soilModule = (Component) paddockModule.LinkByType("SoilWat");
         soilModule.Get("esw", out esw);
         if (plantStatus == "out" &amp;&amp;
             inWindow &amp;&amp;
             rainTracker.Sum() &gt;= rain_amount &amp;&amp;
             esw &gt; esw_amount) 
         {
             isPossibleToday = true;
         } 

	     if (isPossibleToday)
            return 1;
         
         if (plantStatus == "out" &amp;&amp; endOfWindow &amp;&amp; must_sow == "yes")
            return 1;

         if (plantStatus == "out" &amp;&amp; !inWindow)
            return -1;
         
         return 0;
      }
   }  
   [Output, Description("Test whether we have passed the end of the window")] public int pastWindow  {
      get {
         return( (DateUtility.CompareDates(date2, today) &lt; 0) ? 1 : 0);
      }
   }
   
   // Sow a crop
   [Param()] private string cultivar1;
   [Param()] private string cultivar2;
   [Param()] private double density1;
   [Param()] private double depth1;
   [Param()] private double row_spacing1;
   [Param()] private string ftn1;
   [Param()] private string skiprow1;
   [Param()] private string tillageImplement;
   
   [EventHandler, Description("Sow the crop")] public void OnEnter()
   {
      Console.WriteLine(today + " Sowing Crop");
      SowType data = new SowType();
      data.Cultivar = cultivar1;
      if(ChangeCultivar)
         data.Cultivar = cultivar2;

      data.plants = density1;
      data.sowing_depth = depth1;
      data.row_spacing = row_spacing1;
      data.tiller_no_fertile = (ftn1 == "na") ? "" : ftn1;
      data.SkipRow = 0 ;
      if (skiprow1 == "single")
         data.SkipRow = 1;
      else if (skiprow1 == "double")
         data.SkipRow = 2;

      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("Sow", data);
      if (tillageImplement.ToLower() != "na") 
	  {
         TillageType t = new TillageType();
         t.type = tillageImplement;
         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = MySimulation.ChildPaddocks[0];
         paddockModule.Publish("tillage", t);
      }		 
   }

   // Test whether we can harvest a crop today
   // +ve number - yes
   // 0          - no
   // -ve        - out of scope
   [Output] public int canLeave  
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (StageName == "harvest_ripe" || plantStatus == "dead")
            return 1;
         return 0;
      }
   }

   [EventHandler] public void OnLeave()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 0.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);

      KillCropType kdata = new KillCropType();
      kdata.KillFraction = 0.0F;
      cropModule.Publish("killcrop", kdata);
      cropModule.Publish("end_crop");
   } 
}
       </text>
            </manager2>
            <manager2 name="Wheat Sowing Fertiliser">
              <ui>
                <fertType type="text" description="The type of fertiliser">Urea_N</fertType>
                <fertAmt type="text" description="Amout of fertiliser to apply (kg/ha)">150</fertAmt>
                <tag type="category" description="Event details" />
                <ModuleName type="modulename" description="On which module should the event come from: ">wheat</ModuleName>
                <EventName type="text" description="On which event should spraying be triggered">sowing</EventName>
              </ui>
              <text>using System;
using System.Linq;
using System.Collections.Generic;
using ModelFramework;

// Crop management: fertilise at sowing
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.

public class Script 
{      
   [Link]  public Simulation MySimulation;
   [Param] string fertType;
   [Param] float fertAmt;
   [Param] string ModuleName;
   [Param] string EventName;
   
   [EventHandler] public void OnStart_Simulation()
   {
      foreach (Paddock paddock in MySimulation.ChildPaddocks) 
      {
         foreach (Component child in paddock.Children) {
            if(child.Name == ModuleName){
               RuntimeEventHandler.NullFunction curried = () =&gt; OnTrigger(paddock.Name);
               MySimulation.Subscribe(child.FullName + "." + EventName, curried);
               Console.WriteLine("Subscribed '" + child.FullName + "." + EventName + " =&gt; " + paddock.Name + "'"); 
            }
         }
      }
   }

   public void OnTrigger(string paddock)
   {
      Console.WriteLine("Fertiliser OnTrigger called, paddock='" + paddock + "'"); 
      if (fertAmt &gt; 0) 
      {         
         Component paddockModule;
         if (paddock != "")
            paddockModule = (Component) MySimulation.LinkByName(paddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Fertiliser fertModule = (Fertiliser) paddockModule.LinkByName("Fertiliser");
         fertModule.Apply(fertAmt, 50, fertType);
      }
   }
}
       </text>
            </manager2>
            <manager2 name="SummerFallow">
              <ui>
                <endDate type="text" description="Enter the end date of the pause">15-mar</endDate>
              </ui>
              <text>using System;
using System.Collections.Generic;
using ModelFramework;
using CSGeneral;

// A "blocking" period that waits until a specified date.
// Multi-paddock aware.

public class Script 
{  
   [Link()] public Simulation MySimulation;

   [Input] private DateTime today; 
   [Param] private string endDate; 

   private Dictionary&lt;string,bool&gt; flag = new Dictionary&lt;string,bool&gt;();

   // +ve number - yes
   // 0          - no
   [Output, Description("Test whether we can enter the pause")] public int canEnter  
   {
      get {return (1);}
   }

   // Set the flag to say that we cannot leave until the end of the period is passed
   [EventHandler, Description("Enter the pause period")] public void OnEnter()
   {
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      flag[currentPaddock] = false;
   } 
   
   [Output, Description("Test whether we can leave the pause")] public int canLeave  
   {get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("CanLeave called, p=" + currentPaddock + ",c=" + counter[currentPaddock]);
         if (flag[currentPaddock]) {
            return (1);
         }   
         return (0);

      }
   }
   
   [EventHandler, Description("Leave the pause")] public void OnLeave()
   {
       // Nothing
   } 

   // Setup
   [EventHandler] public void OnStart_Simulation()
   {
      flag.Add("", true);
      foreach (Paddock paddock in MySimulation.ChildPaddocks) 
         flag.Add(paddock.Name, true);
   }

   // Set the flag to say that the end of the period has passed
   [EventHandler] public void OnPost()
   {
      if (DateUtility.DatesEqual(endDate, today)) {
         List &lt;string&gt; paddocks = new List&lt;string&gt;(flag.Keys);
         foreach (string p in paddocks) 
            flag[p] = true;
      }
   }
}

</text>
            </manager2>
            <manager2 name="PaddockAccumulator">
              <ui />
              <text>using System; 
using System.Collections.Generic;
using ModelFramework; 
using CSGeneral;

// This captures and accumulates the states of several paddock variables
// to be reported on a single report line. 

// Multi-paddock aware.

public class Script 
{ 
   [Link] public Simulation MySimulation;

   // Cumulative Ep
   [Output, Description("The total transpiration since the last transition"), Units("mm")] public double TEp {
      get {setup(); string s = currentPaddock() + "_Ep"; return(me[s]);}
   }
   // Cumulative Drainage
   [Output, Description("The total drainage since the last transition"), Units("mm")] public double TDrainage {
      get {setup(); string s = currentPaddock() + "_drainage"; return(me[s]);}
   }
   // Cumulative Runoff
   [Output, Description("The total runoff since the last transition"), Units("mm")] public double TRunoff {
      get {setup(); string s = currentPaddock() + "_runoff"; return(me[s]);}
   }
   // Cumulative Es
   [Output, Description("The total soil evaporation since the last transition"), Units("mm")] public double TEs {
      get {setup(); string s = currentPaddock() + "_evaporation"; return(me[s]);}
   }
   // Cumulative fertiliser
   [Output, Description("The total fertiliser applied since the last transition"), Units("kg/ha")] public double applied_fert {
      get {setup(); string s = currentPaddock() + "_applied_fert"; return(me[s]);}
   }
   // Instantaneous sw at start
   [Output, Description("The soil water on the first day of a rotation"), Units("mm")] public double swStart {
      get {setup(); string s = currentPaddock() + "_swStart"; return(me[s]);}
   }
   // Instantaneous sw at end
   [Output, Description("The soil water on the last day of a rotation"), Units("mm")] public double swYesterday {
      get {setup(); string s = currentPaddock() + "_swYesterday"; return(me[s]);}
   }
   // Instantaneous no3 at start
   [Output, Description("The soil NO3 on the first day of a rotation"), Units("kg/ha")] public double no3Start {
      get {setup(); string s = currentPaddock() + "_no3Start"; return(me[s]);}
   }
   // Instantaneous no3 at end
   [Output, Description("The soil NO3 on the last day of a rotation"), Units("kg/ha")] public double no3Yesterday {
      get {setup(); string s = currentPaddock() + "_no3Yesterday"; return(me[s]);}
   }
   // Instantaneous carbon at end
   [Output, Description("The soil carbon on the last day of a rotation"), Units("kg/ha")] public double carbonYesterday {
      get {setup(); string s = currentPaddock() + "_carbon"; return(me[s]);}
   }
   // Instantaneous yield of all crops
   [Output, Description("Crop Yield"), Units("kg/ha")] public double yield_kgha {
      get{
         double yld2 = 0;
         Paddock p = (Paddock) MySimulation.LinkByName(currentPaddock());
         foreach (Component crop in p.Crops)
         {
            double yld = 0;
            crop.Get("yield", out yld);
            yld2 = yld2 + yld;
         }
         return yld2 ;}
   }
   // Instantaneous yield of all crops
   [Output, Description("Crop Yield"), Units("kg")] public double yield_kg {
      get{
         double yld2 = 0, area = 1.0;
         Paddock p = (Paddock) MySimulation.LinkByName(currentPaddock());
         MySimulation.Get(p.Name + ".area", out area);
         foreach (Component crop in p.Crops)
         {
            double yld = 0;
            crop.Get("yield", out yld);
            yld2 = yld2 + yld * area;
         }
         return yld2 ;}
   }
   // Instantaneous biomass of all crops
   [Output, Description("Crop biomass"), Units("kg/ha")] public double biomass_kgha {
      get{
         double biomass2 = 0;
         Paddock p = (Paddock) MySimulation.LinkByName(currentPaddock());
         foreach (Component crop in p.Crops)
         {
            double biomass = 0;
            crop.Get("biomass", out biomass);
            biomass2 = biomass2 + biomass;
         }
         return biomass2 ;}
   }
   // Instantaneous yield of all crops
   [Output, Description("Crop Biomass"), Units("kg")] public double biomass_kg {
      get{
         double biomass2 = 0, area = 1.0;
         Paddock p = (Paddock) MySimulation.LinkByName(currentPaddock());
         MySimulation.Get(p.Name + ".area", out area);
         foreach (Component crop in p.Crops)
         {
            double biomass = 0;
            crop.Get("biomass", out biomass);
            biomass2 = biomass2 + biomass * area;
         }
         return biomass2 ;}
   }
   // Instantaneous protein of all crops
   [Output, Description("Grain Protein"), Units("%")] public double protein {
      get{
         double pro2 = 0;
         Paddock p = (Paddock) MySimulation.LinkByName(currentPaddock());
         foreach (Component crop in p.Crops)
         {
            double pro = 0;
            crop.Get("grain_protein", out pro);
            pro2 = pro2 + pro;
         }
        
         return pro2 ;}
   }
   
   // Instantaneous N of all crops
   [Output, Description("Grain N"), Units("g/m2")] public double GrainN_gm2 {
      get{
         double GN2 = 0;
         Paddock p = (Paddock) MySimulation.LinkByName(currentPaddock());
         foreach (Component crop in p.Crops)
         {
            double GN = 0;
            if (crop.Get("grain_N", out GN))
               GN2 = GN2 + GN;
            else if (crop.Get("GrainGreenN", out GN))
               GN2 = GN2 + GN;
         }
         return GN2 ;}
   }
   
   
   [Output, Description("The state of the current paddock"), Units("")] public string paddockState {
      get {
         string cs = "";
         string cp = currentPaddock();
         MySimulation.Get(cp + "_state", out cs);
         return(cs);
      }
   }
   [Output, Description("The number of days in a rotation"), Units("")] public int daysInPhase = 0;
 
   private string currentPaddock() {
      string result = "";
      MySimulation.Get("currentPaddock", out result);
      if (result != "")
         return(result);
      else
         return(MySimulation.ChildPaddocks[0].Name);
   }


   // An accumulator for each thing in each paddock
   private Dictionary&lt;string, double&gt; me = new Dictionary&lt;string, double&gt;();

   private void setup() {
      if (me.Keys.Count == 0) { OnStart_Simulation(); }
   }
   
   [EventHandler] public void OnStart_Simulation() { 
      if (me.Keys.Count == 0) {
         foreach (Paddock paddock in MySimulation.ChildPaddocks) 
         {
            Component soil = (Component) paddock.LinkByType("soilwat");
            double [] swdep = new double[15];
            soil.Get("sw_dep", out swdep);
            me.Add(paddock.Name + "_swStart", MathUtility.Sum(swdep));
            me.Add(paddock.Name + "_swYesterday", MathUtility.Sum(swdep));
         
            Component soilN = (Component) paddock.LinkByType("soiln");
            double [] no3dep = new double[15];
            soilN.Get("no3", out no3dep);
            me.Add(paddock.Name + "_no3Start", MathUtility.Sum(no3dep));
            me.Add(paddock.Name + "_no3Yesterday", MathUtility.Sum(no3dep));
            me.Add(paddock.Name + "_Ep", 0);
            me.Add(paddock.Name + "_drainage", 0);
            me.Add(paddock.Name + "_runoff", 0);
            me.Add(paddock.Name + "_evaporation", 0);
            me.Add(paddock.Name + "_applied_fert", 0);
            double[] carbon = new double[15];
            soilN.Get("carbon_tot", out carbon);
            me.Add(paddock.Name + "_carbon", MathUtility.Sum(carbon));
         }
      }
   } 
   [EventHandler] public void OnTransition() {
      setup();   
      string s = currentPaddock();
      me[s + "_swStart"] = me[s+"_swYesterday"]; 
      me[s + "_no3Start"] = me[s + "_no3Yesterday"];
      me[s + "_Ep"] = 0;
      me[s + "_drainage"] = 0;
      me[s + "_runoff"] = 0;
      me[s + "_evaporation"] = 0;
      me[s + "_applied_fert"] = 0;
      me[s + "_carbon"] = 0;
      daysInPhase = 0;
   } 
   [EventHandler] public void OnPost() { 
      foreach (Paddock paddock in MySimulation.ChildPaddocks) 
      {
         Component soil = (Component) paddock.LinkByType("soilwat");
         Component soilN = (Component) paddock.LinkByType("soiln");
         Component fertiliser = (Component) paddock.LinkByType("fertiliser");
         double [] swdep = new double[15];
         soil.Get("sw_dep", out swdep);
         me[paddock.Name + "_swYesterday"] = MathUtility.Sum(swdep);

         double [] no3dep = new double[15];
         soilN.Get("no3", out no3dep);
         me[paddock.Name + "_no3Yesterday"] = MathUtility.Sum(no3dep);

         double drain = 0;
         soil.Get("drain", out drain);
         me[paddock.Name + "_drainage"] += drain;

         double runoff = 0;
         soil.Get("runoff", out runoff);
         me[paddock.Name + "_runoff"] += runoff;

         double es = 0;
         soil.Get("es", out es);
         me[paddock.Name + "_evaporation"] += es;

         double applied_fert = 0;
         fertiliser.Get("fertiliser", out applied_fert);
         me[paddock.Name + "_applied_fert"] += applied_fert;

         double[] carbon = new double[15];
         soilN.Get("carbon_tot", out carbon);
         me[paddock.Name + "_carbon"] = MathUtility.Sum(carbon);

         foreach (Component crop in paddock.Crops)
         {
            double Ep = 0.0;
            if(crop.Get("Ep", out Ep))
               me[paddock.Name + "_Ep"] += Ep;
         }
      }
      daysInPhase++;
   }
} 
</text>
            </manager2>
            <manager2 name="RotationCounter">
              <ui />
              <text>using System; 
using ModelFramework; 

// Counts the number of times a rotation has completed (ie gone back to the starting point)
 
public class Script 
{ 
   [Link()] public Paddock myPaddock;   

   [Output, Description("Number of times the rotation has cycled"), Units("n")] public int rotationNumber = 0; 
  
   private string initialState = ""; 
   [EventHandler] public void OnStart_Simulation() { 
      myPaddock.Get("currentState", out initialState);  
   }    
 
   private bool needsCheck = false; 
   [EventHandler] public void OnPrepare() { needsCheck = false; } 
   [EventHandler] public void OnTransition() { needsCheck = true; } 
   [EventHandler] public void OnPost() { 
      if (needsCheck)  { 
         string currentState = ""; 
         myPaddock.Get("currentstate", out currentState);  
         if (currentState == initialState)  
            rotationNumber++; 
      } 
   } 
} 
</text>
            </manager2>
            <tracker>
              <variable>sum of rain on end_of_day from transition to now as TRainfall</variable>
              <variable>count of clock.simulation_days on end_of_day from transition to now as days_in_stage</variable>
            </tracker>
          </folder>
          <outputfile name="Harvest">
            <filename output="yes">WheatLucerne1 Harvest.out</filename>
            <title>WheatLucerne1 Harvest</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>yield</variable>
              <variable>biomass</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>harvesting</event>
            </events>
          </outputfile>
          <outputfile name="Phases">
            <filename output="yes">WheatLucerne1 Phases.out</filename>
            <title>WheatLucerne1 Phases</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>currentState</variable>
              <variable>TRainfall as Rainfall</variable>
              <variable>Trunoff as runoff</variable>
              <variable>Tes as evap</variable>
              <variable>Tdrainage as drainage</variable>
              <variable>TEp as Ep</variable>
              <variable>swStart</variable>
              <variable>swYesterday as swEnd</variable>
              <variable>no3Start</variable>
              <variable>no3Yesterday as no3End</variable>
              <variable>biomass_kgha as Biomass</variable>
              <variable>yield_kgha as Yield</variable>
              <variable>GrainN_gm2 as grainN</variable>
              <variable>carbonYesterday as carbon</variable>
              <variable>applied_fert</variable>
              <variable>rotationNumber</variable>
              <variable>simulation_days</variable>
              <variable>daysInPhase</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>transition</event>
            </events>
            <RGraphics name="Rugplot Graph">
              <script>
                <text>library(ggplot2)

apsim.input&lt;- inputFiles 
aps1 &lt;- read.table(apsim.input,skip=2,header=T) 
aps.name &lt;- names(aps1)
df &lt;- read.table(apsim.input,skip=3,header=T,col.names=aps.name,na.strings = "?")
df$Date&lt;-as.Date(df$Date, format="%d/%m/%Y")

# sort out the beginning and ending dates of each phase
x1 &lt;- df$Date[-1*nrow(df)]
x2 &lt;- df$Date[-1] 
df &lt;- df[-1,]  # throw away the first - it's from Start_Simulation
df$x1&lt;-x1
df$x2&lt;-x2

#lower bound of rectangles at bottom
df$ymin &lt;- -0.25 * max(df$Yield)
 
jpeg(file=imageFileName, width=width, height=height)
g&lt;- ggplot(df) +
 geom_bar(aes(x=Date, y=Yield, fill= currentState), stat="identity") +
 geom_rect(aes(xmin = x1 , xmax = x2, ymin= ymin, ymax=0, fill= currentState ) ) +
 scale_x_date() + scale_fill_discrete(name="state") + theme(
       axis.line = element_line(colour = "black"),
       panel.grid.major = element_blank(),
       panel.grid.minor = element_blank(),
       panel.border = element_blank(),
       panel.background = element_blank() )
print(g)

dev.off()
</text>
              </script>
            </RGraphics>
          </outputfile>
          <Graph name="XY">
            <Legend>
              <CheckedTitles> paddock.wheat.biomass</CheckedTitles>
              <CheckedTitles> paddock.lucerne.biomass</CheckedTitles>
            </Legend>
            <Plot>
              <SeriesType>Bar</SeriesType>
              <PointType>Circle</PointType>
              <colour>
              </colour>
              <X>Date</X>
              <Y>paddock.wheat.biomass</Y>
              <Y>paddock.lucerne.biomass</Y>
              <GDApsimFileReader name="ApsimFileReader" />
            </Plot>
          </Graph>
        </area>
      </simulation>
      <Graph name="XY">
        <Legend>
          <CheckedTitles> paddock.wheat.biomass, WheatLucerne Harvest</CheckedTitles>
          <CheckedTitles> paddock.wheat.biomass, WheatLucerne1 Harvest</CheckedTitles>
          <CheckedTitles> paddock.lucerne.biomass, WheatLucerne Harvest</CheckedTitles>
          <CheckedTitles> paddock.lucerne.biomass, WheatLucerne1 Harvest</CheckedTitles>
        </Legend>
        <Plot>
          <SeriesType>Bar</SeriesType>
          <PointType>Circle</PointType>
          <colour>
          </colour>
          <X>Date</X>
          <Y>paddock.wheat.biomass</Y>
          <Y>paddock.lucerne.biomass</Y>
          <GDApsimFileReader name="ApsimFileReader" />
        </Plot>
      </Graph>
    </folder>
    <folder name="Advanced - Crop Rotation Sorghum Wheat">
      <simulation name="SorghumWheat">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1940</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1989</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <Soil name="Heavy Clay">
            <SoilType description="Soil description">Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown description="Nearest town">Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude description="Latitude (WGS84)">-27.564333</Latitude>
            <Longitude description="Longitude (WGS84)">151.953991</Longitude>
            <LocationAccuracy description="Location accuracy">Regional Soil Type</LocationAccuracy>
            <DataSource type="multiedit" description="Data source">YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments type="multiedit" description="Comments">Generic soil developed by Allan Peake.</Comments>
            <Water>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <FractionFull>1</FractionFull>
              <PercentMethod>FilledFromTop</PercentMethod>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Date type="date" description="Sample date:" />
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <NO3>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </NO3>
              <NH4>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </NH4>
              <SW>
                <double>0</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
              </SW>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat_stubble</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <wheat />
          <sorghum />
          <folder name="Manager folder">
            <manager name="Rotations">
              <ui>
                <category type="category" description="Fallow options" />
                <SummerFallowName type="text" description="Enter summer fallow name : ">sf</SummerFallowName>
                <SummerFallowEndDate type="text" description="Enter summer fallow END date (dd-mmm) : ">15-mar</SummerFallowEndDate>
                <WinterFallowName type="text" description="Enter winter fallow name : ">wf</WinterFallowName>
                <WinterFallowEndDate type="text" description="Enter winter fallow END date (dd-mmm) : ">23-aug</WinterFallowEndDate>
                <category type="category" description="Crop rotation sequence" />
                <crop1 type="crop" description="Enter 1st crop : ">sf</crop1>
                <crop2 type="crop" description="Enter 2nd crop : ">wf</crop2>
                <crop3 type="crop" description="Enter 3rd crop : ">sorghum</crop3>
                <crop4 type="crop" description="Enter 4th crop : ">wf</crop4>
                <crop5 type="crop" description="Enter 5th crop : ">sf</crop5>
                <crop6 type="crop" description="Enter 6th crop : ">wheat</crop6>
                <crop7 type="crop" description="Enter 7th crop : ">nil</crop7>
                <crop8 type="crop" description="Enter 8th crop : ">nil</crop8>
                <crop9 type="crop" description="Enter 9th crop : ">nil</crop9>
                <crop10 type="crop" description="Enter 10th crop : ">nil</crop10>
                <crop11 type="crop" description="Enter 11th crop : ">nil</crop11>
                <crop12 type="crop" description="Enter 12th crop : ">nil</crop12>
                <crop13 type="crop" description="Enter 13th crop : ">nil</crop13>
                <crop14 type="crop" description="Enter 14th crop : ">nil</crop14>
                <crop15 type="crop" description="Enter 15th crop : ">nil</crop15>
                <crop16 type="crop" description="Enter 16th crop : ">nil</crop16>
                <crop17 type="crop" description="Enter 17th crop : ">nil</crop17>
                <crop18 type="crop" description="Enter 18th crop : ">nil</crop18>
                <crop19 type="crop" description="Enter 19th crop : ">nil</crop19>
                <crop20 type="crop" description="Enter 20th crop : ">nil</crop20>
              </ui>
              <script>
                <text>
         NextCropIndex = 1
         NextCrop = ' '
         ChooseNextCrop = 'yes'
         SummerFallowIn = 'no'
         WinterFallowIn = 'no'
         FallowIn = 'no'
                                </text>
                <event>init</event>
              </script>
              <script>
                <text>
      if (ChooseNextCrop = 'yes') then
         if (NextCropIndex = 1) then
            NextCrop = '[crop1]'
         elseif (NextCropIndex = 2) then
            NextCrop = '[crop2]'
         elseif (NextCropIndex = 3) then
            NextCrop = '[crop3]'
         elseif (NextCropIndex = 4) then
            NextCrop = '[crop4]'
         elseif (NextCropIndex = 5) then
            NextCrop = '[crop5]'
         elseif (NextCropIndex = 6) then
            NextCrop = '[crop6]'
         elseif (NextCropIndex = 7) then
            NextCrop = '[crop7]'
         elseif (NextCropIndex = 8) then
            NextCrop = '[crop8]'
         elseif (NextCropIndex = 9) then
            NextCrop = '[crop9]'
         elseif (NextCropIndex = 10) then
            NextCrop = '[crop10]'
         elseif (NextCropIndex = 11) then
            NextCrop = '[crop11]'
         elseif (NextCropIndex = 12) then
            NextCrop = '[crop12]'
         elseif (NextCropIndex = 13) then
            NextCrop = '[crop13]'
         elseif (NextCropIndex = 14) then
            NextCrop = '[crop14]'
         elseif (NextCropIndex = 15) then
            NextCrop = '[crop15]'
         elseif (NextCropIndex = 16) then
            NextCrop = '[crop16]'
         elseif (NextCropIndex = 17) then
            NextCrop = '[crop17]'
         elseif (NextCropIndex = 18) then
            NextCrop = '[crop18]'
         elseif (NextCropIndex = 19) then
            NextCrop = '[crop19]'
         elseif (NextCropIndex = 20) then
            NextCrop = '[crop20]'
         endif
         if (NextCrop = 'nil' or NextCrop = ' ') then
            NextCrop = '[crop1]'
            NextCropIndex = 1
         endif
         NextCropIndex = NextCropIndex + 1
         ChooseNextCrop = 'no'
      endif
      ! if the next crop is due to be a fallow and we're within the
      ! correct date range then put a fallow in.
      if (NextCrop = '[WinterFallowName]') then
         if (paddock_is_fallow() = 1 and FallowIn = 'no') then
            if (date_within('[SummerFallowEndDate], [WinterFallowEndDate]') then
               WinterFallowIn = 'yes'
               FallowIn = 'yes'
               ChooseNextCrop = 'yes'
            endif
         endif
      elseif (NextCrop = '[SummerFallowName]') then
         if (paddock_is_fallow() = 1 and FallowIn = 'no') then
            if (date_within('[WinterFallowEndDate], [SummerFallowEndDate]') then
               SummerFallowIn = 'yes'
               FallowIn = 'yes'
               ChooseNextCrop = 'yes'
            endif
         endif
      endif

      ! if we currently have a fallow in and we're at the end of the fallow window
      ! then remove the fallow.
      if (WinterFallowIn = 'yes' and today = date('[WinterFallowEndDate]')+1) then
         WinterFallowIn = 'no'
         FallowIn = 'no'
      endif
      if (SummerFallowIn = 'yes' and today = date('[SummerFallowEndDate]')+1) then
         SummerFallowIn = 'no'
         FallowIn = 'no'
      endif
                                </text>
                <event>start_of_day</event>
              </script>
            </manager>
            <manager name="WheatSowing">
              <ui>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm) : ">15-may</date1>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm) : ">10-jul</date2>
                <must_sow type="yesno" description="Must sow? : ">yes</must_sow>
                <raincrit type="text" description="Amount of rainfall : ">25</raincrit>
                <rainnumdays type="text" description="Number of days of rainfall : ">3</rainnumdays>
                <esw_amount type="text" description="Enter minimum allowable available soil water (mm) : ">0</esw_amount>
                <category type="category" description="Sowing parameters" />
                <crop type="crop" description="Enter name of crop to sow : ">wheat</crop>
                <density type="text" description="Enter sowing density  (plants/m2) : ">100</density>
                <depth type="text" description="Enter sowing depth  (mm) : ">30</depth>
                <cultivar type="cultivars" description="Enter cultivar : ">hartog</cultivar>
                <class type="classes" description="Enter crop growth class : ">plant</class>
                <row_spacing type="text" description="Enter row spacing (mm) : ">250</row_spacing>
              </ui>
              <script>
                <text>
      if (paddock_is_fallow() = 1 and FallowIn &lt;&gt; 'yes' and (NextCrop = 0 or NextCrop = '[crop]')) then
         if (date_within('[date1], [date2]') = 1) then
            if (rain[[rainnumdays]] &gt;= [raincrit] AND esw &gt;= [esw_amount]) OR
                ('[must_sow]' = 'yes' AND today = date('[date2]'))) THEN
               ChooseNextCrop = 'yes'   ! for rotations
               [crop] sow plants =[density], sowing_depth = [depth], cultivar = [cultivar], row_spacing = [row_spacing], crop_class = [class]
            endif
            if today = date('[date2]') then
               ChooseNextCrop = 'yes'
            endif
         endif
      endif
                                </text>
                <event>start_of_day</event>
              </script>
            </manager>
            <manager name="Sorghum sowing rule">
              <ui>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm) : ">15-oct</date1>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm) : ">10-jan</date2>
                <must_sow type="yesno" description="Must sow? : ">yes</must_sow>
                <raincrit type="text" description="Amount of rainfall : ">30</raincrit>
                <rainnumdays type="text" description="Number of days of rainfall : ">3</rainnumdays>
                <esw_amount type="text" description="Enter minimum allowable available soil water (mm) : ">200</esw_amount>
                <category type="category" description="Sowing parameters" />
                <crop type="crop" description="Enter name of crop to sow : ">sorghum</crop>
                <density type="text" description="Enter sowing density  (plants/m2) : ">7</density>
                <depth type="text" description="Enter sowing depth  (mm) : ">30</depth>
                <cultivar type="cultivars" description="Enter cultivar : ">early</cultivar>
                <row_spacing type="text" description="Enter row spacing (mm) : ">1000</row_spacing>
                <skiprow type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow>
              </ui>
              <script>
                <text>
      if (paddock_is_fallow() = 1 and FallowIn &lt;&gt; 'yes' and (NextCrop = 0 or NextCrop = '[crop]')) then
         if (date_within('[date1], [date2]') = 1) then
            if (rain[[rainnumdays]] &gt;= [raincrit] AND esw &gt;= [esw_amount]) OR
                ('[must_sow]' = 'yes' AND today = date('[date2]'))) THEN
               ChooseNextCrop = 'yes'   ! for rotations
               [crop] sow plants =[density], sowing_depth = [depth], cultivar = [cultivar], row_spacing = [row_spacing], skip = [skiprow]
            endif
            if today = date('[date2]') then
               ChooseNextCrop = 'yes'
            endif
         endif
      endif
                                </text>
                <event>start_of_day</event>
              </script>
            </manager>
            <manager name="WheatFertilise">
              <ui>
                <category description="When should fertiliser be applied" type="category" />
                <modulename type="modulename" description="On which module should the event come from : ">wheat</modulename>
                <eventname type="text" description="On which event should fertiliser be applied : ">sowing</eventname>
                <category description="Fertiliser application details" type="category" />
                <fertmodule type="modulename" description="Module used to apply the fertiliser : ">fertiliser</fertmodule>
                <fert_amount_sow type="text" description="Amount of starter fertiliser at sowing (kg/ha) : ">150</fert_amount_sow>
                <fert_type_sow type="list" listvalues="NO3_N, NH4_N, NH4NO3, urea_N, urea_no3, urea, nh4so4_n, rock_p, banded_p, broadcast_p" description="Sowing fertiliser type : ">urea_N</fert_type_sow>
              </ui>
              <script>
                <text>
        [fertmodule] apply amount = [fert_amount_sow] (kg/ha), depth = 50 (mm), type = [fert_type_sow]
                                </text>
                <event>[modulename].[eventname]</event>
              </script>
            </manager>
            <manager name="SorghumFertilise">
              <ui>
                <category type="category" description="When should fertiliser be applied" />
                <modulename type="modulename" description="On which module should the event come from : ">sorghum</modulename>
                <eventname type="text" description="On which event should fertiliser be applied : ">sowing</eventname>
                <category type="category" description="Fertiliser application details" />
                <fertmodule type="modulename" description="Module used to apply the fertiliser : ">fertiliser</fertmodule>
                <fert_amount_sow type="text" description="Amount of starter fertiliser at sowing (kg/ha) : ">150</fert_amount_sow>
                <fert_type_sow type="list" listvalues="NO3_N, NH4_N, NH4NO3, urea_N, urea_no3, urea, nh4so4_n, rock_p, banded_p, broadcast_p" description="Sowing fertiliser type : ">urea_N</fert_type_sow>
              </ui>
              <script>
                <text>
        [fertmodule] apply amount = [fert_amount_sow] (kg/ha), depth = 50 (mm), type = [fert_type_sow]
                                </text>
                <event>[modulename].[eventname]</event>
              </script>
            </manager>
            <manager name="WheatHarvesting">
              <ui>
                <category description="Harvesting criteria" type="category" />
                <crop type="crop" description="Enter name of crop to harvest when ripe : ">wheat</crop>
              </ui>
              <script>
                <text>

           if [crop].StageName = 'harvest_ripe' or [crop].plant_status = 'dead' then
              [crop]  harvest
              [crop]  end_crop
           endif

                                </text>
                <event>end_of_day</event>
              </script>
            </manager>
            <manager name="SorghumHarvesting">
              <ui>
                <category type="category" description="Harvesting criteria" />
                <crop type="crop" description="Enter name of crop to harvest when ripe : ">sorghum</crop>
              </ui>
              <script>
                <text>

           if [crop].StageName = 'harvest_ripe' or [crop].plant_status = 'dead' then
              [crop]  harvest
              [crop]  end_crop
           endif

                                </text>
                <event>end_of_day</event>
              </script>
            </manager>
          </folder>
          <outputfile>
            <filename output="yes">SorghumWheat.out</filename>
            <title>SorghumWheat</title>
            <variables name="Variables">
              <variable>variable</variable>
              <variable>variable</variable>
              <variable>variable</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>event</event>
            </events>
          </outputfile>
        </area>
        <Graph name="XY">
          <Legend>
            <CheckedTitles> wheat.yield</CheckedTitles>
            <CheckedTitles> sorghum.yield</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Bar</SeriesType>
            <PointType>Circle</PointType>
            <colour>
            </colour>
            <X>year</X>
            <Y>wheat.yield</Y>
            <Y>sorghum.yield</Y>
            <GDApsimFileReader name="ApsimFileReader" />
          </Plot>
        </Graph>
      </simulation>
    </folder>
    <folder name="Advanced - Opportunity Cropping">
      <simulation name="MungbeanWheat">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/04/1974</start_date>
          <end_date type="date" description="Enter the end date of the simulation">30/04/1984</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <Soil name="Heavy Clay">
            <RecordNumber>0</RecordNumber>
            <SoilType>Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown>Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude>-27.564333</Latitude>
            <Longitude>151.953991</Longitude>
            <LocationAccuracy>Regional Soil Type</LocationAccuracy>
            <YearOfSampling>0</YearOfSampling>
            <DataSource>YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments>Generic soil developed by Allan Peake.</Comments>
            <Water>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="mungbean">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.06</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Slope>NaN</Slope>
              <DischargeWidth>NaN</DischargeWidth>
              <CatchmentArea>NaN</CatchmentArea>
              <MaxPond>NaN</MaxPond>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
              <OCUnits>Total</OCUnits>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <FractionFull>0.5</FractionFull>
              <DepthWetSoil>NaN</DepthWetSoil>
              <PercentMethod>FilledFromTop</PercentMethod>
              <RelativeTo>ll15</RelativeTo>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Thickness>
                <double>1800</double>
              </Thickness>
              <NO3>
                <double>140</double>
              </NO3>
              <NH4>
                <double>0</double>
              </NH4>
              <SW>
                <double>0</double>
              </SW>
              <NO3Units>kgha</NO3Units>
              <NH4Units>kgha</NH4Units>
              <SWUnits>Volumetric</SWUnits>
              <OCUnits>Total</OCUnits>
              <PHUnits>Water</PHUnits>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <mungbean />
          <wheat />
          <folder name="Manager folder">
            <rotplot name="Paddock Management">
              <canvas_height>484</canvas_height>
              <rules_height>187</rules_height>
              <graph_name>stateGraph</graph_name>
              <language>C#</language>
              <node>
                <name>munbean</name>
                <x1>191</x1>
                <y1>319</y1>
                <desc>
                </desc>
                <fill>-8323328</fill>
              </node>
              <node>
                <name>wheat</name>
                <x1>190</x1>
                <y1>10</y1>
                <desc>
                </desc>
                <fill>-16744320</fill>
              </node>
              <node>
                <name>Fallow</name>
                <x1>10</x1>
                <y1>160</y1>
                <desc>
                </desc>
                <fill>-4144960</fill>
              </node>
              <arc>
                <name>arc2</name>
                <source>wheat</source>
                <target>Fallow</target>
                <x>50</x>
                <y>55</y>
                <actions>Wheat Management.Leave</actions>
                <rules>Wheat Management.canLeave</rules>
              </arc>
              <arc>
                <name>arc0</name>
                <source>Fallow</source>
                <target>munbean</target>
                <x>51</x>
                <y>386</y>
                <actions>Mungbean Management.Enter</actions>
                <rules>Mungbean Management.canEnter</rules>
              </arc>
              <arc>
                <name>arc1</name>
                <source>munbean</source>
                <target>Fallow</target>
                <x>243</x>
                <y>256</y>
                <actions>Mungbean Management.Leave</actions>
                <rules>Mungbean Management.canLeave</rules>
              </arc>
              <arc>
                <name>arc3</name>
                <source>Fallow</source>
                <target>wheat</target>
                <x>245</x>
                <y>191</y>
                <actions>Wheat Management.Enter</actions>
                <rules>Wheat Management.canEnter</rules>
              </arc>
              <paddock>
                <name>paddock</name>
                <isManaged>True</isManaged>
                <initialState>Fallow</initialState>
              </paddock>
              <component name="Paddock Management_" executable="%apsim%/Model/Manager2.dll">
                <executable>%apsim%/Model/Manager2.dll</executable>
                <initdata>
                  <text><![CDATA[using System;
using System.Collections.Generic;
using System.Dynamic;
using System.Text;
using ModelFramework;
using CSGeneral;
public class Script {
[Link] public Simulation MySimulation;
private List<string> paddocks = new List<string>();
private List<dynamic> paddockStates = new List<dynamic>();
private Graph g = new Graph();
private Dictionary<string,string> _currentState = new Dictionary<string,string>();
[Output, Description("Current State of DG")] public string currentState {
  get {string[] r = new string[_currentState.Count]; _currentState.Values.CopyTo(r,0);  
       return(String.Join(" ", r));} 
}
private void setState(string p, string s) {
  _currentState[p] = s;
}
private string getState(string p) {
  return(_currentState[p]);
}
[Output, Description("Current paddock")] public string currentPaddock = "";
[Output] public string [] states = new string[0]; 
[EventHandler] public void OnInitialised()
{
g = new Graph();
states = new string[3];
int i = 0;
g.AddNode("munbean");
states[i++] = "munbean";
g.AddNode("wheat");
states[i++] = "wheat";
g.AddNode("Fallow");
states[i++] = "Fallow";
ruleAction arc2 = new ruleAction();
arc2.testCondition.Add("Wheat Management.canLeave");
arc2.action.Add("Wheat Management.Leave");
g.AddDirectedEdge("wheat","Fallow",arc2);
ruleAction arc0 = new ruleAction();
arc0.testCondition.Add("Mungbean Management.canEnter");
arc0.action.Add("Mungbean Management.Enter");
g.AddDirectedEdge("Fallow","munbean",arc0);
ruleAction arc1 = new ruleAction();
arc1.testCondition.Add("Mungbean Management.canLeave");
arc1.action.Add("Mungbean Management.Leave");
g.AddDirectedEdge("munbean","Fallow",arc1);
ruleAction arc3 = new ruleAction();
arc3.testCondition.Add("Wheat Management.canEnter");
arc3.action.Add("Wheat Management.Enter");
g.AddDirectedEdge("Fallow","wheat",arc3);
}
[EventHandler] public void OnStart_Simulation()
{
paddocks.Add("paddock");
setState("paddock","Fallow");
   MySimulation.Publish("transition");
}
[Output] public string paddock_state {get {return(getState("paddock"));}}
private string modname(string x) {
  if (x.Contains(".")) return(x.Split('.')[0]);
  return("");
}
private string varname(string x) {
  if (x.Contains(".")) return(x.Split('.')[1]);
  return(x);
}
[EventHandler] public void OnProcess()
{
   bool more = true;
   while (more) {
      more = false;
      double bestScore = -1.0; string bestArc = ""; string bestPaddock = "";
      foreach (string p in paddocks) {
         Node s = g.FindNode(getState(p));
         // Console.WriteLine(" state=" + s.Name);
         foreach (string _arc in s.arcs.Keys) {
            double score = 1;
            foreach (string testCondition in s.arcs[_arc].testCondition){
               double c = 0.0;
               currentPaddock = p;
               if (MySimulation.Get(testCondition, out c))
                  score *= c;
               else
                  throw new Exception("Nothing returned from expression '" + testCondition + "'");
               //Console.WriteLine(" p=" + p +" a=" + _arc + "cond=" + testCondition + " score=" + score);
            }
            if (score > bestScore) {
               bestScore = score;
               bestArc = _arc;
               bestPaddock = p;
            }
         }
      }
      currentPaddock = "";
      if (bestScore > 0.0) {
         Node s = g.FindNode(getState(bestPaddock));
         if( bestPaddock != "")
            currentPaddock = bestPaddock;
         if (getState(bestPaddock) != "") MySimulation.Publish("transition_from_" + getState(bestPaddock));
         MySimulation.Publish("transition");
         setState (bestPaddock, g.FindArcTarget(bestArc));
         foreach (string action in s.arcs[bestArc].action ) {
            MySimulation.Publish(action);
            //Console.WriteLine(" best=" + bestPaddock + " action=" + action);
         }
         MySimulation.Publish("transition_to_" + getState(bestPaddock));
         more = true;
      }
   }
}
  public class ruleAction
  {
     public string Target;
     public List<string> testCondition = new List<string>();
     public List<string> action = new List<string>();
  }
   public class Node : IEquatable<Node>
   {
      private string data /*, alias*/;
      public Node(string _data) { data = _data; }
      public Dictionary<string, ruleAction> arcs = new Dictionary<string, ruleAction>();
      public bool Equals(Node other)
      {
         return ( this.data == other.data );
      }
      public string Name { get { return (data); } }
   }

   class Graph
   {
      public List<Node> vertices;
      public void print() {
         foreach (Node n in vertices) {
            Console.WriteLine(n.Name + ":"); 
            foreach (string k in n.arcs.Keys) {
               Console.WriteLine("  " + k); 
            }
         }
      }
      public Graph() { vertices = new List<Node>(); }
      public Node AddNode(Node node)
      {
         if (vertices.Find(delegate(Node n) { return (n.Equals(node)); }) == null)
            vertices.Add(node);
         return (vertices.Find(delegate(Node n) { return (n.Equals(node)); }));
      }
      public Node AddNode(string value)
      {
         return (AddNode(new Node(value)));
      }
      public Node FindNode(string value)
      {
         return (FindNode(AddNode(value)));
      }
      public Node FindNode(Node node)
      {
         return (vertices.Find(delegate(Node n) { return (n.Equals(node)); }));
      }
      public void AddDirectedEdge(string source, string dest, ruleAction value)
      {
         int i = 0;
         foreach (Node n in vertices) {
            foreach (string arc in n.arcs.Keys) {
               i++;
            }
         }
         Node node1 = AddNode(source);
         AddNode(dest);
         value.Target = dest;
         node1.arcs.Add("arc" + i.ToString(), value);
      }
      public string FindArcTarget(string arc)
      {
         foreach (Node n in vertices) {
            foreach (string a in n.arcs.Keys) {
               if (a == arc) { return (n.arcs[a].Target); }
            }
         }
         Console.WriteLine("Aiee - no target for arc " + arc ); 
         return("");
      }
   }
}
]]></text>
                </initdata>
              </component>
            </rotplot>
            <manager2 name="Wheat Management">
              <ui>
                <category type="category" description="Crop properties" />
                <crop type="crop" description="Name of this crop">wheat</crop>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm)">1-jun</date1>
                <date3 type="ddmmmdate" description="Enter cultivar change date (na if not in use)">15-jun</date3>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm)">1-aug</date2>
                <must_sow type="yesno" description="Must Sow">no</must_sow>
                <rain_amount type="text" description="Enter amount of cumulative rainfall (mm)">20</rain_amount>
                <rain_days type="text" description="Enter number of days to accumulate rainfall (days)">3</rain_days>
                <esw_amount type="text" description="Enter amount of soil water (mm)">200</esw_amount>
                <category type="category" description="Sowing Parameters" />
                <cultivar1 type="cultivars" description="Enter cultivar : ">janz</cultivar1>
                <cultivar2 type="cultivars" description="Enter 2nd Cultivar (na if not using a second cultivar)">hartog</cultivar2>
                <density1 type="text" description="Enter sowing density  (plants/m2)">100</density1>
                <depth1 type="text" description="Enter sowing depth  (mm)">30</depth1>
                <row_spacing1 type="text" description="Enter row spacing  (mm)">250</row_spacing1>
                <category type="category" description="Extra Parameters" />
                <ftn1 type="text" description="Enter Fertile Tiller Number (na for auto) : ">na</ftn1>
                <skiprow1 type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow1>
                <tillageImplement type="text" description="Name of tillage implement (na if not in use): ">na</tillageImplement>
              </ui>
              <text>using System;
using ModelFramework;
using CSGeneral;

// Basic crop management: sowing &amp; harvesting.
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.
// It will assume it is the only crop in the system if it doesnt find a sequencer.
// If it does find a sequencer, it will do nothing until told to (via Enter/Leave).
public class Script 
{      
   [Link()]  public Simulation MySimulation;
   
   [Param()] private string crop;         // The module name of this crop
   [Param()] private string date1;         //Start of sowing window
   [Param()] private string date2;         //End of sowing window
   [Param()] private string date3;         //date to change to different cultivar
   [Param()] int esw_amount;
   [Param()] private string must_sow;

   [Input()] private DateTime today;

   // Rainfall accumulator
   [Param()] int rain_days;              //check for rain over this period
   [Param()] int rain_amount;            //this much rain over that period

   // Daily rainfall from the system
   [Input] private double rain;
   private ManagerUtility.Tracker&lt;double&gt; rainTracker; 

   private bool inWindow = false;
   private bool endOfWindow = false;
   private bool ChangeCultivar = false;

   //initialise tracker, telling it how many days to track
   [EventHandler] public void OnInitialised()
   {
      rainTracker = new ManagerUtility.Tracker&lt;double&gt;(rain_days); 
   }

   // Daily tests common to all paddocks
   [EventHandler] public void OnPrepare()
   {
      bool startOfWindow = DateUtility.DatesEqual(date1, today);

      inWindow = DateUtility.WithinDates(date1, today, date2);
      ChangeCultivar = false;
      if(date3 != "na")  
         ChangeCultivar = DateUtility.WithinDates(date3, today, date2);
      endOfWindow = DateUtility.DatesEqual(date2, today);

      rainTracker.Add(rain);
      string currentPaddock = "";
      if (MySimulation.Get("currentPaddock", out currentPaddock) == false) 
      {
         // If there is no sequencer plugged in then we are it..
         if (canEnter &gt; 0) {
            OnEnter();
         }
         if (canLeave &gt; 0) {
            OnLeave();
         }
      }
   }
   // Test whether we can sow a crop today
   // +ve number - yes
   // 0          - no
   // -ve number - no, out of scope (planting window)
   [Output, Description("Test whether we can sow a crop today")] public int canEnter  {
      get {
         bool isPossibleToday = false;
         
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("1. '" + currentPaddock + "'");

         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Component cropModule = (Component) paddockModule.LinkByName( crop );

         //Console.WriteLine("3. " + cropModule.Name);
         string plantStatus = "";
         cropModule.Get("plant_status", out plantStatus);

         double esw = 0.0;
         Component soilModule = (Component) paddockModule.LinkByType("SoilWat");
         soilModule.Get("esw", out esw);
         if (plantStatus == "out" &amp;&amp;
             inWindow &amp;&amp;
             rainTracker.Sum() &gt;= rain_amount &amp;&amp;
             esw &gt; esw_amount) 
         {
             isPossibleToday = true;
         } 

	     if (isPossibleToday)
            return 1;
         
         if (plantStatus == "out" &amp;&amp; endOfWindow &amp;&amp; must_sow == "yes")
            return 1;

         if (plantStatus == "out" &amp;&amp; !inWindow)
            return -1;
         
         return 0;
      }
   }  
   
   
   // Sow a crop
   [Param()] private string cultivar1;
   [Param()] private string cultivar2;
   [Param()] private double density1;
   [Param()] private double depth1;
   [Param()] private double row_spacing1;
   [Param()] private string ftn1;
   [Param()] private string skiprow1;
   [Param()] private string tillageImplement;
   
   [EventHandler, Description("Sow the crop")] public void OnEnter()
   {
      Console.WriteLine(today + " Sowing Crop");
      SowType data = new SowType();
      data.Cultivar = cultivar1;
      if(ChangeCultivar)
         data.Cultivar = cultivar2;

      data.plants = density1;
      data.sowing_depth = depth1;
      data.row_spacing = row_spacing1;
      data.tiller_no_fertile = (ftn1 == "na") ? "" : ftn1;
      data.SkipRow = 0 ;
      if (skiprow1 == "single")
         data.SkipRow = 1;
      else if (skiprow1 == "double")
         data.SkipRow = 2;

      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("Sow", data);

      if (tillageImplement.ToLower() != "na") 
	  {
         TillageType t = new TillageType();
         t.type = tillageImplement;
         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = MySimulation.ChildPaddocks[0];
         paddockModule.Publish("tillage", t);
      }		 
   }

   // Test whether we can harvest a crop today
   // +ve number - yes
   // 0          - no
   // -ve        - out of scope
   [Output] public int canLeave  
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (StageName == "harvest_ripe" || plantStatus == "dead")
            return 1;
         return 0;
      }
   }

   [EventHandler] public void OnLeave()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 0.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);

      KillCropType kdata = new KillCropType();
      kdata.KillFraction = 0.0F;
      cropModule.Publish("killcrop", kdata);
      cropModule.Publish("end_crop");
   } 
}
       </text>
            </manager2>
            <manager2 name="Fertilise at Sowing">
              <ui>
                <tag type="category" description="When should fertiliser be applied" />
                <ModuleName type="modulename" description="On which module should the event come from: ">wheat</ModuleName>
                <EventName type="text" description="On which event should spraying be triggered">sowing</EventName>
                <tag type="category" description="Event details" />
                <fertType type="text" description="The type of fertiliser">urea_N</fertType>
                <fertAmt type="text" description="Amount of fertiliser to apply (kg/ha)">70</fertAmt>
              </ui>
              <text>using System;
using System.Linq;
using System.Collections.Generic;
using ModelFramework;

// Crop management: fertilise at sowing
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.

public class Script 
{      
   [Link]  public Simulation MySimulation;
   [Param] string fertType;
   [Param] float fertAmt;
   [Param] string ModuleName;
   [Param] string EventName;
   
   [EventHandler] public void OnStart_Simulation()
   {
      foreach (Paddock paddock in MySimulation.ChildPaddocks) 
      {
         foreach (Component child in paddock.Children) {
            if(child.Name == ModuleName){
               RuntimeEventHandler.NullFunction curried = () =&gt; OnTrigger(paddock.Name);
               MySimulation.Subscribe(child.FullName + "." + EventName, curried);
               //Console.WriteLine("Subscribed '" + child.FullName + "." + EventName + " =&gt; " + paddock.Name + "'"); 
            }
         }
      }
   }

   public void OnTrigger(string paddock)
   {
      Console.WriteLine("Fertiliser OnTrigger called, paddock='" + paddock + "'"); 
      if (fertAmt &gt; 0) 
      {         
         Component paddockModule;
         if (paddock != "")
            paddockModule = (Component) MySimulation.LinkByName(paddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Fertiliser fertModule = (Fertiliser) paddockModule.LinkByName("Fertiliser");
         fertModule.Apply(fertAmt, 50, fertType);
      }
   }
}
       </text>
            </manager2>
            <manager2 name="Mungbean Management">
              <ui>
                <category type="category" description="Crop properties" />
                <crop type="crop" description="Name of this crop">mungbean</crop>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm)">1-dec</date1>
                <date3 type="ddmmmdate" description="Enter cultivar change date (na if not in use)">na</date3>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm)">15-jan</date2>
                <must_sow type="yesno" description="Must Sow">no</must_sow>
                <rain_amount type="text" description="Enter amount of cumulative rainfall (mm)">20</rain_amount>
                <rain_days type="text" description="Enter number of days to accumulate rainfall (days)">3</rain_days>
                <esw_amount type="text" description="Enter amount of soil water (mm)">200</esw_amount>
                <category type="category" description="Sowing Parameters" />
                <cultivar1 type="cultivars" description="Enter cultivar : ">berken</cultivar1>
                <cultivar2 type="cultivars" description="Enter 2nd Cultivar (na if not using a second cultivar)">na</cultivar2>
                <density1 type="text" description="Enter sowing density  (plants/m2)">36</density1>
                <depth1 type="text" description="Enter sowing depth  (mm)">50</depth1>
                <row_spacing1 type="text" description="Enter row spacing  (mm)">500</row_spacing1>
                <category type="category" description="Extra Parameters" />
                <ftn1 type="text" description="Enter Fertile Tiller Number (na for auto) : ">na</ftn1>
                <skiprow1 type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow1>
                <tillageImplement type="text" description="Name of tillage implement (na if not in use): ">na</tillageImplement>
              </ui>
              <text>using System;
using ModelFramework;
using CSGeneral;

// Basic crop management: sowing &amp; harvesting.
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.
// It will assume it is the only crop in the system if it doesnt find a sequencer.
// If it does find a sequencer, it will do nothing until told to (via Enter/Leave).
public class Script 
{      
   [Link()]  public Simulation MySimulation;
   
   [Param()] private string crop;         // The module name of this crop
   [Param()] private string date1;         //Start of sowing window
   [Param()] private string date2;         //End of sowing window
   [Param()] private string date3;         //date to change to different cultivar
   [Param()] int esw_amount;
   [Param()] private string must_sow;

   [Input()] private DateTime today;

   // Rainfall accumulator
   [Param()] int rain_days;              //check for rain over this period
   [Param()] int rain_amount;            //this much rain over that period

   // Daily rainfall from the system
   [Input] private double rain;
   private ManagerUtility.Tracker&lt;double&gt; rainTracker; 

   private bool inWindow = false;
   private bool endOfWindow = false;
   private bool ChangeCultivar = false;

   //initialise tracker, telling it how many days to track
   [EventHandler] public void OnInitialised()
   {
      rainTracker = new ManagerUtility.Tracker&lt;double&gt;(rain_days); 
   }

   // Daily tests common to all paddocks
   [EventHandler] public void OnPrepare()
   {
      bool startOfWindow = DateUtility.DatesEqual(date1, today);

      inWindow = DateUtility.WithinDates(date1, today, date2);
      ChangeCultivar = false;
      if(date3 != "na")  
         ChangeCultivar = DateUtility.WithinDates(date3, today, date2);
      endOfWindow = DateUtility.DatesEqual(date2, today);

      rainTracker.Add(rain);
      string currentPaddock = "";
      if (MySimulation.Get("currentPaddock", out currentPaddock) == false) 
      {
         // If there is no sequencer plugged in then we are it..
         if (canEnter &gt; 0) {
            OnEnter();
         }
         if (canLeave &gt; 0) {
            OnLeave();
         }
      }
   }
   // Test whether we can sow a crop today
   // +ve number - yes
   // 0          - no
   // -ve number - no, out of scope (planting window)
   [Output, Description("Test whether we can sow a crop today")] public int canEnter  {
      get {
         bool isPossibleToday = false;
         
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("1. '" + currentPaddock + "'");

         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Component cropModule = (Component) paddockModule.LinkByName( crop );

         //Console.WriteLine("3. " + cropModule.Name);
         string plantStatus = "";
         cropModule.Get("plant_status", out plantStatus);

         double esw = 0.0;
         Component soilModule = (Component) paddockModule.LinkByType("SoilWat");
         soilModule.Get("esw", out esw);
         if (plantStatus == "out" &amp;&amp;
             inWindow &amp;&amp;
             rainTracker.Sum() &gt;= rain_amount &amp;&amp;
             esw &gt; esw_amount) 
         {
             isPossibleToday = true;
         } 

	     if (isPossibleToday)
            return 1;
         
         if (plantStatus == "out" &amp;&amp; endOfWindow &amp;&amp; must_sow == "yes")
            return 1;

         if (plantStatus == "out" &amp;&amp; !inWindow)
            return -1;
         
         return 0;
      }
   }  
   
   
   // Sow a crop
   [Param()] private string cultivar1;
   [Param()] private string cultivar2;
   [Param()] private double density1;
   [Param()] private double depth1;
   [Param()] private double row_spacing1;
   [Param()] private string ftn1;
   [Param()] private string skiprow1;
   [Param()] private string tillageImplement;
   
   [EventHandler, Description("Sow the crop")] public void OnEnter()
   {
      Console.WriteLine(today + " Sowing Crop");
      SowType data = new SowType();
      data.Cultivar = cultivar1;
      if(ChangeCultivar)
         data.Cultivar = cultivar2;

      data.plants = density1;
      data.sowing_depth = depth1;
      data.row_spacing = row_spacing1;
      data.tiller_no_fertile = (ftn1 == "na") ? "" : ftn1;
      data.SkipRow = 0 ;
      if (skiprow1 == "single")
         data.SkipRow = 1;
      else if (skiprow1 == "double")
         data.SkipRow = 2;

      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("Sow", data);

      if (tillageImplement.ToLower() != "na") 
	  {
         TillageType t = new TillageType();
         t.type = tillageImplement;
         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = MySimulation.ChildPaddocks[0];
         paddockModule.Publish("tillage", t);
      }		 
   }

   // Test whether we can harvest a crop today
   // +ve number - yes
   // 0          - no
   // -ve        - out of scope
   [Output] public int canLeave  
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (StageName == "harvest_ripe" || plantStatus == "dead")
            return 1;
         return 0;
      }
   }

   [EventHandler] public void OnLeave()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 0.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);

      KillCropType kdata = new KillCropType();
      kdata.KillFraction = 0.0F;
      cropModule.Publish("killcrop", kdata);
      cropModule.Publish("end_crop");
   } 
}
       </text>
            </manager2>
          </folder>
          <outputfile>
            <filename output="yes">MungbeanWheat.out</filename>
            <title>MungbeanWheat</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>year</variable>
              <variable>biom_n()</variable>
              <variable>yield</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>harvesting</event>
            </events>
            <Graph name="XY">
              <Legend>
                <CheckedTitles> paddock.wheat.yield</CheckedTitles>
                <CheckedTitles> paddock.mungbean.yield</CheckedTitles>
              </Legend>
              <Format>AAEAAAD/////AQAAAAAAAAAMAgAAAFhUZWVDaGFydC5DbGllbnQsIFZlcnNpb249NC4xLjIwMTEuNzI4MywgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj05YzgxMjYyNzZjNzdiZGI3DAMAAABXU3lzdGVtLldpbmRvd3MuRm9ybXMsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5DAQAAABRU3lzdGVtLkRyYXdpbmcsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iMDNmNWY3ZjExZDUwYTNhBQEAAAAVU3RlZW1hLlRlZUNoYXJ0LkNoYXJ0ugAAAA4uWm9vbS5BbmltYXRlZBMuWm9vbS5BbmltYXRlZFN0ZXBzFC5QYW5uaW5nLk1vdXNlQnV0dG9uEC5DdXN0b21DaGFydFJlY3QXLlBhbmVsLkltYWdlQmV2ZWwuV2lkdGgVLlBhbmVsLkJldmVsLkNvbG9yT25lGy5QYW5lbC5CZXZlbC5TdHJpbmdDb2xvck9uZRUuUGFuZWwuQmV2ZWwuQ29sb3JUd28bLlBhbmVsLkJldmVsLlN0cmluZ0NvbG9yVHdvEi5QYW5lbC5CZXZlbC5PdXRlchIuUGFuZWwuQnJ1c2guQ29sb3ISLkxlZ2VuZC5DaGVja0JveGVzEi5MZWdlbmQuTWF4TnVtUm93cxwuTGVnZW5kLlRpdGxlLkJldmVsLkNvbG9yT25lIi5MZWdlbmQuVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JPbmUcLkxlZ2VuZC5UaXRsZS5CZXZlbC5Db2xvclR3byIuTGVnZW5kLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yVHdvFi5MZWdlbmQuQmV2ZWwuQ29sb3JPbmUcLkxlZ2VuZC5CZXZlbC5TdHJpbmdDb2xvck9uZRYuTGVnZW5kLkJldmVsLkNvbG9yVHdvHC5MZWdlbmQuQmV2ZWwuU3RyaW5nQ29sb3JUd28WLkxlZ2VuZC5TaGFkb3cuVmlzaWJsZQ8uTGVnZW5kLlZpc2libGUTLkxlZ2VuZC5UcmFuc3BhcmVudA0uSGVhZGVyLkxpbmVzES5IZWFkZXIuRm9udC5OYW1lES5IZWFkZXIuRm9udC5TaXplFi5IZWFkZXIuRm9udC5TaXplRmxvYXQWLkhlYWRlci5CZXZlbC5Db2xvck9uZRwuSGVhZGVyLkJldmVsLlN0cmluZ0NvbG9yT25lFi5IZWFkZXIuQmV2ZWwuQ29sb3JUd28cLkhlYWRlci5CZXZlbC5TdHJpbmdDb2xvclR3bxkuU3ViSGVhZGVyLkJldmVsLkNvbG9yT25lHy5TdWJIZWFkZXIuQmV2ZWwuU3RyaW5nQ29sb3JPbmUZLlN1YkhlYWRlci5CZXZlbC5Db2xvclR3bx8uU3ViSGVhZGVyLkJldmVsLlN0cmluZ0NvbG9yVHdvFi5Gb290ZXIuQmV2ZWwuQ29sb3JPbmUcLkZvb3Rlci5CZXZlbC5TdHJpbmdDb2xvck9uZRYuRm9vdGVyLkJldmVsLkNvbG9yVHdvHC5Gb290ZXIuQmV2ZWwuU3RyaW5nQ29sb3JUd28ZLlN1YkZvb3Rlci5CZXZlbC5Db2xvck9uZR8uU3ViRm9vdGVyLkJldmVsLlN0cmluZ0NvbG9yT25lGS5TdWJGb290ZXIuQmV2ZWwuQ29sb3JUd28fLlN1YkZvb3Rlci5CZXZlbC5TdHJpbmdDb2xvclR3bxkuQXNwZWN0LkNvbG9yUGFsZXR0ZUluZGV4Di5Bc3BlY3QuVmlldzNECFNlcmllcy4wGS5TZXJpZXMuMC5CYXJXaWR0aFBlcmNlbnQVLlNlcmllcy4wLkJydXNoLkNvbG9yEy5TZXJpZXMuMC5Db2xvckVhY2gPLlNlcmllcy4wLkNvbG9yDy5TZXJpZXMuMC5UaXRsZSsuU2VyaWVzLjAuTWFya3MuU3ltYm9sLkJldmVsLlN0cmluZ0NvbG9yT25lKy5TZXJpZXMuMC5NYXJrcy5TeW1ib2wuQmV2ZWwuU3RyaW5nQ29sb3JUd28kLlNlcmllcy4wLk1hcmtzLkJldmVsLlN0cmluZ0NvbG9yT25lJC5TZXJpZXMuMC5NYXJrcy5CZXZlbC5TdHJpbmdDb2xvclR3bxcuU2VyaWVzLjAuTWFya3MuVmlzaWJsZRouV2FsbHMuTGVmdC5CZXZlbC5Db2xvck9uZSAuV2FsbHMuTGVmdC5CZXZlbC5TdHJpbmdDb2xvck9uZRouV2FsbHMuTGVmdC5CZXZlbC5Db2xvclR3byAuV2FsbHMuTGVmdC5CZXZlbC5TdHJpbmdDb2xvclR3bxsuV2FsbHMuUmlnaHQuQmV2ZWwuQ29sb3JPbmUhLldhbGxzLlJpZ2h0LkJldmVsLlN0cmluZ0NvbG9yT25lGy5XYWxscy5SaWdodC5CZXZlbC5Db2xvclR3byEuV2FsbHMuUmlnaHQuQmV2ZWwuU3RyaW5nQ29sb3JUd28aLldhbGxzLkJhY2suQmV2ZWwuQ29sb3JPbmUgLldhbGxzLkJhY2suQmV2ZWwuU3RyaW5nQ29sb3JPbmUaLldhbGxzLkJhY2suQmV2ZWwuQ29sb3JUd28gLldhbGxzLkJhY2suQmV2ZWwuU3RyaW5nQ29sb3JUd28cLldhbGxzLkJvdHRvbS5CZXZlbC5Db2xvck9uZSIuV2FsbHMuQm90dG9tLkJldmVsLlN0cmluZ0NvbG9yT25lHC5XYWxscy5Cb3R0b20uQmV2ZWwuQ29sb3JUd28iLldhbGxzLkJvdHRvbS5CZXZlbC5TdHJpbmdDb2xvclR3bw4uV2FsbHMuVmlzaWJsZRwuQXhlcy5MZWZ0LkxhYmVscy5TZXBhcmF0aW9uHS5BeGVzLkxlZnQuTGFiZWxzLlZhbHVlRm9ybWF0Gy5BeGVzLkxlZnQuTGFiZWxzLkZvbnQuTmFtZRsuQXhlcy5MZWZ0LkxhYmVscy5Gb250LlNpemUgLkF4ZXMuTGVmdC5MYWJlbHMuRm9udC5TaXplRmxvYXQgLkF4ZXMuTGVmdC5MYWJlbHMuQmV2ZWwuQ29sb3JPbmUmLkF4ZXMuTGVmdC5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JPbmUgLkF4ZXMuTGVmdC5MYWJlbHMuQmV2ZWwuQ29sb3JUd28mLkF4ZXMuTGVmdC5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JUd28YLkF4ZXMuTGVmdC5BeGlzUGVuLldpZHRoGS5BeGVzLkxlZnQuQXhpc1Blbi5FbmRDYXAXLkF4ZXMuTGVmdC5HcmlkLlZpc2libGUYLkF4ZXMuTGVmdC5NYXhpbXVtT2Zmc2V0HS5BeGVzLkxlZnQuTWlub3JUaWNrcy5WaXNpYmxlFi5BeGVzLkxlZnQuVGlja3MuQ29sb3IaLkF4ZXMuTGVmdC5UaXRsZS5Gb250Lk5hbWUaLkF4ZXMuTGVmdC5UaXRsZS5Gb250LlNpemUfLkF4ZXMuTGVmdC5UaXRsZS5Gb250LlNpemVGbG9hdCguQXhlcy5MZWZ0LlRpdGxlLkZvbnQuU2hhZG93LkJydXNoLkNvbG9yIS5BeGVzLkxlZnQuVGl0bGUuRm9udC5CcnVzaC5Db2xvch8uQXhlcy5MZWZ0LlRpdGxlLkJldmVsLkNvbG9yT25lJS5BeGVzLkxlZnQuVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JPbmUfLkF4ZXMuTGVmdC5UaXRsZS5CZXZlbC5Db2xvclR3byUuQXhlcy5MZWZ0LlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yVHdvGy5BeGVzLlRvcC5MYWJlbHMuU2VwYXJhdGlvbhwuQXhlcy5Ub3AuTGFiZWxzLlZhbHVlRm9ybWF0Gi5BeGVzLlRvcC5MYWJlbHMuRm9udC5OYW1lGi5BeGVzLlRvcC5MYWJlbHMuRm9udC5TaXplHy5BeGVzLlRvcC5MYWJlbHMuRm9udC5TaXplRmxvYXQfLkF4ZXMuVG9wLkxhYmVscy5CZXZlbC5Db2xvck9uZSUuQXhlcy5Ub3AuTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yT25lHy5BeGVzLlRvcC5MYWJlbHMuQmV2ZWwuQ29sb3JUd28lLkF4ZXMuVG9wLkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvclR3bxcuQXhlcy5Ub3AuQXhpc1Blbi5XaWR0aBguQXhlcy5Ub3AuQXhpc1Blbi5FbmRDYXAWLkF4ZXMuVG9wLkdyaWQuVmlzaWJsZRwuQXhlcy5Ub3AuTWlub3JUaWNrcy5WaXNpYmxlFS5BeGVzLlRvcC5UaWNrcy5Db2xvchkuQXhlcy5Ub3AuVGl0bGUuRm9udC5OYW1lGS5BeGVzLlRvcC5UaXRsZS5Gb250LlNpemUeLkF4ZXMuVG9wLlRpdGxlLkZvbnQuU2l6ZUZsb2F0IC5BeGVzLlRvcC5UaXRsZS5Gb250LkJydXNoLkNvbG9yHi5BeGVzLlRvcC5UaXRsZS5CZXZlbC5Db2xvck9uZSQuQXhlcy5Ub3AuVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JPbmUeLkF4ZXMuVG9wLlRpdGxlLkJldmVsLkNvbG9yVHdvJC5BeGVzLlRvcC5UaXRsZS5CZXZlbC5TdHJpbmdDb2xvclR3bxEuQXhlcy5Ub3AuVmlzaWJsZR0uQXhlcy5SaWdodC5MYWJlbHMuU2VwYXJhdGlvbh4uQXhlcy5SaWdodC5MYWJlbHMuVmFsdWVGb3JtYXQcLkF4ZXMuUmlnaHQuTGFiZWxzLkZvbnQuTmFtZRwuQXhlcy5SaWdodC5MYWJlbHMuRm9udC5TaXplIS5BeGVzLlJpZ2h0LkxhYmVscy5Gb250LlNpemVGbG9hdCEuQXhlcy5SaWdodC5MYWJlbHMuQmV2ZWwuQ29sb3JPbmUnLkF4ZXMuUmlnaHQuTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yT25lIS5BeGVzLlJpZ2h0LkxhYmVscy5CZXZlbC5Db2xvclR3bycuQXhlcy5SaWdodC5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JUd28ZLkF4ZXMuUmlnaHQuQXhpc1Blbi5XaWR0aBouQXhlcy5SaWdodC5BeGlzUGVuLkVuZENhcBguQXhlcy5SaWdodC5HcmlkLlZpc2libGUZLkF4ZXMuUmlnaHQuTWF4aW11bU9mZnNldB4uQXhlcy5SaWdodC5NaW5vclRpY2tzLlZpc2libGUXLkF4ZXMuUmlnaHQuVGlja3MuQ29sb3IbLkF4ZXMuUmlnaHQuVGl0bGUuRm9udC5OYW1lGy5BeGVzLlJpZ2h0LlRpdGxlLkZvbnQuU2l6ZSAuQXhlcy5SaWdodC5UaXRsZS5Gb250LlNpemVGbG9hdCIuQXhlcy5SaWdodC5UaXRsZS5Gb250LkJydXNoLkNvbG9yIC5BeGVzLlJpZ2h0LlRpdGxlLkJldmVsLkNvbG9yT25lJi5BeGVzLlJpZ2h0LlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yT25lIC5BeGVzLlJpZ2h0LlRpdGxlLkJldmVsLkNvbG9yVHdvJi5BeGVzLlJpZ2h0LlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yVHdvEy5BeGVzLlJpZ2h0LlZpc2libGUeLkF4ZXMuQm90dG9tLkxhYmVscy5TZXBhcmF0aW9uIi5BeGVzLkJvdHRvbS5MYWJlbHMuRGF0ZVRpbWVGb3JtYXQfLkF4ZXMuQm90dG9tLkxhYmVscy5WYWx1ZUZvcm1hdB0uQXhlcy5Cb3R0b20uTGFiZWxzLkZvbnQuTmFtZR0uQXhlcy5Cb3R0b20uTGFiZWxzLkZvbnQuU2l6ZSIuQXhlcy5Cb3R0b20uTGFiZWxzLkZvbnQuU2l6ZUZsb2F0Ii5BeGVzLkJvdHRvbS5MYWJlbHMuQmV2ZWwuQ29sb3JPbmUoLkF4ZXMuQm90dG9tLkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvck9uZSIuQXhlcy5Cb3R0b20uTGFiZWxzLkJldmVsLkNvbG9yVHdvKC5BeGVzLkJvdHRvbS5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JUd28aLkF4ZXMuQm90dG9tLkF4aXNQZW4uV2lkdGgbLkF4ZXMuQm90dG9tLkF4aXNQZW4uRW5kQ2FwGS5BeGVzLkJvdHRvbS5HcmlkLlZpc2libGUaLkF4ZXMuQm90dG9tLk1heGltdW1PZmZzZXQaLkF4ZXMuQm90dG9tLk1pbmltdW1PZmZzZXQfLkF4ZXMuQm90dG9tLk1pbm9yVGlja3MuVmlzaWJsZRguQXhlcy5Cb3R0b20uVGlja3MuQ29sb3IcLkF4ZXMuQm90dG9tLlRpdGxlLkZvbnQuTmFtZRwuQXhlcy5Cb3R0b20uVGl0bGUuRm9udC5TaXplIS5BeGVzLkJvdHRvbS5UaXRsZS5Gb250LlNpemVGbG9hdCMuQXhlcy5Cb3R0b20uVGl0bGUuRm9udC5CcnVzaC5Db2xvciEuQXhlcy5Cb3R0b20uVGl0bGUuQmV2ZWwuQ29sb3JPbmUnLkF4ZXMuQm90dG9tLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yT25lIS5BeGVzLkJvdHRvbS5UaXRsZS5CZXZlbC5Db2xvclR3bycuQXhlcy5Cb3R0b20uVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JUd28kLkF4ZXMuRGVwdGhUb3AuTGFiZWxzLkJldmVsLkNvbG9yT25lKi5BeGVzLkRlcHRoVG9wLkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvck9uZSQuQXhlcy5EZXB0aFRvcC5MYWJlbHMuQmV2ZWwuQ29sb3JUd28qLkF4ZXMuRGVwdGhUb3AuTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yVHdvIy5BeGVzLkRlcHRoVG9wLlRpdGxlLkJldmVsLkNvbG9yT25lKS5BeGVzLkRlcHRoVG9wLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yT25lIy5BeGVzLkRlcHRoVG9wLlRpdGxlLkJldmVsLkNvbG9yVHdvKS5BeGVzLkRlcHRoVG9wLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yVHdvIS5BeGVzLkRlcHRoLkxhYmVscy5CZXZlbC5Db2xvck9uZScuQXhlcy5EZXB0aC5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JPbmUhLkF4ZXMuRGVwdGguTGFiZWxzLkJldmVsLkNvbG9yVHdvJy5BeGVzLkRlcHRoLkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvclR3byAuQXhlcy5EZXB0aC5UaXRsZS5CZXZlbC5Db2xvck9uZSYuQXhlcy5EZXB0aC5UaXRsZS5CZXZlbC5TdHJpbmdDb2xvck9uZSAuQXhlcy5EZXB0aC5UaXRsZS5CZXZlbC5Db2xvclR3byYuQXhlcy5EZXB0aC5UaXRsZS5CZXZlbC5TdHJpbmdDb2xvclR3bwAABAAABAEEAQQEAAAEAQQBBAEEAQAAAAYBAAAEAQQBBAEEAQQBBAEEAQQBAAABAAQABAEBAQEBAAQBBAEEAQQBBAEEAQQBBAEAAAEBAAAEAQQBAAQAAAAEAQAABAQEAQQBAAEBAAAEAQQBAAQAAAQBAAAEBAEEAQAAAQEAAAQBBAEABAAAAAQBAAAEBAEEAQAAAQEBAAAEAQQBAAQAAAAABAEAAAQEAQQBBAEEAQQBBAEEAQQBBAEEAQEIIVN5c3RlbS5XaW5kb3dzLkZvcm1zLk1vdXNlQnV0dG9ucwMAAAABCBRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAI1N0ZWVtYS5UZWVDaGFydC5EcmF3aW5nLkJldmVsU3R5bGVzAgAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABCBRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABAQEICxRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACAEIFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAEUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAARRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAAQgICxRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACCBTeXN0ZW0uRHJhd2luZy5EcmF3aW5nMkQuTGluZUNhcAQAAAABCAEUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACAsUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACAgLFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAIIFN5c3RlbS5EcmF3aW5nLkRyYXdpbmcyRC5MaW5lQ2FwBAAAAAEBFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAgLFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAAQgICxRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACCBTeXN0ZW0uRHJhd2luZy5EcmF3aW5nMkQuTGluZUNhcAQAAAABCAEUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACAsUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABCAgLFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAIIFN5c3RlbS5EcmF3aW5nLkRyYXdpbmcyRC5MaW5lQ2FwBAAAAAEICAEUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACAsUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAIAAAABBAAAAAX7////IVN5c3RlbS5XaW5kb3dzLkZvcm1zLk1vdXNlQnV0dG9ucwEAAAAHdmFsdWVfXwAIAwAAAAAAQAAAAQAAAAX6////FFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAARuYW1lBXZhbHVlCmtub3duQ29sb3IFc3RhdGUBAAAACQcHBAAAAAr/////AAAAAAAAAgAGBwAAAAhGRkZGRkZGRgH4////+v///wqAgID/AAAAAAAAAgAGCQAAAAhGRjgwODA4MAX2////I1N0ZWVtYS5UZWVDaGFydC5EcmF3aW5nLkJldmVsU3R5bGVzAQAAAAd2YWx1ZV9fAAgCAAAAAAAAAAH1////+v///wr/////AAAAAAAAAgABCAAAAAH0////+v///wr/////AAAAAAAAAgAGDQAAAAhGRkZGRkZGRgHy////+v///wqAgID/AAAAAAAAAgAGDwAAAAhGRjgwODA4MAHw////+v///wr/////AAAAAAAAAgAGEQAAAAhGRkZGRkZGRgHu////+v///wqAgID/AAAAAAAAAgAGEwAAAAhGRjgwODA4MAAAAQkUAAAABhUAAAAGVGFob21hDAAAAAAAQEEB6v////r///8K/////wAAAAAAAAIABhcAAAAIRkZGRkZGRkYB6P////r///8KgICA/wAAAAAAAAIABhkAAAAIRkY4MDgwODAB5v////r///8K/////wAAAAAAAAIABhsAAAAIRkZGRkZGRkYB5P////r///8KgICA/wAAAAAAAAIABh0AAAAIRkY4MDgwODAB4v////r///8K/////wAAAAAAAAIABh8AAAAIRkZGRkZGRkYB4P////r///8KgICA/wAAAAAAAAIABiEAAAAIRkY4MDgwODAB3v////r///8K/////wAAAAAAAAIABiMAAAAIRkZGRkZGRkYB3P////r///8KgICA/wAAAAAAAAIABiUAAAAIRkY4MDgwODADAAAAAAYmAAAAGlN0ZWVtYS5UZWVDaGFydC5TdHlsZXMuQmFyLQAAAAHZ////+v///woAAAAAAAAAACUAAQAAAdj////6////CgAAAAAAAAAAJQABAAYpAAAADiBNdW5nYmVhbldoZWF0BioAAAAIRkZGRkZGRkYGKwAAAAhGRjgwODA4MAYsAAAACEZGRkZGRkZGBi0AAAAIRkY4MDgwODAAAdL////6////Cv////8AAAAAAAACAAYvAAAACEZGRkZGRkZGAdD////6////CoCAgP8AAAAAAAACAAYxAAAACEZGODA4MDgwAc7////6////Cv////8AAAAAAAACAAYzAAAACEZGRkZGRkZGAcz////6////CoCAgP8AAAAAAAACAAY1AAAACEZGODA4MDgwAcr////6////Cv////8AAAAAAAACAAY3AAAACEZGRkZGRkZGAcj////6////CoCAgP8AAAAAAAACAAY5AAAACEZGODA4MDgwAcb////6////Cv////8AAAAAAAACAAY7AAAACEZGRkZGRkZGAcT////6////CoCAgP8AAAAAAAACAAY9AAAACEZGODA4MDgwAFAAAAAGPgAAAAgjIyMwLiMjIwkVAAAACQAAAAAAEEEBwP////r///8K/////wAAAAAAAAIABkEAAAAIRkZGRkZGRkYBvv////r///8KgICA/wAAAAAAAAIABkMAAAAIRkY4MDgwODABAAAABbz///8gU3lzdGVtLkRyYXdpbmcuRHJhd2luZzJELkxpbmVDYXABAAAAB3ZhbHVlX18ACAQAAAACAAAAAAoAAAAAAbv////6////CgAAAP8AAAAAAAACAAkVAAAACwAAAAAAMEEBuf////r///8KwAAA/wAAAAAAAAIAAbj////6////Cv8AAP8AAAAAAAACAAG3////+v///wr/////AAAAAAAAAgAGSgAAAAhGRkZGRkZGRgG1////+v///wqAgID/AAAAAAAAAgAGTAAAAAhGRjgwODA4MFAAAAAJPgAAAAkVAAAACQAAAAAAEEEBsf////r///8K/////wAAAAAAAAIABlAAAAAIRkZGRkZGRkYBr/////r///8KgICA/wAAAAAAAAIABlIAAAAIRkY4MDgwODABAAAAAa3///+8////AgAAAAAAAaz////6////CgAAAP8AAAAAAAACAAkVAAAACwAAAAAAMEEBqv////r///8K/wAA/wAAAAAAAAIAAan////6////Cv////8AAAAAAAACAAZYAAAACEZGRkZGRkZGAaf////6////CoCAgP8AAAAAAAACAAZaAAAACEZGODA4MDgwAFAAAAAJPgAAAAkVAAAACQAAAAAAEEEBo/////r///8K/////wAAAAAAAAIABl4AAAAIRkZGRkZGRkYBof////r///8KgICA/wAAAAAAAAIABmAAAAAIRkY4MDgwODABAAAAAZ////+8////AgAAAAAKAAAAAAGe////+v///woAAAD/AAAAAAAAAgAJFQAAAAsAAAAAADBBAZz////6////Cv8AAP8AAAAAAAACAAGb////+v///wr/////AAAAAAAAAgAGZgAAAAhGRkZGRkZGRgGZ////+v///wqAgID/AAAAAAAAAgAGaAAAAAhGRjgwODA4MABQAAAABmkAAAAJZC9NTS95eXl5CT4AAAAJFQAAAAkAAAAAABBBAZT////6////Cv////8AAAAAAAACAAZtAAAACEZGRkZGRkZGAZL////6////CoCAgP8AAAAAAAACAAZvAAAACEZGODA4MDgwAQAAAAGQ////vP///wIAAAAACgAAAAoAAAAAAY/////6////CgAAAP8AAAAAAAACAAkVAAAACwAAAAAAMEEBjf////r///8K/wAA/wAAAAAAAAIAAYz////6////Cv////8AAAAAAAACAAZ1AAAACEZGRkZGRkZGAYr////6////CoCAgP8AAAAAAAACAAZ3AAAACEZGODA4MDgwAYj////6////Cv////8AAAAAAAACAAZ5AAAACEZGRkZGRkZGAYb////6////CoCAgP8AAAAAAAACAAZ7AAAACEZGODA4MDgwAYT////6////Cv////8AAAAAAAACAAZ9AAAACEZGRkZGRkZGAYL////6////CoCAgP8AAAAAAAACAAZ/AAAACEZGODA4MDgwAYD////6////Cv////8AAAAAAAACAAaBAAAACEZGRkZGRkZGAX7////6////CoCAgP8AAAAAAAACAAaDAAAACEZGODA4MDgwAXz////6////Cv////8AAAAAAAACAAaFAAAACEZGRkZGRkZGAXr////6////CoCAgP8AAAAAAAACAAaHAAAACEZGODA4MDgwERQAAAACAAAABogAAAAOTXVuZ2JlYW4tV2hlYXQGiQAAAAAL</Format>
              <Plot>
                <SeriesType>Bar</SeriesType>
                <PointType>Circle</PointType>
                <colour>
                </colour>
                <X>year</X>
                <Y>paddock.wheat.yield</Y>
                <Y>paddock.mungbean.yield</Y>
                <GDApsimFileReader name="ApsimFileReader" />
              </Plot>
            </Graph>
          </outputfile>
        </area>
      </simulation>
      <simulation name="MungbeanWheatEarly">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/04/1974</start_date>
          <end_date type="date" description="Enter the end date of the simulation">30/04/1984</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <Soil name="Heavy Clay">
            <RecordNumber>0</RecordNumber>
            <SoilType>Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown>Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude>-27.564333</Latitude>
            <Longitude>151.953991</Longitude>
            <LocationAccuracy>Regional Soil Type</LocationAccuracy>
            <YearOfSampling>0</YearOfSampling>
            <DataSource>YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments>Generic soil developed by Allan Peake.</Comments>
            <Water>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="mungbean">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.06</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Slope>NaN</Slope>
              <DischargeWidth>NaN</DischargeWidth>
              <CatchmentArea>NaN</CatchmentArea>
              <MaxPond>NaN</MaxPond>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
              <OCUnits>Total</OCUnits>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <FractionFull>0.5</FractionFull>
              <DepthWetSoil>NaN</DepthWetSoil>
              <PercentMethod>FilledFromTop</PercentMethod>
              <RelativeTo>ll15</RelativeTo>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Thickness>
                <double>1800</double>
              </Thickness>
              <NO3>
                <double>140</double>
              </NO3>
              <NH4>
                <double>0</double>
              </NH4>
              <SW>
                <double>0</double>
              </SW>
              <NO3Units>kgha</NO3Units>
              <NH4Units>kgha</NH4Units>
              <SWUnits>Volumetric</SWUnits>
              <OCUnits>Total</OCUnits>
              <PHUnits>Water</PHUnits>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <mungbean />
          <wheat />
          <folder name="Manager folder">
            <rotplot name="Paddock Management">
              <canvas_height>484</canvas_height>
              <rules_height>187</rules_height>
              <graph_name>stateGraph</graph_name>
              <language>C#</language>
              <node>
                <name>munbean</name>
                <x1>191</x1>
                <y1>319</y1>
                <desc>
                </desc>
                <fill>-8323328</fill>
              </node>
              <node>
                <name>wheat</name>
                <x1>190</x1>
                <y1>10</y1>
                <desc>
                </desc>
                <fill>-16744320</fill>
              </node>
              <node>
                <name>Fallow</name>
                <x1>10</x1>
                <y1>160</y1>
                <desc>
                </desc>
                <fill>-4144960</fill>
              </node>
              <arc>
                <name>arc2</name>
                <source>wheat</source>
                <target>Fallow</target>
                <x>50</x>
                <y>55</y>
                <actions>Wheat Management.Leave</actions>
                <rules>Wheat Management.canLeave</rules>
              </arc>
              <arc>
                <name>arc0</name>
                <source>Fallow</source>
                <target>munbean</target>
                <x>51</x>
                <y>386</y>
                <actions>Mungbean Management.Enter</actions>
                <rules>Mungbean Management.canEnter</rules>
              </arc>
              <arc>
                <name>arc1</name>
                <source>munbean</source>
                <target>Fallow</target>
                <x>243</x>
                <y>256</y>
                <actions>Mungbean Management.Leave</actions>
                <rules>Mungbean Management.canLeave</rules>
              </arc>
              <arc>
                <name>arc3</name>
                <source>Fallow</source>
                <target>wheat</target>
                <x>245</x>
                <y>191</y>
                <actions>Wheat Management.Enter</actions>
                <rules>Wheat Management.canEnter</rules>
              </arc>
              <paddock>
                <name>paddock</name>
                <isManaged>True</isManaged>
                <initialState>Fallow</initialState>
              </paddock>
              <component name="Paddock Management_" executable="%apsim%/Model/Manager2.dll">
                <executable>%apsim%/Model/Manager2.dll</executable>
                <initdata>
                  <text><![CDATA[using System;
using System.Collections.Generic;
using System.Dynamic;
using System.Text;
using ModelFramework;
using CSGeneral;
public class Script {
[Link] public Simulation MySimulation;
private List<string> paddocks = new List<string>();
private List<dynamic> paddockStates = new List<dynamic>();
private Graph g = new Graph();
private Dictionary<string,string> _currentState = new Dictionary<string,string>();
[Output, Description("Current State of DG")] public string currentState {
  get {string[] r = new string[_currentState.Count]; _currentState.Values.CopyTo(r,0);  
       return(String.Join(" ", r));} 
}
private void setState(string p, string s) {
  _currentState[p] = s;
}
private string getState(string p) {
  return(_currentState[p]);
}
[Output, Description("Current paddock")] public string currentPaddock = "";
[Output] public string [] states = new string[0]; 
[EventHandler] public void OnInitialised()
{
g = new Graph();
states = new string[3];
int i = 0;
g.AddNode("munbean");
states[i++] = "munbean";
g.AddNode("wheat");
states[i++] = "wheat";
g.AddNode("Fallow");
states[i++] = "Fallow";
ruleAction arc2 = new ruleAction();
arc2.testCondition.Add("Wheat Management.canLeave");
arc2.action.Add("Wheat Management.Leave");
g.AddDirectedEdge("wheat","Fallow",arc2);
ruleAction arc0 = new ruleAction();
arc0.testCondition.Add("Mungbean Management.canEnter");
arc0.action.Add("Mungbean Management.Enter");
g.AddDirectedEdge("Fallow","munbean",arc0);
ruleAction arc1 = new ruleAction();
arc1.testCondition.Add("Mungbean Management.canLeave");
arc1.action.Add("Mungbean Management.Leave");
g.AddDirectedEdge("munbean","Fallow",arc1);
ruleAction arc3 = new ruleAction();
arc3.testCondition.Add("Wheat Management.canEnter");
arc3.action.Add("Wheat Management.Enter");
g.AddDirectedEdge("Fallow","wheat",arc3);
}
[EventHandler] public void OnStart_Simulation()
{
paddocks.Add("paddock");
setState("paddock","Fallow");
   MySimulation.Publish("transition");
}
[Output] public string paddock_state {get {return(getState("paddock"));}}
private string modname(string x) {
  if (x.Contains(".")) return(x.Split('.')[0]);
  return("");
}
private string varname(string x) {
  if (x.Contains(".")) return(x.Split('.')[1]);
  return(x);
}
[EventHandler] public void OnProcess()
{
   bool more = true;
   while (more) {
      more = false;
      double bestScore = -1.0; string bestArc = ""; string bestPaddock = "";
      foreach (string p in paddocks) {
         Node s = g.FindNode(getState(p));
         // Console.WriteLine(" state=" + s.Name);
         foreach (string _arc in s.arcs.Keys) {
            double score = 1;
            foreach (string testCondition in s.arcs[_arc].testCondition){
               double c = 0.0;
               currentPaddock = p;
               if (MySimulation.Get(testCondition, out c))
                  score *= c;
               else
                  throw new Exception("Nothing returned from expression '" + testCondition + "'");
               //Console.WriteLine(" p=" + p +" a=" + _arc + "cond=" + testCondition + " score=" + score);
            }
            if (score > bestScore) {
               bestScore = score;
               bestArc = _arc;
               bestPaddock = p;
            }
         }
      }
      currentPaddock = "";
      if (bestScore > 0.0) {
         Node s = g.FindNode(getState(bestPaddock));
         if( bestPaddock != "")
            currentPaddock = bestPaddock;
         if (getState(bestPaddock) != "") MySimulation.Publish("transition_from_" + getState(bestPaddock));
         MySimulation.Publish("transition");
         setState (bestPaddock, g.FindArcTarget(bestArc));
         foreach (string action in s.arcs[bestArc].action ) {
            MySimulation.Publish(action);
            //Console.WriteLine(" best=" + bestPaddock + " action=" + action);
         }
         MySimulation.Publish("transition_to_" + getState(bestPaddock));
         more = true;
      }
   }
}
  public class ruleAction
  {
     public string Target;
     public List<string> testCondition = new List<string>();
     public List<string> action = new List<string>();
  }
   public class Node : IEquatable<Node>
   {
      private string data /*, alias*/;
      public Node(string _data) { data = _data; }
      public Dictionary<string, ruleAction> arcs = new Dictionary<string, ruleAction>();
      public bool Equals(Node other)
      {
         return ( this.data == other.data );
      }
      public string Name { get { return (data); } }
   }

   class Graph
   {
      public List<Node> vertices;
      public void print() {
         foreach (Node n in vertices) {
            Console.WriteLine(n.Name + ":"); 
            foreach (string k in n.arcs.Keys) {
               Console.WriteLine("  " + k); 
            }
         }
      }
      public Graph() { vertices = new List<Node>(); }
      public Node AddNode(Node node)
      {
         if (vertices.Find(delegate(Node n) { return (n.Equals(node)); }) == null)
            vertices.Add(node);
         return (vertices.Find(delegate(Node n) { return (n.Equals(node)); }));
      }
      public Node AddNode(string value)
      {
         return (AddNode(new Node(value)));
      }
      public Node FindNode(string value)
      {
         return (FindNode(AddNode(value)));
      }
      public Node FindNode(Node node)
      {
         return (vertices.Find(delegate(Node n) { return (n.Equals(node)); }));
      }
      public void AddDirectedEdge(string source, string dest, ruleAction value)
      {
         int i = 0;
         foreach (Node n in vertices) {
            foreach (string arc in n.arcs.Keys) {
               i++;
            }
         }
         Node node1 = AddNode(source);
         AddNode(dest);
         value.Target = dest;
         node1.arcs.Add("arc" + i.ToString(), value);
      }
      public string FindArcTarget(string arc)
      {
         foreach (Node n in vertices) {
            foreach (string a in n.arcs.Keys) {
               if (a == arc) { return (n.arcs[a].Target); }
            }
         }
         Console.WriteLine("Aiee - no target for arc " + arc ); 
         return("");
      }
   }
}
]]></text>
                </initdata>
              </component>
            </rotplot>
            <manager2 name="Wheat Management">
              <ui>
                <category type="category" description="Crop properties" />
                <crop type="crop" description="Name of this crop">wheat</crop>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm)">1-jun</date1>
                <date3 type="ddmmmdate" description="Enter cultivar change date (na if not in use)">15-jun</date3>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm)">1-aug</date2>
                <must_sow type="yesno" description="Must Sow">no</must_sow>
                <rain_amount type="text" description="Enter amount of cumulative rainfall (mm)">20</rain_amount>
                <rain_days type="text" description="Enter number of days to accumulate rainfall (days)">3</rain_days>
                <esw_amount type="text" description="Enter amount of soil water (mm)">200</esw_amount>
                <category type="category" description="Sowing Parameters" />
                <cultivar1 type="cultivars" description="Enter cultivar : ">janz</cultivar1>
                <cultivar2 type="cultivars" description="Enter 2nd Cultivar (na if not using a second cultivar)">hartog</cultivar2>
                <density1 type="text" description="Enter sowing density  (plants/m2)">100</density1>
                <depth1 type="text" description="Enter sowing depth  (mm)">30</depth1>
                <row_spacing1 type="text" description="Enter row spacing  (mm)">250</row_spacing1>
                <category type="category" description="Extra Parameters" />
                <ftn1 type="text" description="Enter Fertile Tiller Number (na for auto) : ">na</ftn1>
                <skiprow1 type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow1>
                <tillageImplement type="text" description="Name of tillage implement (na if not in use): ">na</tillageImplement>
              </ui>
              <text>using System;
using ModelFramework;
using CSGeneral;

// Basic crop management: sowing &amp; harvesting.
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.
// It will assume it is the only crop in the system if it doesnt find a sequencer.
// If it does find a sequencer, it will do nothing until told to (via Enter/Leave).
public class Script 
{      
   [Link()]  public Simulation MySimulation;
   
   [Param()] private string crop;         // The module name of this crop
   [Param()] private string date1;         //Start of sowing window
   [Param()] private string date2;         //End of sowing window
   [Param()] private string date3;         //date to change to different cultivar
   [Param()] int esw_amount;
   [Param()] private string must_sow;

   [Input()] private DateTime today;

   // Rainfall accumulator
   [Param()] int rain_days;              //check for rain over this period
   [Param()] int rain_amount;            //this much rain over that period

   // Daily rainfall from the system
   [Input] private double rain;
   private ManagerUtility.Tracker&lt;double&gt; rainTracker; 

   private bool inWindow = false;
   private bool endOfWindow = false;
   private bool ChangeCultivar = false;

   //initialise tracker, telling it how many days to track
   [EventHandler] public void OnInitialised()
   {
      rainTracker = new ManagerUtility.Tracker&lt;double&gt;(rain_days); 
   }

   // Daily tests common to all paddocks
   [EventHandler] public void OnPrepare()
   {
      bool startOfWindow = DateUtility.DatesEqual(date1, today);

      inWindow = DateUtility.WithinDates(date1, today, date2);
      ChangeCultivar = false;
      if(date3 != "na")  
         ChangeCultivar = DateUtility.WithinDates(date3, today, date2);
      endOfWindow = DateUtility.DatesEqual(date2, today);

      rainTracker.Add(rain);
      string currentPaddock = "";
      if (MySimulation.Get("currentPaddock", out currentPaddock) == false) 
      {
         // If there is no sequencer plugged in then we are it..
         if (canEnter &gt; 0) {
            OnEnter();
         }
         if (canLeave &gt; 0) {
            OnLeave();
         }
      }
   }
   // Test whether we can sow a crop today
   // +ve number - yes
   // 0          - no
   // -ve number - no, out of scope (planting window)
   [Output, Description("Test whether we can sow a crop today")] public int canEnter  {
      get {
         bool isPossibleToday = false;
         
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("1. '" + currentPaddock + "'");

         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Component cropModule = (Component) paddockModule.LinkByName( crop );

         //Console.WriteLine("3. " + cropModule.Name);
         string plantStatus = "";
         cropModule.Get("plant_status", out plantStatus);

         double esw = 0.0;
         Component soilModule = (Component) paddockModule.LinkByType("SoilWat");
         soilModule.Get("esw", out esw);
         if (plantStatus == "out" &amp;&amp;
             inWindow &amp;&amp;
             rainTracker.Sum() &gt;= rain_amount &amp;&amp;
             esw &gt; esw_amount) 
         {
             isPossibleToday = true;
         } 

	     if (isPossibleToday)
            return 1;
         
         if (plantStatus == "out" &amp;&amp; endOfWindow &amp;&amp; must_sow == "yes")
            return 1;

         if (plantStatus == "out" &amp;&amp; !inWindow)
            return -1;
         
         return 0;
      }
   }  
   
   
   // Sow a crop
   [Param()] private string cultivar1;
   [Param()] private string cultivar2;
   [Param()] private double density1;
   [Param()] private double depth1;
   [Param()] private double row_spacing1;
   [Param()] private string ftn1;
   [Param()] private string skiprow1;
   [Param()] private string tillageImplement;
   
   [EventHandler, Description("Sow the crop")] public void OnEnter()
   {
      Console.WriteLine(today + " Sowing Crop");
      SowType data = new SowType();
      data.Cultivar = cultivar1;
      if(ChangeCultivar)
         data.Cultivar = cultivar2;

      data.plants = density1;
      data.sowing_depth = depth1;
      data.row_spacing = row_spacing1;
      data.tiller_no_fertile = (ftn1 == "na") ? "" : ftn1;
      data.SkipRow = 0 ;
      if (skiprow1 == "single")
         data.SkipRow = 1;
      else if (skiprow1 == "double")
         data.SkipRow = 2;

      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("Sow", data);

      if (tillageImplement.ToLower() != "na") 
	  {
         TillageType t = new TillageType();
         t.type = tillageImplement;
         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = MySimulation.ChildPaddocks[0];
         paddockModule.Publish("tillage", t);
      }		 
   }

   // Test whether we can harvest a crop today
   // +ve number - yes
   // 0          - no
   // -ve        - out of scope
   [Output] public int canLeave  
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (StageName == "harvest_ripe" || plantStatus == "dead")
            return 1;
         return 0;
      }
   }

   [EventHandler] public void OnLeave()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 0.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);

      KillCropType kdata = new KillCropType();
      kdata.KillFraction = 0.0F;
      cropModule.Publish("killcrop", kdata);
      cropModule.Publish("end_crop");
   } 
}
       </text>
            </manager2>
            <manager2 name="Fertilise at Sowing">
              <ui>
                <tag type="category" description="When should fertiliser be applied" />
                <ModuleName type="modulename" description="On which module should the event come from: ">wheat</ModuleName>
                <EventName type="text" description="On which event should spraying be triggered">sowing</EventName>
                <tag type="category" description="Event details" />
                <fertType type="text" description="The type of fertiliser">urea_N</fertType>
                <fertAmt type="text" description="Amount of fertiliser to apply (kg/ha)">70</fertAmt>
              </ui>
              <text>using System;
using System.Linq;
using System.Collections.Generic;
using ModelFramework;

// Crop management: fertilise at sowing
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.

public class Script 
{      
   [Link]  public Simulation MySimulation;
   [Param] string fertType;
   [Param] float fertAmt;
   [Param] string ModuleName;
   [Param] string EventName;
   
   [EventHandler] public void OnStart_Simulation()
   {
      foreach (Paddock paddock in MySimulation.ChildPaddocks) 
      {
         foreach (Component child in paddock.Children) {
            if(child.Name == ModuleName){
               RuntimeEventHandler.NullFunction curried = () =&gt; OnTrigger(paddock.Name);
               MySimulation.Subscribe(child.FullName + "." + EventName, curried);
               //Console.WriteLine("Subscribed '" + child.FullName + "." + EventName + " =&gt; " + paddock.Name + "'"); 
            }
         }
      }
   }

   public void OnTrigger(string paddock)
   {
      Console.WriteLine("Fertiliser OnTrigger called, paddock='" + paddock + "'"); 
      if (fertAmt &gt; 0) 
      {         
         Component paddockModule;
         if (paddock != "")
            paddockModule = (Component) MySimulation.LinkByName(paddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Fertiliser fertModule = (Fertiliser) paddockModule.LinkByName("Fertiliser");
         fertModule.Apply(fertAmt, 50, fertType);
      }
   }
}
       </text>
            </manager2>
            <manager2 name="Mungbean Management">
              <ui>
                <category type="category" description="Crop properties" />
                <crop type="crop" description="Name of this crop">mungbean</crop>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm)">1-nov</date1>
                <date3 type="ddmmmdate" description="Enter cultivar change date (na if not in use)">na</date3>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm)">1-jan</date2>
                <must_sow type="yesno" description="Must Sow">no</must_sow>
                <rain_amount type="text" description="Enter amount of cumulative rainfall (mm)">20</rain_amount>
                <rain_days type="text" description="Enter number of days to accumulate rainfall (days)">3</rain_days>
                <esw_amount type="text" description="Enter amount of soil water (mm)">200</esw_amount>
                <category type="category" description="Sowing Parameters" />
                <cultivar1 type="cultivars" description="Enter cultivar : ">berken</cultivar1>
                <cultivar2 type="cultivars" description="Enter 2nd Cultivar (na if not using a second cultivar)">na</cultivar2>
                <density1 type="text" description="Enter sowing density  (plants/m2)">36</density1>
                <depth1 type="text" description="Enter sowing depth  (mm)">50</depth1>
                <row_spacing1 type="text" description="Enter row spacing  (mm)">500</row_spacing1>
                <category type="category" description="Extra Parameters" />
                <ftn1 type="text" description="Enter Fertile Tiller Number (na for auto) : ">na</ftn1>
                <skiprow1 type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow1>
                <tillageImplement type="text" description="Name of tillage implement (na if not in use): ">na</tillageImplement>
              </ui>
              <text>using System;
using ModelFramework;
using CSGeneral;

// Basic crop management: sowing &amp; harvesting.
// Multi-paddock aware.
// This component DOES NOT require a trigger from the sequencer.
// It will assume it is the only crop in the system if it doesnt find a sequencer.
// If it does find a sequencer, it will do nothing until told to (via Enter/Leave).
public class Script 
{      
   [Link()]  public Simulation MySimulation;
   
   [Param()] private string crop;         // The module name of this crop
   [Param()] private string date1;         //Start of sowing window
   [Param()] private string date2;         //End of sowing window
   [Param()] private string date3;         //date to change to different cultivar
   [Param()] int esw_amount;
   [Param()] private string must_sow;

   [Input()] private DateTime today;

   // Rainfall accumulator
   [Param()] int rain_days;              //check for rain over this period
   [Param()] int rain_amount;            //this much rain over that period

   // Daily rainfall from the system
   [Input] private double rain;
   private ManagerUtility.Tracker&lt;double&gt; rainTracker; 

   private bool inWindow = false;
   private bool endOfWindow = false;
   private bool ChangeCultivar = false;

   //initialise tracker, telling it how many days to track
   [EventHandler] public void OnInitialised()
   {
      rainTracker = new ManagerUtility.Tracker&lt;double&gt;(rain_days); 
   }

   // Daily tests common to all paddocks
   [EventHandler] public void OnPrepare()
   {
      bool startOfWindow = DateUtility.DatesEqual(date1, today);

      inWindow = DateUtility.WithinDates(date1, today, date2);
      ChangeCultivar = false;
      if(date3 != "na")  
         ChangeCultivar = DateUtility.WithinDates(date3, today, date2);
      endOfWindow = DateUtility.DatesEqual(date2, today);

      rainTracker.Add(rain);
      string currentPaddock = "";
      if (MySimulation.Get("currentPaddock", out currentPaddock) == false) 
      {
         // If there is no sequencer plugged in then we are it..
         if (canEnter &gt; 0) {
            OnEnter();
         }
         if (canLeave &gt; 0) {
            OnLeave();
         }
      }
   }
   // Test whether we can sow a crop today
   // +ve number - yes
   // 0          - no
   // -ve number - no, out of scope (planting window)
   [Output, Description("Test whether we can sow a crop today")] public int canEnter  {
      get {
         bool isPossibleToday = false;
         
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);
         //Console.WriteLine("1. '" + currentPaddock + "'");

         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = (Component) MySimulation.ChildPaddocks[0];
         //Console.WriteLine("2. " + paddockModule.Name);

         Component cropModule = (Component) paddockModule.LinkByName( crop );

         //Console.WriteLine("3. " + cropModule.Name);
         string plantStatus = "";
         cropModule.Get("plant_status", out plantStatus);

         double esw = 0.0;
         Component soilModule = (Component) paddockModule.LinkByType("SoilWat");
         soilModule.Get("esw", out esw);
         if (plantStatus == "out" &amp;&amp;
             inWindow &amp;&amp;
             rainTracker.Sum() &gt;= rain_amount &amp;&amp;
             esw &gt; esw_amount) 
         {
             isPossibleToday = true;
         } 

	     if (isPossibleToday)
            return 1;
         
         if (plantStatus == "out" &amp;&amp; endOfWindow &amp;&amp; must_sow == "yes")
            return 1;

         if (plantStatus == "out" &amp;&amp; !inWindow)
            return -1;
         
         return 0;
      }
   }  
   
   
   // Sow a crop
   [Param()] private string cultivar1;
   [Param()] private string cultivar2;
   [Param()] private double density1;
   [Param()] private double depth1;
   [Param()] private double row_spacing1;
   [Param()] private string ftn1;
   [Param()] private string skiprow1;
   [Param()] private string tillageImplement;
   
   [EventHandler, Description("Sow the crop")] public void OnEnter()
   {
      Console.WriteLine(today + " Sowing Crop");
      SowType data = new SowType();
      data.Cultivar = cultivar1;
      if(ChangeCultivar)
         data.Cultivar = cultivar2;

      data.plants = density1;
      data.sowing_depth = depth1;
      data.row_spacing = row_spacing1;
      data.tiller_no_fertile = (ftn1 == "na") ? "" : ftn1;
      data.SkipRow = 0 ;
      if (skiprow1 == "single")
         data.SkipRow = 1;
      else if (skiprow1 == "double")
         data.SkipRow = 2;

      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("Sow", data);

      if (tillageImplement.ToLower() != "na") 
	  {
         TillageType t = new TillageType();
         t.type = tillageImplement;
         Component paddockModule;
         if (currentPaddock != "")
            paddockModule = (Component) MySimulation.LinkByName(currentPaddock);
         else
            paddockModule = MySimulation.ChildPaddocks[0];
         paddockModule.Publish("tillage", t);
      }		 
   }

   // Test whether we can harvest a crop today
   // +ve number - yes
   // 0          - no
   // -ve        - out of scope
   [Output] public int canLeave  
   {
      get 
      {
         string currentPaddock;
         MySimulation.Get("currentPaddock", out currentPaddock);

         string plantStatus = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".plant_status", out plantStatus);
         if (plantStatus == "out")
            return -1;

         string StageName = "";
         MySimulation.Get((currentPaddock != "" ? currentPaddock + "." : "") + crop + ".StageName", out StageName);
         if (StageName == "harvest_ripe" || plantStatus == "dead")
            return 1;
         return 0;
      }
   }

   [EventHandler] public void OnLeave()
   {
      Console.WriteLine(today + " Harvesting Crop");
      HarvestType hdata = new HarvestType();
      hdata.Remove = 0.0;
      string currentPaddock;
      MySimulation.Get("currentPaddock", out currentPaddock);
      Component cropModule;
      if (currentPaddock != "")
         cropModule = (Component) MySimulation.LinkByName(currentPaddock + "." + crop);
      else 
         cropModule = (Component) MySimulation.ChildPaddocks[0].LinkByName(crop);

      cropModule.Publish("harvest", hdata);

      KillCropType kdata = new KillCropType();
      kdata.KillFraction = 0.0F;
      cropModule.Publish("killcrop", kdata);
      cropModule.Publish("end_crop");
   } 
}
       </text>
            </manager2>
          </folder>
          <outputfile>
            <filename output="yes">MungbeanWheatEarly.out</filename>
            <title>MungbeanWheatEarly</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>year</variable>
              <variable>biom_n()</variable>
              <variable>yield</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>harvesting</event>
            </events>
            <Graph name="XY">
              <Legend>
                <CheckedTitles> paddock.wheat.yield</CheckedTitles>
                <CheckedTitles> paddock.mungbean.yield</CheckedTitles>
              </Legend>
              <Format>AAEAAAD/////AQAAAAAAAAAMAgAAAFhUZWVDaGFydC5DbGllbnQsIFZlcnNpb249NC4xLjIwMTEuNzI4MywgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj05YzgxMjYyNzZjNzdiZGI3DAMAAABXU3lzdGVtLldpbmRvd3MuRm9ybXMsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5DAQAAABRU3lzdGVtLkRyYXdpbmcsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iMDNmNWY3ZjExZDUwYTNhBQEAAAAVU3RlZW1hLlRlZUNoYXJ0LkNoYXJ0xAAAAA4uWm9vbS5BbmltYXRlZBMuWm9vbS5BbmltYXRlZFN0ZXBzFC5QYW5uaW5nLk1vdXNlQnV0dG9uEC5DdXN0b21DaGFydFJlY3QXLlBhbmVsLkltYWdlQmV2ZWwuV2lkdGgVLlBhbmVsLkJldmVsLkNvbG9yT25lGy5QYW5lbC5CZXZlbC5TdHJpbmdDb2xvck9uZRUuUGFuZWwuQmV2ZWwuQ29sb3JUd28bLlBhbmVsLkJldmVsLlN0cmluZ0NvbG9yVHdvEi5QYW5lbC5CZXZlbC5PdXRlchIuUGFuZWwuQnJ1c2guQ29sb3ISLkxlZ2VuZC5DaGVja0JveGVzEi5MZWdlbmQuTWF4TnVtUm93cxwuTGVnZW5kLlRpdGxlLkJldmVsLkNvbG9yT25lIi5MZWdlbmQuVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JPbmUcLkxlZ2VuZC5UaXRsZS5CZXZlbC5Db2xvclR3byIuTGVnZW5kLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yVHdvFi5MZWdlbmQuQmV2ZWwuQ29sb3JPbmUcLkxlZ2VuZC5CZXZlbC5TdHJpbmdDb2xvck9uZRYuTGVnZW5kLkJldmVsLkNvbG9yVHdvHC5MZWdlbmQuQmV2ZWwuU3RyaW5nQ29sb3JUd28WLkxlZ2VuZC5TaGFkb3cuVmlzaWJsZRMuTGVnZW5kLlRyYW5zcGFyZW50DS5IZWFkZXIuTGluZXMRLkhlYWRlci5Gb250Lk5hbWURLkhlYWRlci5Gb250LlNpemUWLkhlYWRlci5Gb250LlNpemVGbG9hdBYuSGVhZGVyLkJldmVsLkNvbG9yT25lHC5IZWFkZXIuQmV2ZWwuU3RyaW5nQ29sb3JPbmUWLkhlYWRlci5CZXZlbC5Db2xvclR3bxwuSGVhZGVyLkJldmVsLlN0cmluZ0NvbG9yVHdvGS5TdWJIZWFkZXIuQmV2ZWwuQ29sb3JPbmUfLlN1YkhlYWRlci5CZXZlbC5TdHJpbmdDb2xvck9uZRkuU3ViSGVhZGVyLkJldmVsLkNvbG9yVHdvHy5TdWJIZWFkZXIuQmV2ZWwuU3RyaW5nQ29sb3JUd28WLkZvb3Rlci5CZXZlbC5Db2xvck9uZRwuRm9vdGVyLkJldmVsLlN0cmluZ0NvbG9yT25lFi5Gb290ZXIuQmV2ZWwuQ29sb3JUd28cLkZvb3Rlci5CZXZlbC5TdHJpbmdDb2xvclR3bxkuU3ViRm9vdGVyLkJldmVsLkNvbG9yT25lHy5TdWJGb290ZXIuQmV2ZWwuU3RyaW5nQ29sb3JPbmUZLlN1YkZvb3Rlci5CZXZlbC5Db2xvclR3bx8uU3ViRm9vdGVyLkJldmVsLlN0cmluZ0NvbG9yVHdvGS5Bc3BlY3QuQ29sb3JQYWxldHRlSW5kZXgOLkFzcGVjdC5WaWV3M0QIU2VyaWVzLjAZLlNlcmllcy4wLkJhcldpZHRoUGVyY2VudBUuU2VyaWVzLjAuQnJ1c2guQ29sb3ITLlNlcmllcy4wLkNvbG9yRWFjaA8uU2VyaWVzLjAuQ29sb3IPLlNlcmllcy4wLlRpdGxlKy5TZXJpZXMuMC5NYXJrcy5TeW1ib2wuQmV2ZWwuU3RyaW5nQ29sb3JPbmUrLlNlcmllcy4wLk1hcmtzLlN5bWJvbC5CZXZlbC5TdHJpbmdDb2xvclR3byQuU2VyaWVzLjAuTWFya3MuQmV2ZWwuU3RyaW5nQ29sb3JPbmUkLlNlcmllcy4wLk1hcmtzLkJldmVsLlN0cmluZ0NvbG9yVHdvFy5TZXJpZXMuMC5NYXJrcy5WaXNpYmxlCFNlcmllcy4xGS5TZXJpZXMuMS5CYXJXaWR0aFBlcmNlbnQVLlNlcmllcy4xLkJydXNoLkNvbG9yEy5TZXJpZXMuMS5Db2xvckVhY2gPLlNlcmllcy4xLkNvbG9yDy5TZXJpZXMuMS5UaXRsZSsuU2VyaWVzLjEuTWFya3MuU3ltYm9sLkJldmVsLlN0cmluZ0NvbG9yT25lKy5TZXJpZXMuMS5NYXJrcy5TeW1ib2wuQmV2ZWwuU3RyaW5nQ29sb3JUd28kLlNlcmllcy4xLk1hcmtzLkJldmVsLlN0cmluZ0NvbG9yT25lJC5TZXJpZXMuMS5NYXJrcy5CZXZlbC5TdHJpbmdDb2xvclR3bxcuU2VyaWVzLjEuTWFya3MuVmlzaWJsZRouV2FsbHMuTGVmdC5CZXZlbC5Db2xvck9uZSAuV2FsbHMuTGVmdC5CZXZlbC5TdHJpbmdDb2xvck9uZRouV2FsbHMuTGVmdC5CZXZlbC5Db2xvclR3byAuV2FsbHMuTGVmdC5CZXZlbC5TdHJpbmdDb2xvclR3bxsuV2FsbHMuUmlnaHQuQmV2ZWwuQ29sb3JPbmUhLldhbGxzLlJpZ2h0LkJldmVsLlN0cmluZ0NvbG9yT25lGy5XYWxscy5SaWdodC5CZXZlbC5Db2xvclR3byEuV2FsbHMuUmlnaHQuQmV2ZWwuU3RyaW5nQ29sb3JUd28aLldhbGxzLkJhY2suQmV2ZWwuQ29sb3JPbmUgLldhbGxzLkJhY2suQmV2ZWwuU3RyaW5nQ29sb3JPbmUaLldhbGxzLkJhY2suQmV2ZWwuQ29sb3JUd28gLldhbGxzLkJhY2suQmV2ZWwuU3RyaW5nQ29sb3JUd28cLldhbGxzLkJvdHRvbS5CZXZlbC5Db2xvck9uZSIuV2FsbHMuQm90dG9tLkJldmVsLlN0cmluZ0NvbG9yT25lHC5XYWxscy5Cb3R0b20uQmV2ZWwuQ29sb3JUd28iLldhbGxzLkJvdHRvbS5CZXZlbC5TdHJpbmdDb2xvclR3bw4uV2FsbHMuVmlzaWJsZRwuQXhlcy5MZWZ0LkxhYmVscy5TZXBhcmF0aW9uHS5BeGVzLkxlZnQuTGFiZWxzLlZhbHVlRm9ybWF0Gy5BeGVzLkxlZnQuTGFiZWxzLkZvbnQuTmFtZRsuQXhlcy5MZWZ0LkxhYmVscy5Gb250LlNpemUgLkF4ZXMuTGVmdC5MYWJlbHMuRm9udC5TaXplRmxvYXQgLkF4ZXMuTGVmdC5MYWJlbHMuQmV2ZWwuQ29sb3JPbmUmLkF4ZXMuTGVmdC5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JPbmUgLkF4ZXMuTGVmdC5MYWJlbHMuQmV2ZWwuQ29sb3JUd28mLkF4ZXMuTGVmdC5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JUd28YLkF4ZXMuTGVmdC5BeGlzUGVuLldpZHRoGS5BeGVzLkxlZnQuQXhpc1Blbi5FbmRDYXAXLkF4ZXMuTGVmdC5HcmlkLlZpc2libGUYLkF4ZXMuTGVmdC5NYXhpbXVtT2Zmc2V0HS5BeGVzLkxlZnQuTWlub3JUaWNrcy5WaXNpYmxlFi5BeGVzLkxlZnQuVGlja3MuQ29sb3IaLkF4ZXMuTGVmdC5UaXRsZS5Gb250Lk5hbWUaLkF4ZXMuTGVmdC5UaXRsZS5Gb250LlNpemUfLkF4ZXMuTGVmdC5UaXRsZS5Gb250LlNpemVGbG9hdCguQXhlcy5MZWZ0LlRpdGxlLkZvbnQuU2hhZG93LkJydXNoLkNvbG9yIS5BeGVzLkxlZnQuVGl0bGUuRm9udC5CcnVzaC5Db2xvch8uQXhlcy5MZWZ0LlRpdGxlLkJldmVsLkNvbG9yT25lJS5BeGVzLkxlZnQuVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JPbmUfLkF4ZXMuTGVmdC5UaXRsZS5CZXZlbC5Db2xvclR3byUuQXhlcy5MZWZ0LlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yVHdvGy5BeGVzLlRvcC5MYWJlbHMuU2VwYXJhdGlvbhwuQXhlcy5Ub3AuTGFiZWxzLlZhbHVlRm9ybWF0Gi5BeGVzLlRvcC5MYWJlbHMuRm9udC5OYW1lGi5BeGVzLlRvcC5MYWJlbHMuRm9udC5TaXplHy5BeGVzLlRvcC5MYWJlbHMuRm9udC5TaXplRmxvYXQfLkF4ZXMuVG9wLkxhYmVscy5CZXZlbC5Db2xvck9uZSUuQXhlcy5Ub3AuTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yT25lHy5BeGVzLlRvcC5MYWJlbHMuQmV2ZWwuQ29sb3JUd28lLkF4ZXMuVG9wLkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvclR3bxcuQXhlcy5Ub3AuQXhpc1Blbi5XaWR0aBguQXhlcy5Ub3AuQXhpc1Blbi5FbmRDYXAWLkF4ZXMuVG9wLkdyaWQuVmlzaWJsZRwuQXhlcy5Ub3AuTWlub3JUaWNrcy5WaXNpYmxlFS5BeGVzLlRvcC5UaWNrcy5Db2xvchkuQXhlcy5Ub3AuVGl0bGUuRm9udC5OYW1lGS5BeGVzLlRvcC5UaXRsZS5Gb250LlNpemUeLkF4ZXMuVG9wLlRpdGxlLkZvbnQuU2l6ZUZsb2F0IC5BeGVzLlRvcC5UaXRsZS5Gb250LkJydXNoLkNvbG9yHi5BeGVzLlRvcC5UaXRsZS5CZXZlbC5Db2xvck9uZSQuQXhlcy5Ub3AuVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JPbmUeLkF4ZXMuVG9wLlRpdGxlLkJldmVsLkNvbG9yVHdvJC5BeGVzLlRvcC5UaXRsZS5CZXZlbC5TdHJpbmdDb2xvclR3bxEuQXhlcy5Ub3AuVmlzaWJsZR0uQXhlcy5SaWdodC5MYWJlbHMuU2VwYXJhdGlvbh4uQXhlcy5SaWdodC5MYWJlbHMuVmFsdWVGb3JtYXQcLkF4ZXMuUmlnaHQuTGFiZWxzLkZvbnQuTmFtZRwuQXhlcy5SaWdodC5MYWJlbHMuRm9udC5TaXplIS5BeGVzLlJpZ2h0LkxhYmVscy5Gb250LlNpemVGbG9hdCEuQXhlcy5SaWdodC5MYWJlbHMuQmV2ZWwuQ29sb3JPbmUnLkF4ZXMuUmlnaHQuTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yT25lIS5BeGVzLlJpZ2h0LkxhYmVscy5CZXZlbC5Db2xvclR3bycuQXhlcy5SaWdodC5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JUd28ZLkF4ZXMuUmlnaHQuQXhpc1Blbi5XaWR0aBouQXhlcy5SaWdodC5BeGlzUGVuLkVuZENhcBguQXhlcy5SaWdodC5HcmlkLlZpc2libGUZLkF4ZXMuUmlnaHQuTWF4aW11bU9mZnNldB4uQXhlcy5SaWdodC5NaW5vclRpY2tzLlZpc2libGUXLkF4ZXMuUmlnaHQuVGlja3MuQ29sb3IbLkF4ZXMuUmlnaHQuVGl0bGUuRm9udC5OYW1lGy5BeGVzLlJpZ2h0LlRpdGxlLkZvbnQuU2l6ZSAuQXhlcy5SaWdodC5UaXRsZS5Gb250LlNpemVGbG9hdCIuQXhlcy5SaWdodC5UaXRsZS5Gb250LkJydXNoLkNvbG9yIC5BeGVzLlJpZ2h0LlRpdGxlLkJldmVsLkNvbG9yT25lJi5BeGVzLlJpZ2h0LlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yT25lIC5BeGVzLlJpZ2h0LlRpdGxlLkJldmVsLkNvbG9yVHdvJi5BeGVzLlJpZ2h0LlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yVHdvEy5BeGVzLlJpZ2h0LlZpc2libGUeLkF4ZXMuQm90dG9tLkxhYmVscy5TZXBhcmF0aW9uIi5BeGVzLkJvdHRvbS5MYWJlbHMuRGF0ZVRpbWVGb3JtYXQfLkF4ZXMuQm90dG9tLkxhYmVscy5WYWx1ZUZvcm1hdB0uQXhlcy5Cb3R0b20uTGFiZWxzLkZvbnQuTmFtZR0uQXhlcy5Cb3R0b20uTGFiZWxzLkZvbnQuU2l6ZSIuQXhlcy5Cb3R0b20uTGFiZWxzLkZvbnQuU2l6ZUZsb2F0Ii5BeGVzLkJvdHRvbS5MYWJlbHMuQmV2ZWwuQ29sb3JPbmUoLkF4ZXMuQm90dG9tLkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvck9uZSIuQXhlcy5Cb3R0b20uTGFiZWxzLkJldmVsLkNvbG9yVHdvKC5BeGVzLkJvdHRvbS5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JUd28aLkF4ZXMuQm90dG9tLkF4aXNQZW4uV2lkdGgbLkF4ZXMuQm90dG9tLkF4aXNQZW4uRW5kQ2FwGS5BeGVzLkJvdHRvbS5HcmlkLlZpc2libGUaLkF4ZXMuQm90dG9tLk1heGltdW1PZmZzZXQaLkF4ZXMuQm90dG9tLk1pbmltdW1PZmZzZXQfLkF4ZXMuQm90dG9tLk1pbm9yVGlja3MuVmlzaWJsZRguQXhlcy5Cb3R0b20uVGlja3MuQ29sb3IcLkF4ZXMuQm90dG9tLlRpdGxlLkZvbnQuTmFtZRwuQXhlcy5Cb3R0b20uVGl0bGUuRm9udC5TaXplIS5BeGVzLkJvdHRvbS5UaXRsZS5Gb250LlNpemVGbG9hdCMuQXhlcy5Cb3R0b20uVGl0bGUuRm9udC5CcnVzaC5Db2xvciEuQXhlcy5Cb3R0b20uVGl0bGUuQmV2ZWwuQ29sb3JPbmUnLkF4ZXMuQm90dG9tLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yT25lIS5BeGVzLkJvdHRvbS5UaXRsZS5CZXZlbC5Db2xvclR3bycuQXhlcy5Cb3R0b20uVGl0bGUuQmV2ZWwuU3RyaW5nQ29sb3JUd28kLkF4ZXMuRGVwdGhUb3AuTGFiZWxzLkJldmVsLkNvbG9yT25lKi5BeGVzLkRlcHRoVG9wLkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvck9uZSQuQXhlcy5EZXB0aFRvcC5MYWJlbHMuQmV2ZWwuQ29sb3JUd28qLkF4ZXMuRGVwdGhUb3AuTGFiZWxzLkJldmVsLlN0cmluZ0NvbG9yVHdvIy5BeGVzLkRlcHRoVG9wLlRpdGxlLkJldmVsLkNvbG9yT25lKS5BeGVzLkRlcHRoVG9wLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yT25lIy5BeGVzLkRlcHRoVG9wLlRpdGxlLkJldmVsLkNvbG9yVHdvKS5BeGVzLkRlcHRoVG9wLlRpdGxlLkJldmVsLlN0cmluZ0NvbG9yVHdvIS5BeGVzLkRlcHRoLkxhYmVscy5CZXZlbC5Db2xvck9uZScuQXhlcy5EZXB0aC5MYWJlbHMuQmV2ZWwuU3RyaW5nQ29sb3JPbmUhLkF4ZXMuRGVwdGguTGFiZWxzLkJldmVsLkNvbG9yVHdvJy5BeGVzLkRlcHRoLkxhYmVscy5CZXZlbC5TdHJpbmdDb2xvclR3byAuQXhlcy5EZXB0aC5UaXRsZS5CZXZlbC5Db2xvck9uZSYuQXhlcy5EZXB0aC5UaXRsZS5CZXZlbC5TdHJpbmdDb2xvck9uZSAuQXhlcy5EZXB0aC5UaXRsZS5CZXZlbC5Db2xvclR3byYuQXhlcy5EZXB0aC5UaXRsZS5CZXZlbC5TdHJpbmdDb2xvclR3bwAABAAABAEEAQQEAAAEAQQBBAEEAQAABgEAAAQBBAEEAQQBBAEEAQQBBAEAAAEABAAEAQEBAQEAAQAEAAQBAQEBAQAEAQQBBAEEAQQBBAEEAQQBAAABAQAABAEEAQAEAAAABAEAAAQEBAEEAQABAQAABAEEAQAEAAAEAQAABAQBBAEAAAEBAAAEAQQBAAQAAAAEAQAABAQBBAEAAAEBAQAABAEEAQAEAAAAAAQBAAAEBAEEAQQBBAEEAQQBBAEEAQQBBAEBCCFTeXN0ZW0uV2luZG93cy5Gb3Jtcy5Nb3VzZUJ1dHRvbnMDAAAAAQgUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAACNTdGVlbWEuVGVlQ2hhcnQuRHJhd2luZy5CZXZlbFN0eWxlcwIAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAAQgUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAAQEICxRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACAEIFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAEUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAAQgUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAARRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABCAgLFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAIIFN5c3RlbS5EcmF3aW5nLkRyYXdpbmcyRC5MaW5lQ2FwBAAAAAEIARRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAICxRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAICAsUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAggU3lzdGVtLkRyYXdpbmcuRHJhd2luZzJELkxpbmVDYXAEAAAAAQEUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAACAsUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAABCAgLFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAIIFN5c3RlbS5EcmF3aW5nLkRyYXdpbmcyRC5MaW5lQ2FwBAAAAAEIARRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAICxRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAEICAsUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAAAggU3lzdGVtLkRyYXdpbmcuRHJhd2luZzJELkxpbmVDYXAEAAAAAQgIARRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAICxRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAFFN5c3RlbS5EcmF3aW5nLkNvbG9yBAAAABRTeXN0ZW0uRHJhd2luZy5Db2xvcgQAAAAUU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAAAgAAAAEEAAAABfv///8hU3lzdGVtLldpbmRvd3MuRm9ybXMuTW91c2VCdXR0b25zAQAAAAd2YWx1ZV9fAAgDAAAAAABAAAABAAAABfr///8UU3lzdGVtLkRyYXdpbmcuQ29sb3IEAAAABG5hbWUFdmFsdWUKa25vd25Db2xvcgVzdGF0ZQEAAAAJBwcEAAAACv////8AAAAAAAACAAYHAAAACEZGRkZGRkZGAfj////6////CoCAgP8AAAAAAAACAAYJAAAACEZGODA4MDgwBfb///8jU3RlZW1hLlRlZUNoYXJ0LkRyYXdpbmcuQmV2ZWxTdHlsZXMBAAAAB3ZhbHVlX18ACAIAAAAAAAAAAfX////6////Cv////8AAAAAAAACAAEIAAAAAfT////6////Cv////8AAAAAAAACAAYNAAAACEZGRkZGRkZGAfL////6////CoCAgP8AAAAAAAACAAYPAAAACEZGODA4MDgwAfD////6////Cv////8AAAAAAAACAAYRAAAACEZGRkZGRkZGAe7////6////CoCAgP8AAAAAAAACAAYTAAAACEZGODA4MDgwAAEJFAAAAAYVAAAABlRhaG9tYQwAAAAAAEBBAer////6////Cv////8AAAAAAAACAAYXAAAACEZGRkZGRkZGAej////6////CoCAgP8AAAAAAAACAAYZAAAACEZGODA4MDgwAeb////6////Cv////8AAAAAAAACAAYbAAAACEZGRkZGRkZGAeT////6////CoCAgP8AAAAAAAACAAYdAAAACEZGODA4MDgwAeL////6////Cv////8AAAAAAAACAAYfAAAACEZGRkZGRkZGAeD////6////CoCAgP8AAAAAAAACAAYhAAAACEZGODA4MDgwAd7////6////Cv////8AAAAAAAACAAYjAAAACEZGRkZGRkZGAdz////6////CoCAgP8AAAAAAAACAAYlAAAACEZGODA4MDgwAwAAAAAGJgAAABpTdGVlbWEuVGVlQ2hhcnQuU3R5bGVzLkJhci0AAAAB2f////r///8KAAAAAAAAAAAlAAEAAAHY////+v///woAAAAAAAAAACUAAQAGKQAAABQgcGFkZG9jay53aGVhdC55aWVsZAYqAAAACEZGRkZGRkZGBisAAAAIRkY4MDgwODAGLAAAAAhGRkZGRkZGRgYtAAAACEZGODA4MDgwAAkmAAAALQAAAAHR////+v///woAAAAAAAAAAI0AAQAAAdD////6////CgAAAAAAAAAAjQABAAYxAAAAFyBwYWRkb2NrLm11bmdiZWFuLnlpZWxkBjIAAAAIRkZGRkZGRkYGMwAAAAhGRjgwODA4MAY0AAAACEZGRkZGRkZGBjUAAAAIRkY4MDgwODAAAcr////6////Cv////8AAAAAAAACAAY3AAAACEZGRkZGRkZGAcj////6////CoCAgP8AAAAAAAACAAY5AAAACEZGODA4MDgwAcb////6////Cv////8AAAAAAAACAAY7AAAACEZGRkZGRkZGAcT////6////CoCAgP8AAAAAAAACAAY9AAAACEZGODA4MDgwAcL////6////Cv////8AAAAAAAACAAY/AAAACEZGRkZGRkZGAcD////6////CoCAgP8AAAAAAAACAAZBAAAACEZGODA4MDgwAb7////6////Cv////8AAAAAAAACAAZDAAAACEZGRkZGRkZGAbz////6////CoCAgP8AAAAAAAACAAZFAAAACEZGODA4MDgwAFAAAAAGRgAAAAgjIyMwLiMjIwkVAAAACQAAAAAAEEEBuP////r///8K/////wAAAAAAAAIABkkAAAAIRkZGRkZGRkYBtv////r///8KgICA/wAAAAAAAAIABksAAAAIRkY4MDgwODABAAAABbT///8gU3lzdGVtLkRyYXdpbmcuRHJhd2luZzJELkxpbmVDYXABAAAAB3ZhbHVlX18ACAQAAAACAAAAAAoAAAAAAbP////6////CgAAAP8AAAAAAAACAAkVAAAACwAAAAAAMEEBsf////r///8KwAAA/wAAAAAAAAIAAbD////6////Cv8AAP8AAAAAAAACAAGv////+v///wr/////AAAAAAAAAgAGUgAAAAhGRkZGRkZGRgGt////+v///wqAgID/AAAAAAAAAgAGVAAAAAhGRjgwODA4MFAAAAAJRgAAAAkVAAAACQAAAAAAEEEBqf////r///8K/////wAAAAAAAAIABlgAAAAIRkZGRkZGRkYBp/////r///8KgICA/wAAAAAAAAIABloAAAAIRkY4MDgwODABAAAAAaX///+0////AgAAAAAAAaT////6////CgAAAP8AAAAAAAACAAkVAAAACwAAAAAAMEEBov////r///8K/wAA/wAAAAAAAAIAAaH////6////Cv////8AAAAAAAACAAZgAAAACEZGRkZGRkZGAZ/////6////CoCAgP8AAAAAAAACAAZiAAAACEZGODA4MDgwAFAAAAAJRgAAAAkVAAAACQAAAAAAEEEBm/////r///8K/////wAAAAAAAAIABmYAAAAIRkZGRkZGRkYBmf////r///8KgICA/wAAAAAAAAIABmgAAAAIRkY4MDgwODABAAAAAZf///+0////AgAAAAAKAAAAAAGW////+v///woAAAD/AAAAAAAAAgAJFQAAAAsAAAAAADBBAZT////6////Cv8AAP8AAAAAAAACAAGT////+v///wr/////AAAAAAAAAgAGbgAAAAhGRkZGRkZGRgGR////+v///wqAgID/AAAAAAAAAgAGcAAAAAhGRjgwODA4MABQAAAABnEAAAAJZC9NTS95eXl5CUYAAAAJFQAAAAkAAAAAABBBAYz////6////Cv////8AAAAAAAACAAZ1AAAACEZGRkZGRkZGAYr////6////CoCAgP8AAAAAAAACAAZ3AAAACEZGODA4MDgwAQAAAAGI////tP///wIAAAAACgAAAAoAAAAAAYf////6////CgAAAP8AAAAAAAACAAkVAAAACwAAAAAAMEEBhf////r///8K/wAA/wAAAAAAAAIAAYT////6////Cv////8AAAAAAAACAAZ9AAAACEZGRkZGRkZGAYL////6////CoCAgP8AAAAAAAACAAZ/AAAACEZGODA4MDgwAYD////6////Cv////8AAAAAAAACAAaBAAAACEZGRkZGRkZGAX7////6////CoCAgP8AAAAAAAACAAaDAAAACEZGODA4MDgwAXz////6////Cv////8AAAAAAAACAAaFAAAACEZGRkZGRkZGAXr////6////CoCAgP8AAAAAAAACAAaHAAAACEZGODA4MDgwAXj////6////Cv////8AAAAAAAACAAaJAAAACEZGRkZGRkZGAXb////6////CoCAgP8AAAAAAAACAAaLAAAACEZGODA4MDgwAXT////6////Cv////8AAAAAAAACAAaNAAAACEZGRkZGRkZGAXL////6////CoCAgP8AAAAAAAACAAaPAAAACEZGODA4MDgwERQAAAADAAAABpAAAAAUTXVuZ2JlYW4tV2hlYXQgRWFybHkGkQAAAAAJkQAAAAs=</Format>
              <Plot>
                <SeriesType>Bar</SeriesType>
                <PointType>Circle</PointType>
                <colour>
                </colour>
                <X>year</X>
                <Y>paddock.wheat.yield</Y>
                <Y>paddock.mungbean.yield</Y>
                <GDApsimFileReader name="ApsimFileReader" />
              </Plot>
            </Graph>
          </outputfile>
        </area>
      </simulation>
    </folder>
    <folder name="Advanced - SOI and Box Plots">
      <simulation name="A">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1940</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1989</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">sorghum</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">sorghum</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1500</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <sorghum />
          <folder name="Manager folder">
            <manager name="Sorghum Sowing rule">
              <ui>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm) : ">10-dec</date1>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm) : ">10-dec</date2>
                <must_sow type="yesno" description="Must sow? : ">yes</must_sow>
                <raincrit type="text" description="Amount of rainfall : ">30</raincrit>
                <rainnumdays type="text" description="Number of days of rainfall : ">3</rainnumdays>
                <esw_amount type="text" description="Enter minimum allowable available soil water (mm) : ">200</esw_amount>
                <category type="category" description="Sowing parameters" />
                <crop type="crop" description="Enter name of crop to sow : ">sorghum</crop>
                <density type="text" description="Enter sowing density  (plants/m2) : ">5</density>
                <depth type="text" description="Enter sowing depth  (mm) : ">30</depth>
                <cultivar type="cultivars" description="Enter cultivar : ">early</cultivar>
                <row_spacing type="text" description="Enter row spacing (mm) : ">1000</row_spacing>
                <skiprow type="list" listvalues="solid, single, double" description="Skip row : ">solid</skiprow>
              </ui>
              <script>
                <text>
      if (paddock_is_fallow() = 1 and FallowIn &lt;&gt; 'yes' and (NextCrop = 0 or NextCrop = '[crop]')) then
         if (date_within('[date1], [date2]') = 1) then
            if (rain[[rainnumdays]] &gt;= [raincrit] AND esw &gt;= [esw_amount]) OR
                ('[must_sow]' = 'yes' AND today = date('[date2]'))) THEN
               ChooseNextCrop = 'yes'   ! for rotations
               [crop] sow plants =[density], sowing_depth = [depth], cultivar = [cultivar], row_spacing = [row_spacing], skip = [skiprow]
            endif
            if today = date('[date2]') then
               ChooseNextCrop = 'yes'
            endif
         endif
      endif
                                </text>
                <event>start_of_day</event>
              </script>
              <script>
                <text>
            nextcrop = 0
            fallowin = 0
                                </text>
                <event>init</event>
              </script>
            </manager>
            <manager name="Yield moisture correction">
              <ui>
                <category type="category" description="Properties" />
                <MoistureContent type="text" description="Moisture content of grain (%) : ">12</MoistureContent>
              </ui>
              <script>
                <text>
          WetYield = yield / (1 - [MoistureContent]/100)
                                </text>
                <event>start_of_day</event>
              </script>
            </manager>
            <manager name="Simple gross margin (put before harvesting rule)">
              <ui>
                <category type="category" description="Cost properties" />
                <NCost type="text" description="Cost of N fertiliser ($/ha) : ">1.2</NCost>
                <NApplicationCost type="text" description="Cost of N application ($/ha) : ">15</NApplicationCost>
                <category type="category" description="Price properties" />
                <Price type="text" description="Price ($/t) : ">140</Price>
                <MinimumProtein type="text" description="Minimum protein for classification ($/t) : ">10.5</MinimumProtein>
                <ProteinIncrement type="text" description="Protein increment payment ($/t) : ">2</ProteinIncrement>
              </ui>
              <script>
                <text>
           ! Reset the bank to zero the day after harvest.
           if (ResetBank = 1) then
              Bank = 0
              ResetBank = 0
           endif

           ! Subtract fertiliser cost from the bank
           if (fertiliser &gt; 0)then
              Bank = Bank - ([NCost] * fertiliser + [NApplicationCost])
           endif

           ! Add harvest return to the bank
           if StageName = 'harvest_ripe' or plant_status = 'dead' then
              FullPrice = [Price] + (grain_protein - [MinimumProtein]) * 2 * [ProteinIncrement]
              Bank = Bank + FullPrice * (WetYield / 1000)
              ResetBank = 1
           endif
                                </text>
                <event>post</event>
              </script>
            </manager>
            <manager name="Harvesting rule">
              <ui>
                <category description="Harvesting criteria" type="category" />
                <crop type="crop" description="Enter name of crop to harvest when ripe : ">sorghum</crop>
              </ui>
              <script name="end_of_day">
                <text>

           if [crop].StageName = 'harvest_ripe' or [crop].plant_status = 'dead' then
              [crop]  harvest
              [crop]  end_crop
           endif

                                </text>
                <event>end_of_day</event>
              </script>
            </manager>
            <manager name="Fertilise at sowing">
              <ui>
                <category type="category" description="When should fertiliser be applied" />
                <modulename type="modulename" description="On which module should the event come from : ">sorghum</modulename>
                <eventname type="text" description="On which event should fertiliser be applied : ">sowing</eventname>
                <category type="category" description="Fertiliser application details" />
                <fertmodule type="modulename" description="Module used to apply the fertiliser : ">fertiliser</fertmodule>
                <fert_amount_sow type="text" description="Amount of starter fertiliser at sowing (kg/ha) : ">100</fert_amount_sow>
                <fert_type_sow type="list" listvalues="NO3_N, NH4_N, NH4NO3, urea_N, urea_no3, urea, nh4so4_n, rock_p, banded_p, broadcast_p" description="Sowing fertiliser type : "> urea_no3</fert_type_sow>
              </ui>
              <script>
                <text>
        [fertmodule] apply amount = [fert_amount_sow] (kg/ha), depth = 50 (mm), type = [fert_type_sow]
                                </text>
                <event>[modulename].[eventname]</event>
              </script>
            </manager>
          </folder>
          <outputfile>
            <filename output="yes">A.out</filename>
            <title>A</title>
            <variables name="Variables">
              <variable>year</variable>
              <variable>Bank</variable>
              <variable>yield</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>harvesting</event>
            </events>
          </outputfile>
          <Soil name="Heavy Clay">
            <SoilType description="Soil description">Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown description="Nearest town">Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude description="Latitude (WGS84)">-27.564333</Latitude>
            <Longitude description="Longitude (WGS84)">151.953991</Longitude>
            <LocationAccuracy description="Location accuracy">Regional Soil Type</LocationAccuracy>
            <DataSource type="multiedit" description="Data source">YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments type="multiedit" description="Comments">Generic soil developed by Allan Peake.</Comments>
            <Water>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <RelativeTo>ll15</RelativeTo>
              <FractionFull>0.33</FractionFull>
              <PercentMethod>FilledFromTop</PercentMethod>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Date type="date" description="Sample date:" />
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <NO3>
                <double>0.282</double>
                <double>0.28188</double>
                <double>1.19952</double>
                <double>1.2213</double>
                <double>1.31688</double>
                <double>1.42659</double>
                <double>1.51875</double>
              </NO3>
              <NO3Units>kgha</NO3Units>
              <NH4>
                <double>0.24885</double>
                <double>0.28188</double>
                <double>1.19952</double>
                <double>1.2213</double>
                <double>1.31688</double>
                <double>1.42659</double>
                <double>1.51875</double>
              </NH4>
              <NH4Units>kgha</NH4Units>
              <SW>
                <double>0</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
              </SW>
            </Sample>
          </Soil>
        </area>
      </simulation>
      <simulation name="B">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1940</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1989</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">sorghum</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">sorghum</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1500</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <sorghum />
          <folder name="Manager folder">
            <manager name="Sorghum Sowing rule">
              <ui>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm) : ">10-dec</date1>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm) : ">10-dec</date2>
                <must_sow type="yesno" description="Must sow? : ">yes</must_sow>
                <raincrit type="text" description="Amount of rainfall : ">30</raincrit>
                <rainnumdays type="text" description="Number of days of rainfall : ">3</rainnumdays>
                <esw_amount type="text" description="Enter minimum allowable available soil water (mm) : ">200</esw_amount>
                <category type="category" description="Sowing parameters" />
                <crop type="crop" description="Enter name of crop to sow : ">sorghum</crop>
                <density type="text" description="Enter sowing density  (plants/m2) : ">5</density>
                <depth type="text" description="Enter sowing depth  (mm) : ">30</depth>
                <cultivar type="cultivars" description="Enter cultivar : ">early</cultivar>
                <row_spacing type="text" description="Enter row spacing (mm) : ">1000</row_spacing>
                <skiprow type="list" listvalues="solid, single, double" description="Skip row : "> double</skiprow>
              </ui>
              <script>
                <text>
      if (paddock_is_fallow() = 1 and FallowIn &lt;&gt; 'yes' and (NextCrop = 0 or NextCrop = '[crop]')) then
         if (date_within('[date1], [date2]') = 1) then
            if (rain[[rainnumdays]] &gt;= [raincrit] AND esw &gt;= [esw_amount]) OR
                ('[must_sow]' = 'yes' AND today = date('[date2]'))) THEN
               ChooseNextCrop = 'yes'   ! for rotations
               [crop] sow plants =[density], sowing_depth = [depth], cultivar = [cultivar], row_spacing = [row_spacing], skip = [skiprow]
            endif
            if today = date('[date2]') then
               ChooseNextCrop = 'yes'
            endif
         endif
      endif
                                </text>
                <event>start_of_day</event>
              </script>
              <script>
                <text>
            nextcrop = 0
            fallowin = 0
                                </text>
                <event>init</event>
              </script>
            </manager>
            <manager name="Yield moisture correction">
              <ui>
                <category type="category" description="Properties" />
                <MoistureContent type="text" description="Moisture content of grain (%) : ">12</MoistureContent>
              </ui>
              <script>
                <text>
          WetYield = yield / (1 - [MoistureContent]/100)
                                </text>
                <event>start_of_day</event>
              </script>
            </manager>
            <manager name="Simple gross margin (put before harvesting rule)">
              <ui>
                <category type="category" description="Cost properties" />
                <NCost type="text" description="Cost of N fertiliser ($/ha) : ">1.2</NCost>
                <NApplicationCost type="text" description="Cost of N application ($/ha) : ">15</NApplicationCost>
                <category type="category" description="Price properties" />
                <Price type="text" description="Price ($/t) : ">140</Price>
                <MinimumProtein type="text" description="Minimum protein for classification ($/t) : ">10.5</MinimumProtein>
                <ProteinIncrement type="text" description="Protein increment payment ($/t) : ">2</ProteinIncrement>
              </ui>
              <script>
                <text>
           ! Reset the bank to zero the day after harvest.
           if (ResetBank = 1) then
              Bank = 0
              ResetBank = 0
           endif

           ! Subtract fertiliser cost from the bank
           if (fertiliser &gt; 0)then
              Bank = Bank - ([NCost] * fertiliser + [NApplicationCost])
           endif

           ! Add harvest return to the bank
           if StageName = 'harvest_ripe' or plant_status = 'dead' then
              FullPrice = [Price] + (grain_protein - [MinimumProtein]) * 2 * [ProteinIncrement]
              Bank = Bank + FullPrice * (WetYield / 1000)
              ResetBank = 1
           endif
                                </text>
                <event>post</event>
              </script>
            </manager>
            <manager name="Harvesting rule">
              <ui>
                <category description="Harvesting criteria" type="category" />
                <crop type="crop" description="Enter name of crop to harvest when ripe : ">sorghum</crop>
              </ui>
              <script name="end_of_day">
                <text>

           if [crop].StageName = 'harvest_ripe' or [crop].plant_status = 'dead' then
              [crop]  harvest
              [crop]  end_crop
           endif

                                </text>
                <event>end_of_day</event>
              </script>
            </manager>
            <manager name="Fertilise at sowing">
              <ui>
                <category type="category" description="When should fertiliser be applied" />
                <modulename type="modulename" description="On which module should the event come from : ">sorghum</modulename>
                <eventname type="text" description="On which event should fertiliser be applied : ">sowing</eventname>
                <category type="category" description="Fertiliser application details" />
                <fertmodule type="modulename" description="Module used to apply the fertiliser : ">fertiliser</fertmodule>
                <fert_amount_sow type="text" description="Amount of starter fertiliser at sowing (kg/ha) : ">100</fert_amount_sow>
                <fert_type_sow type="list" listvalues="NO3_N, NH4_N, NH4NO3, urea_N, urea_no3, urea, nh4so4_n, rock_p, banded_p, broadcast_p" description="Sowing fertiliser type : "> urea_no3</fert_type_sow>
              </ui>
              <script>
                <text>
        [fertmodule] apply amount = [fert_amount_sow] (kg/ha), depth = 50 (mm), type = [fert_type_sow]
                                </text>
                <event>[modulename].[eventname]</event>
              </script>
            </manager>
          </folder>
          <outputfile>
            <filename output="yes">B.out</filename>
            <title>B</title>
            <variables name="Variables">
              <variable>year</variable>
              <variable>Bank</variable>
              <variable>yield</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>harvesting</event>
            </events>
          </outputfile>
          <Soil name="Heavy Clay">
            <SoilType description="Soil description">Generic Vertosol</SoilType>
            <Site>Generic</Site>
            <NearestTown description="Nearest town">Toowoomba</NearestTown>
            <Region>Darling Downs and Granite Belt</Region>
            <State>Queensland</State>
            <Country>Australia</Country>
            <Latitude description="Latitude (WGS84)">-27.564333</Latitude>
            <Longitude description="Longitude (WGS84)">151.953991</Longitude>
            <LocationAccuracy description="Location accuracy">Regional Soil Type</LocationAccuracy>
            <DataSource type="multiedit" description="Data source">YP. A Peake-CSIRO Sustainable Ecosystems, Toowoomba</DataSource>
            <Comments type="multiedit" description="Comments">Generic soil developed by Allan Peake.</Comments>
            <Water>
              <SoilCrop name="wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.06</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.27</double>
                  <double>0.28</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                </LL>
                <KL>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0.04</double>
                  <double>0.03</double>
                  <double>0.02</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.05</double>
                <double>1.08</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.21</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.135</double>
                <double>0.196</double>
                <double>0.232</double>
                <double>0.27</double>
                <double>0.279</double>
                <double>0.288</double>
                <double>0.297</double>
              </AirDry>
              <LL15>
                <double>0.27</double>
                <double>0.28</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
              </LL15>
              <DUL>
                <double>0.51</double>
                <double>0.5</double>
                <double>0.49</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.45</double>
              </DUL>
              <SAT>
                <double>0.574</double>
                <double>0.562</double>
                <double>0.547</double>
                <double>0.536</double>
                <double>0.525</double>
                <double>0.513</double>
                <double>0.498</double>
              </SAT>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>2.5</WinterCona>
              <WinterU>4</WinterU>
              <WinterDate>1-apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>1000</RootWt>
              <SoilCN>12</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1</double>
                <double>0.5</double>
                <double>0.25</double>
                <double>0.2</double>
                <double>0.1</double>
                <double>0.1</double>
                <double>0.1</double>
              </OC>
              <FBiom>
                <double>0.02</double>
                <double>0.02</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>1</double>
                <double>1</double>
                <double>1</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.1</double>
                <double>0.2</double>
                <double>0.2</double>
                <double>0.3</double>
                <double>0.4</double>
                <double>0.5</double>
                <double>0.6</double>
              </EC>
              <PH>
                <double>8.5</double>
                <double>8.7</double>
                <double>8.5</double>
                <double>8</double>
                <double>7</double>
                <double>6</double>
                <double>5</double>
              </PH>
              <CL>
                <double>20</double>
                <double>40</double>
                <double>70</double>
                <double>110</double>
                <double>160</double>
                <double>220</double>
                <double>300</double>
              </CL>
              <ESP>
                <double>1</double>
                <double>2</double>
                <double>3</double>
                <double>5</double>
                <double>8</double>
                <double>12</double>
                <double>15</double>
              </ESP>
            </Analysis>
            <InitialWater>
              <RelativeTo>ll15</RelativeTo>
              <FractionFull>0.33</FractionFull>
              <PercentMethod>FilledFromTop</PercentMethod>
            </InitialWater>
            <Sample name="Initial nitrogen">
              <Date type="date" description="Sample date:" />
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <NO3>
                <double>0.282</double>
                <double>0.28188</double>
                <double>1.19952</double>
                <double>1.2213</double>
                <double>1.31688</double>
                <double>1.42659</double>
                <double>1.51875</double>
              </NO3>
              <NO3Units>kgha</NO3Units>
              <NH4>
                <double>0.24885</double>
                <double>0.28188</double>
                <double>1.19952</double>
                <double>1.2213</double>
                <double>1.31688</double>
                <double>1.42659</double>
                <double>1.51875</double>
              </NH4>
              <NH4Units>kgha</NH4Units>
              <SW>
                <double>0</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
              </SW>
            </Sample>
          </Soil>
        </area>
      </simulation>
      <Graph name="SOI Box Plot">
        <Legend>
          <CheckedTitles> A,   Negative</CheckedTitles>
          <CheckedTitles> A,   Falling</CheckedTitles>
          <CheckedTitles> A,   Positive</CheckedTitles>
          <CheckedTitles> A,   Zero</CheckedTitles>
          <CheckedTitles> A,   Rising</CheckedTitles>
          <CheckedTitles> B,   Negative</CheckedTitles>
          <CheckedTitles> B,   Falling</CheckedTitles>
          <CheckedTitles> B,   Positive</CheckedTitles>
          <CheckedTitles> B,   Zero</CheckedTitles>
          <CheckedTitles> B,   Rising</CheckedTitles>
          <CheckedTitles> A,   AllYears</CheckedTitles>
          <CheckedTitles> B,   AllYears</CheckedTitles>
        </Legend>
        <Plot>
          <SeriesType>Box</SeriesType>
          <PointType>None</PointType>
          <X>Title</X>
          <colour>
          </colour>
          <Y>yield</Y>
          <GDProbability name="Probability Exceedence">
            <Exceedence>Yes</Exceedence>
            <GDSOI name="SOI">
              <Month>11</Month>
              <GDApsimFileReader name="ApsimFileReader" />
            </GDSOI>
          </GDProbability>
        </Plot>
      </Graph>
    </folder>
    <folder name="Advanced - Irrigation">
      <simulation name="Continuous Wheat">
        <metfile name="met">
          <filename name="filename" input="yes">%apsim%/Examples/MetFiles/Goond.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">01/01/1950</start_date>
          <end_date type="date" description="Enter the end date of the simulation">31/12/1950</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <Soil>
            <SoilType description="Soil description">Black Vertosol</SoilType>
            <LocalName>Waco</LocalName>
            <Site>Jimbour</Site>
            <NearestTown description="Nearest town">Jimbour, Q 4352</NearestTown>
            <Region>South East Queensland</Region>
            <NaturalVegetation description="Natural vegetation">Grassland, mainly Qld bluegrass</NaturalVegetation>
            <InitialWater name="Initial water">
              <FractionFull>0.5</FractionFull>
              <DepthWetSoil>NaN</DepthWetSoil>
              <PercentMethod>EvenlyDistributed</PercentMethod>
              <RelativeTo>ll15</RelativeTo>
            </InitialWater>
            <Water>
              <SoilCrop name="Barley">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.32</double>
                  <double>0.38</double>
                  <double>0.39</double>
                  <double>0.39</double>
                  <double>0.41</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.01</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Chickpea">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.36</double>
                  <double>0.43</double>
                  <double>0.51</double>
                  <double>0.5</double>
                  <double>0.5</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.01</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Lucerne">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.3</double>
                  <double>0.31</double>
                  <double>0.32</double>
                  <double>0.33</double>
                  <double>0.34</double>
                  <double>0.35</double>
                  <double>0.36</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                  <double>0.09</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Maize">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.34</double>
                  <double>0.34</double>
                  <double>0.37</double>
                  <double>0.4</double>
                  <double>0.42</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Perennial Grass">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.39</double>
                  <double>0.41</double>
                  <double>0.4</double>
                  <double>0.4</double>
                  <double>0.41</double>
                  <double>0.41</double>
                  <double>0.4</double>
                  <double>0.4</double>
                  <double>0.42</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.09</double>
                  <double>0.07</double>
                  <double>0.05</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Sorghum">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.35</double>
                  <double>0.38</double>
                  <double>0.4</double>
                  <double>0.4</double>
                  <double>0.4</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <SoilCrop name="Wheat">
                <Thickness>
                  <double>150</double>
                  <double>150</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                  <double>300</double>
                </Thickness>
                <LL>
                  <double>0.29</double>
                  <double>0.29</double>
                  <double>0.32</double>
                  <double>0.32</double>
                  <double>0.35</double>
                  <double>0.38</double>
                  <double>0.41</double>
                  <double>0.48</double>
                  <double>0.47</double>
                  <double>0.46</double>
                  <double>0.44</double>
                </LL>
                <KL>
                  <double>0.1</double>
                  <double>0.1</double>
                  <double>0.08</double>
                  <double>0.06</double>
                  <double>0.04</double>
                  <double>0.02</double>
                  <double>0.01</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </KL>
                <XF>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>1</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                  <double>0</double>
                </XF>
              </SoilCrop>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <BD>
                <double>1.02</double>
                <double>1.03</double>
                <double>1.02</double>
                <double>1.02</double>
                <double>1.06</double>
                <double>1.11</double>
                <double>1.12</double>
                <double>1.15</double>
                <double>1.18</double>
                <double>1.2</double>
                <double>1.25</double>
              </BD>
              <AirDry>
                <double>0.15</double>
                <double>0.26</double>
                <double>0.29</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
                <double>0.34</double>
                <double>0.35</double>
                <double>0.36</double>
              </AirDry>
              <LL15>
                <double>0.29</double>
                <double>0.29</double>
                <double>0.29</double>
                <double>0.29</double>
                <double>0.3</double>
                <double>0.31</double>
                <double>0.32</double>
                <double>0.33</double>
                <double>0.34</double>
                <double>0.35</double>
                <double>0.36</double>
              </LL15>
              <DUL>
                <double>0.54</double>
                <double>0.53</double>
                <double>0.54</double>
                <double>0.54</double>
                <double>0.52</double>
                <double>0.5</double>
                <double>0.5</double>
                <double>0.48</double>
                <double>0.47</double>
                <double>0.46</double>
                <double>0.44</double>
              </DUL>
              <SAT>
                <double>0.59</double>
                <double>0.58</double>
                <double>0.59</double>
                <double>0.58</double>
                <double>0.57</double>
                <double>0.55</double>
                <double>0.55</double>
                <double>0.53</double>
                <double>0.52</double>
                <double>0.51</double>
                <double>0.49</double>
              </SAT>
            </Water>
            <SoilWater>
              <SummerCona>3.5</SummerCona>
              <SummerU>6</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>3.5</WinterCona>
              <WinterU>6</WinterU>
              <WinterDate>1-Apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.13</Salb>
              <CN2Bare>73</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <SWCON>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
                <double>0.3</double>
              </SWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>200</RootWt>
              <SoilCN>12.5</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1.04</double>
                <double>0.89</double>
                <double>0.89</double>
                <double>0.89</double>
                <double>0.77</double>
                <double>0.45</double>
                <double>0.27</double>
                <double>0.22</double>
                <double>0.16</double>
                <double>0.13</double>
                <double>0.12</double>
              </OC>
              <FBiom>
                <double>0.025</double>
                <double>0.02</double>
                <double>0.015</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <EC>
                <double>0.2</double>
                <double>0.25</double>
                <double>0.31</double>
                <double>0.4</double>
                <double>0.59</double>
                <double>0.84</double>
                <double>0.93</double>
                <double>1.01</double>
                <double>1.06</double>
                <double>1.05</double>
                <double>1.01</double>
              </EC>
              <PH>
                <double>8.4</double>
                <double>8.8</double>
                <double>9</double>
                <double>9.2</double>
                <double>9.2</double>
                <double>9.1</double>
                <double>9</double>
                <double>9</double>
                <double>8.9</double>
                <double>8.9</double>
                <double>8.9</double>
              </PH>
            </Analysis>
            <Sample name="Initial nitrogen">
              <Date type="date" description="Sample date:" />
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <NO3>
                <double>6.50300344798777</double>
                <double>2.10100111398159</double>
                <double>2.10100111398159</double>
                <double>1.70100090189562</double>
                <double>1.70100090189562</double>
                <double>1.70100090189562</double>
                <double>1.70100090189562</double>
                <double>1.70100090189562</double>
                <double>1.70100090189562</double>
                <double>1.70100090189562</double>
                <double>1.70100090189562</double>
              </NO3>
              <NH4>
                <double>0.599004378686979</double>
                <double>0.100000730999496</double>
                <double>0.100000730999496</double>
                <double>0.100000730999496</double>
                <double>0.100000730999496</double>
                <double>0.100000730999496</double>
                <double>0.100000730999496</double>
                <double>0.100000730999496</double>
                <double>0.100000730999496</double>
                <double>0.100000730999496</double>
                <double>0.100000730999496</double>
              </NH4>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <fertiliser />
          <wheat />
          <folder name="Manager folder">
            <manager name="Sowing rule">
              <ui>
                <category type="category" description="Sowing criteria" />
                <date1 type="ddmmmdate" description="Enter sowing window START date (dd-mmm) : ">15-may</date1>
                <date2 type="ddmmmdate" description="Enter sowing window END date (dd-mmm) : ">10-jul</date2>
                <must_sow type="yesno" description="Must sow? : ">no</must_sow>
                <raincrit type="text" description="Amount of rainfall : ">25</raincrit>
                <rainnumdays type="text" description="Number of days of rainfall : ">7</rainnumdays>
                <esw_amount type="text" description="Enter minimum allowable available soil water (mm) : ">100</esw_amount>
                <category type="category" description="Sowing parameters" />
                <crop type="crop" description="Enter name of crop to sow : ">wheat</crop>
                <density type="text" description="Enter sowing density  (plants/m2) : ">100</density>
                <depth type="text" description="Enter sowing depth  (mm) : ">30</depth>
                <cultivar type="cultivars" description="Enter cultivar : ">hartog</cultivar>
                <class type="classes" description="Enter crop growth class : ">plant</class>
                <row_spacing type="text" description="Enter row spacing (mm) : ">250</row_spacing>
              </ui>
              <script name="start_of_day">
                <text><![CDATA[
      if (paddock_is_fallow() = 1 and FallowIn <> 'yes' and (NextCrop = 0 or NextCrop = '[crop]')) then
         if (date_within('[date1], [date2]') = 1) then
            if (rain[[rainnumdays]] >= [raincrit] AND esw >= [esw_amount]) OR
                ('[must_sow]' = 'yes' AND today = date('[date2]'))) THEN
               ChooseNextCrop = 'yes'   ! for rotations
               [crop] sow plants =[density], sowing_depth = [depth], cultivar = [cultivar], row_spacing = [row_spacing], crop_class = [class]
            endif
            if today = date('[date2]') then
               ChooseNextCrop = 'yes'
            endif
         endif
      endif
            ]]></text>
                <event>start_of_day</event>
              </script>
              <script name="init">
                <text>
            nextcrop = 0
            fallowin = 0
                                </text>
                <event>init</event>
              </script>
            </manager>
            <manager name="Sowing fertiliser">
              <ui>
                <category description="When should fertiliser be applied" type="category" />
                <modulename type="modulename" description="On which module should the event come from : ">wheat</modulename>
                <eventname type="text" description="On which event should fertiliser be applied : ">sowing</eventname>
                <category description="Fertiliser application details" type="category" />
                <fertmodule type="modulename" description="Module used to apply the fertiliser : ">fertiliser</fertmodule>
                <fert_amount_sow type="text" description="Amount of starter fertiliser at sowing (kg/ha) : ">150</fert_amount_sow>
                <fert_type_sow type="list" listvalues="NO3_N, NH4_N, NH4NO3, urea_N, urea_no3, urea, nh4so4_n, rock_p, banded_p, broadcast_p" description="Sowing fertiliser type : ">urea_N</fert_type_sow>
              </ui>
              <script name="[modulename].[eventname]">
                <text>
        [fertmodule] apply amount = [fert_amount_sow] (kg/ha), depth = 50 (mm), type = [fert_type_sow]
                                </text>
                <event>[modulename].[eventname]</event>
              </script>
            </manager>
            <manager name="Harvesting rule">
              <ui>
                <category type="category" description="Harvesting criteria" />
                <crop type="crop" description="Enter name of crop to harvest when ripe : ">wheat</crop>
              </ui>
              <script>
                <text>

           if [crop].StageName = 'harvest_ripe' or [crop].plant_status = 'dead' then
              [crop]  harvest
              [crop]  end_crop
           endif

                                </text>
                <event>end_of_day</event>
              </script>
            </manager>
            <manager2 name="Irrigate on date">
              <ui>
                <category type="category" description="Irrigation will be applied on the date(s) below" />
                <sameDays type="yesno" description="Apply Irrigation on the same day(s) each year? (yes/no) - if &quot;no&quot; then must include the year of application below">yes</sameDays>
                <irrigDatesStr type="text" description="Dates for one or more Irrigation applications (dd-mmm or dd-mmm-yyyy) as a list with a space between dates">01-mar 01-aug 01-nov</irrigDatesStr>
                <category type="category" description="Irrigation parameters" />
                <amount type="text" description="Amount of irrigation to apply (mm)">100</amount>
                <eff type="text" description="Irrigation efficiency (0-1)">1.0</eff>
              </ui>
              <text>using System;
using ModelFramework;
using CSGeneral;

public class Script 
{      
   [Link] Irrigation Irrigation; 
   [Input] DateTime today;
   [Param] string[] irrigDatesStr;  //a string array holding the dates as text
   [Param] string sameDays;         //if yes, we ignore the year component
   [Param] float amount;           //amount of irrigation to apply (mm)
   [Param] float eff;              //irrigation efficiency

   private DateTime[] irrigDates;   //an array to hold the converted dates
   private bool irrigToday = false; //a variable to hold whether or not we irrigate today

   [EventHandler] public void OnInitialised()
   {
      //convert the date strings to APSIM dates
      irrigDates = new DateTime[irrigDatesStr.Length];
      for (int i = 0; i &lt; irrigDates.Length ; i++)
         irrigDates[i] = DateUtility.GetDate(irrigDatesStr[i]);
   }

   // The following event handler will be called each day at the start of the day
   [EventHandler] public void OnPrepare()
   {
      irrigToday = false;

      //for every date in our date array
      foreach (DateTime day in irrigDates)
      {
         if (sameDays.ToLower().Equals("yes")&amp;&amp; day.Day.Equals(today.Day) &amp;&amp; day.Month.Equals(today.Month))
            irrigToday = true; 
         else if (day.Day.Equals(today.Day) &amp;&amp; day.Month.Equals(today.Month) &amp;&amp; day.Year.Equals(today.Year))
            irrigToday = true;   
      }

         if (irrigToday)
         {
            IrrigationApplicationType data = new IrrigationApplicationType();
            data.Amount = amount;
            Irrigation.Set("irrigation_efficiency", eff);
            Irrigation.Apply(data);
         }
   }  
}
                            </text>
            </manager2>
          </folder>
          <outputfile>
            <filename output="yes">Continuous Wheat.out</filename>
            <title>Continuous Wheat</title>
            <variables name="Variables">
              <variable array="?" description="Date (dd/mm/yyyy)">dd/mm/yyyy as Date</variable>
              <variable array="?" description="Biomass">biomass</variable>
              <variable array="?" description="Yield">yield</variable>
              <variable array="?" description="grain protein content">grain_protein</variable>
              <variable array="?" description="Size of each grain">grain_size</variable>
              <variable array="?" description="Extractable Soil Water (mm)">esw</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>end_day</event>
            </events>
          </outputfile>
          <irrigation name="Irrigation">
            <automatic_irrigation type="list" listvalues="on,off" description="Automatic irrigation">off</automatic_irrigation>
            <asw_depth type="text" description="Depth to which ASW is calculated. (mm)">600</asw_depth>
            <crit_fr_asw type="text" description="Fraction of ASW below which irrigation is applied (0-1.0)">0.5</crit_fr_asw>
            <irrigation_efficiency type="text" description="Efficiency of the irrigation. (0-1.0)">1</irrigation_efficiency>
            <irrigation_allocation type="list" listvalues="on,off" description="Allocation limits">off</irrigation_allocation>
            <allocation type="text" description="Allocation in mm">0</allocation>
            <default_no3_conc type="text" description="Nitrate concentration (ppm N)">0.0</default_no3_conc>
            <default_nh4_conc type="text" description="Ammonium concentration (ppm N)">0.0</default_nh4_conc>
            <default_cl_conc type="text" description="Chloride concentration (ppm Cl)">0.0</default_cl_conc>
          </irrigation>
        </area>
        <Graph name="XY">
          <Legend>
            <CheckedTitles> Continuous Wheat</CheckedTitles>
            <CheckedTitles> {Checkpoint} Continuous Wheat</CheckedTitles>
          </Legend>
          <Plot>
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>Date</X>
            <Y>esw</Y>
            <GDApsimFileReader name="ApsimFileReader" />
          </Plot>
        </Graph>
      </simulation>
    </folder>
    <folder name="Advanced - Scenario">
      <simulation name="April">
        <metfile name="met">
          <filename name="filename" input="yes">Weather.met</filename>
        </metfile>
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">02/04/2010</start_date>
          <end_date type="date" description="Enter the end date of the simulation">03/05/2010</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <Soil>
            <RecordNumber>0</RecordNumber>
            <SoilType>Black Vertosol</SoilType>
            <LocalName>Waco</LocalName>
            <Site>Jimbour</Site>
            <NearestTown>Jimbour, Q 4352</NearestTown>
            <Region>South East Queensland</Region>
            <NaturalVegetation>Grassland, mainly Qld bluegrass</NaturalVegetation>
            <Latitude>0</Latitude>
            <Longitude>0</Longitude>
            <Water>
              <Thickness>
                <double>100</double>
                <double>200</double>
                <double>300</double>
                <double>200</double>
              </Thickness>
              <BD>
                <double>0.851</double>
                <double>0.985</double>
                <double>1.078</double>
                <double>1.112</double>
              </BD>
              <AirDry>
                <double>0.07</double>
                <double>0.076</double>
                <double>0.058</double>
                <double>0.083</double>
              </AirDry>
              <LL15>
                <double>0.334</double>
                <double>0.324</double>
                <double>0.362</double>
                <double>0.368</double>
              </LL15>
              <DUL>
                <double>0.529</double>
                <double>0.527</double>
                <double>0.512</double>
                <double>0.47</double>
              </DUL>
              <SAT>
                <double>0.639</double>
                <double>0.588</double>
                <double>0.553</double>
                <double>0.54</double>
              </SAT>
            </Water>
            <SoilWater>
              <SummerCona>5.3</SummerCona>
              <SummerU>2</SummerU>
              <SummerDate>1-Nov</SummerDate>
              <WinterCona>3.71</WinterCona>
              <WinterU>2</WinterU>
              <WinterDate>1-Apr</WinterDate>
              <DiffusConst>40</DiffusConst>
              <DiffusSlope>16</DiffusSlope>
              <Salb>0.12</Salb>
              <CN2Bare>50</CN2Bare>
              <CNRed>20</CNRed>
              <CNCov>0.8</CNCov>
              <Slope>NaN</Slope>
              <DischargeWidth>NaN</DischargeWidth>
              <CatchmentArea>NaN</CatchmentArea>
              <MaxPond>NaN</MaxPond>
              <Thickness>
                <double>100</double>
                <double>200</double>
                <double>300</double>
                <double>200</double>
              </Thickness>
              <SWCON>
                <double>0.4</double>
                <double>0.4</double>
                <double>0.4</double>
                <double>0</double>
              </SWCON>
              <MWCON>
                <double>NaN</double>
                <double>NaN</double>
                <double>NaN</double>
                <double>0</double>
              </MWCON>
            </SoilWater>
            <SoilOrganicMatter>
              <RootCN>40</RootCN>
              <RootWt>200</RootWt>
              <SoilCN>12.5</SoilCN>
              <EnrACoeff>7.4</EnrACoeff>
              <EnrBCoeff>0.2</EnrBCoeff>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <OC>
                <double>1.04</double>
                <double>0.89</double>
                <double>0.89</double>
                <double>0.89</double>
                <double>0.77</double>
                <double>0.45</double>
                <double>0.27</double>
                <double>0.22</double>
                <double>0.16</double>
                <double>0.13</double>
                <double>0.12</double>
              </OC>
              <FBiom>
                <double>0.025</double>
                <double>0.02</double>
                <double>0.015</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
                <double>0.01</double>
              </FBiom>
              <FInert>
                <double>0.4</double>
                <double>0.6</double>
                <double>0.8</double>
                <double>0.9</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
                <double>0.95</double>
              </FInert>
            </SoilOrganicMatter>
            <Analysis>
              <Thickness>
                <double>150</double>
                <double>150</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
                <double>300</double>
              </Thickness>
              <Texture>
                <string />
                <string />
                <string />
                <string />
                <string />
                <string />
                <string />
                <string />
                <string />
                <string />
                <string />
              </Texture>
              <MunsellColour>
                <string />
                <string />
                <string />
                <string />
                <string />
                <string />
                <string />
                <string />
                <string />
                <string />
                <string />
              </MunsellColour>
              <EC>
                <double>0.2</double>
                <double>0.25</double>
                <double>0.31</double>
                <double>0.4</double>
                <double>0.59</double>
                <double>0.84</double>
                <double>0.93</double>
                <double>1.01</double>
                <double>1.06</double>
                <double>1.05</double>
                <double>1.01</double>
              </EC>
              <PH>
                <double>8.4</double>
                <double>8.8</double>
                <double>9</double>
                <double>9.2</double>
                <double>9.2</double>
                <double>9.1</double>
                <double>9</double>
                <double>9</double>
                <double>8.9</double>
                <double>8.9</double>
                <double>8.9</double>
              </PH>
              <PHUnits>Water</PHUnits>
              <BoronUnits>HotWater</BoronUnits>
            </Analysis>
            <Sample name="Initial nitrogen">
              <Thickness>
                <double>100</double>
                <double>200</double>
                <double>300</double>
                <double>200</double>
              </Thickness>
              <NO3>
                <double>0</double>
                <double>0</double>
                <double>0</double>
                <double>0</double>
              </NO3>
              <NH4>
                <double>0</double>
                <double>0</double>
                <double>0</double>
                <double>0</double>
              </NH4>
              <SW>
                <double>0.569</double>
                <double>0.523</double>
                <double>0.492</double>
                <double>0.481</double>
              </SW>
              <NO3Units>ppm</NO3Units>
              <NH4Units>ppm</NH4Units>
              <SWUnits>Volumetric</SWUnits>
              <OCUnits>Total</OCUnits>
              <PHUnits>Water</PHUnits>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter">
            <PoolName type="text" description="Organic Matter pool name">wheat</PoolName>
            <type type="list" listvalues="bambatsi,barley,base_type,broccoli,camaldulensis,canola,centro,chickpea,chikenmanure_base,cm,cmA,cmB,constants,cotton,cowpea,danthonia,fababean,fieldpea,fym,gbean,globulus,goatmanure,grandis,grass,horsegram,inert,lablab,lentil,lucerne,lupin,maize,manB,manure,medic,millet,mucuna,nativepasture,navybean,oats,orobanche,peanut,pigeonpea,potato,rice,sorghum,soybean,stylo,sugar,sunflower,sweetcorn,sweetsorghum,tillage,tithonia,vetch,weed,wheat" description="Organic Matter type">wheat</type>
            <mass type="text" description="Initial surface residue (kg/ha)">1000</mass>
            <cnr type="text" description="C:N ratio of initial residue">80</cnr>
            <standing_fraction type="text" description="Fraction of residue standing">0</standing_fraction>
          </surfaceom>
          <outputfile>
            <filename output="yes">April.out</filename>
            <title>April</title>
            <variables name="Variables">
              <variable>dd/mm/yyyy as Date</variable>
              <variable>sw_dep()</variable>
            </variables>
            <events name="Reporting Frequency">
              <event>end_day</event>
            </events>
          </outputfile>
        </area>
        <Graph name="April">
          <Legend>
            <CheckedTitles>predicted, September</CheckedTitles>
            <CheckedTitles>observed, observed</CheckedTitles>
          </Legend>
          <Plot name="predicted">
            <SeriesType>Solid line</SeriesType>
            <PointType>None</PointType>
            <colour>
            </colour>
            <X>Date</X>
            <Y>sw_dep()</Y>
            <GDApsimFileReader name="ApsimFileReader" />
          </Plot>
          <Plot name="observed">
            <SeriesType>No line</SeriesType>
            <PointType>Circle</PointType>
            <colour>
            </colour>
            <X>Date</X>
            <Y>sw_dep()</Y>
            <GDFilter name="Filter">
              <Filter>Date &gt;= #4/2/2010# AND Date &lt;= #5/3/2010#</Filter>
              <GDApsimFileReader name="ApsimFileReader">
                <FileName>observed.prn</FileName>
              </GDApsimFileReader>
            </GDFilter>
          </Plot>
        </Graph>
      </simulation>
      <simulation name="May">
        <metfile name="met" />
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">05/05/2010</start_date>
          <end_date type="date" description="Enter the end date of the simulation">01/07/2010</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <Soil>
            <Water />
            <SoilWater />
            <SoilOrganicMatter />
            <Analysis />
            <Sample name="Initial nitrogen">
              <Thickness>
                <double>100</double>
                <double>200</double>
                <double>300</double>
                <double>200</double>
                <double>999999</double>
              </Thickness>
              <NO3>
                <double>0</double>
                <double>0</double>
                <double>0</double>
                <double>0</double>
                <double>NaN</double>
              </NO3>
              <NH4>
                <double>0</double>
                <double>0</double>
                <double>0</double>
                <double>0</double>
                <double>NaN</double>
              </NH4>
              <SW>
                <double>0.51</double>
                <double>0.509</double>
                <double>0.494</double>
                <double>0.454</double>
                <double>NaN</double>
              </SW>
              <NO3Units>ppm</NO3Units>
              <NH4Units>ppm</NH4Units>
              <SWUnits>Volumetric</SWUnits>
              <OCUnits>Total</OCUnits>
              <PHUnits>Water</PHUnits>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter" />
          <outputfile>
            <filename output="yes">May.out</filename>
            <title>May</title>
            <variables name="Variables" />
            <events name="Reporting Frequency" />
          </outputfile>
        </area>
        <Graph name="May">
          <Plot name="predicted">
            <GDApsimFileReader name="ApsimFileReader" />
          </Plot>
          <Plot name="observed">
            <GDFilter name="Filter">
              <Filter>Date &gt;= #5/5/2010# AND Date &lt;= #7/1/2010#</Filter>
              <GDApsimFileReader name="ApsimFileReader" />
            </GDFilter>
          </Plot>
        </Graph>
      </simulation>
      <simulation name="September">
        <metfile name="met" />
        <clock>
          <start_date type="date" description="Enter the start date of the simulation">11/09/2010</start_date>
          <end_date type="date" description="Enter the end date of the simulation">06/10/2010</end_date>
        </clock>
        <summaryfile />
        <area name="paddock">
          <Soil>
            <Water />
            <SoilWater />
            <SoilOrganicMatter />
            <Analysis />
            <Sample name="Initial nitrogen">
              <Thickness>
                <double>100</double>
                <double>200</double>
                <double>300</double>
                <double>200</double>
                <double>999999</double>
              </Thickness>
              <NO3>
                <double>0</double>
                <double>0</double>
                <double>0</double>
                <double>0</double>
                <double>NaN</double>
              </NO3>
              <NH4>
                <double>0</double>
                <double>0</double>
                <double>0</double>
                <double>0</double>
                <double>NaN</double>
              </NH4>
              <SW>
                <double>0.509</double>
                <double>0.508</double>
                <double>0.493</double>
                <double>0.453</double>
                <double>NaN</double>
              </SW>
              <NO3Units>ppm</NO3Units>
              <NH4Units>ppm</NH4Units>
              <SWUnits>Volumetric</SWUnits>
              <OCUnits>Total</OCUnits>
              <PHUnits>Water</PHUnits>
            </Sample>
          </Soil>
          <surfaceom name="SurfaceOrganicMatter" />
          <outputfile>
            <filename output="yes">September.out</filename>
            <title>September</title>
            <variables name="Variables" />
            <events name="Reporting Frequency" />
          </outputfile>
        </area>
        <Graph name="September">
          <Plot name="predicted">
            <GDApsimFileReader name="ApsimFileReader" />
          </Plot>
          <Plot name="observed">
            <GDFilter name="Filter">
              <Filter>Date &gt;= #9/11/2010# AND Date &lt;= #10/6/2010#</Filter>
              <GDApsimFileReader name="ApsimFileReader" />
            </GDFilter>
          </Plot>
        </Graph>
      </simulation>
    </folder>
  </folder>
</folder>