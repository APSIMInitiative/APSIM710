<!DOCTYPE html>
<html  lang="en-AU">

<!-- Mirrored from www.apsim.info/Documentation/Model,CropandSoil/SoilModulesDocumentation/SoilTemp.aspx by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 18 Mar 2014 02:13:15 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head id="Head"><title>
	APSIM > Documentation > Model, Crop and Soil > Soil Modules Documentation > SoilTemp
</title><meta content="text/html; charset=UTF-8" http-equiv="Content-Type" /><meta content="text/javascript" http-equiv="Content-Script-Type" /><meta content="text/css" http-equiv="Content-Style-Type" /><meta id="MetaDescription" name="DESCRIPTION" content="Agriculture Production Systems Simulator" /><meta id="MetaCopyright" name="COPYRIGHT" content="Copyright 2014 APSIM" /><meta id="MetaAuthor" name="AUTHOR" content="APSIM" /><meta name="RESOURCE-TYPE" content="DOCUMENT" /><meta name="DISTRIBUTION" content="GLOBAL" /><meta id="MetaRobots" name="ROBOTS" content="INDEX, FOLLOW" /><meta name="REVISIT-AFTER" content="1 DAYS" /><meta name="RATING" content="GENERAL" /><meta http-equiv="PAGE-ENTER" content="RevealTrans(Duration=0,Transition=1)" /><style id="StylePlaceholder" type="text/css"></style><link href="../../DependencyHandler.axd/b0e9bcca91a071945a9daa4998ffc22c.46.css" type="text/css" rel="stylesheet"/><!--[if LT IE 8]><link id="IE7Minus" rel="stylesheet" type="text/css" href="/Portals/0/Skins/APSIM_2012/ie7skin.css" /><![endif]-->     
        
			    

        
		  </head>
<body id="Body">
    
    <form method="post" action="../../external.html?link=http://www.apsim.info/Documentation/Model,CropandSoil/SoilModulesDocumentation/SoilTemp.aspx" id="Form" enctype="multipart/form-data">


     
<div id="DNN6" class="ThreeCol">
    <div id="Header">
        <div id="ContentBG">
            <div id="ControlPanelWrapper">
                
		    </div>
            <!-- START: Header -->
<div id="Header">
	<h1><a href="../../../index-2.html">APSIM</a></h1>
    <div id="dnn_Banner" class="Banner DNNEmptyPane"></div>
		<div id="search">
		

<div id="dnn_dnnSearch_DropDownSearch" class="SearchContainer">
  <div class="SearchBorder">
  <div id="SearchIcon" class="SearchIcon">
    <img id="dnn_dnnSearch_downArrow" title="Select the search type" src="../../../icons/sigma/Action_16X16_Standard.png" alt="Select the search type" />
  </div>
  <input name="dnn$dnnSearch$txtSearchNew" type="text" maxlength="255" id="dnn_dnnSearch_txtSearchNew" class="SearchTextBox" onkeydown="return __dnn_KeyDown(&#39;13&#39;, &#39;javascript:__doPostBack(%27dnn$dnnSearch$cmdSearchNew%27,%27%27)&#39;, event);" />&nbsp;
  <ul id="SearchChoices">
    <li id="SearchIconSite">Site</li>
    <li id="SearchIconWeb">Web</li>
  </ul>
  </div>
  <a id="dnn_dnnSearch_cmdSearchNew" class="SkinObject SearchButton" href="javascript:__doPostBack(&#39;dnn$dnnSearch$cmdSearchNew&#39;,&#39;&#39;)">Go</a>
</div>

		</div>
		<div class="clear">&nbsp;</div>
</div>
		    <div class="Content">
                <div id="Nav">
				     <!-- DDRmenu v02.00.01 - DNNStandard template --><!--SEO NOINDEX-->




			    </div> 
		    </div>
        </div>
	</div>
    <div class="wrapper">
    <div id="Content">   
        <div class="LogoRowRight">
            <div id="Login">
                
                

                

            </div> 
        </div>    
        <div id="Breadcrumb"><span id="dnn_dnnBreadcrumb_lblBreadCrumb"><a href="../../default.html" class="SkinObject">Documentation</a><span class="Sep"></span><a href="../../Model%2cCropandSoil.html" class="SkinObject">Model, Crop and Soil</a><span class="Sep"></span><a href="../SoilModulesDocumentation.html" class="SkinObject">Soil Modules Documentation</a><span class="Sep"></span><a href="SoilTemp.html" class="SkinObject">SoilTemp</a></span>
</div>
        <div id="PageTitle">
        	<h1>SoilTemp</h1>
        </div>
 
             <div id="Panes">
            <div id="dnn_ContentPane"><div class="DnnModule DnnModule-DNN_HTML DnnModule-532"><a name="532"></a>
<div class="Invisible"><div id="dnn_ctr532_ContentPane"><!-- Start_Module_532 --><div id="dnn_ctr532_ModuleContent" class="DNNModuleContent ModDNNHTMLC">
	<div id="dnn_ctr532_HtmlModule_lblContent" class="Normal">
	<p style="margin: 0cm 0cm 10pt;"><strong>General description</strong></p>
<p>Simulates soil temperature given minimal input information using a numerical scheme. <br />
<a href="../../../index-2.html"></a><strong>Usage</strong></p>
<p>Soiltemp requires </p>
<ol style="list-style-type: decimal;">
    <li style="margin: 0cm 0cm 10pt;">water content information from a water module,</li>
    <li style="margin: 0cm 0cm 10pt;">air temperature from the input module,</li>
    <li style="margin: 0cm 0cm 10pt;">and where available will use soil water evaporation and incident net radiation as part of the upper boundary condition. </li>
</ol>
<p style="margin: 0cm 0cm 10pt;"><strong>Theory</strong></p>
<p style="margin: 0cm 0cm 12pt;">The node/element scheme for the numerical simulation is shown in Figure 1 where the circles denote the nodes and the zigzag's show the elements. <br />
All heat storage is assumed to occur at the nodes and all resistance to heat transfer is assumed to take place within the elements.<br />
<br />
<br />
<br />
<strong><em></em></strong></p>
<p style="margin: 0cm 0cm 12pt;"><strong><em><img alt="" src="../../portals/0/Documentation/Soil/image019.gif" /></em></strong></p>
<p style="margin: 0cm 0cm 12pt;"><strong><em>Figure 1</em></strong><em>. A diagrammatic representation of the node structure of the numerical simulation.</em> <br />
<br />
where in Figure 1. ,<br />
T is temperature, <br />
Z is depth,<br />
K is thermal conductance,<br />
S is heat storage, <br />
nz is the number of nodes in the simulation, <br />
BL stands for boundary layer, <br />
T<sub>a</sub> is the air temperature, and <br />
T<sub>ave</sub> is the annual average soil temperature. <br />
<br />
<br />
<br />
We begin by defining the heat balance at a node i, where i &ne; 1 or nz.<br />
The decrease in storage of heat at the node over a particular timestep is equal to the amount of heat leaving the node minus the amount of heat coming in all divided by the timestep so that, <br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image020.gif" />, [1] <br />
<br />
where in Equation 1. ,<br />
Delta stands for a change and <br />
<em>t </em>is time (s). <br />
<br />
<br />
Also In Equation 1. ,<br />
Storage of heat is calculated from the change in temperature with time and the volumetric specific heat of the soil so that,<br />
<img alt="" src="../../portals/0/Documentation/Soil/image021.gif" />, [2] <br />
<br />
in Equation 2. , <br />
<em>i </em>stands for a particular node,<br />
<em>j </em>refers to the current timestep and j+1 to the next timestep,<br />
<em>T </em>is temperature ( <sup>o</sup>C), <br />
<em>C </em>is the volumetric specific heat of the soil (J K<sup>-1</sup> m<sup>-3</sup> ),<br />
<em>A </em>is the cross-sectional area and is normally taken as 1 m<sup>2</sup> , and <br />
<em>z </em>is depth (m). Because all heat storage is assumed to occur at the nodes, the appropriate depth interval is half the distance to the node on either side of <em>i </em>.<br />
<br />
<br />
In Equation 2. ,<br />
<em>C </em>can be calculated from the specific heats of the soil constituents so that, <br />
<br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image022.gif" />, [3] <br />
<br />
in Equation 3. , <br />
Rho is the soil bulk density (Mg m<sup>-3</sup> ), <br />
Rho<sub>s</sub> is the particle density and is usually taken as 2.65 Mg m<sup>-3</sup> , <br />
Theta is the volumetric water content (m<sup>3</sup> m<sup>-3</sup> ), <br />
the subscripts on <em>C </em>indicate the substance. <br />
<em>C<sub>air</sub> </em>is usually assumed to be negligible while appropriate values of C for clay minerals and water are 2.39 and 4.18 MJ m<sup>-3</sup> K<sup>-1</sup> . <br />
Where more precise values are required, the equation can be expanded to account for organic matter and other minerals. <br />
See Campbell (1985) or Jury <em>et al. </em>(1991) for details on how to calculate C in more detail. <br />
<br />
Also back in Equation 1.,<br />
Heat transfer is calculated from the standard Fickian equation where the rate of transfer is proportional to the temperature difference divided by the distance, </p>
<p style="margin: 0cm 0cm 10pt;"><img alt="" src="../../portals/0/Documentation/Soil/image023.gif" />, [4] <br />
<br />
in Equation 4. ,<br />
Lambda is the thermal conductivity (J s<sup>-1</sup> m<sup>-1</sup> K<sup>-1</sup> ) and <br />
the overbar on T indicates that an appropriate average in time of temperature should be used. <br />
<br />
<br />
in Equation 4., <br />
Lamda can either be calculated from measurements of temperature changes in the soil (see Jury <em>et al. </em>, 1991 for an example) or can be approximated from regression equations. <br />
<br />
Below is given the scheme from Campbell (1985).<br />
First four parameters dependent on density, water content, and the amount of clay are calculated. <br />
These are, <br />
<br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image024.gif" />, [5] <br />
<br />
in Equation 5. , <br />
<em>f<sub>clay</sub> </em>is the fraction of clay in the soil. <br />
<br />
The parameters in Equation 5 are combined into the equation for Lamda so that,<br />
<br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image025.gif" />. [6] <br />
<br />
<br />
<br />
<strong><span style="text-decoration: underline;">We are now able to put the elements of the equation together and rewrite Equation 1. as follows, </span></strong><br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image026.gif" />. [7] <br />
<br />
Now, in order to make some notational simplifications, define <br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image027.gif" />, [8] <br />
<br />
and <br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image028.gif" />, [9] <br />
<br />
and multiply by -1, so that Equation 7. can be rewritten as,<br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image029.gif" />. [10] <br />
<br />
The average temperature is defined as <br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image030.gif" />, [11] <br />
<br />
in Equation 11. , <br />
Eta is an operator controlling the forward/backward averaging of temperature. <br />
<br />
Expanding the heat balance equation (Equation 10.), <br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image031.gif" />, [12] <br />
<br />
and collecting on the terms of T, we can rewrite Equation 12. , <br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image032.gif" />, [13] <br />
<br />
we can now put the unknown, or &lsquo;future', terms of T on the left hand side, we can rewrite Equation 13. , <br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image033.gif" />, [14] <br />
<br />
the Equation 14. can now be expressed in matrix format,<br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image034.gif" />[15] <br />
<br />
in Equation 15., if the <strong>three</strong> elements of the left-most matrix are expressed as <br />
a<sub>i</sub> , <br />
b<sub>i</sub> ,<br />
and c<sub>i</sub> , <br />
and the right hand side as <br />
d<sub>i</sub> , <br />
Then Equation 15. can be expanded as an example for a simulation of nz nodes, <br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image035.gif" />. [16] <br />
<br />
<strong><span style="text-decoration: underline;">We now have a tri-diagonal matrix which can be solved using the Thomas algorithm (Carnahan <em>et al. </em>, 1969).</span></strong> <br />
<br />
<strong>The lower boundary condition</strong> is taken as a zero flux condition, ie. constant temperature, <br />
in which T<sub>nz+1</sub> equals a constant which is usually taken as the average annual temperature. <br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image036.gif" />[17] <br />
<br />
<strong>The upper boundary condition</strong> is more complex. <br />
Usually the known temperature is the air temperature at some height above the soil and d<sub>1</sub> is expressed as, <br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image037.gif" />, [18] <br />
<br />
in Equation 18. , <br />
K<sub>BL</sub> is the boundary layer conductance (J s<sup>-1</sup> m<sup>-2</sup> K<sup>-1</sup> ), <br />
T<sub>air</sub> is the temperature at the top of the boundary layer, <br />
R<sub>n</sub> is the net radiative input (J s<sup>-1</sup> m<sup>-2</sup> ), and <br />
E<sub>soil</sub> is the evaporative loss of energy from the soil surface (J s<sup>-1</sup> m<sup>-2</sup> ). <br />
<br />
<strong>Implementation</strong></p>
<p>Soiltemp is designed to independent of the Apsim timestep. <br />
<br />
To allow for the numerical solution, the equations above ([16],[17] and [18]) are solved 48 times within each Apsim timestep. <br />
<br />
<br />
When Apsim is running on its customary daily step (24 hours) this allows for a <strong>half-hourly</strong> (24 hours/48) internal time step, <br />
which should be more than sufficient for numerical stability. <br />
<br />
</p>
<strong>
</strong>
<p style="margin: 0cm 0cm 10pt;"><strong></strong></p>
<p style="margin: 0cm 0cm 10pt;"><strong>Estimating upper boundary condition (Change in air temperature) </strong></p>
<p style="margin: 0cm 0cm 10pt;"><strong>When the Apsim timestep is daily(24 hours) </strong></p>
<p style="margin: 0cm 0cm 12pt;">Soiltemp estimates the <strong>changes in air temperature</strong>, the <strong>upper boundary condition (Equation 18.)</strong>, in the following manner: <br />
<br />
<br />
<br />
<strong><em><img alt="" src="../../portals/0/Documentation/Soil/image038.gif" /></em></strong></p>
<p style="margin: 0cm 0cm 12pt;"><strong><em>Figure 2</em></strong><em>. Diagram showing the interpolation of air temperature within a day based on minimum and maximum temperature.</em> <br />
<br />
Air temperatures occurring between midnight and mint_time are linearly interpolated from the air temperature at midnight,<br />
calculated at the end of the previous Apsim timestep, and mint. <br />
There is a linear rise in temperture from the day's minimum to maximum. <br />
After maxt_time until midnight, air temperature is calculated as decreasing at the same rate at which it rose.<br />
<br />
</p>
<p style="margin: 0cm 0cm 10pt;"><strong>If the Apsim timestep is less than 24 hours</strong></p>
<p>it is assumed that the user is supplying enough detail of the diurnal <strong>changes in air temperature</strong> that such interpolation is not required. <br />
In that case air temperture is taken as the average of mint and maxt for each Apsim timestep. <br />
<br />
</p>
<strong>
</strong>
<p style="margin: 0cm 0cm 10pt;"><strong></strong></p>
<p style="margin: 0cm 0cm 10pt;"><strong>Initialisation</strong></p>
<p>There are two sections required for initialisation of the Soiltemp module; constants and parameters. <br />
<br />
</p>
<p><strong>Constants</strong></p>
<table cellspacing="8" cellpadding="0" border="0">
    <thead>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Name </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Unit </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Description </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Value </strong></p>
            </td>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>nu </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>- </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>forward/backward differencing </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>0.6 </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>vol_spec_heat_om </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>J m<sup>-3</sup> K<sup>-1</sup> </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>volumetric specific heat of organic matter </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>5.00e6 </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>vol_spec_heat_water </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>J m<sup>-3</sup> K<sup>-1</sup> </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>volumetric specific heat of water </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>4.18e6 </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>vol_spec_heat_clay </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>J m<sup>-3</sup> K<sup>-1</sup> </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>volumetric specific heat of clay minerals </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>2.39e6 </p>
            </td>
        </tr>
    </tbody>
</table>
<p><strong>Parameters</strong></p>
<p style="margin: 0cm 0cm 12pt;">Where a variable name is followed by &ldquo;[nz]&rdquo; the variable is an array and the appropriate number of values must be supplied.</p>
<table cellspacing="8" cellpadding="0" border="0">
    <tbody>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Name </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Unit </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Description </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Range</strong></p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>clay[nz] </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>- </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>proportion of clay </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>0.0 - 1.0 </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>bound_layer_cond </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>J s<sup>-1</sup> m<sup>-2</sup> K<sup>-1</sup> </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>boundary layer conductance </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>0.0 - 100.0 </p>
            </td>
        </tr>
    </tbody>
</table>
<p style="margin: 0cm 0cm 12pt;">The higher the value of <strong>bound_layer_cond</strong> the greater the difference between air and soil surface temperature. <br />
If its value is unknown, Campbell (1986) suggests that a value of 20 J s<sup>-1</sup> m<sup>-2</sup> K<sup>-1</sup> is an appropriate initial estimate. <br />
<br />
<br />
A further, optional, parameter is, </p>
<table cellspacing="8" cellpadding="0" border="0">
    <tbody>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Name </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Unit </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Description </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Range</strong></p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>soil_temp[nz] </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p><sup>o</sup>C </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>initial soil temperature </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>-100.0 - 100.0</p>
            </td>
        </tr>
    </tbody>
</table>
<p>which used to initialise soil temperature. <br />
If it is not supplied the soil temperature array is initialised to the average annual temperature.<br />
Simulations will eventually &lsquo;forget' the effect of poor initial guesses of soil temperature, but this may take some time. <br />
Testing of this module showed that it took approximately 40 days for the temperature at 1.5 m deep to converge to within 0.5 <sup>o</sup>C of the analytical solution when the initial temperature difference was 7 <sup>o</sup>C. <br />
The discrepancy will be greatest deeper in the soil profile, and where <em>C </em>is high or l is low. <br />
In general, where soil temperature is only important in the soil surface layers the convergence will occur within the first 10 days or so. <br />
<br />
<br />
Where the time taken to &lsquo;forget' the initial conditions might cause significant error, there are two strategies for overcoming this problem. <br />
The first is to run a dummy simulation prior to the start of the real simulation to estimate the starting soil temperature. <br />
The second option is to estimate the initial soil temperatures from an analytical solution. <br />
A solution for the heat flow equation assuming a sinusoidal upper boundary condition, <br />
which might for example be the annual cycle in air temperature, is (Carslaw and Jaeger, 1959),<br />
<br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image039.gif" />, [19] <br />
<br />
in Equation 19. , <br />
<br />
<img alt="" src="../../portals/0/Documentation/Soil/image040.gif" />, [20] <br />
<br />
and,<br />
T <sub>ave</sub> is the average annual temperature ( <sup>o</sup>C), <br />
T <sub>amp</sub> is the annual amplitude in temperature ( <sup>o</sup>C), and <br />
w or Omega is the angular frequency (radians). <br />
Thermal conductivity and heat capacity can be estimated, using soil profile averages, from equations 3, 5, and 6. <br />
<br />
</p>
<p style="margin: 0cm 0cm 10pt;"><strong>Time step inputs from other modules</strong></p>
<p>Soiltemp must be accompanied by the input module and a soil water module in order that other inputs are supplied. <br />
<br />
These inputs are: </p>
<p><a href="../../../index-2.html"></a><strong>Variables from the Met(Input) module</strong></p>
<table cellspacing="8" cellpadding="0" border="0">
    <tbody>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Name </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Unit </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Description</strong></p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>tav </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p><sup>o</sup>C </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Average annual temperature, used to set the initial soil temperature if soil_temp is not supplied. Also determines the temperature at the lower boundary.</p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>mint </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p><sup>o</sup>C </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Minimum air temperature. </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>maxt </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p><sup>o</sup>C </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Maximum air temperature. </p>
            </td>
        </tr>
    </tbody>
</table>
<strong><br clear="all" style="page-break-before: always;" />
</strong>
<p style="margin: 0cm 0cm 10pt;"><strong></strong></p>
<p style="margin: 0cm 0cm 10pt;"><strong>Variables from the Clock module</strong></p>
<table cellspacing="8" cellpadding="0" border="0">
    <tbody>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Name </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Unit </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Description</strong></p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>timestep </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>min </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Simulation timestep, converted to seconds internally. </p>
            </td>
        </tr>
    </tbody>
</table>
<p> </p>
<p style="margin: 0cm 0cm 10pt;"><strong>Variables from the soil water module</strong></p>
<p style="margin: 0cm 0cm 12pt;">Where a variable name is followed by &ldquo;[nz]&rdquo; the variable is an array and the appropriate number of values must be supplied.</p>
<table cellspacing="8" cellpadding="0" border="0">
    <tbody>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Name </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Unit </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Description</strong></p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>dlayer[nz] </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>mm </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Array of layer depths used to specify the nodes, converted to m internally. </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>sw[nz] </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>m<sup>3 </sup>m<sup>-3 </sup></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Volumetric soil water content. </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>bd[nz] </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Mg m<sup>-3</sup></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Soil bulk density.</p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>eos </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>mm </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Potential soil water evaporation, or the water-depth equivalent of the net radiation reaching the soil surface, converted to J s<sup>-1</sup> m<sup>-2</sup> K<sup>-1</sup> internally. </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>es </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>mm </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Actual soil water evaporation, or the water-depth equivalent of the evaporation from the soil surface, converted to J s<sup>-1</sup> m<sup>-2</sup> K<sup>-1</sup> internally. </p>
            </td>
        </tr>
    </tbody>
</table>
<p>To allow compatibility with modules where changes in the soil occur with time, dlayer and bd are requested at every Apsim time step. If eos and es are not available they are assumed equal to zero. <br />
<br />
<strong>Time step outputs</strong></p>
<p style="margin: 0cm 0cm 12pt;">Where a variable name is followed by &ldquo;[nz]&rdquo; the variable is an array and the appropriate number of values will be outputted.</p>
<table cellspacing="8" cellpadding="0" border="0">
    <thead>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Name </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Unit </strong></p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p style="text-align: center;"><strong>Description</strong></p>
            </td>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>final_soil_temp_surface </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p><sup>o</sup>C </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Soil surface temperature at the end of the final internal Soiltemp timestep. </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>final_soil_temp[nz] </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p><sup>o</sup>C </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Soil temperature at the end of the final internal Soiltemp timestep.</p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Ave_soil_temp_surface </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p><sup>o</sup>C </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Average soil surface temperature during the Apsim timestep.</p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Ave_soil_temp[nz] </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p><sup>o</sup>C </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Average soil temperature during the Apsim timestep. </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>mint_soil_surface </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p><sup>o</sup>C </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Minimum soil surface temperature found in each layer during the Apsim timestep. </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>mint_soil[nz] </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p><sup>o</sup>C </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Minimum soil temperature found in each layer during the Apsim timestep. </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>maxt_soil_surface </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p><sup>o</sup>C </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Maximum soil surface temperature found in each layer during the Apsim timestep. </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>maxt_soil[nz] </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p><sup>o</sup>C </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Maximum soil temperature found in each layer during the Apsim timestep. </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>therm_cond[nz] </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>J s<sup>-1</sup> m<sup>-1</sup> K<sup>-1</sup> </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Thermal conductivity for each layer. </p>
            </td>
        </tr>
        <tr>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>heat_store[nz] </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>J m<sup>-3</sup> K<sup>-1</sup> </p>
            </td>
            <td style="padding: 0.75pt; background-color: transparent; border: medium none #ece9d8;">
            <p>Volumetric specific heat for each layer. </p>
            </td>
        </tr>
    </tbody>
</table>
<p style="margin: 0cm 0cm 10pt;"><strong>References</strong></p>
<p style="margin: 0cm 0cm 10pt;">Campbell G.S., 1985, <em>Soil Physics with Basic </em>, Elsevier, Amsterdam.<br />
Carnahan B., Luther H.A., Wilkes J.O., 1969, <em>Applied Numerical Methods </em>, 1 st Ed. Wiley, New York. <br />
Carslaw H.S., Jaeger J.C., 1959, <em>Conduction of Heat in Solids </em>, Oxford University Press, London. <br />
Jury W.A., Gardner W.R., Gardner W.H., 1991, <em>Soil Physics </em>, 5 th Ed. Wiley, New York.</p>
<br clear="all" style="page-break-before: always;" />
</div>

</div><!-- End_Module_532 --></div></div></div></div>
            
            	<table width="100%" border="0" cellspacing="0" cellpadding="0">
					<tr>
						<td id="dnn_MenuPane" width="20%" valign="top" class="MenuPane DNNEmptyPane"></td>

						<td id="dnn_LeftPane" width="50%" valign="top" class="LeftPane DNNEmptyPane"></td>

						<td id="dnn_CenterPane" valign="top" class="CenterPane DNNEmptyPane"></td>

						<td id="dnn_RightPane" width="50%" valign="top" class="RightPane DNNEmptyPane"></td>

					</tr>
				</table>
		    
		    <div id="dnn_BottomPane" class="DNNEmptyPane"></div>
        </div>
    </div>
    </div> 
	<div id="Footer">
    	<div class="container">        
			<div id="dnn_FooterPane" class="DNNEmptyPane"></div>
			<div class="clearboth">
			</div>
    	</div>
    </div>
</div>





        <input name="ScrollTop" type="hidden" id="ScrollTop" />
        <input name="__dnnVariable" type="hidden" id="__dnnVariable" autocomplete="off" value="`{`__scdoff`:`1`,`SearchIconWebUrl`:`url(/icons/sigma/GoogleSearch_16X16_Standard.png)`,`SearchIconSiteUrl`:`url(/icons/sigma/DnnSearch_16X16_Standard.png)`,`SearchIconSelected`:`S`}" />
        
    
</form>
    
    
</body>

<!-- Mirrored from www.apsim.info/Documentation/Model,CropandSoil/SoilModulesDocumentation/SoilTemp.aspx by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 18 Mar 2014 02:13:15 GMT -->
</html>