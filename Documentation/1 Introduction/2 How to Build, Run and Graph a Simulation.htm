<html><head>
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">


   <title>APSIM Training Package</title>
   <link rel="stylesheet" href="../ApsimWebStyle.css" type="text/css">
</head><body>




<h1>How to Build, Run and Graph a Simulation</h1>

<h3>Building, running and graphing simulations</h3>
<p>Click on the <i>New</i> button and select a simulation that closest matches
the simulation you're trying to create. For this example, choose <i>Continuous
Wheat Simulation</i>.</p>
<h3>Weather</h3>
<p>The weather properties are located under the <i>Met</i> component in the
simulation tree. There you will have the ability to browse to a weather file.
Weather files need to be in APSIM format and should have a .met extension. Many
sample weather files (e.g. Dalby) can be found in the apsim\met\sample directory
under your apsim installation</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.g.
c:\program files\apsim61\apsim\met\sample</p>
<p>Closely related to the weather file are the start and end date of simulation.
These two properties can be found under the <i>Clock</i> component. They need to
be within the range of the weather file. At this stage, to set the clock
properties to include the entire climate record involves looking at the met
file, taking note of the first and last date and entering those dates in the
clock properties screen.</p>
<h3>Soil</h3>
<p>Picking a soil file involves finding a suitable soil from the APSRU-Australia-Soils toolbox. 
To open the toolbox just click on the <i>APSRU-Australia-Soils</i> button on the toolbar at the bottom of the window. 
The APSRU-Australia-Soils toolbox has many soils to choose from.</p>
<p><img src="2%20How%20to%20Build,%20Run%20and%20Graph%20a%20Simulation_files/build_simulation1.jpg"  border="0" ></p>
<p>Drag your chosen soil from the toolbox and drop into the paddock on the
simulation tree. You can then delete the existing soil in the paddock as it is
no longer needed. Once the soil has been dropped it can be modified by clicking
on it and then modifying the parameters to the right.</p>
<p><font color=red><b><u>Important: </u></b>
<ol>
<li>Once you have dragged your soil onto your simulation tree, you should rename it 
to something with a shorter name. Some soil names in the toolbox are too long and will cause your run to crash if it is not 
renamed to something shorter.
<p><p>
<li> It is important to remember that the soil must be parameterised for the crops
that you're going to sow. If your simulation is going to sow wheat, then the
soil must have LL, KL and XF values for wheat. These soil/crop values can be
added to the soil but
it is probably better to choose a soil that is already parameterised for the
crops that you want.
</ol>
</font>
</p>



<p>The starting water that a
simulation initialises with can be found by expanding the soil component in the simulation
tree and then clicking <i>InitWater</i>.</p>
<p><img src="2%20How%20to%20Build,%20Run%20and%20Graph%20a%20Simulation_files/build_simulation2.jpg"  border="0"></p>
<p>The initial water can be specified in multiple ways by selecting one of the
radio buttons and then entering a percent water or mm water. All changes made are
automatically reflected in the graph on the right. By selecting <i>Specify water
as layered values</i>, you are able to directly enter the values in the soil
water grid.</p>
<p>The starting nitrogen that a simulation initialises with can be found under
the <i>InitNitrogen</i> node under the soil in the Simulation tree. </p>
<p><img src="2%20How%20to%20Build,%20Run%20and%20Graph%20a%20Simulation_files/build_simulation3.jpg"  border="0"></p>
<p>A single value for amount of nitrate or ammonia can be entered for the whole
profile (in kg/ha) or amounts for individual layers can be entered in the grid.</p>
<h3>Surface Residues / Organic Matter</h3>
<p>The parameters for the initial surface residues can be found under the <i>
surface organic matter</i> component in the simulation tree.</p>
<p><img src="2%20How%20to%20Build,%20Run%20and%20Graph%20a%20Simulation_files/build_simulation4.jpg"  border="0" ></p>
<p>The "Organic Matter pool name" is simply an alphabetic description of the residue pool. The
more important parameters are the "Organic matter type" and "Initial surface residue", "C:N ratio of initial residue" and the "Fraction of residue standing".</p>
<h3>Fertiliser</h3>
<p>This component does not have any editable parameters. This component only needs to be present if you are going to be 
doing fertiliser applications in your simulation.</p>
<h3>Crops</h3>
<p>Crops can be dragged from the Standard Toolbox and dropped onto a paddock.
A crop can be deleted by selecting it and pressing Delete. Crops typically don't
have any editable parameters. It is important to remember that the crop
parameters LL, KL and XF come under the soil.</p>
<h3>Simulation management</h3>
<p>The <i>Manager</i> component contains all the management options for the
simulation e.g.</p>
<ul>
  <li><font size="3">sowing</font></li>
  <li><font size="3">fertilising</font></li>
  <li><font size="3">irrigation</font></li>
  <li><font size="3">tillage</font></li>
  <li><font size="3">resetting of water and nitrogen</font></li>
  <li><font size="3">rotations</font></li>
</ul>
<p>These options can be dragged from the <i>Standard toolbox</i> (under <i>
Manager</i>) and dropped under a <i>Manager</i> component within a paddock.</p>
<p><img src="2%20How%20to%20Build,%20Run%20and%20Graph%20a%20Simulation_files/build_simulation6.jpg"  border="0" ></p>
<p>The properties of the management option can then be edited on the right. The
management options in the toolbox cover the same sort of functionality as the
older APSFront software.</p>
<p>It is also possible to drag a <i>Logic</i> component from the <i>Standard
toolbox</i> and drop it on a paddock. This component lets you exactly specify
your own manager logic for a sowing, harvesting etc. This will be familar to you if
you have used control / parameter files in the past.</p>

<h3>Reporting</h3>
<p>APSIM is capable of producing an ASCII space separated output file containing
whatever APSIM variables you want. In fact you need to exactly specify which
variables you want output to the file. This is all configured from the <i>
Outputfile </i>component. Expand the outputfile component and click <i>Variables</i></p>
<img src="2%20How%20to%20Build,%20Run%20and%20Graph%20a%20Simulation_files/build_simulation7.jpg" border="0" >
<p>The top pane allows you to enter some text to put at the top of the output file. This is usually used to
put some constant values that you have used in your simulation. </p>
<p>The middle pane lists which variables
are to go into the output file (date, biomass yield etc) as columns. These variables can be deleted and reordered
up and down in the same way as the components in the simulation.</p> 
<p>The bottom pane
gives you the variables that can be dragged onto the variable list in the middle pane (adding them to the list). The variables are
grouped according to the components currently plugged into the simulation. To see the variables belonging
to each component, simply choose the component from the "Component filter" drop down list.</p>

<p>Some variables are layer variables or profile variables e.g.
extractable soil
water. Look for "Yes" or "No" in the <i>Array?</i> to see if a variable is or not. These variables that are, when dropped onto the variable list will
produce a
number for each layer in the output file. If you want the sum of all layers, put a () in
 alongside the variable name in the <i>Variable name</i> column of the middle pane. Other options include a
(1-3) for the
first 3 layers, or a (5) for the fifth layer. (click the ? button in the middle pane for more information)</p>

<p>The frequency of output is controlled by the "Reporting Frequency" sub component. The top pane contains a list of
events and whenever one of these events occur in the simulation a line with the current values of the variables will be written to the output file. 
</p> 
<p><img src="2%20How%20to%20Build,%20Run%20and%20Graph%20a%20Simulation_files/build_simulation8.jpg" border="0" ></p>
<p>In this example, a line of output will be produced every time
APSIM harvests a crop. Daily output can be achieved by dragging <i>Daily</i> from
the <i>Global</i> component list of events in the bottom pane. Just like with variables, use the "Component filter" drop down list to see the events for each component that can be dragged to the top pane.</p>
<p>APSIM is also capable of producing multiple output files. The user simply
needs to drag and drop multiple <i>outputfile</i> components onto the simulation
tree. Each can then be configuring independently.</p>
<p>Precisely specifying outputs can quickly become tedious. If you frequently
use common outputs, why not create a toolbox and drag your configured <i>
outputfile</i> component and drop it onto your toolbox. You can then easily
reuse this configured outputfile in your next simulation. To see how to do
this, <a href="http://www.apsim.info/apsim/training/Exercises/Main%20overview.htm#Adding%20modules%20to%20a%20simulation%20via%20Toolboxes">read
the overview on toolboxes</a>.</p>
<h3>Multiple simulations; creating / saving and running them</h3>
<p>Simulations can be saved to any folder by clicking the <i>Save</i> button.
Likewise, running a simulation is as simple as clicking <i>Run</i> on the button
bar. The user interface is capable of hosting multiple simulations within the
single simulation tree. The example we've been working through here has a single
simulation called <i>Continuous Wheat Simulation</i>. You can add another simulation by
simply dragging this simulation and dropping it back on the top level node <i>
Simulations</i>, a copy will be made and there will be two simulations in the
simulation tree.</p>
<p><img src="2%20How%20to%20Build,%20Run%20and%20Graph%20a%20Simulation_files/build_simulation9.jpg" border="0" ></p>
<p>Notice the second simulation called <i>Continuous Wheat Simulation1</i> at
the bottom. This simulation will be identical to the first simulation. 
Usually you would change a parameter in the second simulation to see what effect 
this parameter has on the result compared with the first simulation.  
Before you run the simulations the second simulation should be renamed to a more suitable name. 
Clicking <i>Run</i> in this situation will cause both simulations to be run. </p>

<p>Often APSIM will produce a fatal error as a result of an invalid
configuration or parameterisation. In this instance, it is important to consult
the summary file that APSIM produces. Clicking on the <i>summaryfile</i>
component will give quick access to the contents of this file. When looking for
errors, always scroll down to the first error and fix that first.</p>

<p><b>NOTE: </b>The user interface keeps track of
output and summary file names automatically. It uses the simulation name in the
tree (eg. <i>Continuous Wheat Simulation</i>) for the output / summary file name. This ensures names of output and
summary files are always kept in sync with the name of the simulation. The suffixes .out and .sum are used for
the output and summary files respectively. After a run you will find them in the same folder that you have
saved the simulation to.</p>

<h3>Graphing the output and Exporting to Excel</h3>

<p>To graph the output file, if there is already a graph component in your simulation tree, then all you have to do is click 
the graph component. Depending up the type of graph component it was, you will see that type of graph in the properties pane.
If you do not already have a graph component in your simulation tree, then you can drag one there from the <i>Graph</i> toolbox.
There are different types of graph components availible allowing you to choose the type of graph you wish to use.</p>
<p><img src="2%20How%20to%20Build,%20Run%20and%20Graph%20a%20Simulation_files/build_simulation11.jpg"  border="0"></p>
<p>The graph component is able to find any output file on the same level or lower in the simulation tree. So dropping a
graph control on the top <i>Simulations</i> node will allow it to find all the output files in all the simulations. Dropping on
a specific simulation will allow it to find all the output files in the simulation and dropping it on a paddock will allow it
to find all of them in that paddock. If you just drop it on a specific output file it will only be able to find that outputfile.</p>

<p>APSIM has buttons on the main application toolbar to send the output file to a couple of other APSIM graphing tools (APSVis
and APSIM Outlook) and also to Microsoft Excel.  </p>

<p>&nbsp;<img src="2%20How%20to%20Build,%20Run%20and%20Graph%20a%20Simulation_files/build_simulation10.jpg" border="0" ></p>

<p>Using APSVis (<i>Graph</i> button), you can quickly create scatter charts, depth charts,
probability charts and frequency charts. Users can graph all output files in all simulations, using APSVis, by
clicking the graph button. Alternatively, all output files can be sent to
ApsimOutlook.</p>

<p>To send an output file or multiple output files to Excel, just select them in the simulation tree and click the <i>Excel</i> button</p>




<h3>The help system</h3>

<p>The window at the bottom of the user interface gives quick access to the APSIM Documentation.</p> 
<p>A lot of documentation, including the science documentation and how some of
the modules perform at different locations (i.e. sensibility tests), can be
found under <i>Module documentation</i>. </p>


</body></html>