<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>The APSIM SoilWat Module </title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../ApsimWebStyle.css" rel="stylesheet" type="text/css">
</head>

<body>
<p align="left" class="Title1">The APSIM SoilWat Module </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Title2">Description </p>
<p align="left" class="Normal">The SoilWater module is a cascading water balance model that owes much to its precursors in CERES (Jones and Kiniry, 1986) and PERFECT(Littleboy <em>et al </em>, 1992). The algorithms for redistribution of water throughout the soil profile have been inherited from the CERES family of models. The water characteristics of the soil are specified in terms of the lower limit (ll15), drained upper limit (dul) and saturated (sat) volumetric water contents. Water movement is described using separate algorithms for saturated or unsaturated flow. It is notable that redistribution of solutes, such as nitrate- and urea-N, is carried out in this module. Modifications adopted from PERFECT include (i) the effects of surface residues and crop cover on modifying runoff and reducing potential soil evaporation, (ii) small rainfall events are lost as first stage evaporation rather than by the slower process of second stage evaporation, and (iii) specification of the second stage evaporation coefficient (cona) as an input parameter, providing more flexibility for describing differences in long term soil drying due to soil texture and environmental effects. The module is interfaced with the RESIDUE and crop modules so that simulation of the soil water balance responds to change in the status of surface residues and crop cover (via tillage, decomposition and crop growth). </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">Enhancements beyond CERES and PERFECT include </p>
<ul>
  <li> the specification of swcon for each layer, being the proportion of soil water above dul that drains in one day </li>
  <li> isolation from the code of the coefficients determining diffusivity as a function of soil water (used in calculating unsaturated flow). Choice of diffusivity coefficients more appropriate for soil type have been found to improve model performance. </li>
  <li> Unsaturated flow is permitted to move water between adjacent soil layers until some nominated gradient in soil water content is achieved, thereby accounting for the effect of gravity on the fully drained soil water profile. </li>
</ul>
<p align="left" class="Normal">SoilWater is called by APSIM on a daily basis, and typical of such models the various processes are calculated consecutively (This contrasts with models such as SWIM that solve simultaneously a set of differential equations that describe the flow processes).<br>
</p>
<p align="left" class="Normal">Figure 1. The subroutine structure of SoilWater. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><img width="376" height="318" src="SoilWat/soilwat2_science_clip_image002.gif"></p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">Figure 2. A diagram showing the communication between SoilWater and other APSIM modules. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><img width="479" height="360" src="SoilWat/soilwat2_science_clip_image004.gif"></p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Title2">Soil Moisture Properties </p>
<p align="left" class="Normal">An example some soil properties used to configure the SoilWater soil water &quot;bucket&quot; is as follows. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><img width="264" height="210" src="SoilWat/soilwat2_science_clip_image006.gif"></p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">LL15 is the 15Bar lower limit of soil water content . It is approximately the driest water content achievable by plant extraction. This defines the “bottom of the bucket”. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">DUL is the drained upper limit of soil water content . It is the content of water retained after gravitational flow. DUL is sometimes referred to as “Field Capacity”. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">SAT is the Saturated water content . This defines the “top of the bucket” </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Title2">Initial Soil Water </p>
<p align="left" class="Normal">There are five ways to parameterise initial soil water in SoilWater. These can also be specified in the Manager module sections using the ‘set' command </p>
<p align="left" class="Normal">e.g SoilWater set insoil = 0.5 () </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><strong>User Specified Soil Water Content </strong></p>
<p align="left" class="Normal">The user can initialise soil water content to any initial volumetric soil water content for each layer. This can be done by setting the soil water parameter (sw) for each layer to a value between SAT and LL15. To use this option the insoil parameter must be set to &gt; 1. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><strong>Soil Water as a Fraction of Available Soil Water distributed evenly down the profile </strong></p>
<p align="left" class="Normal">Initial soil water can be set to a fraction of the maximum available soil water in each layer. Setting the insoil parameter to a fraction (0 = LL15, 1 = DUL) initialises the soil water parameter (initial sw values are ignored) to this fraction for each layer. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">I.e. If 0.0 &lt;= Insoil &lt;= 1.0, then </p>
<p align="left" class="Normal">in each layer </p>
<p align="left" class="Normal">Soil water (sw) = LL15 + (DUL-LL15) x Insoil </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><strong>Soil Water as a Fraction of Available Soil Water filling the profile from the top. </strong></p>
<p align="left" class="Normal">Initial soil water can be set to a fraction of the maximum extractable soil water in the whole profile. The profile is filled from the top down until the fraction is reached. Setting the profile_fesw parameter to a fraction of total extractable soil water initialises the soil water for layers starting at the top of the profile to DUL, until the fraction is reached. The remaining layers are set to LL15. This parameter is exclusive of the others. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">e.g. If </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;the soil profile has layers of 150, 150, 300 and 300 mm, </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;giving a total profile depth of 900 mm </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;with corresponding DUL of 67.5, 67.5, 135, 120 mm and </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;corresponding LL15 of 34.5, 34.5, 72, 75 mm giving </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;ESW of 33, 33, 63, 45 mm with a </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;Total ESW in the profile of 174 mm. </p>
<p align="left" class="Normal">And</p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;profile_fesw = 0.5, </p>
<p align="left" class="Normal">Then</p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;The ESW of each layer is set to 33, 33, 21, 0 mm giving </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;A total of 87 mm in the profile. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><strong>Soil Water as a depth of available Soil Water from the top of the profile. </strong></p>
<p align="left" class="Normal">Initial soil water can be set to a depth of available soil water in the whole profile. The profile is filled from the top down until the soilwater depth is reached. Setting the profile_esw_depth parameter to a total available soil water initialises the soil water for layers starting at the top of the profile to DUL, until the total is reached. The remaining layers are set to LL15. This parameter is exclusive of the others. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;e.g. Using the soil parameters of the previous example and </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;profile_esw_depth = 87mm, </p>
<p align="left" class="Normal">Then</p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;The ESW of each layer is set to 33, 33, 21, 0 mm. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><strong>Soil Water as a depth of wet soil, filled to field capacity. </strong></p>
<p align="left" class="Normal">Initial soil water can be set to a depth of wet soil. The profile is filled from the top down until the soil depth is reached. Setting the wet_soil_depth parameter to a depth of soil filled to field capacity (DUL) initialises the soil water for layers starting at the top of the profile to DUL, until the soil depth is reached. The remaining layers are set to LL15. This parameter is exclusive of the others. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;e.g. Using the soil parameters of the previous example and </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;wet_soil_depth = 400 mm, </p>
<p align="left" class="Normal">Then</p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;The ESW of each layer is set to 33, 33, 21, 0 mm giving </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;A total of 87 mm in the profile. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><strong>Runoff </strong></p>
<p align="left" class="Normal">Runoff from rainfall is calculated using the USDA-Soil Conservation Service procedure known as the curve number technique. The procedure uses total precipitation from one or more storms occurring on a given day to estimate runoff. The relation excludes duration of rainfall as an explicit variable, and so rainfall intensity is ignored. When irrigation is applied it is assumed to be at low intensity and therefore no runoff is calculated. </p>
<p align="left" class="Normal">&nbsp;</p>
<div align="left">
  <table cellspacing="0" cellpadding="0">
    <tr>
      <td valign="top" align="left"><p align="center" class="Normal"><img width="372" height="303" src="SoilWat/soilwat2_science_clip_image008.gif"></p></td>
    </tr>
  </table>
</div>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">Runoff response curves (ie runoff as a function of total daily rainfall) are specified by numbers from 0 (no runoff) to 100 (all runoff). </p>
<p align="left" class="Normal">Response curves for three runoff curve numbers for rainfall varying between 0 and 100 mm per day </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">For SoilWater, the user only needs to supply the curve number for average antecedent rainfall conditions(CN2). From this value the wet (high runoff potential) response curve and the dry (low runoff potential) response curve are calculated. SoilWater will then use the family of curves between these two extremes for calculation of runoff depending on the daily moisture status of the soil. The effect of moisture on runoff is confined to the effective hydraulic depth as specified in the module's ini file and is calculated to give extra weighting to layers closer to the soil surface. </p>
<p align="left" class="Normal">&nbsp;</p>
<div align="left">
  <table cellspacing="0" cellpadding="0">
    <tr>
      <td valign="top" align="left"><p align="center" class="Normal"><img width="400" height="216" src="SoilWat/soilwat2_science_clip_image010.gif"></p></td>
    </tr>
  </table>
</div>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">Runoff response curve for average antecedent rainfall condition curve </p>
<p align="left" class="Normal">number (CN2) of 75 for a range of soil moisture conditions </p>
<p align="left" class="Normal">(0 - dry, 1 - wet). </p>
<p align="left" class="Normal">&nbsp;</p>
<div align="left">
  <table cellspacing="0" cellpadding="0">
    <tr>
      <td valign="top" align="left"><p align="center" class="Normal"><img width="417" height="256" src="SoilWat/soilwat2_science_clip_image012.gif"></p>
      <p align="center" class="Normal">&nbsp;</p></td>
    </tr>
  </table>
</div>
<p align="left" class="Normal">Surface residues inhibit the transport of water across the soil surface during runoff events and so different families of response curves are used according to the amount of crop and residue cover. The extent of the effect on runoff is specified by a threshold residue cover, above which there is no effect, and the corresponding curve number reduction. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">Residue cover effect on runoff curve number where bare soil </p>
<p align="left" class="Normal">curve number is 75 and total reduction in curve number is 20 at 80% cover. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Title2">Evaporation </p>
<p align="left" class="Normal">Soil evaporation is assumed to take place in two stages: the constant and the falling rate stages. In the first stage the soil is sufficiently wet for water to be transported to the surface at a rate at least equal to the potential evaporation rate. Potential evapotranspiration is calculated using an equilibrium evaporation concept as modified by Priestly and Taylor(1972). Once the water content of the soil has decreased below a threshold value the rate of supply from the soil will be less than potential evaporation (second stage evaporation). These behaviors are described in SoilWater through the use of two parameters: U and cona. The parameter U (as from CERES) represents the amount of cumulative evaporation before soil supply decreases below atmospheric demand. The rate of soil evaporation during the second stage is specified as a function of time since the end of first stage evaporation. The parameter Cona (from PERFECT) specifies the change in cumulative second stage evaporation against the square root of time. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">i.e. E s = cona t 1/2 </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">Water lost by evaporation is removed from the surface layer of the soil profile thus this layer can dry below the wilting point or lower limit (LL) to a specified air-dry water content (air_dry). </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">SoilWater uses two parameters, U and CONA, to specify soil evaporation. U (as in CERES) is the amount of cumulative evaporation, since soil wetting, before soil supply becomes limiting. Subsequently soil evaporation is a fraction of the square root of time since the end of first stage evaporation, using the regression coefficient CONA ( from PERFECT). </p>
<p align="left" class="Normal">&nbsp;</p>
<div align="left">
  <table cellspacing="0" cellpadding="0">
    <tr>
      <td valign="top" align="left"><p class="Normal"><img width="378" height="212" src="SoilWat/soilwat2_science_clip_image014.gif"></p></td>
    </tr>
  </table>
</div>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">Cumulative Soil Evaporation through time for U = 6 mm and CONA = 3.5. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">For t &lt;= t 1 E s = E os </p>
<p align="left" class="Normal">For t &gt; t 1 <img width="171" height="23" src="SoilWat/soilwat2_science_clip_image016.gif"></p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Title2">Saturated Water Flow </p>
<p align="left" class="Normal">When water content in any layer is above DUL, a fraction of the water drains to the next deepest layer each day. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">Flux = SWCON x (SW - DUL) </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">Infiltration or water movement into any layer that exceeds the saturation capacity of the layer automatically cascades to the next layer. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Title2">Unsaturated Water Flow </p>
<p align="left" class="Normal">For water contents below DUL, movement depends upon the water content gradient between adjacent layers and the diffusivity, which is a function of the average water contents of the two layers. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">Unsaturated flow may occur both towards the surface and downwards, but cannot move water out of the bottom of the deepest layer in the profile. Flow between adjacent layers ceases at a soil water gradient (gravity_gradient) specified in the SoilWater ini file. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">The diffusivity is defined by two parameters set by the user (diffus_const, diffus_slope) in the SoilWater parameter set (Default values, from CERES, are 88 and 35.4, but 40 and 16 have been found to be more appropriate for describing water movement in cracking clay soils). </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">Diffusivity = diffus_const x exp (diffus_slope x thet_av) </p>
<p align="left" class="Normal">where thet_av is the average of SW - LL15 across the two layers. </p>
<p align="left" class="Normal">Flow = Diffusivity x Volumetric Soil Water Gradient </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Title2">Solute Movement </p>
<p align="left" class="Normal">SoilWater can move any solute within the APSIM simulation. Solutes are defined to be either mobile or immobile, according to specifications in the SoilWater module's ini file. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">The saturated and unsaturated flows of soil water are used to calculate the redistribution of solutes throughout the soil using a “mixing” algorithm which assumes that all water and solute entering or leaving a layer is completely mixed. This means that solute movement can simply be calculated as the product of the water flow and the solute concentration in that water. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">Fluxes of solutes are associated with both saturated and unsaturated water fluxes. In both cases a simple mixing algorithm is used whereby incoming water and solute is fully mixed with that already present in any layer to obtain concentrations for solutes that are applied to the water leaving the layer. Efficiency factors (flux_eff and flow_eff) are specified in the SoilWater ini file to adjust the effectiveness of mixing for either saturated or unsaturated flows. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Title2">Leaching </p>
<p align="left" class="Normal">The amount of solute dissolved in water can move to the layer below. This is considered by the model to be leaching. Individual solutes leached from each layer can be tracked by reporting the solute leaving the layer. An example may include reporting no3_leach(7). If there are 7 layers defined in the soil profile then this variable will represent the leaching of no3 out of the root zone. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Title2">Solutes in Rainfall </p>
<p align="left" class="Normal">Solutes can be applied to the soil via rainfall using the optional parameter 'rainfall_XXX_conc' in parts per million, where 'XXX' is the solute name.  As many solutes as desired can be applied in this way, however any solutes used must first be initialised in the system with the SOLUTE module. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Title2">Surface Ponding and Water Table Functionality </p>
<p align="left" class="Normal">Soilwat2 has the functionality of simulating an impermeable layer(s) within the soil profile, above which a water table may perch. Two methods are implemented that describe impermeability either in terms of a fractional value (0-1), or in absolute terms (mm/day).
<p align="left" class="Normal">&nbsp;</p>
The impermeable layer(s) is specified using the parameter ‘mwcon' or 'ks'. If the water-table happens to reach the surface, then Soilwat2 also has the ability to simulate a surface-storage (or ‘ponding') pool. The surface-water storage capacity is specified by the parameter ‘max_pond', the maximum available surface water storage. This ‘max_pond' is applied to both runoff from rainfall events and also to runoff generated by water backing-up above an impermeable layer (mwcon=0) below. All of ‘mwcon', 'ks' and ‘max_pond' are optional parameters, and if not provided, they are set to defaults (1.0 for mwcon and ks, and 0.0 for max_pond). Eg </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">[black_earth.soilwat2.parameters] </p>
<p align="left" class="Normal">!layer 1 2 3 4 5 6 7 </p>
<p align="left" class="Normal">dlayer = 150 150 300 300 300 300 300 ! layer thickness mm soil </p>
<p align="left" class="Normal">sat = .500 .509 .510 .505 .490 .480 .480 ! saturation mm water/mm soil </p>
<p align="left" class="Normal">dul = .450 .459 .45 .44 .42 .41 .41 ! drained upper limit mm water/mm soil </p>
<p align="left" class="Normal">sw = .280 .364 .43 .43 .40 .41 .41 ! initial soil water mm water/mm soil </p>
<p align="left" class="Normal">ll15 = .230 .240 .240 .250 .260 .270 .280 ! lower limit mm water/mm soil </p>
<p align="left" class="Normal">air_dry = .10 .20 .20 .20 .20 .20 .20 ! air dry mm water/ mm soil </p>
<p align="left" class="Normal">swcon = 0.02 0.02 0.02 0.02 0.02 0.02 0.02 ! drainage coefficient </p>
<p align="left" class="Normal">mwcon = 1.0 0.0 1.0 1.0 1.0 1.0 1.0 </p>
<p align="left" class="Normal">bd = 1.30 1.30 1.29 1.31 1.35 1.36 1.36 ! bulk density gm dry soil/cc moist soil </p>
<p align="left" class="Normal">max_pond = 15.0 ! maximum depth of surface storage </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">The layer in which mwcon = 0.0 is considered impermeable to ‘cascading' flow, hence water cascading down the soil profile will reach this layer and begin to back-up towards the surface. Drainage is still allowed through this layer unless ‘swcon' is also set to zero. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">The output variable ‘water_table' reports the depth of the water-table surface from the ground surface. If there is no water table, ‘water_table' = 10000 by default. </p>
<p align="left" class="Normal">Any surface water backing-up over ‘max_pond' is added to the runoff pool. </p>
<p align="left" class="Normal">Note that the functionality of mwcon has been superceded by ks and it is slated for deletion. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Title2">Runon, Lateral Inflow and Outflow on a layer basis </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><strong>Runon Capability – </strong></p>
<ul>
  <li class="Normal">Surface 'runon' can now be input from a data file. Soilwat2 does a daily 'get' to retrieve this information from the input module. From a user's point of view this means that 'runon' can be provided on a daily basis from the met file or from a separate input file. For example : </li>
</ul>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[runon.sparse.data] </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;runon = 0 </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allow_sparse_data = true </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;year day runon </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;() () (mm) </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1988 1 20 </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1988 5 17 </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1988 6 22 </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1988 10 25 </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1988 11 22 </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><strong>Lateral Inflow Capability – </strong></p>
<ul>
  <li class="Normal">Lateral Inflow can be input as a layer-based array via the same method as 'runon'. The parameter name is 'inflow_lat(layer)'. For example: </li>
</ul>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[runon.sparse.data] </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;runon = 0 </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;allow_sparse_data = true </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;year day runon inflow_lat(1) inflow_lat(2) inflow_lat(3) </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;() () (mm) (mm) (mm) (mm) </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1988 1 20 1 2 2 </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1988 5 17 2 1 2 </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1988 6 22 0 0 0 </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1988 10 25 1 1 1 </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1988 11 22 1 2 2 </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">Both 'runon' and 'inflow_lat(layer)' are optional inputs to the model. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><strong>Lateral Outflow Capability – </strong></p>
<ul>
  <li class="Normal">The calculation of lateral outflow on a layer basis is now performed using the equation: <br>
    Lateral flow for a layer = Klat * d * s/(1+s^2)^0.5 * L/A * unit conversions. <br>
    Where </li>
</ul>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Klat = lateral conductivity (mm/day) </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d = depth of saturation in the layer (mm)= dlayer*(sw-dul)/(sat-dul) if sw&gt;dul. Note this allows lateral flow in </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;any &quot;saturated&quot; layer, not just those inside a water table. </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s = slope (m/m) </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L = catchment discharge width. Basically, it's the width of the downslope boundary of the catchment. (m) </p>
<p align="left" class="Normal">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A = catchment area. (m2)</p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">An example of the new soilwat2 input parameters (optional - if not included, lateral outflow = zero) are : </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">[black_earth.soilwat2.parameters] </p>
<p align="left" class="Normal">slope =0 .1 </p>
<p align="left" class="Normal">discharge_width = 50 </p>
<p align="left" class="Normal">catchment_area = 1000 </p>
<p align="left" class="Normal">klat = 0.5 </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal">There is a new reportable variable called 'outflow_lat(layer)'. This can be summed by reporting 'outflow_lat()'. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Title2">SoilWater Module Outputs </p>
<div align="left">
  <table cellspacing="0" cellpadding="0">
    <tr>
      <td width="103" valign="top"><p class="Normal"><strong>Name </strong></p></td>
      <td width="116" valign="top"><p class="Normal"><strong>Units </strong></p></td>
      <td width="371" valign="top"><p class="Normal"><strong>Description </strong></p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">Es </p></td>
      <td width="116" valign="top"><p class="Normal">Mm </p></td>
      <td width="371" valign="top"><p class="Normal">Daily soil evaporation </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">Eo </p></td>
      <td width="116" valign="top"><p class="Normal">Mm </p></td>
      <td width="371" valign="top"><p class="Normal">Daily potential evapotranspiration </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">Eos </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Daily potential soil evaporation </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">cn2_new </p></td>
      <td width="116" valign="top"></td>
      <td width="371" valign="top"><p class="Normal">Daily value CN2 adjusted for surface cover </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">Runoff </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Daily runoff </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">Drain </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Daily drainage from bottom of soil profile </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">infiltration </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Daily infiltration across the soil surface </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">eff_rain </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Effective Rainfall (Rainfall - Runoff - Drainage). </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">salb </p></td>
      <td width="116" valign="top"></td>
      <td width="371" valign="top"><p class="Normal">Bare soil albedo </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">bd </p></td>
      <td width="116" valign="top"><p class="Normal">g/cm 3 </p></td>
      <td width="371" valign="top"><p class="Normal">Bulk density of the soil for each layer </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">esw </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Extractable soil water in each layer (ie. sw_dep - ll15_dep) </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">sw_dep </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Amount of water in each layer </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">sw </p></td>
      <td width="116" valign="top"><p class="Normal">mm 3 /mm 3 </p></td>
      <td width="371" valign="top"><p class="Normal">Volumetric water content in each layer </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">dlayer </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Thickness of each soil layer </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">ll15_dep </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Amount of water corresponding to a soil potential of 15 bar </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">ll15 </p></td>
      <td width="116" valign="top"><p class="Normal">mm 3 /mm 3 </p></td>
      <td width="371" valign="top"><p class="Normal">Volumetric water content for each layer corresponding to a soil potential of 15 bar </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">dul_dep </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Amount of water at drained upper limit for each soil layer </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">dul </p></td>
      <td width="116" valign="top"><p class="Normal">mm 3 /mm 3 </p></td>
      <td width="371" valign="top"><p class="Normal">Volumetric water content at drained upper limit for each soil layer </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">sat_dep </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Amount of water in each layer at saturation </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">sat </p></td>
      <td width="116" valign="top"><p class="Normal">mm 3 /mm 3 </p></td>
      <td width="371" valign="top"><p class="Normal">Volumetric water content at saturation for each soil layer </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">air_dry_dep </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Amount of water retained at air_dry for each layer </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">air_dry </p></td>
      <td width="116" valign="top"><p class="Normal">mm 3 /mm 3 </p></td>
      <td width="371" valign="top"><p class="Normal">Volumetric water content for air dry soil in each layer </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">flux </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Saturated water flux from each layer to the layer below </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">flow </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Unsaturated water movement between layers (+ve up) </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">nnnn_leach </p></td>
      <td width="116" valign="top"><p class="Normal">kg/ha </p></td>
      <td width="371" valign="top"><p class="Normal">Amount of solute nnnn in saturated water movement from each layer to the layer below </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">nnnn_up </p>
          <p class="Normal">water_table </p>
          <p class="Normal">pond </p></td>
      <td width="116" valign="top"><p class="Normal">kg/ha </p>
          <p class="Normal">mm </p>
          <p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Amount of solute nnnn in unsaturated water movement for each layer (+ve up). </p>
          <p class="Normal">Depth of the water table (10000 if no water table present) </p>
          <p class="Normal">Surface ponding </p></td>
    </tr>
    <tr>
      <td width="103" valign="top"><p class="Normal">outflow_lat </p></td>
      <td width="116" valign="top"><p class="Normal">mm </p></td>
      <td width="371" valign="top"><p class="Normal">Lateral outflow from each layer </p></td>
    </tr>
  </table>
</div>
<p align="left" class="Normal"><strong></strong>
</p>
<p align="left" class="Title2">SoilWater module actions </p>
<p align="left" class="Title2">&nbsp;</p>
<p align="left" class="Normal"><strong>Reset </strong></p>
<p align="left" class="Normal">The reset action can be invoked to reset the module to the state specified within the module's input data, which includes the soil moisture characteristics, runoff and evaporation parameters and the initial soil water profile. The Reset action is identical to the initialise action used by the simulation engine at the start of the simulation except that a description of the reinitialised state is not printed in the simulation summary file. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><em>APSIM Manager Example: </em></p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Code">[sample.manager.start_of_day] </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Code">! reinitialise residues at the beginning of each sowing window </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Code">&nbsp;&nbsp;&nbsp;&nbsp;If day = 100 then </p>
<p align="left" class="Code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SoilWater reset </p>
<p align="left" class="Code">&nbsp;&nbsp;&nbsp;&nbsp;endif </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><strong>Initialise </strong></p>
<p align="left" class="Normal">The initialise action has now been replaced by the reset action (see above). </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><strong>Summary Report </strong></p>
<p align="left" class="Normal">At initialisation, at series of tables and useful information is printed to the simulation summary file for perusal by the user. These tables can be printed to the summary file at any point during the simulation as a detailed record of the system state at a particular time. </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Normal"><em>APSIM Manager Example: </em></p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Code">[sample.manager.start_of_day] </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Code">! Print out a summary of module state to the summary file </p>
<p align="left" class="Normal">&nbsp;</p>
<p align="left" class="Code">&nbsp;&nbsp;&nbsp;&nbsp;If day = 100 then </p>
<p align="left" class="Code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SoilWater sum_report </p>
<p align="left" class="Code">&nbsp;&nbsp;&nbsp;&nbsp;endif </p>
<p align="left" class="Normal"><strong></strong>
</p>
<p align="left" class="Title2">References </p>
<p align="left" class="Normal">Jones, C.A., and J.R. Kiniry. 1986. CERES-Maize: A simulation model of maize growth and development. Texas A&amp;M University Press, College Station, Texas. </p>
<p align="left" class="Normal">Littleboy, M., D.M. Silburn, D.M. Freebairn, D.R. Woodruff, G.L. Hammer, and J.K. Leslie. 1992. Impact of soil erosion on production in cropping systems. I. Development and validation of a simulation model. Aust. J. Soil Res. 30, 757-774. </p>
<p align="left" class="Normal">Priestly, C.H.B., and Taylor, R.J. (1972) On the assessment of surface heat and evaporation using large-scale parameters. <em>Monthly Weather Review </em>. <strong>100 </strong>, 81 </p>
<p align="left" class="Normal">Ritchie, J.T. (1972) Model for predicting evaporation from a row crop with incomplete cover. <em>Water Resources Research. </em><strong>8 </strong>, 1204. </p>
<p align="left" class="Normal">Soil Conservation Service (1972) National Engineering Handbook Section 4: Hydrology, Soil Conservation Service, USDA, Washington. </p>
</body>
</html>
