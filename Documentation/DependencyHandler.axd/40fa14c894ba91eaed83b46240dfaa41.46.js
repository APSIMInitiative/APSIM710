
function MemberDirectory($,ko,settings){var opts=$.extend({},MemberDirectory.defaultSettings,settings);var serviceFramework=settings.servicesFramework;var baseServicepath=serviceFramework.getServiceRoot('MemberDirectory')+'MemberDirectory.ashx/';var pageIndex=0;var pageSize=opts.pageSize;var userId=opts.userId;var groupId=opts.groupId;var viewerId=opts.viewerId;var profileUrl=opts.profileUrl;var profileUrlUserToken=opts.profileUrlUserToken;var profilePicHandler=opts.profilePicHandler;var containerElement=null;function displayMessage(message,cssclass){var messageNode=$("<div/>").addClass('dnnFormMessage '+ cssclass).text(message);$(containerElement).prepend(messageNode);messageNode.fadeOut(3000,'easeInExpo',function(){messageNode.remove();});};function Member(item){var self=this;self.AddFriendText=opts.addFriendText;self.AcceptFriendText=opts.acceptFriendText;self.FriendPendingText=opts.friendPendingText;self.RemoveFriendText=opts.removeFriendText;self.FollowText=opts.followText;self.UnFollowText=opts.unFollowText;self.SendMessageText=opts.sendMessageText;self.UserNameText=opts.userNameText;self.EmailText=opts.emailText;self.CityText=opts.cityText;self.UserId=ko.observable(item.MemberId);self.LastName=ko.observable(item.LastName);self.FirstName=ko.observable(item.FirstName);self.UserName=ko.observable(item.UserName);self.DisplayName=ko.observable(item.DisplayName);self.Email=ko.observable(item.Email);self.IsUser=ko.observable(item.MemberId==viewerId);self.IsAuthenticated=(viewerId>0);self.FriendStatus=ko.observable(item.FriendStatus);self.FriendId=ko.observable(item.FriendId);self.IsFriend=ko.computed(function(){return self.FriendStatus()==2;},this);self.IsPending=ko.computed(function(){return self.FriendStatus()==1&&self.FriendId()!=viewerId;},this);self.HasPendingRequest=ko.computed(function(){return self.FriendStatus()==1&&self.FriendId()==viewerId;},this);self.FollowingStatus=ko.observable(item.FollowingStatus);self.IsFollowing=ko.computed(function(){return self.FollowingStatus()==2;},this);self.FollowerStatus=ko.observable(item.FollowerStatus);self.IsFollower=ko.computed(function(){return self.FollowerStatus()==2;},this);self.City=ko.observable(item.City);self.Title=ko.observable(item.Title);self.Country=ko.observable(item.Country);self.Phone=ko.observable(item.Phone);self.Website=ko.observable(item.Website);self.PhotoURL=ko.observable(item.PhotoURL);self.ProfileProperties=ko.observable(item.ProfileProperties);self.Location=ko.computed(function(){var city=self.City();var country=self.Country();var location=(city!=null)?city:'';if(location!=''&&country!=null&&country!=''){location +=', ';}
if(country!=null){location +=country;}
return location;});self.ProfileUrl=ko.computed(function(){return profileUrl.replace(profileUrlUserToken,self.UserId().toString());},this);self.getProfilePicture=function(w,h){return profilePicHandler.replace("{0}",self.PhotoURL()).replace("{1}",h).replace("{2}",w);};self.acceptFriend=function(){$.ajax({type:"POST",cache:false,url:baseServicepath +'AcceptFriend',beforeSend:serviceFramework.setModuleHeaders,data:serviceFramework.getAntiForgeryProperty({friendId:self.UserId})}).done(function(data){if(data.Result==="success"){self.FriendStatus(2);}else{displayMessage(settings.serverErrorText,"dnnFormWarning");}}).fail(function(xhr,status){displayMessage(settings.serverErrorWithDescriptionText + status,"dnnFormWarning");});};self.addFriend=function(){$.ajax({type:"POST",cache:false,url:baseServicepath +'AddFriend',beforeSend:serviceFramework.setModuleHeaders,data:serviceFramework.getAntiForgeryProperty({friendId:self.UserId})}).done(function(data){if(data.Result==="success"){self.FriendStatus(1);self.FriendId(self.UserId);}else{displayMessage(settings.serverErrorText,"dnnFormWarning");}}).fail(function(xhr,status){displayMessage(settings.serverErrorWithDescriptionText + status,"dnnFormWarning");});};self.follow=function(){$.ajax({type:"POST",cache:false,url:baseServicepath +'Follow',beforeSend:serviceFramework.setModuleHeaders,data:serviceFramework.getAntiForgeryProperty({followId:self.UserId})}).done(function(data){if(data.Result==="success"){self.FollowingStatus(2);}else{displayMessage(settings.serverErrorText,"dnnFormWarning");}}).fail(function(xhr,status){displayMessage(settings.serverErrorWithDescriptionText + status,"dnnFormWarning");});};self.removeFriend=function(){$.ajax({type:"POST",cache:false,url:baseServicepath +'RemoveFriend',beforeSend:serviceFramework.setModuleHeaders,data:serviceFramework.getAntiForgeryProperty({friendId:self.UserId})}).done(function(data){if(data.Result==="success"){self.FriendStatus(0);}else{displayMessage(settings.serverErrorText,"dnnFormWarning");}}).fail(function(xhr,status){displayMessage(settings.serverErrorWithDescriptionText + status,"dnnFormWarning");});};self.unFollow=function(){$.ajax({type:"POST",cache:false,url:baseServicepath +'UnFollow',beforeSend:serviceFramework.setModuleHeaders,data:serviceFramework.getAntiForgeryProperty({followId:self.UserId})}).done(function(data){if(data.Result==="success"){self.FollowingStatus(0);}else{displayMessage(settings.serverErrorText,"dnnFormWarning");}}).fail(function(xhr,status){displayMessage(settings.serverErrorWithDescriptionText + status,"dnnFormWarning");});};};function MemberDirectoryViewModel(initialData){var self=this;var initialMembers=$.map(initialData,function(item){return new Member(item);});self.Visible=ko.observable(true);self.Members=ko.observableArray(initialMembers);self.CanLoadMore=ko.observable(initialMembers.length==pageSize);self.SearchTerm=ko.observable('');self.ResetEnabled=ko.observable(false);self.HasMembers=ko.computed(function(){return self.Members().length>0;},this);self.AdvancedSearchTerm1=ko.observable('');self.AdvancedSearchTerm2=ko.observable('');self.AdvancedSearchTerm3=ko.observable('');self.AdvancedSearchTerm4=ko.observable('');self.LastSearch=ko.observable('Advanced');self.loadingData=ko.observable(false);self.advancedSearch=function(){pageIndex=0;self.SearchTerm('');self.xhrAdvancedSearch();self.LastSearch('Advanced');self.ResetEnabled(true);};self.basicSearch=function(){pageIndex=0;self.AdvancedSearchTerm1('');self.AdvancedSearchTerm2('');self.AdvancedSearchTerm3('');self.AdvancedSearchTerm4('');self.xhrBasicSearch();self.LastSearch('Basic');self.ResetEnabled(true);};self.getMember=function(item){self.SearchTerm(item.value);$.ajax({type:"GET",cache:false,url:baseServicepath +"GetMember",beforeSend:serviceFramework.setModuleHeaders,data:{userName:item.userName}}).done(function(members){if(typeof members!=="undefined"&&members!=null){var mappedMembers=$.map(members,function(member){return new Member(member);});self.Members(mappedMembers);self.CanLoadMore(false);}else{displayMessage(settings.serverErrorText,"dnnFormWarning");}}).fail(function(xhr,status){displayMessage(settings.serverErrorWithDescriptionText + status,"dnnFormWarning");});};self.getSuggestions=function(term,response){$.ajax({type:"GET",cache:false,url:baseServicepath +"GetSuggestions",beforeSend:serviceFramework.setModuleHeaders,data:{groupId:groupId,displayName:term}}).done(function(data){response(data);}).fail(function(){displayMessage(settings.searchErrorText,"dnnFormWarning");response({});});};self.handleAfterRender=function(elements,data){for(var i in elements){var element=elements[i];if(element.nodeType==1){var config={over:function(){$(this).find("div[id$='popUpPanel']").fadeIn("slow");},timeout:500,out:function(){$(this).find("div[id$='popUpPanel']").fadeOut("fast");}};$(element).hoverIntent(config);}}};self.isEven=function(item){return(self.Members.indexOf(item)%2==0);};self.loadMore=function(){pageIndex++;if(self.LastSearch()==='Advanced'){self.xhrAdvancedSearch();}
else{self.xhrBasicSearch();}};self.resetSearch=function(){self.SearchTerm('');self.AdvancedSearchTerm1('');self.AdvancedSearchTerm2('');self.AdvancedSearchTerm3('');self.AdvancedSearchTerm4('');self.xhrAdvancedSearch();self.LastSearch('Advanced');self.ResetEnabled(false);};self.xhrAdvancedSearch=function(){$.ajax({type:"GET",cache:false,url:baseServicepath +"AdvancedSearch",beforeSend:serviceFramework.setModuleHeaders,data:{userId:userId,groupId:groupId,pageIndex:pageIndex,pageSize:pageSize,searchTerm1:self.AdvancedSearchTerm1(),searchTerm2:self.AdvancedSearchTerm2(),searchTerm3:self.AdvancedSearchTerm3(),searchTerm4:self.AdvancedSearchTerm4()}}).done(function(members){if(typeof members!=="undefined"&&members!=null){var mappedMembers=$.map(members,function(item){return new Member(item);});if(pageIndex===0){self.Members(mappedMembers);}else{for(var i=0;i<mappedMembers.length;i++){self.Members.push(mappedMembers[i]);}}
self.CanLoadMore(mappedMembers.length==pageSize);}else{displayMessage(settings.searchErrorText,"dnnFormWarning");}}).fail(function(xhr,status){displayMessage(settings.searchErrorText,"dnnFormWarning");});};self.xhrBasicSearch=function(){$.ajax({type:"GET",cache:false,url:baseServicepath +"BasicSearch",beforeSend:serviceFramework.setModuleHeaders,data:{groupId:groupId,searchTerm:self.SearchTerm(),pageIndex:pageIndex,pageSize:pageSize}}).done(function(members){if(typeof members!=="undefined"&&members!=null){var mappedMembers=$.map(members,function(item){return new Member(item);});if(pageIndex===0){self.Members(mappedMembers);}else{for(var i=0;i<mappedMembers.length;i++){self.Members.push(mappedMembers[i]);}}
self.CanLoadMore(mappedMembers.length==pageSize);}else{displayMessage(settings.searchErrorText,"dnnFormWarning");}}).fail(function(xhr,status){displayMessage(settings.searchErrorText,"dnnFormWarning");});};};this.init=function(element){containerElement=element;$.ajax({type:"GET",cache:false,url:baseServicepath +"AdvancedSearch",beforeSend:serviceFramework.setModuleHeaders,data:{userId:userId,groupId:groupId,pageIndex:pageIndex,pageSize:pageSize,searchTerm1:'',searchTerm2:'',searchTerm3:'',searchTerm4:''}}).done(function(members){if(typeof members!=="undefined"&&members!=null){var viewModel=new MemberDirectoryViewModel(members);ko.applyBindings(viewModel,document.getElementById($(element).attr("id")));$('input#mdBasicSearch').autocomplete({source:function(request,response){viewModel.getSuggestions(request.term,response);return;},minLength:1,select:function(event,ui){viewModel.getMember(ui.item);}});$('a#mdAdvancedSearch').click(function(event){event.preventDefault();$('div#mdAdvancedSearchForm').slideDown();$(this).addClass("active");$(".mdSearch").addClass("active");});var timer;var cursorIsOnAdvancedSearchForm;$('a#mdAdvancedSearch').mouseleave(function(){timer=setTimeout(function(){if($('div#mdAdvancedSearchForm').is(':visible')&&!cursorIsOnAdvancedSearchForm){$('div#mdAdvancedSearchForm').hide();$(this).removeClass("active");$(".mdSearch").removeClass("active");}},150);});$('div#mdAdvancedSearchForm').mouseenter(function(){cursorIsOnAdvancedSearchForm=true;});$('div#mdAdvancedSearchForm').mouseleave(function(){clearTimeout(timer);cursorIsOnAdvancedSearchForm=false;$(this).hide();$('a#mdAdvancedSearch').removeClass("active");$(".mdSearch").removeClass("active");});$.fn.dnnComposeMessage({openTriggerSelector:containerElement +" .ComposeMessage",onPrePopulate:function(target){var context=ko.contextFor(target);var prePopulatedRecipients=[{id:"user-"+ context.$data.UserId(),name:context.$data.DisplayName()}];return prePopulatedRecipients;},servicesFramework:serviceFramework});}else{displayMessage(settings.serverErrorText,"dnnFormWarning");}}).fail(function(xhr,status){displayMessage(settings.serverErrorWithDescriptionText + status,"dnnFormWarning");});};}
MemberDirectory.defaultSettings={userId:-1,groupId:-1,viewerId:-1,profileUrl:"",profileUrlUserToken:"PROFILEUSER",addFriendText:"AddFriend",acceptFriendText:"AcceptFriend",friendPendingText:"FriendPendingText",removeFriendText:"RemoveFriendText",followText:"FollowText",unFollowText:"UnFollowText",sendMessageText:"SendMessageText",userNameText:"UserNameText",emailText:"EmailText",cityText:"CityText",serverErrorText:"ServerErrorText",serverErrorWithDescriptionText:"ServerErrorWithDescriptionText"};
;;;
(function(a,b){dnnModal={load:function(){try{if(parent.location.href!==undefined){var g=parent;var f=g.parent;if(typeof(f.$find)!="undefined"){if(location.href.indexOf("popUp")==-1||g.location.href.indexOf("popUp")>-1){var c=g.$("#iPopUp");var d=c.dialog("option","refresh");var h=c.dialog("option","closingUrl");if(h==""){h=location.href}if(c.dialog("isOpen")===true){c.dialog("option",{close:function(i,j){dnnModal.closePopUp(d,h)}}).dialog("close")}}else{g.$("#iPopUp").dialog({title:document.title})}}}}catch(e){return false}},show:function(c,m,j,d,f,i){var h=b("#iPopUp");if(h.length==0){h=b('<iframe id="iPopUp" src="about:blank" scrolling="auto" frameborder="0"></iframe>');b(document).find("html").css("overflow","hidden");b(document).append(h)}var k=parent;h.dialog({modal:true,autoOpen:true,dialogClass:"dnnFormPopup",position:"center",minWidth:d,minHeight:j,maxWidth:1920,maxHeight:1080,resizable:true,closeOnEscape:true,zIndex:100000,refresh:f,closingUrl:i,close:function(n,o){dnnModal.closePopUp(f,i)}}).width(d-11).height(j-11);if(b(".ui-dialog-title").next("a.dnnToggleMax").length===0){var g=b('<a href="#" class="dnnToggleMax"><span>Max</span></a>');b(".ui-dialog-title").after(g);g.click(function(r){r.preventDefault();var s=b(a),q=b(this),n,p,o;if(h.data("isMaximized")){n=h.data("height");p=h.data("width");o=h.data("position");h.data("isMaximized",false)}else{h.data("height",h.dialog("option","minHeight")).data("width",h.dialog("option","minWidth")).data("position",h.dialog("option","position"));n=s.height()-11;p=s.width()-11;o=[0,0];h.data("isMaximized",true)}q.toggleClass("ui-dialog-titlebar-max");h.dialog({height:n,width:p});h.dialog({position:"center"})})}var e=function(){var n=b('<div class="dnnLoading"></div>');n.css({width:h.width(),height:h.height()});h.before(n)};var l=function(){h.prev(".dnnLoading").remove()};e();h[0].src=c;h.bind("load",function(){l()});if(m.toString()=="true"){return false}},closePopUp:function(d,c){var e=parent;if(typeof d==="undefined"){d=true}if((typeof c==="undefined")||(c=="")){c=e.location}if(d.toString()=="true"){e.location.href=c;b(this).hide()}else{b(this).remove()}b(e.document).find("html").css("overflow","")}};dnnModal.load()}(window,jQuery));
;;;
var DNN_COL_DELIMITER=String.fromCharCode(16);var DNN_ROW_DELIMITER=String.fromCharCode(15);var __dnn_m_bPageLoaded=false;if(window.addEventListener)window.addEventListener("load",__dnn_Page_OnLoad,false);else window.attachEvent("onload",__dnn_Page_OnLoad);function __dnn_ClientAPIEnabled(){return typeof(dnn)!="undefined"}function __dnn_Page_OnLoad(){if(__dnn_ClientAPIEnabled()){var sLoadHandlers=dnn.getVar("__dnn_pageload");if(sLoadHandlers!=null){eval(sLoadHandlers)}dnn.dom.attachEvent(window,"onscroll",__dnn_bodyscroll)}__dnn_m_bPageLoaded=true}function __dnn_KeyDown(iKeyCode,sFunc,e){if(e==null){e=window.event}if(e.keyCode==iKeyCode){eval(unescape(sFunc));return false}}function __dnn_bodyscroll(){var a=document.forms[0];if(__dnn_ClientAPIEnabled()&&__dnn_m_bPageLoaded&&typeof(a.ScrollTop)!="undefined"){a.ScrollTop.value=document.documentElement.scrollTop?document.documentElement.scrollTop:dnn.dom.getByTagName("body")[0].scrollTop}}function __dnn_setScrollTop(c){if(__dnn_ClientAPIEnabled()){if(c==null){c=document.forms[0].ScrollTop.value}var a=dnn.getVar("ScrollToControl");if(a!=null&&a.length>0){var b=dnn.dom.getById(a);if(b!=null){c=dnn.dom.positioning.elementTop(b);dnn.setVar("ScrollToControl","")}}window.scrollTo(0,c)}}function __dnn_SetInitialFocus(a){var b=dnn.dom.getById(a);if(b!=null&&__dnn_CanReceiveFocus(b)){b.focus()}}function __dnn_CanReceiveFocus(b){if(b.style.display!="none"&&b.tabIndex>-1&&b.disabled==false&&b.style.visible!="hidden"){var a=b.parentElement;while(a!=null&&a.tagName!="BODY"){if(a.style.display=="none"||a.disabled||a.style.visible=="hidden"){return false}a=a.parentElement}return true}else{return false}}function __dnn_ContainerMaxMin_OnClick(i,b){var g=dnn.dom.getById(b);if(g!=null){var e=i.childNodes[0];var l=dnn.getVar("containerid_"+ b);var j=dnn.getVar("cookieid_"+ b);var d=e.src.toLowerCase().substr(e.src.lastIndexOf("../../../../../../index-2.html"));var a;var h;var k;if(dnn.getVar("min_icon_"+ l)){k=dnn.getVar("min_icon_"+ l)}else{k=dnn.getVar("min_icon")}if(dnn.getVar("max_icon_"+ l)){h=dnn.getVar("max_icon_"+ l)}else{h=dnn.getVar("max_icon")}a=h.toLowerCase().substr(h.lastIndexOf("../../../../../../index-2.html"));var c=5;var f=dnn.getVar("animf_"+ b);if(f!=null){c=new Number(f)}if(d==a){e.src=k;dnn.dom.expandElement(g,c);e.title=dnn.getVar("min_text");if(j!=null){if(dnn.getVar("__dnn_"+ l +":defminimized")=="true"){dnn.dom.setCookie(j,"true",365)}else{dnn.dom.deleteCookie(j)}}else{dnn.setVar("__dnn_"+ l +"_Visible","true")}}else{e.src=h;dnn.dom.collapseElement(g,c);e.title=dnn.getVar("max_text");if(j!=null){if(dnn.getVar("__dnn_"+ l +":defminimized")=="true"){dnn.dom.deleteCookie(j)}else{dnn.dom.setCookie(j,"false",365)}}else{dnn.setVar("__dnn_"+ l +"_Visible","false")}}return true}return false}function __dnn_Help_OnClick(a){var b=dnn.dom.getById(a);if(b!=null){if(b.style.display=="none"){b.style.display=""}else{b.style.display="none"}return true}return false}function __dnn_SectionMaxMin(f,c){var d=dnn.dom.getById(c);if(d!=null){var g=f.getAttribute("max_icon");var e=f.getAttribute("min_icon");var a=f.getAttribute("userctr")!=null;var b;if(d.style.display=="none"){f.src=e;d.style.display="";if(a){b="True"}else{dnn.setVar(f.id +":exp",1)}}else{f.src=g;d.style.display="none";if(a){b="False"}else{dnn.setVar(f.id +":exp",0)}}if(a){dnncore.setUserProp(f.getAttribute("userctr"),f.getAttribute("userkey"),b,null)}return true}return false}function __dnn_enableDragDrop(){var b=dnn.getVar("__dnn_dragDrop").split(";");var e;for(var c=0;c<b.length;c++){e=b[c].split(" ");if(e[0].length>0){var a=dnn.dom.getById(e[0]);var d=dnn.dom.getById(e[1]);if(a!=null&&d!=null){a.setAttribute("moduleid",e[2]);dnn.dom.positioning.enableDragAndDrop(a,d,"__dnn_dragComplete()","__dnn_dragOver()")}}}}var __dnn_oPrevSelPane;var __dnn_oPrevSelModule;var __dnn_dragEventCount=0;function __dnn_dragOver(){__dnn_dragEventCount++;if(__dnn_dragEventCount%75!=0){return}var c=dnn.dom.getById(dnn.dom.positioning.dragCtr.contID);var a=__dnn_getMostSelectedPane(dnn.dom.positioning.dragCtr);if(__dnn_oPrevSelPane!=null){__dnn_oPrevSelPane.pane.style.border=__dnn_oPrevSelPane.origBorder}if(a!=null){__dnn_oPrevSelPane=a;a.pane.style.border="4px double "+ DNN_HIGHLIGHT_COLOR;var e=__dnn_getPaneControlIndex(c,a);var b;var f;for(var d=0;d<a.controls.length;d++){if(e>d&&a.controls[d].id!=c.id){b=a.controls[d]}if(e<=d&&a.controls[d].id!=c.id){f=a.controls[d];break}}if(__dnn_oPrevSelModule!=null){dnn.dom.getNonTextNode(__dnn_oPrevSelModule.control).style.border=__dnn_oPrevSelModule.origBorder}if(f!=null){__dnn_oPrevSelModule=f;dnn.dom.getNonTextNode(f.control).style.borderTop="5px groove "+ DNN_HIGHLIGHT_COLOR}else{if(b!=null){__dnn_oPrevSelModule=b;dnn.dom.getNonTextNode(b.control).style.borderBottom="5px groove "+ DNN_HIGHLIGHT_COLOR}}}}function __dnn_dragComplete(){var f=dnn.dom.getById(dnn.dom.positioning.dragCtr.contID);var d=f.getAttribute("moduleid");if(__dnn_oPrevSelPane!=null){__dnn_oPrevSelPane.pane.style.border=__dnn_oPrevSelPane.origBorder}if(__dnn_oPrevSelModule!=null){dnn.dom.getNonTextNode(__dnn_oPrevSelModule.control).style.border=__dnn_oPrevSelModule.origBorder}var b=__dnn_getMostSelectedPane(dnn.dom.positioning.dragCtr);var e;if(b==null){var a=__dnn_Panes();for(var c=0;c<a.length;c++){if(a[c].id==f.parentNode.id){b=a[c]}}}if(b!=null){e=__dnn_getPaneControlIndex(f,b);__dnn_MoveToPane(b,f,e);dnn.callPostBack("MoveToPane","moduleid="+ d,"pane="+ b.paneName,"order="+ e*2)}}function __dnn_MoveToPane(a,e,d){if(a!=null){var c=new Array();for(var b=d;b<a.controls.length;b++){if(a.controls[b].control.id!=e.id){c[c.length]=a.controls[b].control}dnn.dom.removeChild(a.controls[b].control)}dnn.dom.appendChild(a.pane,e);e.style.top=0;e.style.left=0;e.style.position="relative";for(var b=0;b<c.length;b++){dnn.dom.appendChild(a.pane,c[b])}__dnn_RefreshPanes()}else{e.style.top=0;e.style.left=0;e.style.position="relative"}}function __dnn_RefreshPanes(){var b=dnn.getVar("__dnn_Panes").split(";");var a=dnn.getVar("__dnn_PaneNames").split(";");__dnn_m_aryPanes=new Array();for(var c=0;c<b.length;c++){if(b[c].length>0){__dnn_m_aryPanes[__dnn_m_aryPanes.length]=new __dnn_Pane(dnn.dom.getById(b[c]),a[c])}}}var __dnn_m_aryPanes;var __dnn_m_aryModules;function __dnn_Panes(){if(__dnn_m_aryPanes==null){__dnn_m_aryPanes=new Array();__dnn_RefreshPanes()}return __dnn_m_aryPanes}function __dnn_Modules(a){if(__dnn_m_aryModules==null){__dnn_RefreshPanes()}return __dnn_m_aryModules[a]}function __dnn_getMostSelectedPane(g){var c=new dnn.dom.positioning.dims(g);var f=0;var a;var h;for(var e=0;e<__dnn_Panes().length;e++){var b=__dnn_Panes()[e];var d=new dnn.dom.positioning.dims(b.pane);a=dnn.dom.positioning.elementOverlapScore(d,c);if(a>f){f=a;h=b}}return h}function __dnn_getPaneControlIndex(f,b){if(b==null){return}var a=new dnn.dom.positioning.dims(f);var e;if(b.controls.length==0){return 0}for(var c=0;c<b.controls.length;c++){e=b.controls[c];var d=new dnn.dom.positioning.dims(e.control);if(a.t<d.t){return e.index}}if(e!=null){return e.index + 1}else{return 0}}function __dnn_Pane(a,b){this.pane=a;this.id=a.id;this.controls=new Array();this.origBorder=a.style.border;this.paneName=b;var f=0;var e="";for(var d=0;d<a.childNodes.length;d++){var g=a.childNodes[d];if(dnn.dom.isNonTextNode(g)){if(__dnn_m_aryModules==null){__dnn_m_aryModules=new Array()}var c=g.getAttribute("moduleid");if(c!=null&&c.length>0){e +=c +"~";this.controls[this.controls.length]=new __dnn_PaneControl(g,f);__dnn_m_aryModules[c]=g.id;f +=1}}}this.moduleOrder=e}function __dnn_PaneControl(a,b){this.control=a;this.id=a.id;this.index=b;this.origBorder=a.style.border}function __dnncore(){this.GetUserVal=0;this.SetUserVal=1}__dnncore.prototype={getUserProp:function(b,c,a){this._doUserCallBack(dnncore.GetUserVal,b,c,null,new dnncore.UserPropArgs(b,c,a))},setUserProp:function(c,d,a,b){this._doUserCallBack(dnncore.SetUserVal,c,d,a,new dnncore.UserPropArgs(c,d,b))},_doUserCallBack:function(c,d,e,a,b){if(dnn&&dnn.xmlhttp){var f=c + COL_DELIMITER + d + COL_DELIMITER + e + COL_DELIMITER + a;dnn.xmlhttp.doCallBack("__Page",f,dnncore._callBackSuccess,b,dnncore._callBackFail,null,true,null,0)}else{alert("Client Personalization not enabled")}},_callBackSuccess:function(a,b,c){if(b.pFunc){b.pFunc(b.namingCtr,b.key,a)}},_callBackFail:function(a,b){window.status=a}};__dnncore.prototype.UserPropArgs=function(b,c,a){this.namingCtr=b;this.key=c;this.pFunc=a};var dnncore=new __dnncore();
;;;
(function($){$.fn.dnnConsole=function(options){var opts=$.extend({},$.fn.dnnConsole.defaults,options);$(this).find("img").each(function(){this.style.borderWidth="0px";});if(opts.showTooltip&&opts.showDetails!="Show"){$(this).find("div > div").each(function(){var $this=$(this);var $title=$this.find("h3");var $desc=$this.find("div");var tooltip="";if($title.length>0){tooltip=$title.text();}
if($desc.length>0){if(tooltip!="")
tooltip +=" - ";tooltip +=$desc.text();}
if(tooltip!="")
this.title +=tooltip;});}
function _changeView(jObj){var classList="console-none console-none-detail console-small console-large console-small-detail console-large-detail";switch(opts.selectedSize){case"IconFile":style="console-small";$(jObj).find("div > div img").hide();$(jObj).find("div > div img:first-child").show();break;case"IconFileLarge":$(jObj).find("div > div img").show();$(jObj).find("div > div img:first-child").hide();style="console-large";break;case"IconNone":$(jObj).find("div > div img").hide();$(jObj).find("div > div img:first-child").hide();style="console-none";break;}
style +=opts.showDetails=="Show"?"-detail":"";$(jObj).find("div").removeClass(classList).addClass(style);opts.currentClass=style;}
$(this).find("div > div").bind("click",function(){if($(this).children("a").length>0)
window.location.href=$(this).children("a")[0].href;});$(this).find("div > div").hover(function(e){$(this).addClass("console-mouseon");},function(e){$(this).removeClass("console-mouseon");});var self=this;$(this).find("select").bind("change",function(){var data="";if(this.value=="IconFile"||this.value=="IconFileLarge"||this.value=="IconNone"){opts.selectedSize=this.value;data="CS="+ opts.selectedSize;}
if(this.value=="Show"||this.value=="Hide"){opts.showDetails=this.value;data="CV="+ opts.showDetails;}
_changeView(self,opts);if(data!=""){if(opts.tabModuleID.toString()!="-1"){data=data +"&CTMID="+ opts.tabModuleID.toString();$.ajax({type:'get',data:data,error:function(){return;},success:function(msg){return;}});}}});_changeView(this);return this;};$.fn.dnnConsole.defaults={allowIconSizeChange:true,allowDetailChange:true,selectedSize:'IconFile',showDetails:'Hide',showTooltip:true};})(jQuery);
;;;
(function($){$.dnnSF=function(moduleId){var base=this;base.getServiceRoot=function(moduleName){var serviceRoot=dnn.getVar("sf_siteRoot","../../../../../../index-2.html");serviceRoot +="DesktopModules/"+ moduleName +"/API/";return serviceRoot;};base.getTabId=function(){return dnn.getVar("sf_tabId",-1);};base.getModuleId=function(){return moduleId;};base.setModuleHeaders=function(xhr){xhr.setRequestHeader("ModuleId",base.getModuleId());xhr.setRequestHeader("TabId",base.getTabId());};base.getAntiForgeryKey=function(){return"__RequestVerificationToken";};base.getAntiForgeryValue=function(){return $('[name="__RequestVerificationToken"]').val();};base.getAntiForgeryProperty=function(hash){if(!hash){hash={};}hash[base.getAntiForgeryKey()]=base.getAntiForgeryValue();return hash;};return base;};$.ServicesFramework=function(moduleId){return new $.dnnSF(moduleId);};})(jQuery);
;;;
(function($){$.fn.dnnTabs=function(options){var opts=$.extend({},$.fn.dnnTabs.defaultOptions,options),$wrap=this;$.ui.tabs.prototype._sanitizeSelector=function(hash){return hash.replace(/:/g,"\\:").replace(/\./g,"\\\.");};$wrap.each(function(){var showEvent=null,cookieId;if(this.id){cookieId='dnnTabs-'+ this.id;if(opts.selected===-1){var cookieValue=dnn.dom.getCookie(cookieId);if(cookieValue){opts.selected=cookieValue;}
if(opts.selected===-1){opts.selected=0;}}}
showEvent=(function(cookieId){return function(event,ui){dnn.dom.setCookie(cookieId,ui.index,opts.cookieDays,'../../../../../../index-2.html','',false,opts.cookieMilleseconds);}})(cookieId);$wrap.tabs({show:showEvent,selected:opts.selected,disabled:opts.disabled,fx:{opacity:opts.opacity,duration:opts.duration}});if(typeof Page_ClientValidate!="undefined"&&$.isFunction(Page_ClientValidate)){$wrap.find(opts.validationTriggerSelector).click(function(e){if(!Page_ClientValidate(opts.validationGroup)){var invalidControl=$wrap.find(opts.invalidItemSelector).eq(0);var $parent=invalidControl.closest(".ui-tabs-panel");if($parent.length>0){var tabId=$parent.attr("id");$parent.parent().find("a[href='#"+ tabId +"']").click();}}});};});return $wrap;};$.fn.dnnTabs.defaultOptions={opacity:'toggle',duration:'fast',validationTriggerSelector:'.dnnPrimaryAction',validationGroup:'',invalidItemSelector:'.dnnFormError[style*="inline"]',regionToToggleSelector:'fieldset',selected:-1,cookieDays:0,cookieMilleseconds:120000};})(jQuery);(function($){$.fn.dnnConfirm=function(options){var opts=$.extend({},$.fn.dnnConfirm.defaultOptions,options),$wrap=this;$wrap.each(function(){var $this=$(this),defaultAction=$this.attr('href'),$dnnDialog;if(defaultAction||opts.isButton){$dnnDialog=$("<div class='dnnDialog'></div>").html(opts.text).dialog(opts);$this.click(function(e){if($dnnDialog.is(':visible')){$dnnDialog.dialog("close");return true;}
e.preventDefault();$dnnDialog.dialog({open:function(e){$('.ui-dialog-buttonpane').find('button:contains("'+ opts.noText +'")').addClass('dnnConfirmCancel');},position:'center',buttons:[{text:opts.yesText,click:function(){$dnnDialog.dialog("close");if($.isFunction(opts.callbackTrue)){opts.callbackTrue.call(this);}
else{if(opts.isButton){$this.click();}
else{window.location.href=defaultAction;}}}},{text:opts.noText,click:function(){$(this).dialog("close");if($.isFunction(opts.callbackFalse)){opts.callbackFalse.call(this);};}}]});$dnnDialog.dialog('open');});}});return $wrap;};$.fn.dnnConfirm.defaultOptions={text:'Are you sure?',yesText:'Yes',noText:'No',actionUrl:window.location.href,autoOpen:false,resizable:false,modal:true,title:'Confirm',dialogClass:'dnnFormPopup dnnClear',isButton:false};})(jQuery);(function($){$.dnnAlert=function(options){var opts=$.extend({},$.dnnAlert.defaultOptions,options),$dnnDialog=$("<div class='dnnDialog'></div>").html(opts.text).dialog(opts);$dnnDialog.dialog({buttons:[{text:opts.okText,click:function(){$(this).dialog("close");if($.isFunction(opts.callback)){opts.callback.call(this);};return false;}}]});$dnnDialog.dialog('open');}
$.dnnAlert.defaultOptions={okText:'Ok',autoOpen:false,resizable:false,modal:true,dialogClass:'dnnFormPopup dnnClear'};})(jQuery);(function($){$.fn.dnnPanels=function(options){var opts=$.extend({},$.fn.dnnPanels.defaultOptions,options),$wrap=this;$wrap.each(function(){var $this=$(this);$this.find(opts.clickToToggleSelector).click(function(e){e.preventDefault();var toggle=$(this).toggleClass(opts.toggleClass).parent().next(opts.regionToToggleSelector).slideToggle(function(){var id=$(toggle.context.parentNode).attr("id");dnn.dom.setCookie(id,$(this).is(':visible'),opts.cookieDays,'../../../../../../index-2.html','',false,opts.cookieMilleseconds);});});function collapsePanel($clicker,$region){$clicker.removeClass(opts.toggleClass);$region.hide();}
function expandPanel($clicker,$region){$clicker.addClass(opts.toggleClass);$region.show();}
$this.find(opts.sectionHeadSelector).each(function(indexInArray,valueOfElement){var $this=$(valueOfElement),elementId=$this.attr("id"),cookieValue=dnn.dom.getCookie(elementId),$clicker=$this.find(opts.clickToToggleIsolatedSelector),$region=$this.next(opts.regionToToggleSelector),$parentSeparator=$this.parents(opts.panelSeparatorSelector),groupPanelIndex=$parentSeparator.find(opts.sectionHeadSelector).index($this)
if(cookieValue=="false"){collapsePanel($clicker,$region);}
else if(cookieValue=="true"||indexInArray===0){expandPanel($clicker,$region);}
else if($parentSeparator.size()>0&&groupPanelIndex===0){expandPanel($clicker,$region);}
else{collapsePanel($clicker,$region);}});$this.find(opts.validationTriggerSelector).click(function(e){if(typeof Page_ClientValidate!="undefined"&&$.isFunction(Page_ClientValidate)){if(!Page_ClientValidate(opts.validationGroup)){$this.find(opts.invalidItemSelector).each(function(){var $parent=$(this).closest(opts.regionToToggleSelector);if($parent.is(':hidden')){$parent.prev(opts.sectionHeadSelector).find(opts.clickToToggleIsolatedSelector).click();}});}}});});return $wrap;};$.fn.dnnPanels.defaultOptions={clickToToggleSelector:'h2.dnnFormSectionHead a',sectionHeadSelector:'.dnnFormSectionHead',regionToToggleSelector:'fieldset',toggleClass:'dnnSectionExpanded',clickToToggleIsolatedSelector:'a',validationTriggerSelector:'.dnnPrimaryAction',invalidItemSelector:'.dnnFormError[style*="inline"]',validationGroup:'',panelSeparatorSelector:'.ui-tabs-panel',cookieDays:0,cookieMilleseconds:120000};})(jQuery);(function($){$.fn.dnnPreview=function(options){var opts=$.extend({},$.fn.dnnPreview.defaultOptions,options),$wrap=this;$wrap.each(function(){var $this=$(this);$this.find(opts.linkSelector).click(function(e){e.preventDefault();var params="?";var skin=$this.find(opts.skinSelector).val();var container=$this.find(opts.containerSelector).val();if(skin){params +="SkinSrc="+ skin;}
if(container){if(skin){params +="&";}
params +="ContainerSrc="+ container;}
if(params!="?"){window.open(encodeURI(opts.baseUrl + params.replace(/.ascx/gi,'')),"skinpreview");}
else{$.dnnAlert({text:opts.noSelectionMessage,okText:opts.alertOkText,closeText:opts.alertCloseText});}});});return $wrap;};$.fn.dnnPreview.defaultOptions={baseUrl:window.location.protocol +"//"+ window.location.host + window.location.pathname,linkSelector:'a.dnnSecondaryAction',skinSelector:'',containerSelector:'',noSelectionMessage:'Please select a preview option.',alertOkText:'Ok',alertCloseText:'close'};})(jQuery);(function($){$.fn.dnnExpandAll=function(options){var opts=$.extend({},$.fn.dnnExpandAll.defaultOptions,options),$elem=this;if(($(opts.targetArea).find(opts.targetSelector +':visible').length===$(opts.targetArea).find(opts.targetSelector + opts.targetExpandedSelector +':visible').length)&&!$(this).hasClass('expanded')){$(this).addClass('expanded').text(opts.collapseText);}
$elem.click(function(e){e.preventDefault();var $this=$(this);if($this.hasClass('expanded')){$this.removeClass('expanded').text(opts.expandText);$(opts.targetArea).find(opts.targetSelector + opts.targetExpandedSelector +':visible').click();}
else{$this.addClass('expanded').text(opts.collapseText);$(opts.targetArea).find(opts.targetSelector +':visible').not(opts.targetExpandedSelector).click();}});return $elem;};$.fn.dnnExpandAll.defaultOptions={expandText:'Expand All',collapseText:'Collapse All',targetArea:'#dnnHostSettings',targetSelector:'h2.dnnFormSectionHead a',targetExpandedSelector:'.dnnSectionExpanded'};})(jQuery);(function($){$.fn.dnnTooltip=function(options){var opts=$.extend({},$.fn.dnnTooltip.defaultOptions,options),$wrap=this;$wrap.each(function(){var $this=$(this);$this.find('a').not(opts.helpSelector +' a').click(function(e){e.preventDefault();});$wrap.data("left",$wrap.position().left).data("top",$wrap.position().top);$this.hoverIntent({over:function(){$this.find(opts.helpSelector).show();},out:function(){if(!$this.hasClass(opts.pinnedClass)){$this.find(opts.helpSelector).hide();}},timeout:200,interval:200});$this.find(opts.pinSelector).click(function(e){e.preventDefault();if($this.hasClass(opts.pinnedClass)){$this.find(opts.helpSelector).animate({"left":$wrap.data("left"),"top":$wrap.data("top")},"fast",function(){$this.removeClass(opts.pinnedClass);$(this).hide().draggable('destroy');});}
else{$this.addClass(opts.pinnedClass);if($.isFunction($().draggable)){$this.find(opts.helpSelector).draggable();}}});});return $wrap;};$.fn.dnnTooltip.defaultOptions={pinSelector:'a.pinHelp',helpSelector:'.dnnFormHelpContent',pinnedClass:'dnnTooltipPinned'};})(jQuery);
;;;
(function($){$.fn.dnnControlPanel=function(options){var opts=$.extend({},$.fn.dnnControlPanel.defaultOptions,options),$wrap=this;return $wrap.each(function(){var $controlPanel=$(this);$controlPanel.wrap(function(){return opts.wrappingHtml;});if($('[id$="CommonTasksPanel"]').length>0)$('[id$="CommonTasksPanel"]').detach().appendTo('#dnnCommonTasks .megaborder');else $('#dnnCommonTasks').remove();$('[id$="CurrentPagePanel"]').detach().appendTo('#dnnCurrentPage .megaborder');if($('[id$="AdminPanel"]').length>0)$('[id$="AdminPanel"]').detach().appendTo('#dnnOtherTools .megaborder');else $('#dnnOtherTools').remove();var $wrapper=$('#dnnCPWrap');if($wrapper.hasClass('Pinned')){$wrapper.parent().css({paddingBottom:'0'});}
else{$(document.body).css({marginTop:$wrapper.outerHeight()});}
$.fn.dnnControlPanel.show=function(){$controlPanel.parents(opts.controlPanelWrapper).slideDown();}
$.fn.dnnControlPanel.hide=function(){$controlPanel.parents(opts.controlPanelWrapper).slideUp();}
var canHide=false,forceShow=false,$controlPanel=$(this);function EnableHide(){if(!forceShow)canHide=true;}
function megaHoverOver(){hideAll();var menuSelector=$(this).parent().find(opts.menuBorderSelector);if($.browser.msie&&menuSelector.prev("iframe").length==0){var mask=$("<iframe frameborder=\"0\"></iframe>");menuSelector.before(mask);mask.css({position:"absolute",width:menuSelector.outerWidth()+"px",height:menuSelector.outerHeight()+"px",left:menuSelector.position().left +"px",top:menuSelector.position().top +"px",opacity:0});}
menuSelector.stop().fadeTo('fast',1).show();}
function hideAll(){$controlPanel.find(opts.menuBorderSelector).stop().fadeTo('fast',0,function(){if($.browser.msie)$(this).prev("iframe").remove();$(this).hide();});}
var config={sensitivity:2,interval:200,over:megaHoverOver,timeout:100,out:function(){return null;}};var hideConfig={sensitivity:2,interval:1,over:function(){return;},timeout:300,out:function(){if(canHide)hideAll();}};$controlPanel.find(opts.menuBorderSelector).css({'opacity':'0'});$controlPanel.find(opts.menuBorderSelector).find(opts.primaryActionSelector).css({opacity:1});$controlPanel.find(opts.menuItemSelector).mouseenter(EnableHide);$(document).dblclick(function(){if(!canHide)
hideAll();});$controlPanel.dblclick(function(e){e.stopPropagation();});$(document).keyup(function(e){if(e.keyCode==27){hideAll();}});$controlPanel.find(opts.menuItemActionSelector).hoverIntent(config);$controlPanel.find(opts.menuItemSelector).hoverIntent(hideConfig);$controlPanel.find(opts.enableAutohideOnFocusSelector).focus(function(){canHide=true;});$controlPanel.find(opts.persistOnMouseoverSelector).live('mouseover',function(){canHide=false;});$controlPanel.find(opts.persistOnWaitForChangeSelector).live('click',function(){forceShow=true;canHide=false;setTimeout(function(){$(document).one("click",function(){forceShow=false;canHide=true;});},0);});$controlPanel.find(opts.persistOnFocusSelector).live('focus',function(){canHide=false;});});};$.fn.dnnControlPanel.defaultOptions={wrappingHtml:'<div id="dnnCPWrap"><div id="dnnCPWrapLeft"><div id="dnnCPWrapRight"></div></div></div>',persistOnFocusSelector:'select, input',persistOnMouseoverSelector:'.rcbSlide li',persistOnWaitForChangeSelector:'.RadComboBox',enableAutohideOnFocusSelector:'.dnnadminmega .megaborder',menuItemActionSelector:'.dnnadminmega > li > a',menuItemSelector:'.dnnadminmega > li',menuBorderSelector:'.megaborder',primaryActionSelector:'.dnnPrimaryAction',controlPanelWrapper:'#dnnCPWrap'};$(document).ready(function(){$('.dnnControlPanel').dnnControlPanel();});})(jQuery);
;;;
(function($){var ver="2.99";if($.support==undefined){$.support={opacity:!($.browser.msie)};}function debug(s){$.fn.cycle.debug&&log(s);}function log(){window.console&&console.log&&console.log("[cycle] "+Array.prototype.join.call(arguments," "));}$.expr[":"].paused=function(el){return el.cyclePause;};$.fn.cycle=function(options,arg2){var o={s:this.selector,c:this.context};if(this.length===0&&options!="stop"){if(!$.isReady&&o.s){log("DOM not ready, queuing slideshow");$(function(){$(o.s,o.c).cycle(options,arg2);});return this;}log("terminating; zero elements found by selector"+($.isReady?"":" (DOM not ready)"));return this;}return this.each(function(){var opts=handleArguments(this,options,arg2);if(opts===false){return;}opts.updateActivePagerLink=opts.updateActivePagerLink||$.fn.cycle.updateActivePagerLink;if(this.cycleTimeout){clearTimeout(this.cycleTimeout);}this.cycleTimeout=this.cyclePause=0;var $cont=$(this);var $slides=opts.slideExpr?$(opts.slideExpr,this):$cont.children();var els=$slides.get();if(els.length<2){log("terminating; too few slides: "+els.length);return;}var opts2=buildOptions($cont,$slides,els,opts,o);if(opts2===false){return;}var startTime=opts2.continuous?10:getTimeout(els[opts2.currSlide],els[opts2.nextSlide],opts2,!opts2.backwards);if(startTime){startTime+=(opts2.delay||0);if(startTime<10){startTime=10;}debug("first timeout: "+startTime);this.cycleTimeout=setTimeout(function(){go(els,opts2,0,!opts.backwards);},startTime);}});};function handleArguments(cont,options,arg2){if(cont.cycleStop==undefined){cont.cycleStop=0;}if(options===undefined||options===null){options={};}if(options.constructor==String){switch(options){case"destroy":case"stop":var opts=$(cont).data("cycle.opts");if(!opts){return false;}cont.cycleStop++;if(cont.cycleTimeout){clearTimeout(cont.cycleTimeout);}cont.cycleTimeout=0;$(cont).removeData("cycle.opts");if(options=="destroy"){destroy(opts);}return false;case"toggle":cont.cyclePause=(cont.cyclePause===1)?0:1;checkInstantResume(cont.cyclePause,arg2,cont);return false;case"pause":cont.cyclePause=1;return false;case"resume":cont.cyclePause=0;checkInstantResume(false,arg2,cont);return false;case"prev":case"next":var opts=$(cont).data("cycle.opts");if(!opts){log('options not found, "prev/next" ignored');return false;}$.fn.cycle[options](opts);return false;default:options={fx:options};}return options;}else{if(options.constructor==Number){var num=options;options=$(cont).data("cycle.opts");if(!options){log("options not found, can not advance slide");return false;}if(num<0||num>=options.elements.length){log("invalid slide index: "+num);return false;}options.nextSlide=num;if(cont.cycleTimeout){clearTimeout(cont.cycleTimeout);cont.cycleTimeout=0;}if(typeof arg2=="string"){options.oneTimeFx=arg2;}go(options.elements,options,1,num>=options.currSlide);return false;}}return options;function checkInstantResume(isPaused,arg2,cont){if(!isPaused&&arg2===true){var options=$(cont).data("cycle.opts");if(!options){log("options not found, can not resume");return false;}if(cont.cycleTimeout){clearTimeout(cont.cycleTimeout);cont.cycleTimeout=0;}go(options.elements,options,1,!options.backwards);}}}function removeFilter(el,opts){if(!$.support.opacity&&opts.cleartype&&el.style.filter){try{el.style.removeAttribute("filter");}catch(smother){}}}function destroy(opts){if(opts.next){$(opts.next).unbind(opts.prevNextEvent);}if(opts.prev){$(opts.prev).unbind(opts.prevNextEvent);}if(opts.pager||opts.pagerAnchorBuilder){$.each(opts.pagerAnchors||[],function(){this.unbind().remove();});}opts.pagerAnchors=null;if(opts.destroy){opts.destroy(opts);}}function buildOptions($cont,$slides,els,options,o){var opts=$.extend({},$.fn.cycle.defaults,options||{},$.metadata?$cont.metadata():$.meta?$cont.data():{});if(opts.autostop){opts.countdown=opts.autostopCount||els.length;}var cont=$cont[0];$cont.data("cycle.opts",opts);opts.$cont=$cont;opts.stopCount=cont.cycleStop;opts.elements=els;opts.before=opts.before?[opts.before]:[];opts.after=opts.after?[opts.after]:[];if(!$.support.opacity&&opts.cleartype){opts.after.push(function(){removeFilter(this,opts);});}if(opts.continuous){opts.after.push(function(){go(els,opts,0,!opts.backwards);});}saveOriginalOpts(opts);if(!$.support.opacity&&opts.cleartype&&!opts.cleartypeNoBg){clearTypeFix($slides);}if($cont.css("position")=="static"){$cont.css("position","relative");}if(opts.width){$cont.width(opts.width);}if(opts.height&&opts.height!="auto"){$cont.height(opts.height);}if(opts.startingSlide){opts.startingSlide=parseInt(opts.startingSlide);}else{if(opts.backwards){opts.startingSlide=els.length-1;}}if(opts.random){opts.randomMap=[];for(var i=0;i<els.length;i++){opts.randomMap.push(i);}opts.randomMap.sort(function(a,b){return Math.random()-0.5;});opts.randomIndex=1;opts.startingSlide=opts.randomMap[1];}else{if(opts.startingSlide>=els.length){opts.startingSlide=0;}}opts.currSlide=opts.startingSlide||0;var first=opts.startingSlide;$slides.css({position:"absolute",top:0,left:0}).hide().each(function(i){var z;if(opts.backwards){z=first?i<=first?els.length+(i-first):first-i:els.length-i;}else{z=first?i>=first?els.length-(i-first):first-i:els.length-i;}$(this).css("z-index",z);});$(els[first]).css("opacity",1).show();removeFilter(els[first],opts);if(opts.fit&&opts.width){$slides.width(opts.width);}if(opts.fit&&opts.height&&opts.height!="auto"){$slides.height(opts.height);}var reshape=opts.containerResize&&!$cont.innerHeight();if(reshape){var maxw=0,maxh=0;for(var j=0;j<els.length;j++){var $e=$(els[j]),e=$e[0],w=$e.outerWidth(),h=$e.outerHeight();if(!w){w=e.offsetWidth||e.width||$e.attr("width");}if(!h){h=e.offsetHeight||e.height||$e.attr("height");}maxw=w>maxw?w:maxw;maxh=h>maxh?h:maxh;}if(maxw>0&&maxh>0){$cont.css({width:maxw+"px",height:maxh+"px"});}}if(opts.pause){$cont.hover(function(){this.cyclePause++;},function(){this.cyclePause--;});}if(supportMultiTransitions(opts)===false){return false;}var requeue=false;options.requeueAttempts=options.requeueAttempts||0;$slides.each(function(){var $el=$(this);this.cycleH=(opts.fit&&opts.height)?opts.height:($el.height()||this.offsetHeight||this.height||$el.attr("height")||0);this.cycleW=(opts.fit&&opts.width)?opts.width:($el.width()||this.offsetWidth||this.width||$el.attr("width")||0);if($el.is("img")){var loadingIE=($.browser.msie&&this.cycleW==28&&this.cycleH==30&&!this.complete);var loadingFF=($.browser.mozilla&&this.cycleW==34&&this.cycleH==19&&!this.complete);var loadingOp=($.browser.opera&&((this.cycleW==42&&this.cycleH==19)||(this.cycleW==37&&this.cycleH==17))&&!this.complete);var loadingOther=(this.cycleH==0&&this.cycleW==0&&!this.complete);if(loadingIE||loadingFF||loadingOp||loadingOther){if(o.s&&opts.requeueOnImageNotLoaded&&++options.requeueAttempts<100){log(options.requeueAttempts," - img slide not loaded, requeuing slideshow: ",this.src,this.cycleW,this.cycleH);setTimeout(function(){$(o.s,o.c).cycle(options);},opts.requeueTimeout);requeue=true;return false;}else{log("could not determine size of image: "+this.src,this.cycleW,this.cycleH);}}}return true;});if(requeue){return false;}opts.cssBefore=opts.cssBefore||{};opts.cssAfter=opts.cssAfter||{};opts.cssFirst=opts.cssFirst||{};opts.animIn=opts.animIn||{};opts.animOut=opts.animOut||{};$slides.not(":eq("+first+")").css(opts.cssBefore);$($slides[first]).css(opts.cssFirst);if(opts.timeout){opts.timeout=parseInt(opts.timeout);if(opts.speed.constructor==String){opts.speed=$.fx.speeds[opts.speed]||parseInt(opts.speed);}if(!opts.sync){opts.speed=opts.speed/2;}var buffer=opts.fx=="none"?0:opts.fx=="shuffle"?500:250;while((opts.timeout-opts.speed)<buffer){opts.timeout+=opts.speed;}}if(opts.easing){opts.easeIn=opts.easeOut=opts.easing;}if(!opts.speedIn){opts.speedIn=opts.speed;}if(!opts.speedOut){opts.speedOut=opts.speed;}opts.slideCount=els.length;opts.currSlide=opts.lastSlide=first;if(opts.random){if(++opts.randomIndex==els.length){opts.randomIndex=0;}opts.nextSlide=opts.randomMap[opts.randomIndex];}else{if(opts.backwards){opts.nextSlide=opts.startingSlide==0?(els.length-1):opts.startingSlide-1;}else{opts.nextSlide=opts.startingSlide>=(els.length-1)?0:opts.startingSlide+1;}}if(!opts.multiFx){var init=$.fn.cycle.transitions[opts.fx];if($.isFunction(init)){init($cont,$slides,opts);}else{if(opts.fx!="custom"&&!opts.multiFx){log("unknown transition: "+opts.fx,"; slideshow terminating");return false;}}}var e0=$slides[first];if(opts.before.length){opts.before[0].apply(e0,[e0,e0,opts,true]);}if(opts.after.length){opts.after[0].apply(e0,[e0,e0,opts,true]);}if(opts.next){$(opts.next).bind(opts.prevNextEvent,function(){return advance(opts,1);});}if(opts.prev){$(opts.prev).bind(opts.prevNextEvent,function(){return advance(opts,0);});}if(opts.pager||opts.pagerAnchorBuilder){buildPager(els,opts);}exposeAddSlide(opts,els);return opts;}function saveOriginalOpts(opts){opts.original={before:[],after:[]};opts.original.cssBefore=$.extend({},opts.cssBefore);opts.original.cssAfter=$.extend({},opts.cssAfter);opts.original.animIn=$.extend({},opts.animIn);opts.original.animOut=$.extend({},opts.animOut);$.each(opts.before,function(){opts.original.before.push(this);});$.each(opts.after,function(){opts.original.after.push(this);});}function supportMultiTransitions(opts){var i,tx,txs=$.fn.cycle.transitions;if(opts.fx.indexOf(",")>0){opts.multiFx=true;opts.fxs=opts.fx.replace(/\s*/g,"").split(",");for(i=0;i<opts.fxs.length;i++){var fx=opts.fxs[i];tx=txs[fx];if(!tx||!txs.hasOwnProperty(fx)||!$.isFunction(tx)){log("discarding unknown transition: ",fx);opts.fxs.splice(i,1);i--;}}if(!opts.fxs.length){log("No valid transitions named; slideshow terminating.");return false;}}else{if(opts.fx=="all"){opts.multiFx=true;opts.fxs=[];for(p in txs){tx=txs[p];if(txs.hasOwnProperty(p)&&$.isFunction(tx)){opts.fxs.push(p);}}}}if(opts.multiFx&&opts.randomizeEffects){var r1=Math.floor(Math.random()*20)+30;for(i=0;i<r1;i++){var r2=Math.floor(Math.random()*opts.fxs.length);opts.fxs.push(opts.fxs.splice(r2,1)[0]);}debug("randomized fx sequence: ",opts.fxs);}return true;}function exposeAddSlide(opts,els){opts.addSlide=function(newSlide,prepend){var $s=$(newSlide),s=$s[0];if(!opts.autostopCount){opts.countdown++;}els[prepend?"unshift":"push"](s);if(opts.els){opts.els[prepend?"unshift":"push"](s);}opts.slideCount=els.length;$s.css("position","absolute");$s[prepend?"prependTo":"appendTo"](opts.$cont);if(prepend){opts.currSlide++;opts.nextSlide++;}if(!$.support.opacity&&opts.cleartype&&!opts.cleartypeNoBg){clearTypeFix($s);}if(opts.fit&&opts.width){$s.width(opts.width);}if(opts.fit&&opts.height&&opts.height!="auto"){$s.height(opts.height);}s.cycleH=(opts.fit&&opts.height)?opts.height:$s.height();s.cycleW=(opts.fit&&opts.width)?opts.width:$s.width();$s.css(opts.cssBefore);if(opts.pager||opts.pagerAnchorBuilder){$.fn.cycle.createPagerAnchor(els.length-1,s,$(opts.pager),els,opts);}if($.isFunction(opts.onAddSlide)){opts.onAddSlide($s);}else{$s.hide();}};}$.fn.cycle.resetState=function(opts,fx){fx=fx||opts.fx;opts.before=[];opts.after=[];opts.cssBefore=$.extend({},opts.original.cssBefore);opts.cssAfter=$.extend({},opts.original.cssAfter);opts.animIn=$.extend({},opts.original.animIn);opts.animOut=$.extend({},opts.original.animOut);opts.fxFn=null;$.each(opts.original.before,function(){opts.before.push(this);});$.each(opts.original.after,function(){opts.after.push(this);});var init=$.fn.cycle.transitions[fx];if($.isFunction(init)){init(opts.$cont,$(opts.elements),opts);}};function go(els,opts,manual,fwd){if(manual&&opts.busy&&opts.manualTrump){debug("manualTrump in go(), stopping active transition");$(els).stop(true,true);opts.busy=0;}if(opts.busy){debug("transition active, ignoring new tx request");return;}var p=opts.$cont[0],curr=els[opts.currSlide],next=els[opts.nextSlide];if(p.cycleStop!=opts.stopCount||p.cycleTimeout===0&&!manual){return;}if(!manual&&!p.cyclePause&&!opts.bounce&&((opts.autostop&&(--opts.countdown<=0))||(opts.nowrap&&!opts.random&&opts.nextSlide<opts.currSlide))){if(opts.end){opts.end(opts);}return;}var changed=false;if((manual||!p.cyclePause)&&(opts.nextSlide!=opts.currSlide)){changed=true;var fx=opts.fx;curr.cycleH=curr.cycleH||$(curr).height();curr.cycleW=curr.cycleW||$(curr).width();next.cycleH=next.cycleH||$(next).height();next.cycleW=next.cycleW||$(next).width();if(opts.multiFx){if(opts.lastFx==undefined||++opts.lastFx>=opts.fxs.length){opts.lastFx=0;}fx=opts.fxs[opts.lastFx];opts.currFx=fx;}if(opts.oneTimeFx){fx=opts.oneTimeFx;opts.oneTimeFx=null;}$.fn.cycle.resetState(opts,fx);if(opts.before.length){$.each(opts.before,function(i,o){if(p.cycleStop!=opts.stopCount){return;}o.apply(next,[curr,next,opts,fwd]);});}var after=function(){opts.busy=0;$.each(opts.after,function(i,o){if(p.cycleStop!=opts.stopCount){return;}o.apply(next,[curr,next,opts,fwd]);});};debug("tx firing("+fx+"); currSlide: "+opts.currSlide+"; nextSlide: "+opts.nextSlide);opts.busy=1;if(opts.fxFn){opts.fxFn(curr,next,opts,after,fwd,manual&&opts.fastOnEvent);}else{if($.isFunction($.fn.cycle[opts.fx])){$.fn.cycle[opts.fx](curr,next,opts,after,fwd,manual&&opts.fastOnEvent);}else{$.fn.cycle.custom(curr,next,opts,after,fwd,manual&&opts.fastOnEvent);}}}if(changed||opts.nextSlide==opts.currSlide){opts.lastSlide=opts.currSlide;if(opts.random){opts.currSlide=opts.nextSlide;if(++opts.randomIndex==els.length){opts.randomIndex=0;}opts.nextSlide=opts.randomMap[opts.randomIndex];if(opts.nextSlide==opts.currSlide){opts.nextSlide=(opts.currSlide==opts.slideCount-1)?0:opts.currSlide+1;}}else{if(opts.backwards){var roll=(opts.nextSlide-1)<0;if(roll&&opts.bounce){opts.backwards=!opts.backwards;opts.nextSlide=1;opts.currSlide=0;}else{opts.nextSlide=roll?(els.length-1):opts.nextSlide-1;opts.currSlide=roll?0:opts.nextSlide+1;}}else{var roll=(opts.nextSlide+1)==els.length;if(roll&&opts.bounce){opts.backwards=!opts.backwards;opts.nextSlide=els.length-2;opts.currSlide=els.length-1;}else{opts.nextSlide=roll?0:opts.nextSlide+1;opts.currSlide=roll?els.length-1:opts.nextSlide-1;}}}}if(changed&&opts.pager){opts.updateActivePagerLink(opts.pager,opts.currSlide,opts.activePagerClass);}var ms=0;if(opts.timeout&&!opts.continuous){ms=getTimeout(els[opts.currSlide],els[opts.nextSlide],opts,fwd);}else{if(opts.continuous&&p.cyclePause){ms=10;}}if(ms>0){p.cycleTimeout=setTimeout(function(){go(els,opts,0,!opts.backwards);},ms);}}$.fn.cycle.updateActivePagerLink=function(pager,currSlide,clsName){$(pager).each(function(){$(this).children().removeClass(clsName).eq(currSlide).addClass(clsName);});};function getTimeout(curr,next,opts,fwd){if(opts.timeoutFn){var t=opts.timeoutFn.call(curr,curr,next,opts,fwd);while(opts.fx!="none"&&(t-opts.speed)<250){t+=opts.speed;}debug("calculated timeout: "+t+"; speed: "+opts.speed);if(t!==false){return t;}}return opts.timeout;}$.fn.cycle.next=function(opts){advance(opts,1);};$.fn.cycle.prev=function(opts){advance(opts,0);};function advance(opts,moveForward){var val=moveForward?1:-1;var els=opts.elements;var p=opts.$cont[0],timeout=p.cycleTimeout;if(timeout){clearTimeout(timeout);p.cycleTimeout=0;}if(opts.random&&val<0){opts.randomIndex--;if(--opts.randomIndex==-2){opts.randomIndex=els.length-2;}else{if(opts.randomIndex==-1){opts.randomIndex=els.length-1;}}opts.nextSlide=opts.randomMap[opts.randomIndex];}else{if(opts.random){opts.nextSlide=opts.randomMap[opts.randomIndex];}else{opts.nextSlide=opts.currSlide+val;if(opts.nextSlide<0){if(opts.nowrap){return false;}opts.nextSlide=els.length-1;}else{if(opts.nextSlide>=els.length){if(opts.nowrap){return false;}opts.nextSlide=0;}}}}var cb=opts.onPrevNextEvent||opts.prevNextClick;if($.isFunction(cb)){cb(val>0,opts.nextSlide,els[opts.nextSlide]);}go(els,opts,1,moveForward);return false;}function buildPager(els,opts){var $p=$(opts.pager);$.each(els,function(i,o){$.fn.cycle.createPagerAnchor(i,o,$p,els,opts);});opts.updateActivePagerLink(opts.pager,opts.startingSlide,opts.activePagerClass);}$.fn.cycle.createPagerAnchor=function(i,el,$p,els,opts){var a;if($.isFunction(opts.pagerAnchorBuilder)){a=opts.pagerAnchorBuilder(i,el);debug("pagerAnchorBuilder("+i+", el) returned: "+a);}else{a='<a href="#">'+(i+1)+"</a>";}if(!a){return;}var $a=$(a);if($a.parents("body").length===0){var arr=[];if($p.length>1){$p.each(function(){var $clone=$a.clone(true);$(this).append($clone);arr.push($clone[0]);});$a=$(arr);}else{$a.appendTo($p);}}opts.pagerAnchors=opts.pagerAnchors||[];opts.pagerAnchors.push($a);$a.bind(opts.pagerEvent,function(e){e.preventDefault();opts.nextSlide=i;var p=opts.$cont[0],timeout=p.cycleTimeout;if(timeout){clearTimeout(timeout);p.cycleTimeout=0;}var cb=opts.onPagerEvent||opts.pagerClick;if($.isFunction(cb)){cb(opts.nextSlide,els[opts.nextSlide]);}go(els,opts,1,opts.currSlide<i);});if(!/^click/.test(opts.pagerEvent)&&!opts.allowPagerClickBubble){$a.bind("click.cycle",function(){return false;});}if(opts.pauseOnPagerHover){$a.hover(function(){opts.$cont[0].cyclePause++;},function(){opts.$cont[0].cyclePause--;});}};$.fn.cycle.hopsFromLast=function(opts,fwd){var hops,l=opts.lastSlide,c=opts.currSlide;if(fwd){hops=c>l?c-l:opts.slideCount-l;}else{hops=c<l?l-c:l+opts.slideCount-c;}return hops;};function clearTypeFix($slides){debug("applying clearType background-color hack");function hex(s){s=parseInt(s).toString(16);return s.length<2?"0"+s:s;}function getBg(e){for(;e&&e.nodeName.toLowerCase()!="html";e=e.parentNode){var v=$.css(e,"background-color");if(v&&v.indexOf("rgb")>=0){var rgb=v.match(/\d+/g);return"#"+hex(rgb[0])+hex(rgb[1])+hex(rgb[2]);}if(v&&v!="transparent"){return v;}}return"#ffffff";}$slides.each(function(){$(this).css("background-color",getBg(this));});}$.fn.cycle.commonReset=function(curr,next,opts,w,h,rev){$(opts.elements).not(curr).hide();if(typeof opts.cssBefore.opacity=="undefined"){opts.cssBefore.opacity=1;}opts.cssBefore.display="block";if(opts.slideResize&&w!==false&&next.cycleW>0){opts.cssBefore.width=next.cycleW;}if(opts.slideResize&&h!==false&&next.cycleH>0){opts.cssBefore.height=next.cycleH;}opts.cssAfter=opts.cssAfter||{};opts.cssAfter.display="none";$(curr).css("zIndex",opts.slideCount+(rev===true?1:0));$(next).css("zIndex",opts.slideCount+(rev===true?0:1));};$.fn.cycle.custom=function(curr,next,opts,cb,fwd,speedOverride){var $l=$(curr),$n=$(next);var speedIn=opts.speedIn,speedOut=opts.speedOut,easeIn=opts.easeIn,easeOut=opts.easeOut;$n.css(opts.cssBefore);if(speedOverride){if(typeof speedOverride=="number"){speedIn=speedOut=speedOverride;}else{speedIn=speedOut=1;}easeIn=easeOut=null;}var fn=function(){$n.animate(opts.animIn,speedIn,easeIn,function(){cb();});};$l.animate(opts.animOut,speedOut,easeOut,function(){$l.css(opts.cssAfter);if(!opts.sync){fn();}});if(opts.sync){fn();}};$.fn.cycle.transitions={fade:function($cont,$slides,opts){$slides.not(":eq("+opts.currSlide+")").css("opacity",0);opts.before.push(function(curr,next,opts){$.fn.cycle.commonReset(curr,next,opts);opts.cssBefore.opacity=0;});opts.animIn={opacity:1};opts.animOut={opacity:0};opts.cssBefore={top:0,left:0};}};$.fn.cycle.ver=function(){return ver;};$.fn.cycle.defaults={activePagerClass:"activeSlide",after:null,allowPagerClickBubble:false,animIn:null,animOut:null,autostop:0,autostopCount:0,backwards:false,before:null,cleartype:!$.support.opacity,cleartypeNoBg:false,containerResize:1,continuous:0,cssAfter:null,cssBefore:null,delay:0,easeIn:null,easeOut:null,easing:null,end:null,fastOnEvent:0,fit:0,fx:"fade",fxFn:null,height:"auto",manualTrump:true,next:null,nowrap:0,onPagerEvent:null,onPrevNextEvent:null,pager:null,pagerAnchorBuilder:null,pagerEvent:"click.cycle",pause:0,pauseOnPagerHover:0,prev:null,prevNextEvent:"click.cycle",random:0,randomizeEffects:1,requeueOnImageNotLoaded:true,requeueTimeout:250,rev:0,shuffle:null,slideExpr:null,slideResize:1,speed:1000,speedIn:null,speedOut:null,startingSlide:0,sync:1,timeout:4000,timeoutFn:null,updateActivePagerLink:null};})(jQuery);
;;;
(function(window,document,navigator,undefined){function m(w){throw w;}var n=void 0,p=!0,s=null,t=!1;function A(w){return function(){return w}};function E(w){function B(b,c,d){d&&c!==a.k.r(b)&&a.k.S(b,c);c!==a.k.r(b)&&a.a.va(b,"change")}var a="undefined"!==typeof w?w:{};a.b=function(b,c){for(var d=b.split("."),f=a,g=0;g<d.length-1;g++)f=f[d[g]];f[d[d.length-1]]=c};a.B=function(a,c,d){a[c]=d};a.version="2.1.0";a.b("version",a.version);a.a=new function(){function b(b,c){if("input"!==a.a.o(b)||!b.type||"click"!=c.toLowerCase())return t;var e=b.type;return"checkbox"==e||"radio"==e}var c=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,d={},f={};d[/Firefox\/2/i.test(navigator.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"];d.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" ");for(var g in d){var e=d[g];if(e.length)for(var h=0,j=e.length;h<j;h++)f[e[h]]=g}var k={propertychange:p},i=function(){for(var a=3,b=document.createElement("div"),c=b.getElementsByTagName("i");b.innerHTML="<\!--[if gt IE "+ ++a+"]><i></i><![endif]--\>",c[0];);return 4<a?a:n}();return{Ca:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],v:function(a,b){for(var c=0,e=a.length;c<e;c++)b(a[c])},j:function(a,b){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(a,b);for(var c=0,e=a.length;c<e;c++)if(a[c]===b)return c;return-1},ab:function(a,b,c){for(var e=0,f=a.length;e<f;e++)if(b.call(c,a[e]))return a[e];return s},ba:function(b,c){var e=a.a.j(b,c);0<=e&&b.splice(e,1)},za:function(b){for(var b=b||[],c=[],e=0,f=b.length;e<f;e++)0>a.a.j(c,b[e])&&c.push(b[e]);return c},T:function(a,b){for(var a=a||[],c=[],e=0,f=a.length;e<f;e++)c.push(b(a[e]));return c},aa:function(a,b){for(var a=a||[],c=[],e=0,f=a.length;e<f;e++)b(a[e])&&c.push(a[e]);return c},N:function(a,b){if(b instanceof Array)a.push.apply(a,b);else for(var c=0,e=b.length;c<e;c++)a.push(b[c]);return a},extend:function(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},ga:function(b){for(;b.firstChild;)a.removeNode(b.firstChild)},Ab:function(b){for(var b=a.a.L(b),c=document.createElement("div"),e=0,f=b.length;e<f;e++)a.F(b[e]),c.appendChild(b[e]);return c},X:function(b,c){a.a.ga(b);if(c)for(var e=0,f=c.length;e<f;e++)b.appendChild(c[e])},Na:function(b,c){var e=b.nodeType?[b]:b;if(0<e.length){for(var f=e[0],d=f.parentNode,g=0,h=c.length;g<h;g++)d.insertBefore(c[g],f);g=0;for(h=e.length;g<h;g++)a.removeNode(e[g])}},Pa:function(a,b){0<=navigator.userAgent.indexOf("MSIE 6")?a.setAttribute("selected",b):a.selected=b},w:function(a){return(a||"").replace(c,"")},Ib:function(b,c){for(var e=[],f=(b||"").split(c),g=0,d=f.length;g<d;g++){var h=a.a.w(f[g]);""!==h&&e.push(h)}return e},Hb:function(a,b){a=a||"";return b.length>a.length?t:a.substring(0,b.length)===b},eb:function(a,b){for(var c="return ("+a+")",e=0;e<b;e++)c="with(sc["+e+"]) { "+c+" } ";return new Function("sc",c)},kb:function(a,b){if(b.compareDocumentPosition)return 16==(b.compareDocumentPosition(a)&16);for(;a!=s;){if(a==b)return p;a=a.parentNode}return t},fa:function(b){return a.a.kb(b,b.ownerDocument)},o:function(a){return a&&a.tagName&&a.tagName.toLowerCase()},n:function(a,c,e){var f=i&&k[c];if(!f&&"undefined"!=typeof jQuery){if(b(a,c))var g=e,e=function(a,b){var c=this.checked;b&&(this.checked=b.fb!==p);g.call(this,a);this.checked=c};jQuery(a).bind(c,e)}else!f&&"function"==typeof a.addEventListener?a.addEventListener(c,e,t):"undefined"!=typeof a.attachEvent?a.attachEvent("on"+c,function(b){e.call(a,b)}):m(Error("Browser doesn't support addEventListener or attachEvent"))},va:function(a,c){(!a||!a.nodeType)&&m(Error("element must be a DOM node when calling triggerEvent"));if("undefined"!=typeof jQuery){var e=[];b(a,c)&&e.push({fb:a.checked});jQuery(a).trigger(c,e)}else"function"==typeof document.createEvent?"function"==typeof a.dispatchEvent?(e=document.createEvent(f[c]||"HTMLEvents"),e.initEvent(c,p,p,window,0,0,0,0,0,t,t,t,t,0,a),a.dispatchEvent(e)):m(Error("The supplied element doesn't support dispatchEvent")):"undefined"!=typeof a.fireEvent?(b(a,c)&&(a.checked=a.checked!==p),a.fireEvent("on"+c)):m(Error("Browser doesn't support triggering events"))},d:function(b){return a.la(b)?b():b},Ua:function(b,c,e){var f=(b.className||"").split(/\s+/),g=0<=a.a.j(f,c);if(e&&!g)b.className+=(f[0]?" ":"")+c;else if(g&&!e){e="";for(g=0;g<f.length;g++)f[g]!=c&&(e+=f[g]+" ");b.className=a.a.w(e)}},Qa:function(b,c){var e=a.a.d(c);if(e===s||e===n)e="";"innerText"in b?b.innerText=e:b.textContent=e;9<=i&&(b.style.display=b.style.display)},lb:function(a){if(9<=i){var b=a.style.width;a.style.width=0;a.style.width=b}},Eb:function(b,e){for(var b=a.a.d(b),e=a.a.d(e),c=[],f=b;f<=e;f++)c.push(f);return c},L:function(a){for(var b=[],e=0,c=a.length;e<c;e++)b.push(a[e]);return b},tb:6===i,ub:7===i,ja:i,Da:function(b,e){for(var c=a.a.L(b.getElementsByTagName("input")).concat(a.a.L(b.getElementsByTagName("textarea"))),f="string"==typeof e?function(a){return a.name===e}:function(a){return e.test(a.name)},g=[],d=c.length-1;0<=d;d--)f(c[d])&&g.push(c[d]);return g},Bb:function(b){return"string"==typeof b&&(b=a.a.w(b))?window.JSON&&window.JSON.parse?window.JSON.parse(b):(new Function("return "+b))():s},sa:function(b,e,c){("undefined"==typeof JSON||"undefined"==typeof JSON.stringify)&&m(Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js"));return JSON.stringify(a.a.d(b),e,c)},Cb:function(b,e,c){var c=c||{},f=c.params||{},g=c.includeFields||this.Ca,d=b;if("object"==typeof b&&"form"===a.a.o(b))for(var d=b.action,h=g.length-1;0<=h;h--)for(var k=a.a.Da(b,g[h]),j=k.length-1;0<=j;j--)f[k[j].name]=k[j].value;var e=a.a.d(e),i=document.createElement("form");i.style.display="none";i.action=d;i.method="post";for(var z in e)b=document.createElement("input"),b.name=z,b.value=a.a.sa(a.a.d(e[z])),i.appendChild(b);for(z in f)b=document.createElement("input"),b.name=z,b.value=f[z],i.appendChild(b);document.body.appendChild(i);c.submitter?c.submitter(i):i.submit();setTimeout(function(){i.parentNode.removeChild(i)},0)}}};a.b("utils",a.a);a.b("utils.arrayForEach",a.a.v);a.b("utils.arrayFirst",a.a.ab);a.b("utils.arrayFilter",a.a.aa);a.b("utils.arrayGetDistinctValues",a.a.za);a.b("utils.arrayIndexOf",a.a.j);a.b("utils.arrayMap",a.a.T);a.b("utils.arrayPushAll",a.a.N);a.b("utils.arrayRemoveItem",a.a.ba);a.b("utils.extend",a.a.extend);a.b("utils.fieldsIncludedWithJsonPost",a.a.Ca);a.b("utils.getFormFields",a.a.Da);a.b("utils.postJson",a.a.Cb);a.b("utils.parseJson",a.a.Bb);a.b("utils.registerEventHandler",a.a.n);a.b("utils.stringifyJson",a.a.sa);a.b("utils.range",a.a.Eb);a.b("utils.toggleDomNodeCssClass",a.a.Ua);a.b("utils.triggerEvent",a.a.va);a.b("utils.unwrapObservable",a.a.d);Function.prototype.bind||(Function.prototype.bind=function(a){var c=this,d=Array.prototype.slice.call(arguments),a=d.shift();return function(){return c.apply(a,d.concat(Array.prototype.slice.call(arguments)))}});a.a.f=new function(){var b=0,c="__ko__"+(new Date).getTime(),d={};return{get:function(b,c){var e=a.a.f.getAll(b,t);return e===n?n:e[c]},set:function(b,c,e){e===n&&a.a.f.getAll(b,t)===n||(a.a.f.getAll(b,p)[c]=e)},getAll:function(a,g){var e=a[c];if(!(e&&"null"!==e)){if(!g)return;e=a[c]="ko"+b++;d[e]={}}return d[e]},clear:function(a){var b=a[c];b&&(delete d[b],a[c]=s)}}};a.b("utils.domData",a.a.f);a.b("utils.domData.clear",a.a.f.clear);a.a.G=new function(){function b(b,c){var f=a.a.f.get(b,d);f===n&&c&&(f=[],a.a.f.set(b,d,f));return f}function c(e){var f=b(e,t);if(f)for(var f=f.slice(0),d=0;d<f.length;d++)f[d](e);a.a.f.clear(e);"function"==typeof jQuery&&"function"==typeof jQuery.cleanData&&jQuery.cleanData([e]);if(g[e.nodeType])for(f=e.firstChild;e=f;)f=e.nextSibling,8===e.nodeType&&c(e)}var d="__ko_domNodeDisposal__"+(new Date).getTime(),f={1:p,8:p,9:p},g={1:p,9:p};return{wa:function(a,c){"function"!=typeof c&&m(Error("Callback must be a function"));b(a,p).push(c)},Ma:function(c,f){var g=b(c,t);g&&(a.a.ba(g,f),0==g.length&&a.a.f.set(c,d,n))},F:function(b){if(f[b.nodeType]&&(c(b),g[b.nodeType])){var d=[];a.a.N(d,b.getElementsByTagName("*"));for(var b=0,j=d.length;b<j;b++)c(d[b])}},removeNode:function(b){a.F(b);b.parentNode&&b.parentNode.removeChild(b)}}};a.F=a.a.G.F;a.removeNode=a.a.G.removeNode;a.b("cleanNode",a.F);a.b("removeNode",a.removeNode);a.b("utils.domNodeDisposal",a.a.G);a.b("utils.domNodeDisposal.addDisposeCallback",a.a.G.wa);a.b("utils.domNodeDisposal.removeDisposeCallback",a.a.G.Ma);(function(){a.a.pa=function(b){var c;if("undefined"!=typeof jQuery){if((c=jQuery.clean([b]))&&c[0]){for(b=c[0];b.parentNode&&11!==b.parentNode.nodeType;)b=b.parentNode;b.parentNode&&b.parentNode.removeChild(b)}}else{var d=a.a.w(b).toLowerCase();c=document.createElement("div");d=d.match(/^<(thead|tbody|tfoot)/)&&[1,"<table>","</table>"]||!d.indexOf("<tr")&&[2,"<table><tbody>","</tbody></table>"]||(!d.indexOf("<td")||!d.indexOf("<th"))&&[3,"<table><tbody><tr>","</tr></tbody></table>"]||[0,"",""];b="ignored<div>"+d[1]+b+d[2]+"</div>";for("function"==typeof window.innerShiv?c.appendChild(window.innerShiv(b)):c.innerHTML=b;d[0]--;)c=c.lastChild;c=a.a.L(c.lastChild.childNodes)}return c};a.a.Y=function(b,c){a.a.ga(b);if(c!==s&&c!==n)if("string"!=typeof c&&(c=c.toString()),"undefined"!=typeof jQuery)jQuery(b).html(c);else for(var d=a.a.pa(c),f=0;f<d.length;f++)b.appendChild(d[f])}})();a.b("utils.parseHtmlFragment",a.a.pa);a.b("utils.setHtml",a.a.Y);a.s=function(){function b(){return(4294967296*(1+Math.random())|0).toString(16).substring(1)}function c(b,g){if(b)if(8==b.nodeType){var e=a.s.Ja(b.nodeValue);e!=s&&g.push({jb:b,yb:e})}else if(1==b.nodeType)for(var e=0,d=b.childNodes,j=d.length;e<j;e++)c(d[e],g)}var d={};return{na:function(a){"function"!=typeof a&&m(Error("You can only pass a function to ko.memoization.memoize()"));var c=b()+b();d[c]=a;return"<\!--[ko_memo:"+c+"]--\>"},Va:function(a,b){var c=d[a];c===n&&m(Error("Couldn't find any memo with ID "+a+". Perhaps it's already been unmemoized."));try{return c.apply(s,b||[]),p}finally{delete d[a]}},Wa:function(b,d){var e=[];c(b,e);for(var h=0,j=e.length;h<j;h++){var k=e[h].jb,i=[k];d&&a.a.N(i,d);a.s.Va(e[h].yb,i);k.nodeValue="";k.parentNode&&k.parentNode.removeChild(k)}},Ja:function(a){return(a=a.match(/^\[ko_memo\:(.*?)\]$/))?a[1]:s}}}();a.b("memoization",a.s);a.b("memoization.memoize",a.s.na);a.b("memoization.unmemoize",a.s.Va);a.b("memoization.parseMemoText",a.s.Ja);a.b("memoization.unmemoizeDomNodeAndDescendants",a.s.Wa);a.Ba={throttle:function(b,c){b.throttleEvaluation=c;var d=s;return a.h({read:b,write:function(a){clearTimeout(d);d=setTimeout(function(){b(a)},c)}})},notify:function(b,c){b.equalityComparer="always"==c?A(t):a.m.fn.equalityComparer;return b}};a.b("extenders",a.Ba);a.Sa=function(b,c,d){this.target=b;this.ca=c;this.ib=d;a.B(this,"dispose",this.A)};a.Sa.prototype.A=function(){this.sb=p;this.ib()};a.R=function(){this.u={};a.a.extend(this,a.R.fn);a.B(this,"subscribe",this.ta);a.B(this,"extend",this.extend);a.B(this,"getSubscriptionsCount",this.ob)};a.R.fn={ta:function(b,c,d){var d=d||"change",b=c?b.bind(c):b,f=new a.Sa(this,b,function(){a.a.ba(this.u[d],f)}.bind(this));this.u[d]||(this.u[d]=[]);this.u[d].push(f);return f},notifySubscribers:function(b,c){c=c||"change";this.u[c]&&a.a.v(this.u[c].slice(0),function(a){a&&a.sb!==p&&a.ca(b)})},ob:function(){var a=0,c;for(c in this.u)this.u.hasOwnProperty(c)&&(a+=this.u[c].length);return a},extend:function(b){var c=this;if(b)for(var d in b){var f=a.Ba[d];"function"==typeof f&&(c=f(c,b[d]))}return c}};a.Ga=function(a){return"function"==typeof a.ta&&"function"==typeof a.notifySubscribers};a.b("subscribable",a.R);a.b("isSubscribable",a.Ga);a.U=function(){var b=[];return{bb:function(a){b.push({ca:a,Aa:[]})},end:function(){b.pop()},La:function(c){a.Ga(c)||m(Error("Only subscribable things can act as dependencies"));if(0<b.length){var d=b[b.length-1];0<=a.a.j(d.Aa,c)||(d.Aa.push(c),d.ca(c))}}}}();var G={undefined:p,"boolean":p,number:p,string:p};a.m=function(b){function c(){if(0<arguments.length){if(!c.equalityComparer||!c.equalityComparer(d,arguments[0]))c.I(),d=arguments[0],c.H();return this}a.U.La(c);return d}var d=b;a.R.call(c);c.H=function(){c.notifySubscribers(d)};c.I=function(){c.notifySubscribers(d,"beforeChange")};a.a.extend(c,a.m.fn);a.B(c,"valueHasMutated",c.H);a.B(c,"valueWillMutate",c.I);return c};a.m.fn={equalityComparer:function(a,c){return a===s||typeof a in G?a===c:t}};var x=a.m.Db="__ko_proto__";a.m.fn[x]=a.m;a.ia=function(b,c){return b===s||b===n||b[x]===n?t:b[x]===c?p:a.ia(b[x],c)};a.la=function(b){return a.ia(b,a.m)};a.Ha=function(b){return"function"==typeof b&&b[x]===a.m||"function"==typeof b&&b[x]===a.h&&b.pb?p:t};a.b("observable",a.m);a.b("isObservable",a.la);a.b("isWriteableObservable",a.Ha);a.Q=function(b){0==arguments.length&&(b=[]);b!==s&&(b!==n&&!("length"in b))&&m(Error("The argument passed when initializing an observable array must be an array, or null, or undefined."));var c=a.m(b);a.a.extend(c,a.Q.fn);return c};a.Q.fn={remove:function(a){for(var c=this(),d=[],f="function"==typeof a?a:function(c){return c===a},g=0;g<c.length;g++){var e=c[g];f(e)&&(0===d.length&&this.I(),d.push(e),c.splice(g,1),g--)}d.length&&this.H();return d},removeAll:function(b){if(b===n){var c=this(),d=c.slice(0);this.I();c.splice(0,c.length);this.H();return d}return!b?[]:this.remove(function(c){return 0<=a.a.j(b,c)})},destroy:function(a){var c=this(),d="function"==typeof a?a:function(c){return c===a};this.I();for(var f=c.length-1;0<=f;f--)d(c[f])&&(c[f]._destroy=p);this.H()},destroyAll:function(b){return b===n?this.destroy(A(p)):!b?[]:this.destroy(function(c){return 0<=a.a.j(b,c)})},indexOf:function(b){var c=this();return a.a.j(c,b)},replace:function(a,c){var d=this.indexOf(a);0<=d&&(this.I(),this()[d]=c,this.H())}};a.a.v("pop push reverse shift sort splice unshift".split(" "),function(b){a.Q.fn[b]=function(){var a=this();this.I();a=a[b].apply(a,arguments);this.H();return a}});a.a.v(["slice"],function(b){a.Q.fn[b]=function(){var a=this();return a[b].apply(a,arguments)}});a.b("observableArray",a.Q);a.h=function(b,c,d){function f(){a.a.v(v,function(a){a.A()});v=[]}function g(){var a=h.throttleEvaluation;a&&0<=a?(clearTimeout(x),x=setTimeout(e,a)):e()}function e(){if(!l)if(i&&w())u();else{l=p;try{var b=a.a.T(v,function(a){return a.target});a.U.bb(function(c){var e;0<=(e=a.a.j(b,c))?b[e]=n:v.push(c.ta(g))});for(var e=q.call(c),f=b.length-1;0<=f;f--)b[f]&&v.splice(f,1)[0].A();i=p;h.notifySubscribers(k,"beforeChange");k=e}finally{a.U.end()}h.notifySubscribers(k);l=t}}function h(){if(0<arguments.length)j.apply(h,arguments);else return i||e(),a.U.La(h),k}function j(){"function"===typeof o?o.apply(c,arguments):m(Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters."))}
var k,i=t,l=t,q=b;q&&"object"==typeof q?(d=q,q=d.read):(d=d||{},q||(q=d.read));"function"!=typeof q&&m(Error("Pass a function that returns the value of the ko.computed"));var o=d.write;c||(c=d.owner);var v=[],u=f,r="object"==typeof d.disposeWhenNodeIsRemoved?d.disposeWhenNodeIsRemoved:s,w=d.disposeWhen||A(t);if(r){u=function(){a.a.G.Ma(r,arguments.callee);f()};a.a.G.wa(r,u);var y=w,w=function(){return!a.a.fa(r)||y()}}var x=s;h.nb=function(){return v.length};h.pb="function"===typeof d.write;h.A=function(){u()};a.R.call(h);a.a.extend(h,a.h.fn);d.deferEvaluation!==p&&e();a.B(h,"dispose",h.A);a.B(h,"getDependenciesCount",h.nb);return h};a.rb=function(b){return a.ia(b,a.h)};w=a.m.Db;a.h[w]=a.m;a.h.fn={};a.h.fn[w]=a.h;a.b("dependentObservable",a.h);a.b("computed",a.h);a.b("isComputed",a.rb);(function(){function b(a,g,e){e=e||new d;a=g(a);if(!("object"==typeof a&&a!==s&&a!==n&&!(a instanceof Date)))return a;var h=a instanceof Array?[]:{};e.save(a,h);c(a,function(c){var d=g(a[c]);switch(typeof d){case"boolean":case"number":case"string":case"function":h[c]=d;break;case"object":case"undefined":var i=e.get(d);h[c]=i!==n?i:b(d,g,e)}});return h}function c(a,b){if(a instanceof Array){for(var c=0;c<a.length;c++)b(c);"function"==typeof a.toJSON&&b("toJSON")}else for(c in a)b(c)}function d(){var b=[],c=[];this.save=function(e,d){var j=a.a.j(b,e);0<=j?c[j]=d:(b.push(e),c.push(d))};this.get=function(e){e=a.a.j(b,e);return 0<=e?c[e]:n}}a.Ta=function(c){0==arguments.length&&m(Error("When calling ko.toJS, pass the object you want to convert."));return b(c,function(b){for(var c=0;a.la(b)&&10>c;c++)b=b();return b})};a.toJSON=function(b,c,e){b=a.Ta(b);return a.a.sa(b,c,e)}})();a.b("toJS",a.Ta);a.b("toJSON",a.toJSON);(function(){a.k={r:function(b){switch(a.a.o(b)){case"option":return b.__ko__hasDomDataOptionValue__===p?a.a.f.get(b,a.c.options.oa):b.getAttribute("value");case"select":return 0<=b.selectedIndex?a.k.r(b.options[b.selectedIndex]):n;default:return b.value}},S:function(b,c){switch(a.a.o(b)){case"option":switch(typeof c){case"string":a.a.f.set(b,a.c.options.oa,n);"__ko__hasDomDataOptionValue__"in b&&delete b.__ko__hasDomDataOptionValue__;b.value=c;break;default:a.a.f.set(b,a.c.options.oa,c),b.__ko__hasDomDataOptionValue__=p,b.value="number"===typeof c?c:""}break;case"select":for(var d=b.options.length-1;0<=d;d--)if(a.k.r(b.options[d])==c){b.selectedIndex=d;break}break;default:if(c===s||c===n)c="";b.value=c}}}})();a.b("selectExtensions",a.k);a.b("selectExtensions.readValue",a.k.r);a.b("selectExtensions.writeValue",a.k.S);a.g=function(){function b(a,b){for(var d=s;a!=d;)d=a,a=a.replace(c,function(a,c){return b[c]});return a}var c=/\@ko_token_(\d+)\@/g,d=/^[\_$a-z][\_$a-z0-9]*(\[.*?\])*(\.[\_$a-z][\_$a-z0-9]*(\[.*?\])*)*$/i,f=["true","false"];return{D:[],W:function(c){var e=a.a.w(c);if(3>e.length)return[];"{"===e.charAt(0)&&(e=e.substring(1,e.length-1));for(var c=[],d=s,f,k=0;k<e.length;k++){var i=e.charAt(k);if(d===s)switch(i){case'"':case"'":case"/":d=k,f=i}else if(i==f&&"\\"!==e.charAt(k-1)){i=e.substring(d,k+1);c.push(i);var l="@ko_token_"+(c.length-
1)+"@",e=e.substring(0,d)+l+e.substring(k+1),k=k-(i.length-l.length),d=s}}f=d=s;for(var q=0,o=s,k=0;k<e.length;k++){i=e.charAt(k);if(d===s)switch(i){case"{":d=k;o=i;f="}";break;case"(":d=k;o=i;f=")";break;case"[":d=k,o=i,f="]"}i===o?q++:i===f&&(q--,0===q&&(i=e.substring(d,k+1),c.push(i),l="@ko_token_"+(c.length-1)+"@",e=e.substring(0,d)+l+e.substring(k+1),k-=i.length-l.length,d=s))}f=[];e=e.split(",");d=0;for(k=e.length;d<k;d++)q=e[d],o=q.indexOf(":"),0<o&&o<q.length-1?(i=q.substring(o+1),f.push({key:b(q.substring(0,o),c),value:b(i,c)})):f.push({unknown:b(q,c)});return f},ka:function(b){for(var c="string"===typeof b?a.g.W(b):b,h=[],b=[],j,k=0;j=c[k];k++)if(0<h.length&&h.push(","),j.key){var i;a:{i=j.key;var l=a.a.w(i);switch(l.length&&l.charAt(0)){case"'":case'"':break a;default:i="'"+l+"'"}}j=j.value;h.push(i);h.push(":");h.push(j);l=a.a.w(j);if(0<=a.a.j(f,a.a.w(l).toLowerCase())?0:l.match(d)!==s)0<b.length&&b.push(", "),b.push(i+" : function(__ko_value) { "+j+" = __ko_value; }")}else j.unknown&&h.push(j.unknown);c=h.join("");0<b.length&&(c=c+", '_ko_property_writers' : { "+b.join("")+" } ");return c},wb:function(b,c){for(var d=0;d<b.length;d++)if(a.a.w(b[d].key)==c)return p;return t},$:function(b,c,d,f,k){if(!b||!a.Ha(b)){if((b=c()._ko_property_writers)&&b[d])b[d](f)}else(!k||b()!==f)&&b(f)}}}();a.b("jsonExpressionRewriting",a.g);a.b("jsonExpressionRewriting.bindingRewriteValidators",a.g.D);a.b("jsonExpressionRewriting.parseObjectLiteral",a.g.W);a.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",a.g.ka);(function(){function b(a){return 8==a.nodeType&&(g?a.text:a.nodeValue).match(e)}function c(a){return 8==a.nodeType&&(g?a.text:a.nodeValue).match(h)}function d(a,e){for(var d=a,f=1,g=[];d=d.nextSibling;){if(c(d)&&(f--,0===f))return g;g.push(d);b(d)&&f++}e||m(Error("Cannot find closing comment tag to match: "+a.nodeValue));return s}function f(a,b){var c=d(a,b);return c?0<c.length?c[c.length-1].nextSibling:a.nextSibling:s}var g="<\!--test--\>"===document.createComment("test").text,e=g?/^<\!--\s*ko\s+(.*\:.*)\s*--\>$/:/^\s*ko\s+(.*\:.*)\s*$/,h=g?/^<\!--\s*\/ko\s*--\>$/:/^\s*\/ko\s*$/,j={ul:p,ol:p};a.e={C:{},childNodes:function(a){return b(a)?d(a):a.childNodes},ha:function(c){if(b(c))for(var c=a.e.childNodes(c),e=0,d=c.length;e<d;e++)a.removeNode(c[e]);else a.a.ga(c)},X:function(c,e){if(b(c)){a.e.ha(c);for(var d=c.nextSibling,f=0,g=e.length;f<g;f++)d.parentNode.insertBefore(e[f],d)}else a.a.X(c,e)},Ka:function(a,c){b(a)?a.parentNode.insertBefore(c,a.nextSibling):a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)},Fa:function(a,c,e){b(a)?a.parentNode.insertBefore(c,e.nextSibling):e.nextSibling?a.insertBefore(c,e.nextSibling):a.appendChild(c)},firstChild:function(a){return!b(a)?a.firstChild:!a.nextSibling||c(a.nextSibling)?s:a.nextSibling},nextSibling:function(a){b(a)&&(a=f(a));return a.nextSibling&&c(a.nextSibling)?s:a.nextSibling},Xa:function(a){return(a=b(a))?a[1]:s},Ia:function(e){if(j[a.a.o(e)]){var d=e.firstChild;if(d){do if(1===d.nodeType){var g;g=d.firstChild;var h=s;if(g){do if(h)h.push(g);else if(b(g)){var o=f(g,p);o?g=o:h=[g]}else c(g)&&(h=[g]);while(g=g.nextSibling)}if(g=h){h=d.nextSibling;for(o=0;o<g.length;o++)h?e.insertBefore(g[o],h):e.appendChild(g[o])}}while(d=d.nextSibling)}}}}})();a.b("virtualElements",a.e);a.b("virtualElements.allowedBindings",a.e.C);a.b("virtualElements.emptyNode",a.e.ha);a.b("virtualElements.insertAfter",a.e.Fa);a.b("virtualElements.prepend",a.e.Ka);a.b("virtualElements.setDomNodeChildren",a.e.X);(function(){a.J=function(){this.cb={}};a.a.extend(a.J.prototype,{nodeHasBindings:function(b){switch(b.nodeType){case 1:return b.getAttribute("data-bind")!=s;case 8:return a.e.Xa(b)!=s;default:return t}},getBindings:function(a,c){var d=this.getBindingsString(a,c);return d?this.parseBindingsString(d,c):s},getBindingsString:function(b){switch(b.nodeType){case 1:return b.getAttribute("data-bind");case 8:return a.e.Xa(b);default:return s}},parseBindingsString:function(b,c){try{var d=c.$data,d="object"==typeof d&&d!=s?[d,c]:[c],f=d.length,g=this.cb,e=f+"_"+b,h;if(!(h=g[e])){var j=" { "+a.g.ka(b)+" } ";h=g[e]=a.a.eb(j,f)}return h(d)}catch(k){m(Error("Unable to parse bindings.\nMessage: "+
k+";\nBindings value: "+b))}}});a.J.instance=new a.J})();a.b("bindingProvider",a.J);(function(){function b(b,d,e){for(var h=a.e.firstChild(d);d=h;)h=a.e.nextSibling(d),c(b,d,e)}function c(c,g,e){var h=p,j=1===g.nodeType;j&&a.e.Ia(g);if(j&&e||a.J.instance.nodeHasBindings(g))h=d(g,s,c,e).Gb;h&&b(c,g,!j)}function d(b,c,e,d){function j(a){return function(){return l[a]}}function k(){return l}var i=0,l,q;a.h(function(){var o=e&&e instanceof a.z?e:new a.z(a.a.d(e)),v=o.$data;d&&a.Ra(b,o);if(l=("function"==typeof c?c():c)||a.J.instance.getBindings(b,o)){if(0===i){i=1;for(var u in l){var r=a.c[u];r&&8===b.nodeType&&!a.e.C[u]&&m(Error("The binding '"+u+"' cannot be used with virtual elements"));if(r&&"function"==typeof r.init&&(r=(0,r.init)(b,j(u),k,v,o))&&r.controlsDescendantBindings)q!==n&&m(Error("Multiple bindings ("+q+" and "+u+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.")),q=u}i=2}if(2===i)for(u in l)(r=a.c[u])&&"function"==typeof r.update&&(0,r.update)(b,j(u),k,v,o)}},s,{disposeWhenNodeIsRemoved:b});return{Gb:q===n}}a.c={};a.z=function(b,c){c?(a.a.extend(this,c),this.$parentContext=c,this.$parent=c.$data,this.$parents=(c.$parents||[]).slice(0),this.$parents.unshift(this.$parent)):(this.$parents=[],this.$root=b);this.$data=b};a.z.prototype.createChildContext=function(b){return new a.z(b,this)};a.z.prototype.extend=function(b){var c=a.a.extend(new a.z,this);return a.a.extend(c,b)};a.Ra=function(b,c){if(2==arguments.length)a.a.f.set(b,"__ko_bindingContext__",c);else return a.a.f.get(b,"__ko_bindingContext__")};a.ya=function(b,c,e){1===b.nodeType&&a.e.Ia(b);return d(b,c,e,p)};a.Ya=function(a,c){(1===c.nodeType||8===c.nodeType)&&b(a,c,p)};a.xa=function(a,b){b&&(1!==b.nodeType&&8!==b.nodeType)&&m(Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node"));b=b||window.document.body;c(a,b,p)};a.ea=function(b){switch(b.nodeType){case 1:case 8:var c=a.Ra(b);if(c)return c;if(b.parentNode)return a.ea(b.parentNode)}};a.hb=function(b){return(b=a.ea(b))?b.$data:n};a.b("bindingHandlers",a.c);a.b("applyBindings",a.xa);a.b("applyBindingsToDescendants",a.Ya);a.b("applyBindingsToNode",a.ya);a.b("contextFor",a.ea);a.b("dataFor",a.hb)})();a.a.v(["click"],function(b){a.c[b]={init:function(c,d,f,g){return a.c.event.init.call(this,c,function(){var a={};a[b]=d();return a},f,g)}}});a.c.event={init:function(b,c,d,f){var g=c()||{},e;for(e in g)(function(){var g=e;"string"==typeof g&&a.a.n(b,g,function(b){var e,i=c()[g];if(i){var l=d();try{var q=a.a.L(arguments);q.unshift(f);e=i.apply(f,q)}finally{e!==p&&(b.preventDefault?b.preventDefault():b.returnValue=t)}l[g+"Bubble"]===t&&(b.cancelBubble=p,b.stopPropagation&&b.stopPropagation())}})})()}};a.c.submit={init:function(b,c,d,f){"function"!=typeof c()&&m(Error("The value for a submit binding must be a function"));a.a.n(b,"submit",function(a){var e,d=c();try{e=d.call(f,b)}finally{e!==p&&(a.preventDefault?a.preventDefault():a.returnValue=t)}})}};a.c.visible={update:function(b,c){var d=a.a.d(c()),f="none"!=b.style.display;d&&!f?b.style.display="":!d&&f&&(b.style.display="none")}};a.c.enable={update:function(b,c){var d=a.a.d(c());d&&b.disabled?b.removeAttribute("disabled"):!d&&!b.disabled&&(b.disabled=p)}};a.c.disable={update:function(b,c){a.c.enable.update(b,function(){return!a.a.d(c())})}};a.c.value={init:function(b,c,d){function f(){var e=c(),f=a.k.r(b);a.g.$(e,d,"value",f,p)}var g=["change"],e=d().valueUpdate;e&&("string"==typeof e&&(e=[e]),a.a.N(g,e),g=a.a.za(g));if(a.a.ja&&("input"==b.tagName.toLowerCase()&&"text"==b.type&&"off"!=b.autocomplete&&(!b.form||"off"!=b.form.autocomplete))&&-1==a.a.j(g,"propertychange")){var h=t;a.a.n(b,"propertychange",function(){h=p});a.a.n(b,"blur",function(){if(h){h=t;f()}})}a.a.v(g,function(c){var e=f;if(a.a.Hb(c,"after")){e=function(){setTimeout(f,0)};c=c.substring(5)}a.a.n(b,c,e)})},update:function(b,c){var d="select"===a.a.o(b),f=a.a.d(c()),g=a.k.r(b),e=f!=g;0===f&&(0!==g&&"0"!==g)&&(e=p);e&&(g=function(){a.k.S(b,f)},g(),d&&setTimeout(g,0));d&&0<b.length&&B(b,f,t)}};a.c.options={update:function(b,c,d){"select"!==a.a.o(b)&&m(Error("options binding applies only to SELECT elements"));for(var f=0==b.length,g=a.a.T(a.a.aa(b.childNodes,function(b){return b.tagName&&"option"===a.a.o(b)&&b.selected}),function(b){return a.k.r(b)||b.innerText||b.textContent}),e=b.scrollTop,h=a.a.d(c());0<b.length;)a.F(b.options[0]),b.remove(0);if(h){d=d();"number"!=typeof h.length&&(h=[h]);if(d.optionsCaption){var j=document.createElement("option");a.a.Y(j,d.optionsCaption);a.k.S(j,n);b.appendChild(j)}for(var c=0,k=h.length;c<k;c++){var j=document.createElement("option"),i="string"==typeof d.optionsValue?h[c][d.optionsValue]:h[c],i=a.a.d(i);a.k.S(j,i);var l=d.optionsText,i="function"==typeof l?l(h[c]):"string"==typeof l?h[c][l]:i;if(i===s||i===n)i="";a.a.Qa(j,i);b.appendChild(j)}h=b.getElementsByTagName("option");c=j=0;for(k=h.length;c<k;c++)0<=a.a.j(g,a.k.r(h[c]))&&(a.a.Pa(h[c],p),j++);b.scrollTop=e;f&&"value"in d&&B(b,a.a.d(d.value),p);a.a.lb(b)}}};a.c.options.oa="__ko.optionValueDomData__";a.c.selectedOptions={Ea:function(b){for(var c=[],b=b.childNodes,d=0,f=b.length;d<f;d++){var g=b[d],e=a.a.o(g);"option"==e&&g.selected?c.push(a.k.r(g)):"optgroup"==e&&(g=a.c.selectedOptions.Ea(g),Array.prototype.splice.apply(c,[c.length,0].concat(g)))}return c},init:function(b,c,d){a.a.n(b,"change",function(){var b=c(),g=a.c.selectedOptions.Ea(this);a.g.$(b,d,"value",g)})},update:function(b,c){"select"!=a.a.o(b)&&m(Error("values binding applies only to SELECT elements"));var d=a.a.d(c());if(d&&"number"==typeof d.length)for(var f=b.childNodes,g=0,e=f.length;g<e;g++){var h=f[g];"option"===a.a.o(h)&&a.a.Pa(h,0<=a.a.j(d,a.k.r(h)))}}};a.c.text={update:function(b,c){a.a.Qa(b,c())}};a.c.html={init:function(){return{controlsDescendantBindings:p}},update:function(b,c){var d=a.a.d(c());a.a.Y(b,d)}};a.c.css={update:function(b,c){var d=a.a.d(c()||{}),f;for(f in d)if("string"==typeof f){var g=a.a.d(d[f]);a.a.Ua(b,f,g)}}};a.c.style={update:function(b,c){var d=a.a.d(c()||{}),f;for(f in d)if("string"==typeof f){var g=a.a.d(d[f]);b.style[f]=g||""}}};a.c.uniqueName={init:function(b,c){c()&&(b.name="ko_unique_"+ ++a.c.uniqueName.gb,(a.a.tb||a.a.ub)&&b.mergeAttributes(document.createElement("<input name='"+b.name+"'/>"),t))}};a.c.uniqueName.gb=0;a.c.checked={init:function(b,c,d){a.a.n(b,"click",function(){var f;if("checkbox"==b.type)f=b.checked;else if("radio"==b.type&&b.checked)f=b.value;else return;var g=c();"checkbox"==b.type&&a.a.d(g)instanceof Array?(f=a.a.j(a.a.d(g),b.value),b.checked&&0>f?g.push(b.value):!b.checked&&0<=f&&g.splice(f,1)):a.g.$(g,d,"checked",f,p)});"radio"==b.type&&!b.name&&a.c.uniqueName.init(b,A(p))},update:function(b,c){var d=a.a.d(c());"checkbox"==b.type?b.checked=d instanceof Array?0<=a.a.j(d,b.value):d:"radio"==b.type&&(b.checked=b.value==d)}};var F={"class":"className","for":"htmlFor"};a.c.attr={update:function(b,c){var d=a.a.d(c())||{},f;for(f in d)if("string"==typeof f){var g=a.a.d(d[f]),e=g===t||g===s||g===n;e&&b.removeAttribute(f);8>=a.a.ja&&f in F?(f=F[f],e?b.removeAttribute(f):b[f]=g):e||b.setAttribute(f,g.toString())}}};a.c.hasfocus={init:function(b,c,d){function f(b){var e=c();a.g.$(e,d,"hasfocus",b,p)}a.a.n(b,"focus",function(){f(p)});a.a.n(b,"focusin",function(){f(p)});a.a.n(b,"blur",function(){f(t)});a.a.n(b,"focusout",function(){f(t)})},update:function(b,c){var d=a.a.d(c());d?b.focus():b.blur();a.a.va(b,d?"focusin":"focusout")}};a.c["with"]={p:function(b){return function(){var c=b();return{"if":c,data:c,templateEngine:a.q.K}}},init:function(b,c){return a.c.template.init(b,a.c["with"].p(c))},update:function(b,c,d,f,g){return a.c.template.update(b,a.c["with"].p(c),d,f,g)}};a.g.D["with"]=t;a.e.C["with"]=p;a.c["if"]={p:function(b){return function(){return{"if":b(),templateEngine:a.q.K}}},init:function(b,c){return a.c.template.init(b,a.c["if"].p(c))},update:function(b,c,d,f,g){return a.c.template.update(b,a.c["if"].p(c),d,f,g)}};a.g.D["if"]=t;a.e.C["if"]=p;a.c.ifnot={p:function(b){return function(){return{ifnot:b(),templateEngine:a.q.K}}},init:function(b,c){return a.c.template.init(b,a.c.ifnot.p(c))},update:function(b,c,d,f,g){return a.c.template.update(b,a.c.ifnot.p(c),d,f,g)}};a.g.D.ifnot=t;a.e.C.ifnot=p;a.c.foreach={p:function(b){return function(){var c=a.a.d(b());return!c||"number"==typeof c.length?{foreach:c,templateEngine:a.q.K}:{foreach:c.data,includeDestroyed:c.includeDestroyed,afterAdd:c.afterAdd,beforeRemove:c.beforeRemove,afterRender:c.afterRender,templateEngine:a.q.K}}},init:function(b,c){return a.c.template.init(b,a.c.foreach.p(c))},update:function(b,c,d,f,g){return a.c.template.update(b,a.c.foreach.p(c),d,f,g)}};a.g.D.foreach=t;a.e.C.foreach=p;a.t=function(){};a.t.prototype.renderTemplateSource=function(){m(Error("Override renderTemplateSource"))};a.t.prototype.createJavaScriptEvaluatorBlock=function(){m(Error("Override createJavaScriptEvaluatorBlock"))};a.t.prototype.makeTemplateSource=function(b,c){if("string"==typeof b){var c=c||document,d=c.getElementById(b);d||m(Error("Cannot find template with ID "+b));return new a.l.i(d)}if(1==b.nodeType||8==b.nodeType)return new a.l.M(b);m(Error("Unknown template type: "+b))};a.t.prototype.renderTemplate=function(a,c,d,f){return this.renderTemplateSource(this.makeTemplateSource(a,f),c,d)};a.t.prototype.isTemplateRewritten=function(a,c){return this.allowTemplateRewriting===t||!(c&&c!=document)&&this.V&&this.V[a]?p:this.makeTemplateSource(a,c).data("isRewritten")};a.t.prototype.rewriteTemplate=function(a,c,d){var f=this.makeTemplateSource(a,d),c=c(f.text());f.text(c);f.data("isRewritten",p);!(d&&d!=document)&&"string"==typeof a&&(this.V=this.V||{},this.V[a]=p)};a.b("templateEngine",a.t);a.Z=function(){function b(b,c,e){for(var b=a.g.W(b),d=a.g.D,j=0;j<b.length;j++){var k=b[j].key;if(d.hasOwnProperty(k)){var i=d[k];"function"===typeof i?(k=i(b[j].value))&&m(Error(k)):i||m(Error("This template engine does not support the '"+k+"' binding within its templates"))}}b="ko.templateRewriting.applyMemoizedBindingsToNextSibling(function() {             return (function() { return { "+a.g.ka(b)+" } })()         })";return e.createJavaScriptEvaluatorBlock(b)+c}var c=/(<[a-z]+\d*(\s+(?!data-bind=)[a-z0-9\-]+(=(\"[^\"]*\"|\'[^\']*\'))?)*\s+)data-bind=(["'])([\s\S]*?)\5/gi,d=/<\!--\s*ko\b\s*([\s\S]*?)\s*--\>/g;return{mb:function(b,c,e){c.isTemplateRewritten(b,e)||c.rewriteTemplate(b,function(b){return a.Z.zb(b,c)},e)},zb:function(a,g){return a.replace(c,function(a,c,d,f,i,l,q){return b(q,c,g)}).replace(d,function(a,c){return b(c,"<\!-- ko --\>",g)})},Za:function(b){return a.s.na(function(c,e){c.nextSibling&&a.ya(c.nextSibling,b,e)})}}}();a.b("templateRewriting",a.Z);a.b("templateRewriting.applyMemoizedBindingsToNextSibling",a.Z.Za);(function(){a.l={};a.l.i=function(a){this.i=a};a.l.i.prototype.text=function(){var b=a.a.o(this.i),b="script"===b?"text":"textarea"===b?"value":"innerHTML";if(0==arguments.length)return this.i[b];var c=arguments[0];"innerHTML"===b?a.a.Y(this.i,c):this.i[b]=c};a.l.i.prototype.data=function(b){if(1===arguments.length)return a.a.f.get(this.i,"templateSourceData_"+
b);a.a.f.set(this.i,"templateSourceData_"+b,arguments[1])};a.l.M=function(a){this.i=a};a.l.M.prototype=new a.l.i;a.l.M.prototype.text=function(){if(0==arguments.length){var b=a.a.f.get(this.i,"__ko_anon_template__")||{};b.ua===n&&b.da&&(b.ua=b.da.innerHTML);return b.ua}a.a.f.set(this.i,"__ko_anon_template__",{ua:arguments[0]})};a.l.i.prototype.nodes=function(){if(0==arguments.length)return(a.a.f.get(this.i,"__ko_anon_template__")||{}).da;a.a.f.set(this.i,"__ko_anon_template__",{da:arguments[0]})};a.b("templateSources",a.l);a.b("templateSources.domElement",a.l.i);a.b("templateSources.anonymousTemplate",a.l.M)})();(function(){function b(b,c,d){for(var f,c=a.e.nextSibling(c);b&&(f=b)!==c;)b=a.e.nextSibling(f),(1===f.nodeType||8===f.nodeType)&&d(f)}function c(c,d){if(c.length){var f=c[0],g=c[c.length-1];b(f,g,function(b){a.xa(d,b)});b(f,g,function(b){a.s.Wa(b,[d])})}}function d(a){return a.nodeType?a:0<a.length?a[0]:s}function f(b,f,j,k,i){var i=i||{},l=b&&d(b),l=l&&l.ownerDocument,q=i.templateEngine||g;a.Z.mb(j,q,l);j=q.renderTemplate(j,k,i,l);("number"!=typeof j.length||0<j.length&&"number"!=typeof j[0].nodeType)&&m(Error("Template engine must return an array of DOM nodes"));l=t;switch(f){case"replaceChildren":a.e.X(b,j);l=p;break;case"replaceNode":a.a.Na(b,j);l=p;break;case"ignoreTargetNode":break;default:m(Error("Unknown renderMode: "+f))}l&&(c(j,k),i.afterRender&&i.afterRender(j,k.$data));return j}var g;a.ra=function(b){b!=n&&!(b instanceof a.t)&&m(Error("templateEngine must inherit from ko.templateEngine"));g=b};a.qa=function(b,c,j,k,i){j=j||{};(j.templateEngine||g)==n&&m(Error("Set a template engine before calling renderTemplate"));i=i||"replaceChildren";if(k){var l=d(k);return a.h(function(){var g=c&&c instanceof a.z?c:new a.z(a.a.d(c)),o="function"==typeof b?b(g.$data):b,g=f(k,i,o,g,j);"replaceNode"==i&&(k=g,l=d(k))},s,{disposeWhen:function(){return!l||!a.a.fa(l)},disposeWhenNodeIsRemoved:l&&"replaceNode"==i?l.parentNode:l})}return a.s.na(function(d){a.qa(b,c,j,d,"replaceNode")})};a.Fb=function(b,d,g,k,i){function l(a,b){c(b,o);g.afterRender&&g.afterRender(b,a)}function q(c,d){var h="function"==typeof b?b(c):b;o=i.createChildContext(a.a.d(c));o.$index=d;return f(s,"ignoreTargetNode",h,o,g)}var o;return a.h(function(){var b=a.a.d(d)||[];"undefined"==typeof b.length&&(b=[b]);b=a.a.aa(b,function(b){return g.includeDestroyed||b===n||b===s||!a.a.d(b._destroy)});a.a.Oa(k,b,q,g,l)},s,{disposeWhenNodeIsRemoved:k})};a.c.template={init:function(b,c){var d=a.a.d(c());if("string"!=typeof d&&!d.name&&(1==b.nodeType||8==b.nodeType))d=1==b.nodeType?b.childNodes:a.e.childNodes(b),d=a.a.Ab(d),(new a.l.M(b)).nodes(d);return{controlsDescendantBindings:p}},update:function(b,c,d,f,g){c=a.a.d(c());f=p;"string"==typeof c?d=c:(d=c.name,"if"in c&&(f=f&&a.a.d(c["if"])),"ifnot"in c&&(f=f&&!a.a.d(c.ifnot)));var l=s;"object"===typeof c&&"foreach"in c?l=a.Fb(d||b,f&&c.foreach||[],c,b,g):f?(g="object"==typeof c&&"data"in c?g.createChildContext(a.a.d(c.data)):g,l=a.qa(d||b,g,c,b)):a.e.ha(b);g=l;(c=a.a.f.get(b,"__ko__templateSubscriptionDomDataKey__"))&&"function"==typeof c.A&&c.A();a.a.f.set(b,"__ko__templateSubscriptionDomDataKey__",g)}};a.g.D.template=function(b){b=a.g.W(b);return 1==b.length&&b[0].unknown||a.g.wb(b,"name")?s:"This template engine does not support anonymous templates nested within its templates"};a.e.C.template=p})();a.b("setTemplateEngine",a.ra);a.b("renderTemplate",a.qa);(function(){a.a.O=function(b,c,d){if(d===n)return a.a.O(b,c,1)||a.a.O(b,c,10)||a.a.O(b,c,Number.MAX_VALUE);for(var b=b||[],c=c||[],f=b,g=c,e=[],h=0;h<=g.length;h++)e[h]=[];for(var h=0,j=Math.min(f.length,d);h<=j;h++)e[0][h]=h;h=1;for(j=Math.min(g.length,d);h<=j;h++)e[h][0]=h;for(var j=f.length,k,i=g.length,h=1;h<=j;h++){k=Math.max(1,h-d);for(var l=Math.min(i,h+d);k<=l;k++)e[k][h]=f[h-1]===g[k-1]?e[k-1][h-1]:Math.min(e[k-1][h]===n?Number.MAX_VALUE:e[k-1][h]+1,e[k][h-1]===n?Number.MAX_VALUE:e[k][h-1]+1)}d=b.length;f=c.length;g=[];h=e[f][d];if(h===n)e=s;else{for(;0<d||0<f;){j=e[f][d];i=0<f?e[f-1][d]:h+1;l=0<d?e[f][d-1]:h+1;k=0<f&&0<d?e[f-1][d-1]:h+1;if(i===n||i<j-1)i=h+1;if(l===n||l<j-1)l=h+1;k<j-1&&(k=h+1);i<=l&&i<k?(g.push({status:"added",value:c[f-1]}),f--):(l<i&&l<k?g.push({status:"deleted",value:b[d-1]}):(g.push({status:"retained",value:b[d-1]}),f--),d--)}e=g.reverse()}return e}})();a.b("utils.compareArrays",a.a.O);(function(){function b(a){if(2<a.length){for(var b=a[0],c=a[a.length-1],e=[b];b!==c;){b=b.nextSibling;if(!b)return;e.push(b)}Array.prototype.splice.apply(a,[0,a.length].concat(e))}}function c(c,f,g,e,h){var j=[],c=a.h(function(){var c=f(g,h)||[];0<j.length&&(b(j),a.a.Na(j,c),e&&e(g,c));j.splice(0,j.length);a.a.N(j,c)},s,{disposeWhenNodeIsRemoved:c,disposeWhen:function(){return 0==j.length||!a.a.fa(j[0])}});return{xb:j,h:c}}a.a.Oa=function(d,f,g,e,h){for(var f=f||[],e=e||{},j=a.a.f.get(d,"setDomNodeChildrenFromArrayMapping_lastMappingResult")===n,k=a.a.f.get(d,"setDomNodeChildrenFromArrayMapping_lastMappingResult")||[],i=a.a.T(k,function(a){return a.$a}),l=a.a.O(i,f),f=[],q=0,o=[],v=0,i=[],u=s,r=0,w=l.length;r<w;r++)switch(l[r].status){case"retained":var y=k[q];y.qb(v);v=f.push(y);0<y.P.length&&(u=y.P[y.P.length-1]);q++;break;case"deleted":k[q].h.A();b(k[q].P);a.a.v(k[q].P,function(a){o.push({element:a,index:r,value:l[r].value});u=a});q++;break;case"added":for(var y=l[r].value,x=a.m(v),v=c(d,g,y,h,x),C=v.xb,v=f.push({$a:l[r].value,P:C,h:v.h,qb:x}),z=0,B=C.length;z<B;z++){var D=C[z];i.push({element:D,index:r,value:l[r].value});u==s?a.e.Ka(d,D):a.e.Fa(d,D,u);u=D}h&&h(y,C,x)}a.a.v(o,function(b){a.F(b.element)});g=t;if(!j){if(e.afterAdd)for(r=0;r<i.length;r++)e.afterAdd(i[r].element,i[r].index,i[r].value);if(e.beforeRemove){for(r=0;r<o.length;r++)e.beforeRemove(o[r].element,o[r].index,o[r].value);g=p}}if(!g&&o.length)for(r=0;r<o.length;r++)e=o[r].element,e.parentNode&&e.parentNode.removeChild(e);a.a.f.set(d,"setDomNodeChildrenFromArrayMapping_lastMappingResult",f)}})();a.b("utils.setDomNodeChildrenFromArrayMapping",a.a.Oa);a.q=function(){this.allowTemplateRewriting=t};a.q.prototype=new a.t;a.q.prototype.renderTemplateSource=function(b){var c=!(9>a.a.ja)&&b.nodes?b.nodes():s;if(c)return a.a.L(c.cloneNode(p).childNodes);b=b.text();return a.a.pa(b)};a.q.K=new a.q;a.ra(a.q.K);a.b("nativeTemplateEngine",a.q);(function(){a.ma=function(){var a=this.vb=function(){if("undefined"==typeof jQuery||!jQuery.tmpl)return 0;try{if(0<=jQuery.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(a){}return 1}();this.renderTemplateSource=function(b,f,g){g=g||{};2>a&&m(Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later."));var e=b.data("precompiled");e||(e=b.text()||"",e=jQuery.template(s,"{{ko_with $item.koBindingContext}}"+e+"{{/ko_with}}"),b.data("precompiled",e));b=[f.$data];f=jQuery.extend({koBindingContext:f},g.templateOptions);f=jQuery.tmpl(e,b,f);f.appendTo(document.createElement("div"));jQuery.fragments={};return f};this.createJavaScriptEvaluatorBlock=function(a){return"{{ko_code ((function() { return "+a+" })()) }}"};this.addTemplate=function(a,b){document.write("<script type='text/html' id='"+a+"'>"+b+"<\/script>")};0<a&&(jQuery.tmpl.tag.ko_code={open:"__.push($1 || '');"},jQuery.tmpl.tag.ko_with={open:"with($1) {",close:"} "})};a.ma.prototype=new a.t;var b=new a.ma;0<b.vb&&a.ra(b);a.b("jqueryTmplTemplateEngine",a.ma)})()}"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?E(module.exports||exports):"function"===typeof define&&define.amd?define(["exports"],E):E(window.ko={});p;})(window,document,navigator);
;;;
(function($){$.fn.hoverIntent=function(f,g){var cfg={sensitivity:7,interval:100,timeout:0};cfg=$.extend(cfg,g?{over:f,out:g}:f);var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if((Math.abs(pX-cX)+Math.abs(pY-cY))<cfg.sensitivity){$(ob).unbind("mousemove",track);ob.hoverIntent_s=1;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=0;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var ev=jQuery.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)}if(e.type=="mouseenter"){pX=ev.pageX;pY=ev.pageY;$(ob).bind("mousemove",track);if(ob.hoverIntent_s!=1){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}}else{$(ob).unbind("mousemove",track);if(ob.hoverIntent_s==1){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}}};return this.bind('mouseenter',handleHover).bind('mouseleave',handleHover)}})(jQuery);
;;;
jQuery(document).ready(function($){function megaHoverOver(){$(this).addClass('mmItemHover').find(".megaborder").stop().show();setDimensions($(this));}
function megaHoverOut(){$(this).removeClass('mmItemHover').find(".megaborder").stop().fadeOut('fast',function(){$(this).hide();});}
function setDimensions(obj){maxWidth=0;maxHeight=0;numColumns=0;maxColumns=3;obj.find("li.category").each(function(){numColumns++;maxWidth=($(this).width()>maxWidth)?$(this).width():maxWidth;});maxWidth=(numColumns>maxColumns)?(maxWidth*maxColumns):(maxWidth*numColumns);obj.find("li.category").each(function(){maxHeight=($(this).height()>maxHeight)?$(this).height():maxHeight;});obj.find(".megaborder").css({'width':maxWidth + 20});obj.find("li.category").each(function(){var thisPosition=$(this).index()+ 1;if(thisPosition%3==0){$(this).addClass("mmRightColumn");}}).css({'height':maxHeight});}
var config={sensitivity:2,interval:100,over:megaHoverOver,timeout:500,out:megaHoverOut};$("ul.dnnmega li.mmHasChild").hoverIntent(config);var firstTouch=true;$("ul.dnnmega li.mmHasChild").bind("touchstart",function(){if(firstTouch){firstTouch=false;setDimensions($(this));$(this).find(".megaborder").stop().show();return false;}});});
;;;
(function($){$.fn.dnnComposeMessage=function(options){var opts=$.extend({},$.fn.dnnComposeMessage.defaultOptions,options),$wrap=$(opts.openTriggerScope),html,composeMessageDialog,canSend=false,users=[],roles=[],attachments=[];opts.serviceurlbase=opts.servicesFramework.getServiceRoot('InternalServices')+'MessagingService.ashx/';html="<fieldset>";html +="<div class='dnnFormItem'><label for='to'>"+ opts.toText +"</label><input type='text' id='to' name='to'/></div>";html +="<div class='dnnFormItem'><label for='subject'>"+ opts.subjectText +"</label><input type='text' id='subject' name='subject' maxlength='400'/></div>";html +="<div class='dnnFormItem'><label for='bodytext'>"+ opts.messageText +"</label><textarea rows='2' cols='20' id='bodytext' name='bodytext'/></div>";if(opts.showAttachments){html +="<div class='dnnFormItem'><label>"+ opts.attachmentsText +"</label><div class='dnnLeft'><button type='button' id='fileFromSite' class='dnnTertiaryAction'><span>"+ opts.browseText +"</span></button><div class='messageAttachments'><ul></ul></div></div></div>";html +="<div id='userFileManager'></div>";opts.userFileManagerOptions.openTriggerSelector='#fileFromSite';opts.userFileManagerOptions.attachCallback=function(file){if($.inArray(file.id,attachments)===-1){attachments.push(file.id);composeMessageDialog.find('.messageAttachments ul').append('<li><a href="#" title="'+ file.name +'">'+ file.name +'</a><a href="#" class="removeAttachment" title="'+ opts.removeText +'"></a></li>');composeMessageDialog.find('.messageAttachments li:last-child .removeAttachment').click(function(){var index=$.inArray(file.id,attachments);if(index!==-1){attachments.splice(index,1);$(this).parent().remove();}
return false;});}};}
html +="</fieldset>";function getWaitTimeForNextMessage(){var returnValue=0;$.ajax({url:opts.serviceurlbase +"WaitTimeForNextMessage",async:false,cache:false}).done(function(data){if(data.Result==="success"){returnValue=data.Value;}});return returnValue;};function updateSendButtonStatus(){var sendButton=composeMessageDialog.dialog("widget").find('.ui-dialog-buttonpane button:first');if((users.length>0||roles.length>0)&&composeMessageDialog.find('#subject').val().trim().length>0&&canSend){sendButton.removeAttr('disabled').removeClass('disabled');}else{sendButton.attr('disabled','disabled').addClass('disabled');}};function displayMessage(placeHolderElement,message){var messageNode=$("<div/>").addClass('dnnFormMessage dnnFormWarning').text(message);placeHolderElement.prepend(messageNode);messageNode.fadeOut(3000,'easeInExpo',function(){messageNode.remove();});};$wrap.delegate(opts.openTriggerSelector,'click',function(e){e.preventDefault();e.stopPropagation();var autoclose,messageId=-1;canSend=false;users=[];roles=[];attachments=[];composeMessageDialog=$("<div class='composeMessageDialog dnnForm dnnClear'/>").html(html).dialog(opts);if(opts.showAttachments&&!$wrap.data('fileManagerInitialized')){composeMessageDialog.find('#userFileManager').userFileManager(opts.userFileManagerOptions);$wrap.data('fileManagerInitialized',true);}
composeMessageDialog.find('#to').tokenInput(opts.serviceurlbase +"Search",{theme:"facebook",resultsFormatter:function(item){if(item.id.startsWith("user-")){return"<li class='user'><img src='"+ item.iconfile +"' title='"+ item.name +"' height='25px' width='25px' /><span>"+ item.name +"</span></li>";}else if(item.id.startsWith("role-")){return"<li class='role'><img src='"+ item.iconfile +"' title='"+ item.name +"' height='25px' width='25px' /><span>"+ item.name +"</span></li>";}
return"<li>"+ item[this.propertyToSearch]+"</li>";},minChars:2,preventDuplicates:true,hintText:'',noResultsText:opts.noResultsText,searchingText:opts.searchingText,onAdd:function(item){if(item.id.startsWith("user-")){users.push(item.id.substring(5));}else if(item.id.startsWith("role-")){roles.push(item.id.substring(5));}
updateSendButtonStatus();},onDelete:function(item){var array=item.id.startsWith("user-")?users:roles,id=item.id.substring(5),index=$.inArray(id,array);if(index!==-1){array.splice(index,1);}
updateSendButtonStatus();},onError:function(xhr,status){displayMessage(composeMessageDialog,opts.autoSuggestErrorText + status);}});composeMessageDialog.find('#subject').keyup(function(){updateSendButtonStatus();});var prePopulatedRecipients=opts.onPrePopulate(this);if(prePopulatedRecipients!=null){var to=composeMessageDialog.find('#to');$.each(prePopulatedRecipients,function(index,value){to.tokenInput("add",value);});}
composeMessageDialog.dialog({minWidth:650,modal:true,resizable:false,open:function(){composeMessageDialog.dialog("widget").find('.ui-dialog-buttonpane :button').removeClass().addClass('dnnTertiaryAction');messageId=-1;canSend=false;var sendButton=composeMessageDialog.dialog("widget").find('.ui-dialog-buttonpane button:first');var timeForNextMessage=getWaitTimeForNextMessage();if(timeForNextMessage>0){var throttlingMessage=$('<div/>').addClass('ThrottlingWarning dnnFormMessage dnnFormWarning').text(opts.throttlingText +' '+ timeForNextMessage +' sec');composeMessageDialog.prepend(throttlingMessage);sendButton.attr('disabled','disabled').addClass('disabled');var countdown=setInterval(function(){timeForNextMessage--;if(timeForNextMessage==0){canSend=true;throttlingMessage.remove();if(composeMessageDialog.find('#to').val().trim().length>0&&composeMessageDialog.find('#subject').val().trim().length>0){sendButton.removeAttr('disabled').removeClass('disabled');}
clearInterval(countdown);}else{throttlingMessage.text(opts.throttlingText +' '+ timeForNextMessage +' sec');}},1000);}else{canSend=true;sendButton.attr('disabled','disabled').addClass('disabled');}
if(prePopulatedRecipients!=null){composeMessageDialog.find('#subject').focus();}},buttons:[{text:opts.sendText,click:function(){var params={subject:encodeURIComponent(composeMessageDialog.find('#subject').val()),body:encodeURIComponent(composeMessageDialog.find('#bodytext').val()),roleIds:(roles.length>0?JSON.stringify(roles):{}),userIds:(users.length>0?JSON.stringify(users):{}),fileIds:(attachments.length>0?JSON.stringify(attachments):{})};$.post(opts.serviceurlbase +"Create",opts.servicesFramework.getAntiForgeryProperty(params),function(data){if(data.Result==="success"){composeMessageDialog.dialog("option","title",opts.messageSentTitle);var dismissThis=$('<a href="javascript:void(0)"/>').text(' '+ opts.dismissThisText).click(function(){composeMessageDialog.dialog("close");});var messageSent=$('<div/>').addClass('MessageSent dnnFormMessage dnnFormSuccess').text(opts.messageSentText).append(dismissThis);composeMessageDialog.html(messageSent);composeMessageDialog.dialog("widget").find('.ui-dialog-buttonpane button').remove();messageId=data.Value;autoclose=setInterval(function(){composeMessageDialog.dialog("close");},opts.msgSentAutoCloseTimeout);}else{displayMessage(composeMessageDialog,opts.createMessageErrorText);}}).fail(function(xhr,status){displayMessage(composeMessageDialog,opts.createMessageErrorWithDescriptionText + status);});}},{text:opts.cancelText,click:function(){$(this).dialog("close");}}],close:function(){if(autoclose!=null){clearInterval(autoclose);}
if(messageId!=-1&&opts.onMessageSent!=null){opts.onMessageSent(messageId);}}});composeMessageDialog.dialog('open');});};$.fn.dnnComposeMessage.defaultOptions={openTriggerScope:'body',openTriggerSelector:'.ComposeMessage',onMessageSent:function(messageId){},title:'Compose Message',toText:'Send to',subjectText:'Subject',messageText:'Your Message',attachmentsText:'Attachment(s)',browseText:'Browse',removeText:'Remove attachment',sendText:'Send',cancelText:'Cancel',messageSentTitle:'Message Sent',messageSentText:'Your message has been sent successfully.',dismissThisText:'Dismiss this',throttlingText:'Please wait before sending a new message.',noResultsText:'No results',searchingText:'Searching...',createMessageErrorText:'An error occurred while creating the message. Please try again later.',createMessageErrorWithDescriptionText:'An error occurred while creating the message: ',autoSuggestErrorText:'An error occurred while getting suggestions: ',dialogClass:'dnnFormPopup dnnClear',autoOpen:false,showAttachments:false,onPrePopulate:function(target){return null;},msgSentAutoCloseTimeout:3000,userFileManagerOptions:{}};}(jQuery));
;;;
(function($,ko){"use strict";$.fn.userFileManager=function(options){var opts=$.extend({},$.fn.userFileManager.defaultOptions,options),$wrap=$(this),templateUrl=opts.templatePath + opts.templateName + opts.templateExtension;function fileManagerModel(items){var self=this,data=items;self.items=ko.observableArray(data);self.chosenFolderId=ko.observable();self.chosenFolderData=ko.observable();self.chosenFileData=ko.observable();self.nameHeaderText=ko.observable();self.typeHeaderText=ko.observable();self.lastModifiedHeaderText=ko.observable();self.fileSizeText=ko.observable();self.find=function(array,id){if(array){for(var i=0;i<array.length;i++){if(array[i].id===id){return array[i];}
var a=self.find(array[i].children,id);if(a!==null){return a;}}}
return null;};self.goToFolder=function(folder){self.chosenFileData(null);$wrap.data('chosenFileData',null);self.chosenFolderData(self.find(data,folder.id));self.chosenFolderId(folder.id);};self.updateItems=function(newItems){data=newItems;self.items=ko.observable(newItems);self.goToFolder(newItems[0]);};self.showFilePreview=function(file){self.chosenFileData(file);$wrap.data('chosenFileData',file);};self.attachFile=function(file){opts.attachCallback(file);$wrap.dialog('close');};ko.bindingHandlers.updateRowNumbers={update:function(){$('#'+ $wrap.attr("id")+' tbody tr').each(function(i){$(this).find('td.fm-number').text(i + 1);});}};self.currentBreadcrumbs=ko.computed(function(){var result=[],current=self.chosenFolderData();while(current){result.unshift(current);current=current.parentId?self.find(data,current.parentId):null;}
return result;},self);self.nameHeaderText=opts.nameHeaderText;self.typeHeaderText=opts.typeHeaderText;self.lastModifiedHeaderText=opts.lastModifiedHeaderText;self.fileSizeText=opts.fileSizeText;self.goToFolder(data[0]);}
function getItems(callback){$.get(opts.getItemsServiceUrl,{fileExtensions:$wrap.data('fileExtensions')},callback);}
$.get(templateUrl,function(data){$wrap.html(data);});$wrap.css('display','none');$(opts.openTriggerScope).delegate(opts.openTriggerSelector,'click',function(e){e.preventDefault();getItems(function(result){if($wrap.data('userFileManager.bound')===true){var boundDomElement=$wrap.get(0);var context=ko.contextFor(boundDomElement);context.$root.updateItems(result);}
else{ko.applyBindings(new fileManagerModel(result),document.getElementById($wrap.attr('id')));$wrap.data('userFileManager.bound',true);}});$wrap.dialog({dialogClass:opts.dialogClass,width:opts.width,minHeight:opts.minHeight,title:opts.title,modal:true,resizable:true,open:function(event,ui){var $div=$('<div />',{'class':'fm-actions'});var $actionList=$('<ul />',{'class':'dnnActions'});$('<a />',{'class':'dnnSecondaryAction',text:opts.cancelText,href:'#'}).appendTo($actionList).click(function(ev){ev.preventDefault();$(event.target).dialog('close');});$('<a />',{'class':'dnnPrimaryAction',text:opts.attachText,href:'#'}).appendTo($actionList).click(function(ev){ev.preventDefault();var file=$wrap.data('chosenFileData');if(file){opts.attachCallback(file);$(event.target).dialog("close");}});$actionList.appendTo($div);$div.appendTo($wrap.dialog("widget").find('.ui-dialog-buttonpane'));$wrap.dialog("widget").find('.ui-dialog-buttonset').hide();},buttons:[{}],close:function(){}});});$.fn.userFileManager.setFileExtensions=function(fileExtensions){$wrap.data('fileExtensions',fileExtensions);};};$.fn.userFileManager.defaultOptions={openTriggerScope:'body',openTriggerSelector:'#photoFromSite',dialogClass:'dnnFormPopup fileManagerPopup',width:'700px',minHeight:'400px',getItemsServiceUrl:'/DesktopModules/Journal/API/UserFile.ashx/GetItems',attachCallback:function(file){alert(file.name +' attached.');},templatePath:'/Resources/Shared/Components/UserFileManager/Templates/',templateName:'Default',templateExtension:'.html',title:'My Files',cancelText:'Cancel',attachText:'Attach',nameHeaderText:'Name',typeHeaderText:'Type',lastModifiedHeaderText:'Last Modified',fileSizeText:'File size: '};}(jQuery,ko));
;;;
(function($){var DEFAULT_SETTINGS={method:"GET",contentType:"json",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",jsonContainer:null,hintText:"Type in a search term",noResultsText:"No results",searchingText:"Searching...",deleteText:"&times;",animateDropdown:true,tokenLimit:null,tokenDelimiter:",",preventDuplicates:false,tokenValue:"id",prePopulate:null,processPrePopulate:false,idPrefix:"token-input-",resultsFormatter:function(item){return"<li>"+ item[this.propertyToSearch]+"</li>"},tokenFormatter:function(item){return"<li><p>"+ item[this.propertyToSearch]+"</p></li>"},onResult:null,onError:null,onAdd:null,onDelete:null,onReady:null};var DEFAULT_CLASSES={tokenList:"token-input-list",token:"token-input-token",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token"};var POSITION={BEFORE:0,AFTER:1,END:2};var KEY={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMPAD_ENTER:108,COMMA:188};var methods={init:function(url_or_data_or_function,options){var settings=$.extend({},DEFAULT_SETTINGS,options||{});return this.each(function(){$(this).data("tokenInputObject",new $.TokenList(this,url_or_data_or_function,settings));});},clear:function(){this.data("tokenInputObject").clear();return this;},add:function(item){this.data("tokenInputObject").add(item);return this;},remove:function(item){this.data("tokenInputObject").remove(item);return this;},get:function(){return this.data("tokenInputObject").getTokens();}}
$.fn.tokenInput=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else{return methods.init.apply(this,arguments);}};$.TokenList=function(input,url_or_data,settings){if($.type(url_or_data)==="string"||$.type(url_or_data)==="function"){settings.url=url_or_data;var url=computeURL();if(settings.crossDomain===undefined){if(url.indexOf("://")===-1){settings.crossDomain=false;}else{settings.crossDomain=(location.href.split(/\/+/g)[1]!==url.split(/\/+/g)[1]);}}}else if(typeof(url_or_data)==="object"){settings.local_data=url_or_data;}
if(settings.classes){settings.classes=$.extend({},DEFAULT_CLASSES,settings.classes);}else if(settings.theme){settings.classes={};$.each(DEFAULT_CLASSES,function(key,value){settings.classes[key]=value +"-"+ settings.theme;});}else{settings.classes=DEFAULT_CLASSES;}
var saved_tokens=[];var token_count=0;var cache=new $.TokenList.Cache();var timeout;var input_val;var input_box=$("<input type=\"text\"  autocomplete=\"off\">").css({outline:"none"}).attr("id",settings.idPrefix + input.id).focus(function(){if(settings.tokenLimit===null||settings.tokenLimit!==token_count){show_dropdown_hint();}}).blur(function(){hide_dropdown();$(this).val("");}).bind("keyup keydown blur update",resize_input).keydown(function(event){var previous_token;var next_token;switch(event.keyCode){case KEY.LEFT:case KEY.RIGHT:case KEY.UP:case KEY.DOWN:if(!$(this).val()){previous_token=input_token.prev();next_token=input_token.next();if((previous_token.length&&previous_token.get(0)===selected_token)||(next_token.length&&next_token.get(0)===selected_token)){if(event.keyCode===KEY.LEFT||event.keyCode===KEY.UP){deselect_token($(selected_token),POSITION.BEFORE);}else{deselect_token($(selected_token),POSITION.AFTER);}}else if((event.keyCode===KEY.LEFT||event.keyCode===KEY.UP)&&previous_token.length){select_token($(previous_token.get(0)));}else if((event.keyCode===KEY.RIGHT||event.keyCode===KEY.DOWN)&&next_token.length){select_token($(next_token.get(0)));}}else{var dropdown_item=null;if(event.keyCode===KEY.DOWN||event.keyCode===KEY.RIGHT){dropdown_item=$(selected_dropdown_item).next();}else{dropdown_item=$(selected_dropdown_item).prev();}
if(dropdown_item.length){select_dropdown_item(dropdown_item);}
return false;}
break;case KEY.BACKSPACE:previous_token=input_token.prev();if(!$(this).val().length){if(selected_token){delete_token($(selected_token));hidden_input.change();}else if(previous_token.length){select_token($(previous_token.get(0)));}
return false;}else if($(this).val().length===1){hide_dropdown();}else{setTimeout(function(){do_search();},5);}
break;case KEY.TAB:case KEY.ENTER:case KEY.NUMPAD_ENTER:case KEY.COMMA:if(selected_dropdown_item){add_token($(selected_dropdown_item).data("tokeninput"));hidden_input.change();return false;}
break;case KEY.ESCAPE:hide_dropdown();return true;default:if(String.fromCharCode(event.which)){setTimeout(function(){do_search();},5);}
break;}});var hidden_input=$(input).hide().val("").focus(function(){input_box.focus();}).blur(function(){input_box.blur();});var selected_token=null;var selected_token_index=0;var selected_dropdown_item=null;var token_list=$("<ul />").addClass(settings.classes.tokenList).click(function(event){var li=$(event.target).closest("li");if(li&&li.get(0)&&$.data(li.get(0),"tokeninput")){toggle_select_token(li);}else{if(selected_token){deselect_token($(selected_token),POSITION.END);}
input_box.focus();}}).mouseover(function(event){var li=$(event.target).closest("li");if(li&&selected_token!==this){li.addClass(settings.classes.highlightedToken);}}).mouseout(function(event){var li=$(event.target).closest("li");if(li&&selected_token!==this){li.removeClass(settings.classes.highlightedToken);}}).insertBefore(hidden_input);var input_token=$("<li />").addClass(settings.classes.inputToken).appendTo(token_list).append(input_box);var dropdown=$("<div>").addClass(settings.classes.dropdown).appendTo("body").hide();var input_resizer=$("<tester/>").insertAfter(input_box).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:input_box.css("fontSize"),fontFamily:input_box.css("fontFamily"),fontWeight:input_box.css("fontWeight"),letterSpacing:input_box.css("letterSpacing"),whiteSpace:"nowrap"});hidden_input.val("");var li_data=settings.prePopulate||hidden_input.data("pre");if(settings.processPrePopulate&&$.isFunction(settings.onResult)){li_data=settings.onResult.call(hidden_input,li_data);}
if(li_data&&li_data.length){$.each(li_data,function(index,value){insert_token(value);checkTokenLimit();});}
if($.isFunction(settings.onReady)){settings.onReady.call();}
this.clear=function(){token_list.children("li").each(function(){if($(this).children("input").length===0){delete_token($(this));}});}
this.add=function(item){add_token(item);}
this.remove=function(item){token_list.children("li").each(function(){if($(this).children("input").length===0){var currToken=$(this).data("tokeninput");var match=true;for(var prop in item){if(item[prop]!==currToken[prop]){match=false;break;}}
if(match){delete_token($(this));}}});}
this.getTokens=function(){return saved_tokens;}
function checkTokenLimit(){if(settings.tokenLimit!==null&&token_count>=settings.tokenLimit){input_box.hide();hide_dropdown();return;}}
function resize_input(){if(input_val===(input_val=input_box.val())){return;}
var escaped=input_val.replace(/&/g,'&amp;').replace(/\s/g,' ').replace(/</g,'&lt;').replace(/>/g,'&gt;');input_resizer.html(escaped);input_box.width(input_resizer.width()+ 30);}
function is_printable_character(keycode){return((keycode>=48&&keycode<=90)||(keycode>=96&&keycode<=111)||(keycode>=186&&keycode<=192)||(keycode>=219&&keycode<=222));}
function insert_token(item){var this_token=settings.tokenFormatter(item);this_token=$(this_token).addClass(settings.classes.token).insertBefore(input_token);$("<span>"+ settings.deleteText +"</span>").addClass(settings.classes.tokenDelete).appendTo(this_token).click(function(){delete_token($(this).parent());hidden_input.change();return false;});var token_data={"id":item.id};token_data[settings.propertyToSearch]=item[settings.propertyToSearch];$.data(this_token.get(0),"tokeninput",item);saved_tokens=saved_tokens.slice(0,selected_token_index).concat([token_data]).concat(saved_tokens.slice(selected_token_index));selected_token_index++;update_hidden_input(saved_tokens,hidden_input);token_count +=1;if(settings.tokenLimit!==null&&token_count>=settings.tokenLimit){input_box.hide();hide_dropdown();}
return this_token;}
function add_token(item){var callback=settings.onAdd;if(token_count>0&&settings.preventDuplicates){var found_existing_token=null;token_list.children().each(function(){var existing_token=$(this);var existing_data=$.data(existing_token.get(0),"tokeninput");if(existing_data&&existing_data.id===item.id){found_existing_token=existing_token;return false;}});if(found_existing_token){select_token(found_existing_token);input_token.insertAfter(found_existing_token);input_box.focus();return;}}
if(settings.tokenLimit==null||token_count<settings.tokenLimit){insert_token(item);checkTokenLimit();}
input_box.val("");hide_dropdown();if($.isFunction(callback)){callback.call(hidden_input,item);}}
function select_token(token){token.addClass(settings.classes.selectedToken);selected_token=token.get(0);input_box.val("");hide_dropdown();}
function deselect_token(token,position){token.removeClass(settings.classes.selectedToken);selected_token=null;if(position===POSITION.BEFORE){input_token.insertBefore(token);selected_token_index--;}else if(position===POSITION.AFTER){input_token.insertAfter(token);selected_token_index++;}else{input_token.appendTo(token_list);selected_token_index=token_count;}
input_box.focus();}
function toggle_select_token(token){var previous_selected_token=selected_token;if(selected_token){deselect_token($(selected_token),POSITION.END);}
if(previous_selected_token===token.get(0)){deselect_token(token,POSITION.END);}else{select_token(token);}}
function delete_token(token){var token_data=$.data(token.get(0),"tokeninput");var callback=settings.onDelete;var index=token.prevAll().length;if(index>selected_token_index)index--;token.remove();selected_token=null;input_box.focus();saved_tokens=saved_tokens.slice(0,index).concat(saved_tokens.slice(index + 1));if(index<selected_token_index)selected_token_index--;update_hidden_input(saved_tokens,hidden_input);token_count-=1;if(settings.tokenLimit!==null){input_box.show().val("").focus();}
if($.isFunction(callback)){callback.call(hidden_input,token_data);}}
function update_hidden_input(saved_tokens,hidden_input){var token_values=$.map(saved_tokens,function(el){return el[settings.tokenValue];});hidden_input.val(token_values.join(settings.tokenDelimiter));}
function hide_dropdown(){dropdown.hide().empty();selected_dropdown_item=null;}
function show_dropdown(){dropdown.css({position:"absolute",top:$(token_list).offset().top + $(token_list).outerHeight(),left:$(token_list).offset().left,zindex:999}).show();}
function show_dropdown_searching(){if(settings.searchingText){dropdown.html("<p>"+ settings.searchingText +"</p>");show_dropdown();}}
function show_dropdown_hint(){if(settings.hintText){dropdown.html("<p>"+ settings.hintText +"</p>");show_dropdown();}}
function highlight_term(value,term){return value.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+ term +")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>");}
function find_value_and_highlight_term(template,value,term){return template.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+ value +")(?![^<>]*>)(?![^&;]+;)","g"),highlight_term(value,term));}
function populate_dropdown(query,results){if(results&&results.length){dropdown.empty();var dropdown_ul=$("<ul>").appendTo(dropdown).mouseover(function(event){select_dropdown_item($(event.target).closest("li"));}).mousedown(function(event){add_token($(event.target).closest("li").data("tokeninput"));hidden_input.change();return false;}).hide();$.each(results,function(index,value){var this_li=settings.resultsFormatter(value);this_li=find_value_and_highlight_term(this_li,value[settings.propertyToSearch],query);this_li=$(this_li).appendTo(dropdown_ul);if(index%2){this_li.addClass(settings.classes.dropdownItem);}else{this_li.addClass(settings.classes.dropdownItem2);}
if(index===0){select_dropdown_item(this_li);}
$.data(this_li.get(0),"tokeninput",value);});show_dropdown();if(settings.animateDropdown){dropdown_ul.slideDown("fast");}else{dropdown_ul.show();}}else{if(settings.noResultsText){dropdown.html("<p>"+ settings.noResultsText +"</p>");show_dropdown();}}}
function select_dropdown_item(item){if(item){if(selected_dropdown_item){deselect_dropdown_item($(selected_dropdown_item));}
item.addClass(settings.classes.selectedDropdownItem);selected_dropdown_item=item.get(0);}}
function deselect_dropdown_item(item){item.removeClass(settings.classes.selectedDropdownItem);selected_dropdown_item=null;}
function do_search(){var query=input_box.val().toLowerCase();if(query&&query.length){if(selected_token){deselect_token($(selected_token),POSITION.AFTER);}
if(query.length>=settings.minChars){show_dropdown_searching();clearTimeout(timeout);timeout=setTimeout(function(){run_search(query);},settings.searchDelay);}else{hide_dropdown();}}}
function run_search(query){var cache_key=query + computeURL();var cached_results=cache.get(cache_key);if(cached_results){populate_dropdown(query,cached_results);}else{if(settings.url){var url=computeURL();var ajax_params={};ajax_params.data={};if(url.indexOf("?")>-1){var parts=url.split("?");ajax_params.url=parts[0];var param_array=parts[1].split("&");$.each(param_array,function(index,value){var kv=value.split("=");ajax_params.data[kv[0]]=kv[1];});}else{ajax_params.url=url;}
ajax_params.data[settings.queryParam]=query;ajax_params.type=settings.method;ajax_params.dataType=settings.contentType;if(settings.crossDomain){ajax_params.dataType="jsonp";}
ajax_params.success=function(results){if($.isFunction(settings.onResult)){results=settings.onResult.call(hidden_input,results);}
cache.add(cache_key,settings.jsonContainer?results[settings.jsonContainer]:results);if(input_box.val().toLowerCase()===query){populate_dropdown(query,settings.jsonContainer?results[settings.jsonContainer]:results);}};ajax_params.error=function(xhr,status,error){if($.isFunction(settings.onError)){settings.onError.call(xhr,status,error);}};$.ajax(ajax_params);}else if(settings.local_data){var results=$.grep(settings.local_data,function(row){return row[settings.propertyToSearch].toLowerCase().indexOf(query.toLowerCase())>-1;});if($.isFunction(settings.onResult)){results=settings.onResult.call(hidden_input,results);}
cache.add(cache_key,results);populate_dropdown(query,results);}}}
function computeURL(){var url=settings.url;if(typeof settings.url=='function'){url=settings.url.call();}
return url;}};$.TokenList.Cache=function(options){var settings=$.extend({max_size:500},options);var data={};var size=0;var flush=function(){data={};size=0;};this.add=function(query,results){if(size>settings.max_size){flush();}
if(!data[query]){size +=1;}
data[query]=results;};this.get=function(query){return data[query];};};}(jQuery));
;;;