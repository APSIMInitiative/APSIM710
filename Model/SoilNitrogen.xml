<Type name="SoilNitrogen">

  <!-- _________________________________________________________________________________________________________
  This is a copy of parts of soil.xml (extracted and rearranged by RCichota)
  It is meant to be used when using SWIM2 in the graphic user interface.
 __________________________________________________________________________________________________________ -->

  <MetaData>
    <UItype>CSUserInterface.GenericUI</UItype>
    <ShowInMainTree>Yes</ShowInMainTree>
    <Image>%apsim%\UserInterface\Images\banner2.jpg</Image>
    <Documentation name="Nitrogen science documentation">%apsim%\Documentation\4 Module Reference\SoilN.htm</Documentation>
    <LargeIcon>%apsim%\UserInterface\Images\note_pinned32.png</LargeIcon>
    <SmallIcon>%apsim%\UserInterface\Images\note_pinned16.png</SmallIcon>
    <dll>%apsim%/Model/SoilNitrogen.%dllext%</dll>
    <drops>
      <drop>toolbox</drop>
      <drop>area</drop>
      <drop>simulation</drop>
      <drop>folder</drop>
      <drop>factor</drop>
    </drops>
    <ApsimToSim>
      <component name="SoilNitrogen" executable="%apsim%/Model/SoilNitrogen.%dllext%" class="SoilN">
        <executable name="%apsim%/Model/SoilNitrogen.%dllext%" version="1.0" />
        <initdata>
          [Model]
          [SoilNitrogen.innerxml]
        </initdata>
      </component>
    </ApsimToSim>
  </MetaData>
  <Model>
    <SoilNitrogen>

      <!-- Values typically read from soil's interface  -->
      <!-- <root_cn> 30 </root_cn>
      <soiltype> default </soiltype>
      <root_wt> 0.0 </root_wt>
      <soil_cn> 12.0 </soil_cn>
      <enr_a_coeff> 7.4 </enr_a_coeff>
      <enr_b_coeff> 0.2 </enr_b_coeff>  -->
      <oc> 3.0  1.0 </oc>
      <ph> 6.0  6.0 </ph>
      <fbiom> 0.05  0.01 </fbiom>
      <finert> 0.50  0.95 </finert>
      <no3ppm> 5.0  2.0 </no3ppm>
      <nh4ppm> 1.0  0.5 </nh4ppm>


      <!--  -  General setting parameters  ....................................................................................................... -->
      <SoilNParameterSet description="the parameter set used to initialise SoilNitrogen">standard</SoilNParameterSet>
      <allowSimpleSoilTemp description="whether internal soilTemp can be used, otherwise the SoilTemp has to be present"> yes </allowSimpleSoilTemp>
      <allowProfileReduction description="whether soil profile reduction is allowed or not"> no </allowProfileReduction>
      <allowOrganicSolutes description="whether organic solute are defined or not"> no </allowOrganicSolutes>
      <defaultCarbonInSoilOM description="factor to convert organic carbon to organic matter"> 0.588 </defaultCarbonInSoilOM>
      <defaultCarbonInFOM description="Carbon weight fraction in FOM (0-1)"> 0.40 </defaultCarbonInFOM>
      <defaultInitialpH description="Default initial ph, used case no pH is initialised in model"> 6.0 </defaultInitialpH>
      <WarningNegativeThreshold description="Threshold for raising a warning due to small negative values"> -0.0000000001 </WarningNegativeThreshold>
      <FatalNegativeThreshold description="Threshold for a fatal error due to negative values (loss of mass balance)"> -0.0000001 </FatalNegativeThreshold>

      <NPartitionApproach description="The approach to use when partitioning dltN amongst patches"> BasedOnLayerConcentration </NPartitionApproach>

      <!--  -  Parameters for setting soil organic matter  ....................................................................................... -->
      <MBiomassCNr description="C:N ratio of microbes ()"> 8.0 </MBiomassCNr>
      <HumusCNr description="C:N ratio of soil humus"> 12.5 </HumusCNr>
      <MBiomassTurnOverRate description="potential daily rate of soil biomass mineralization (aerobic and anaerobic conditions)">
        <double>0.0081</double>
        <double>0.004</double>
      </MBiomassTurnOverRate>
      <MBiomassRespirationFactor description="fraction of biomass C mineralized retained in system (0-1)"> 0.6 </MBiomassRespirationFactor>
      <MBiomassFractionIntoBiomass description="fraction of retained biomass C returned to biomass (0-1)"> 0.6 </MBiomassFractionIntoBiomass>
      <AHumusTurnOverRate description="potential daily rate of humus mineralization (aerobic and anaerobic conditions)">
        <double>0.00015</double>
        <double>0.00007</double>
      </AHumusTurnOverRate>
      <AHumusRespirationFactor description="fraction of humic C mineralized retained in system (0-1)"> 0.6 </AHumusRespirationFactor>

      <!--  -  Parameters for setting soil fresh organic matter  ................................................................................. -->
      <fom_type description="List of fom types available">
        <string>generic</string>
        <string>manure</string>
        <string>mucuna</string>
        <string>lablab</string>
        <string>shemp</string>
        <string>stable</string>
      </fom_type>
      <fract_carb description="carbohydrate fraction of FOM (0-1)">
        <double>0.2</double>
        <double>0.3</double>
        <double>0.54</double>
        <double>0.57</double>
        <double>0.45</double>
        <double>0.0</double>
      </fract_carb>
      <fract_cell description="cellulose fraction of FOM (0-1)">
        <double>0.7</double>
        <double>0.3</double>
        <double>0.37</double>
        <double>0.37</double>
        <double>0.47</double>
        <double>0.1</double>
      </fract_cell>
      <fract_lign description="lignin fraction of FOM (0-1)">
        <double>0.1</double>
        <double>0.4</double>
        <double>0.09</double>
        <double>0.06</double>
        <double>0.08</double>
        <double>0.9</double>
      </fract_lign>
      <InitialFOMType description="The FOM type to be used for initialisation">generic</InitialFOMType>
      <InitialFOMAmount description="Total amount of FOM in the soil (kg/ha)">2000</InitialFOMAmount>
      <InitialFOMDepth description="Depth down to which initial FOM will be ditributed (mm)"> -99 </InitialFOMDepth>
      <!-- If a negative number is given than the soil depth will be used -->
      <FOMDistributionCoefficient description="Exponent of function used to compute initial distribution of FOM in the soil">3.0</FOMDistributionCoefficient>
      <InitialCNrFOM description="Depth down to which initial FOM will be ditributed (mm)"> 40.0 </InitialCNrFOM>
      <FOMCarbTurnOverRate description="maximum rate constant for decomposition of FPool1 (0-1)">
        <double>0.2</double>
        <double>0.1</double>
      </FOMCarbTurnOverRate>
      <FOMCellTurnOverRate description="maximum rate constant for decomposition of FPool2 (0-1)">
        <double>0.05</double>
        <double>0.25</double>
      </FOMCellTurnOverRate>
      <FOMLignTurnOverRate description="maximum rate constant for decomposition of FPool3 (0-1)">
        <double>0.0095</double>
        <double>0.003</double>
      </FOMLignTurnOverRate>
      <FOMRespirationFactor description="fraction of FOM C mineralized retained in system (0-1)"> 0.6 </FOMRespirationFactor>
      <FOMFractionIntoBiomass description="fraction of retained FOM C transferred to biomass (0-1)"> 0.9 </FOMFractionIntoBiomass>

      <!--  -  Parameters for setting surface OM residues  ....................................................................................... -->
      <ResiduesRespirationFactor description="fraction of residue C mineralized retained in system (0-1)"> 0.6 </ResiduesRespirationFactor>
      <ResiduesFractionIntoBiomass description="fraction of retained residue C transferred to biomass (0-1)"> 0.9 </ResiduesFractionIntoBiomass>
      <ImmobilisationDepth description="depth of soil from which N can be immobilised by decomposing surface residues (mm)"> 100.0 </ImmobilisationDepth>

      <!-- =======================================================================================================
    .                              SETUP for limiting factors on soil processes
           =======================================================================================================
   
    .       > The decomposition/mineralisation parameters (potential rate and temperature factors) are given 
                 for (a) aerobic AND (b)anaerobic conditions *****
   
    .       > The limiting factors for temperature are given by a 'bent stick' function. This is defined by 
                 two points, the value of the factor at zero degrees and the optimum temperature. Additionally
                 an exponent gives the curvature.
             __________________________________________________________________________________________-                   
                Example for temperature factor of hydrolysis:

                     1.0 |....... ______
                         |      _/.                     In this example:
                         |    _/  .                      stf_Hydrol_Topt = 32
                         |  _/    .                      stf_Hydrol_FctrZero = 0.2
                     0.2 |_/      .                      stf_Hydrol_CvExp = 1.0 (i.e. straight line)
                         |________.___
                       0.0        32
                                  OptTemp

   
    .       > The limiting factors for soil moisture and pH are given using 'broken stick' functions,
                 for water the x-axis is a modified water content, where:
                   0.0 = totally dry
                   1.0 = LL15 or wilting point
                   2.0 = DUL or field capacity
                   3.0 = SAT or water content at saturation
             __________________________________________________________________________________________-                   
                Example for moisture factor of nitrification:

                     1.0 |          ______
                         |         /     :\
                         |        /      : \                In this example
                     0.5 |       /       :  \                swf_Nitrif_swx = 0.0; 1.0; 1.25; 2.0; 3.0
                         |      /        :   \               swf_Nitrif_y   = 0.0; 0.0; 1.0;  1.0; 0.0
                         |     /         :    \
                     0.0 |____/__________:_____\_____
                         0    1          2      3
                              LL15       DUL    SAT
                              
          ======================================================================================================= -->

      <!--  -  Limiting factors for fresh OM decomposition  ...................................................................................... -->
      <cnrf_ReductionCoeff description="coeff. to determine the magnitude of C:N effects on decomposition of FOM"> 0.693 </cnrf_ReductionCoeff>
      <cnrf_CNthreshold description="C:N above which decomposition rate of FOM declines"> 25.0 </cnrf_CNthreshold>
      <stf_DecompFOM_Topt description="parameters for the temperature factor, optimum temperature (aerobic and anaerobic conditions)">
        <double>32.0</double>
        <double>32.0</double>
      </stf_DecompFOM_Topt>
      <stf_DecompFOM_FctrZero description="parameters for the temperature factor, value of factor at zero degrees (aerobic and anaerobic)">
        <double>0.0</double>
        <double>0.0</double>
      </stf_DecompFOM_FctrZero>
      <stf_DecompFOM_CvExp description="parameters for the temperature factor, curve exponent (aerobic and anaerobic conditions)">
        <double>2.0</double>
        <double>2.0</double>
      </stf_DecompFOM_CvExp>
      <swf_DecompFOM_swx description="parameters for the moisture factor, values of modified swc (0-3)">
        <double>0.0</double>
        <double>1.0</double>
        <double>1.5</double>
        <double>2.0</double>
        <double>3.0</double>
      </swf_DecompFOM_swx>
      <swf_DecompFOM_y description="parameters for the moisture factor, values of moisture factor corresponding to x (0-1)">
        <double>0.0</double>
        <double>0.0</double>
        <double>1.0</double>
        <double>1.0</double>
        <double>0.5</double>
      </swf_DecompFOM_y>

      <!--  -  Parameters for SOM mineralisation/immobilisation process  ......................................................................... -->
      <stf_MinerSOM_Topt description="parameters for the temperature factor, optimum temperature (aerobic and anaerobic conditions)">
        <double>32.0</double>
        <double>32.0</double>
      </stf_MinerSOM_Topt>
      <stf_MinerSOM_FctrZero description="parameters for the temperature factor, value of factor at zero degrees (aerobic and anaerobic)">
        <double>0.0</double>
        <double>0.0</double>
      </stf_MinerSOM_FctrZero>
      <stf_MinerSOM_CvExp description="parameters for the temperature factor, curve exponent (aerobic and anaerobic conditions)">
        <double>2.0</double>
        <double>2.0</double>
      </stf_MinerSOM_CvExp>
      <swf_MinerSOM_swx description="parameters for the moisture factor, values of modified swc (0-3)">
        <double>0.0</double>
        <double>1.0</double>
        <double>1.5</double>
        <double>2.0</double>
        <double>3.0</double>
      </swf_MinerSOM_swx>
      <swf_MinerSOM_y description="parameters for the moisture factor, values of moisture factor corresponding to x (0-1)">
        <double>0.0</double>
        <double>0.0</double>
        <double>1.0</double>
        <double>1.0</double>
        <double>0.5</double>
      </swf_MinerSOM_y>

      <!--  -  Parameters for urea hydrolysis  ................................................................................................... -->
      <potHydrol_min description="minimum potential hydrolysis rate for urea (/day)"> 0.25 </potHydrol_min>
      <potHydrol_parmA description="parameter A for potential urea hydrolysis function"> -1.12 </potHydrol_parmA>
      <potHydrol_parmB description="parameter B for potential urea hydrolysis function"> 1.31 </potHydrol_parmB>
      <potHydrol_parmC description="parameter C for potential urea hydrolysis function"> 0.203 </potHydrol_parmC>
      <potHydrol_parmD description="parameter D for potential urea hydrolysis function"> -0.155 </potHydrol_parmD>
      <!-- Limiting factors for hydrolysis -->
      <stf_Hydrol_Topt description="parameters for the temperature factor, optimum temperature (aerobic and anaerobic)">
        <double>32.0</double>
        <double>32.0</double>
      </stf_Hydrol_Topt>
      <stf_Hydrol_FctrZero description="parameters for the temperature factor, value of factor at zero degrees (aerobic and anaerobic)">
        <double>0.20</double>
        <double>0.20</double>
      </stf_Hydrol_FctrZero>
      <stf_Hydrol_CvExp description="parameters for the temperature factor, curve exponent (aerobic and anaerobic)">
        <double>1.0</double>
        <double>1.0</double>
      </stf_Hydrol_CvExp>
      <swf_Hydrol_swx description="parameters for the moisture factor, values of modified swc (0-3)">
        <double>0.0</double>
        <double>1.0</double>
        <double>1.4</double>
        <double>2.4</double>
        <double>3.0</double>
      </swf_Hydrol_swx>
      <swf_Hydrol_y description="parameters for the moisture factor, values of moisture factor corresponding to x (0-1)">
        <double>0.2</double>
        <double>0.2</double>
        <double>1.0</double>
        <double>1.0</double>
        <double>0.7</double>
      </swf_Hydrol_y>

      <!-- Parameters for nitrification -->
      <nitrification_pot units="ppm" description="Soil Nitrification potential (ug NH4/g soil)"> 40.0 </nitrification_pot>
      <nh4_at_half_pot units="ppm" description="NH4 concentration at half potential nitrification (Michaelis-Menten kinetics)"> 90.0 </nh4_at_half_pot>
      <n2oLossFactor description="Fraction of nitrification lost as denitrification"> 0.0 </n2oLossFactor>
      <!-- Limiting factors for nitrification -->
      <stf_Nitrif_Topt description="parameters for the temperature factor, optimum temperature (aerobic and anaerobic)">
        <double>32.0</double>
        <double>32.0</double>
      </stf_Nitrif_Topt>
      <stf_Nitrif_FctrZero description="parameters for the temperature factor, value of factor at zero degrees (aerobic and anaerobic)">
        <double>0.00</double>
        <double>0.00</double>
      </stf_Nitrif_FctrZero>
      <stf_Nitrif_CvExp description="parameters for the temperature factor, curve exponent (aerobic and anaerobic)">
        <double>2.0</double>
        <double>2.0</double>
      </stf_Nitrif_CvExp>
      <swf_Nitrif_swx description="parameters for the moisture factor, values of modified swc (0-3)">
        <double>0.0</double>
        <double>1.0</double>
        <double>1.25</double>
        <double>2.0</double>
        <double>3.0</double>
      </swf_Nitrif_swx>
      <swf_Nitrif_y description="parameters for the moisture factor, values of moisture factor corresponding to x (0-1)">
        <double>0.0</double>
        <double>0.0</double>
        <double>1.0</double>
        <double>1.0</double>
        <double>0.0</double>
      </swf_Nitrif_y>
      <phf_Nitrif_phx description="parameters for pH factor, values of soil ph (0-14)">
        <double>0.0</double>
        <double>4.5</double>
        <double>6.0</double>
        <double>8.0</double>
        <double>9.0</double>
        <double>14.0</double>
      </phf_Nitrif_phx>
      <phf_Nitrif_y description="parameters for pH factor, values of pH factor corresponding to x (0-1)">
        <double>0.0</double>
        <double>0.0</double>
        <double>1.0</double>
        <double>1.0</double>
        <double>0.0</double>
        <double>0.0</double>
      </phf_Nitrif_y>

      <!--  -  Parameters for denitrification  ................................................................................................... -->
      <DenitRateCoefficient description="denitrification rate coefficient (kg soil/mg C per day)"> 0.0006 </DenitRateCoefficient>
      <actC_parmA description="parameter A to compute active carbon"> 24.5 </actC_parmA>
      <actC_parmB description="parameter B to compute active carbon"> 0.0031 </actC_parmB>
      <!-- Limiting factors for denitrification -->
      <stf_dnit_Topt description="parameter for the temperature factor, optimum temperature (aerobic and anaerobic)">
        <double>50.056</double>
        <double>50.0056</double>
      </stf_dnit_Topt>
      <stf_dnit_FctrZero description="parameters for the temperature factor, value of factor at zero degrees (aerobic and anaerobic)">
        <double>0.10</double>
        <double>0.10</double>
      </stf_dnit_FctrZero>
      <stf_dnit_CvExp description="parameters for the temperature factor, curve exponent (aerobic and anaerobic)">
        <double>68350.0</double>
        <double>68350.0</double>
      </stf_dnit_CvExp>
      <swf_dnit_swx description="parameters for the moisture factor, values of modified swc (0-3)">
        <double>0.0</double>
        <double>2.0</double>
        <double>3.0</double>
      </swf_dnit_swx>
      <swf_dnit_y description="parameters for the moisture factor, values of moisture factor corresponding to x (0-1)">
        <double>0.0</double>
        <double>0.0</double>
        <double>1.0</double>
      </swf_dnit_y>
      <!-- Parameters for computing the N2-N20 ration -->
      <dnit_k1 description="K1 parameter from Thorburn et al (2010) for N2O model"> 25.1 </dnit_k1>
      <N2N2O_parmA description="parameter A in the equation computing the N2:N2O ratio"> 0.16 </N2N2O_parmA>
      <N2N2O_parmB description="parameter B in the equation computing the N2:N2O ratio"> -0.80 </N2N2O_parmB>
      <swpsf_dnit_swpx description="parameters for WFPS factor to compute N2:N2O ratio, values of water filled pore space (%)">
        <double>0.0</double>
        <double>28.0</double>
        <double>88.0</double>
        <double>100.0</double>
      </swpsf_dnit_swpx>
      <swpsf_dnit_y description="parameters for WFPS factor to compute N2:N2O ratio, values of WFPS factor corresponding to x (0-1)">
        <double>0.1</double>
        <double>0.1</double>
        <double>1.0</double>
        <double>1.18</double>
      </swpsf_dnit_y>

      <!--  -  Parameters for handling soil loss process  ........................................................................................ -->
      <enr_a_coeff description="coefficient A for erosion enrichment function">7.4</enr_a_coeff>
      <enr_b_coeff description="coefficient B for erosion enrichment function">0.2</enr_b_coeff>
    </SoilNitrogen>
  </Model>
</Type>
